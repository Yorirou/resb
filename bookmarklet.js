(function(a,b){function cu(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cr(a){if(!cz[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){ch||(ch=c.createElement("iframe"),ch.frameBorder=ch.width=ch.height=0),b.appendChild(ch);if(!ci||!ch.createElement)ci=(ch.contentWindow||ch.contentDocument).document,ci.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),ci.close();d=ci.createElement(a),ci.body.appendChild(d),e=f.css(d,"display"),b.removeChild(ch)}cz[a]=e}return cz[a]}function cq(a,b){var c={};f.each(cm.concat.apply([],cm.slice(0,b)),function(){c[this]=a});return c}function cp(){cn=b}function co(){setTimeout(cp,0);return cn=f.now()}function cf(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ce(){try{return new a.XMLHttpRequest}catch(b){}}function b$(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function bZ(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function bY(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bA.test(a)?d(a,e):bY(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)bY(a+"["+e+"]",b[e],c,d);else d(a,b)}function bX(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function bW(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bP,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=bW(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=bW(a,c,d,e,"*",g));return l}function bV(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bL),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function by(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bt:bu;if(d>0){c!=="border"&&f.each(e,function(){c||(d-=parseFloat(f.css(a,"padding"+this))||0),c==="margin"?d+=parseFloat(f.css(a,c+this))||0:d-=parseFloat(f.css(a,"border"+this+"Width"))||0});return d+"px"}d=bv(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0,c&&f.each(e,function(){d+=parseFloat(f.css(a,"padding"+this))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+this+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+this))||0)});return d+"px"}function bl(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bd,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bk(a){f.nodeName(a,"input")?bj(a):"getElementsByTagName"in a&&f.grep(a.getElementsByTagName("input"),bj)}function bj(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bi(a){return"getElementsByTagName"in a?a.getElementsByTagName("*"):"querySelectorAll"in a?a.querySelectorAll("*"):[]}function bh(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bg(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c=f.expando,d=f.data(a),e=f.data(b,d);if(d=d[c]){var g=d.events;e=e[c]=f.extend({},d);if(g){delete e.handle,e.events={};for(var h in g)for(var i=0,j=g[h].length;i<j;i++)f.event.add(b,h+(g[h][i].namespace?".":"")+g[h][i].namespace,g[h][i],g[h][i].data)}}}}function bf(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function V(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(Q.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function U(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function M(a,b){return(a&&a!=="*"?a+".":"")+b.replace(y,"`").replace(z,"&")}function L(a){var b,c,d,e,g,h,i,j,k,l,m,n,o,p=[],q=[],r=f._data(this,"events");if(!(a.liveFired===this||!r||!r.live||a.target.disabled||a.button&&a.type==="click")){a.namespace&&(n=new RegExp("(^|\\.)"+a.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)")),a.liveFired=this;var s=r.live.slice(0);for(i=0;i<s.length;i++)g=s[i],g.origType.replace(w,"")===a.type?q.push(g.selector):s.splice(i--,1);e=f(a.target).closest(q,a.currentTarget);for(j=0,k=e.length;j<k;j++){m=e[j];for(i=0;i<s.length;i++){g=s[i];if(m.selector===g.selector&&(!n||n.test(g.namespace))&&!m.elem.disabled){h=m.elem,d=null;if(g.preType==="mouseenter"||g.preType==="mouseleave")a.type=g.preType,d=f(a.relatedTarget).closest(g.selector)[0],d&&f.contains(h,d)&&(d=h);(!d||d!==h)&&p.push({elem:h,handleObj:g,level:m.level})}}}for(j=0,k=p.length;j<k;j++){e=p[j];if(c&&e.level>c)break;a.currentTarget=e.elem,a.data=e.handleObj.data,a.handleObj=e.handleObj,o=e.handleObj.origHandler.apply(e.elem,arguments);if(o===!1||a.isPropagationStopped()){c=e.level,o===!1&&(b=!1);if(a.isImmediatePropagationStopped())break}}return b}}function J(a,c,d){var e=f.extend({},d[0]);e.type=a,e.originalEvent={},e.liveFired=b,f.event.handle.call(c,e),e.isDefaultPrevented()&&d[0].preventDefault()}function D(){return!0}function C(){return!1}function m(a,c,d){var e=c+"defer",g=c+"queue",h=c+"mark",i=f.data(a,e,b,!0);i&&(d==="queue"||!f.data(a,g,b,!0))&&(d==="mark"||!f.data(a,h,b,!0))&&setTimeout(function(){!f.data(a,g,b,!0)&&!f.data(a,h,b,!0)&&(f.removeData(a,e,!0),i.resolve())},0)}function l(a){for(var b in a)if(b!=="toJSON")return!1;return!0}function k(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(j,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNaN(d)?i.test(d)?f.parseJSON(d):d:parseFloat(d)}catch(g){}f.data(a,c,d)}else d=b}return d}var c=a.document,d=a.navigator,e=a.location,f=function(){function K(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(K,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/\d/,n=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,o=/^[\],:{}\s]*$/,p=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,q=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,r=/(?:^|:|,)(?:\s*\[)+/g,s=/(webkit)[ \/]([\w.]+)/,t=/(opera)(?:.*version)?[ \/]([\w.]+)/,u=/(msie) ([\w.]+)/,v=/(mozilla)(?:.*? rv:([\w.]+))?/,w=/-([a-z]|[0-9])/ig,x=/^-ms-/,y=function(a,b){return(b+"").toUpperCase()},z=d.userAgent,A,B,C,D=Object.prototype.toString,E=Object.prototype.hasOwnProperty,F=Array.prototype.push,G=Array.prototype.slice,H=String.prototype.trim,I=Array.prototype.indexOf,J={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=n.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.6.4",length:0,size:function(){return this.length},toArray:function(){return G.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?F.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),B.done(a);return this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(G.apply(this,arguments),"slice",G.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:F,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;B.resolveWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").unbind("ready")}},bindReady:function(){if(!B){B=e._Deferred();if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",C,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",C),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&K()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNaN:function(a){return a==null||!m.test(a)||isNaN(a)},type:function(a){return a==null?String(a):J[D.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!E.call(a,"constructor")&&!E.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||E.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw a},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(o.test(b.replace(p,"@").replace(q,"]").replace(r,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(x,"ms-").replace(w,y)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:H?function(a){return a==null?"":H.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?F.call(c,a):e.merge(c,a)}return c},inArray:function(a,b){if(!b)return-1;if(I)return I.call(b,a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c;return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=G.call(arguments,2),g=function(){return a.apply(c,f.concat(G.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=s.exec(a)||t.exec(a)||u.exec(a)||a.indexOf("compatible")<0&&v.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){J["[object "+b+"]"]=b.toLowerCase()}),A=e.uaMatch(z),A.browser&&(e.browser[A.browser]=!0,e.browser.version=A.version),e.browser.webkit&&(e.browser.safari=!0),j.test("Â ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?C=function(){c.removeEventListener("DOMContentLoaded",C,!1),e.ready()}:c.attachEvent&&(C=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",C),e.ready())});return e}(),g="done fail isResolved isRejected promise then always pipe".split(" "),h=[].slice;f.extend({_Deferred:function(){var a=[],b,c,d,e={done:function(){if(!d){var c=arguments,g,h,i,j,k;b&&(k=b,b=0);for(g=0,h=c.length;g<h;g++)i=c[g],j=f.type(i),j==="array"?e.done.apply(e,i):j==="function"&&a.push(i);k&&e.resolveWith(k[0],k[1])}return this},resolveWith:function(e,f){if(!d&&!b&&!c){f=f||[],c=1;try{while(a[0])a.shift().apply(e,f)}finally{b=[e,f],c=0}}return this},resolve:function(){e.resolveWith(this,arguments);return this},isResolved:function(){return!!c||!!b},cancel:function(){d=1,a=[];return this}};return e},Deferred:function(a){var b=f._Deferred(),c=f._Deferred(),d;f.extend(b,{then:function(a,c){b.done(a).fail(c);return this},always:function(){return b.done.apply(b,arguments).fail.apply(this,arguments)},fail:c.done,rejectWith:c.resolveWith,reject:c.resolve,isRejected:c.isResolved,pipe:function(a,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[c,"reject"]},function(a,c){var e=c[0],g=c[1],h;f.isFunction(e)?b[a](function(){h=e.apply(this,arguments),h&&f.isFunction(h.promise)?h.promise().then(d.resolve,d.reject):d[g+"With"](this===b?d:this,[h])}):b[a](d[g])})}).promise()},promise:function(a){if(a==null){if(d)return d;d=a={}}var c=g.length;while(c--)a[g[c]]=b[g[c]];return a}}),b.done(c.cancel).fail(b.cancel),delete b.cancel,a&&a.call(b,b);return b},when:function(a){function i(a){return function(c){b[a]=arguments.length>1?h.call(arguments,0):c,--e||g.resolveWith(g,h.call(b,0))}}var b=arguments,c=0,d=b.length,e=d,g=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred();if(d>1){for(;c<d;c++)b[c]&&f.isFunction(b[c].promise)?b[c].promise().then(i(c),g.reject):--e;e||g.resolveWith(g,b)}else g!==a&&g.resolveWith(g,d?[a]:[]);return g.promise()}}),f.support=function(){var a=c.createElement("div"),b=c.documentElement,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;a.setAttribute("className","t"),a.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=a.getElementsByTagName("*"),e=a.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=a.getElementsByTagName("input")[0],k={leadingWhitespace:a.firstChild.nodeType===3,tbody:!a.getElementsByTagName("tbody").length,htmlSerialize:!!a.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55$/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:a.className!=="t",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,k.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,k.optDisabled=!h.disabled;try{delete a.test}catch(v){k.deleteExpando=!1}!a.addEventListener&&a.attachEvent&&a.fireEvent&&(a.attachEvent("onclick",function(){k.noCloneEvent=!1}),a.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),k.radioValue=i.value==="t",i.setAttribute("checked","checked"),a.appendChild(i),l=c.createDocumentFragment(),l.appendChild(a.firstChild),k.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,a.innerHTML="",a.style.width=a.style.paddingLeft="1px",m=c.getElementsByTagName("body")[0],o=c.createElement(m?"div":"body"),p={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},m&&f.extend(p,{position:"absolute",left:"-1000px",top:"-1000px"});for(t in p)o.style[t]=p[t];o.appendChild(a),n=m||b,n.insertBefore(o,n.firstChild),k.appendChecked=i.checked,k.boxModel=a.offsetWidth===2,"zoom"in a.style&&(a.style.display="inline",a.style.zoom=1,k.inlineBlockNeedsLayout=a.offsetWidth===2,a.style.display="",a.innerHTML="<div style='width:4px;'></div>",k.shrinkWrapBlocks=a.offsetWidth!==2),a.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",q=a.getElementsByTagName("td"),u=q[0].offsetHeight===0,q[0].style.display="",q[1].style.display="none",k.reliableHiddenOffsets=u&&q[0].offsetHeight===0,a.innerHTML="",c.defaultView&&c.defaultView.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",a.appendChild(j),k.reliableMarginRight=(parseInt((c.defaultView.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0),o.innerHTML="",n.removeChild(o);if(a.attachEvent)for(t in{submit:1,change:1,focusin:1})s="on"+t,u=s in a,u||(a.setAttribute(s,"return;"),u=typeof a[s]=="function"),k[t+"Bubbles"]=u;o=l=g=h=m=j=a=i=null;return k}(),f.boxModel=f.support.boxModel;var i=/^(?:\{.*\}|\[.*\])$/,j=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!l(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i=f.expando,j=typeof c=="string",k=a.nodeType,l=k?f.cache:a,m=k?a[f.expando]:a[f.expando]&&f.expando;if((!m||e&&m&&l[m]&&!l[m][i])&&j&&d===b)return;m||(k?a[f.expando]=m=++f.uuid:m=f.expando),l[m]||(l[m]={},k||(l[m].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?l[m][i]=f.extend(l[m][i],c):l[m]=f.extend(l[m],c);g=l[m],e&&(g[i]||(g[i]={}),g=g[i]),d!==b&&(g[f.camelCase(c)]=d);if(c==="events"&&!g[c])return g[i]&&g[i].events;j?(h=g[c],h==null&&(h=g[f.camelCase(c)])):h=g;return h}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e=f.expando,g=a.nodeType,h=g?f.cache:a,i=g?a[f.expando]:f.expando;if(!h[i])return;if(b){d=c?h[i][e]:h[i];if(d){d[b]||(b=f.camelCase(b)),delete d[b];if(!l(d))return}}if(c){delete h[i][e];if(!l(h[i]))return}var j=h[i][e];f.support.deleteExpando||!h.setInterval?delete h[i]:h[i]=null,j?(h[i]={},g||(h[i].toJSON=f.noop),h[i][e]=j):g&&(f.support.deleteExpando?delete a[f.expando]:a.removeAttribute?a.removeAttribute(f.expando):a[f.expando]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d=null;if(typeof a=="undefined"){if(this.length){d=f.data(this[0]);if(this[0].nodeType===1){var e=this[0].attributes,g;for(var h=0,i=e.length;h<i;h++)g=e[h].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),k(this[0],g,d[g]))}}return d}if(typeof a=="object")return this.each(function(){f.data(this,a)});var j=a.split(".");j[1]=j[1]?"."+j[1]:"";if(c===b){d=this.triggerHandler("getData"+j[1]+"!",[j[0]]),d===b&&this.length&&(d=f.data(this[0],a),d=k(this[0],a,d));return d===b&&j[1]?this.data(j[0]):d}return this.each(function(){var b=f(this),d=[j[0],c];b.triggerHandler("setData"+j[1]+"!",d),f.data(this,a,c),b.triggerHandler("changeData"+j[1]+"!",d)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,c){a&&(c=(c||"fx")+"mark",f.data(a,c,(f.data(a,c,b,!0)||0)+1,!0))},_unmark:function(a,c,d){a!==!0&&(d=c,c=a,a=!1);if(c){d=d||"fx";var e=d+"mark",g=a?0:(f.data(c,e,b,!0)||1)-1;g?f.data(c,e,g,!0):(f.removeData(c,e,!0),m(c,d,"mark"))}},queue:function(a,c,d){if(a){c=(c||"fx")+"queue";var e=f.data(a,c,b,!0);d&&(!e||f.isArray(d)?e=f.data(a,c,f.makeArray(d),!0):e.push(d));return e||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e;d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),d.call(a,function(){f.dequeue(a,b)})),c.length||(f.removeData(a,b+"queue",!0),m(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(){var c=this;setTimeout(function(){f.dequeue(c,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f._Deferred(),!0))h++,l.done(m);m();return d.promise()}});var n=/[\n\t\r]/g,o=/\s+/,p=/\r/g,q=/^(?:button|input)$/i,r=/^(?:button|input|object|select|textarea)$/i,s=/^a(?:rea)?$/i,t=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,u,v;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(o);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(o);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(n," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(o);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ";for(var c=0,d=this.length;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(n," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e=this[0];if(!arguments.length){if(e){c=f.valHooks[e.nodeName.toLowerCase()]||f.valHooks[e.type];if(c&&"get"in c&&(d=c.get(e,"value"))!==b)return d;d=e.value;return typeof d=="string"?d.replace(p,""):d==null?"":d}return b}var g=f.isFunction(a);return this.each(function(d){var e=f(this),h;if(this.nodeType===1){g?h=a.call(this,d,e.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c=a.selectedIndex,d=[],e=a.options,g=a.type==="select-one";if(c<0)return null;for(var h=g?c:0,i=g?c+1:e.length;h<i;h++){var j=e[h];if(j.selected&&(f.support.optDisabled?!j.disabled:j.getAttribute("disabled")===null)&&(!j.parentNode.disabled||!f.nodeName(j.parentNode,"optgroup"))){b=f(j).val();if(g)return b;d.push(b)}}if(g&&!d.length&&e.length)return f(e[c]).val();return d},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attrFix:{tabindex:"tabIndex"},attr:function(a,c,d,e){var g=a.nodeType;if(!a||g===3||g===8||g===2)return b;if(e&&c in f.attrFn)return f(a)[c](d);if(!("getAttribute"in a))return f.prop(a,c,d);var h,i,j=g!==1||!f.isXMLDoc(a);j&&(c=f.attrFix[c]||c,i=f.attrHooks[c],i||(t.test(c)?i=v:u&&(i=u)));if(d!==b){if(d===null){f.removeAttr(a,c);return b}if(i&&"set"in i&&j&&(h=i.set(a,d,c))!==b)return h;a.setAttribute(c,""+d);return d}if(i&&"get"in i&&j&&(h=i.get(a,c))!==null)return h;h=a.getAttribute(c);return h===null?b:h},removeAttr:function(a,b){var c;a.nodeType===1&&(b=f.attrFix[b]||b,f.attr(a,b,""),a.removeAttribute(b),t.test(b)&&(c=f.propFix[b]||b)in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,b){if(q.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(u&&f.nodeName(a,"button"))return u.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(u&&f.nodeName(a,"button"))return u.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e=a.nodeType;if(!a||e===3||e===8||e===2)return b;var g,h,i=e!==1||!f.isXMLDoc(a);i&&(c=f.propFix[c]||c,h=f.propHooks[c]);return d!==b?h&&"set"in h&&(g=h.set(a,d,c))!==b?g:a[c]=d:h&&"get"in h&&(g=h.get(a,c))!==null?g:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):r.test(a.nodeName)||s.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabIndex=f.propHooks.tabIndex,v={get:function(a,c){var d;return f.prop(a,c)===!0||(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},f.support.getSetAttribute||(u=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&d.nodeValue!==""?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})})),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var w=/\.(.*)$/,x=/^(?:textarea|input|select)$/i,y=/\./g,z=/ /g,A=/[^\w\s.|`]/g,B=function(a){return a.replace(A,"\\$&")};f.event={add:function(a,c,d,e){if(a.nodeType!==3&&a.nodeType!==8){if(d===!1)d=C;else if(!d)return;var g,h;d.handler&&(g=d,d=g.handler),d.guid||(d.guid=f.guid++);var i=f._data(a);if(!i)return;var j=i.events,k=i.handle;j||(i.events=j={}),k||(i.handle=k=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.handle.apply(k.elem,arguments):b}),k.elem=a,c=c.split(" ");var l,m=0,n;while(l=c[m++]){h=g?f.extend({},g):{handler:d,data:e},l.indexOf(".")>-1?(n=l.split("."),l=n.shift(),h.namespace=n.slice(0).sort().join(".")):(n=[],h.namespace=""),h.type=l,h.guid||(h.guid=d.guid);var o=j[l],p=f.event.special[l]||{};if(!o){o=j[l]=[];if(!p.setup||p.setup.call(a,e,n,k)===!1)a.addEventListener?a.addEventListener(l,k,!1):a.attachEvent&&a.attachEvent("on"+l,k)}p.add&&(p.add.call(a,h),h.handler.guid||(h.handler.guid=d.guid)),o.push(h),f.event.global[l]=!0}a=null}},global:{},remove:function(a,c,d,e){if(a.nodeType!==3&&a.nodeType!==8){d===!1&&(d=C);var g,h,i,j,k=0,l,m,n,o,p,q,r,s=f.hasData(a)&&f._data(a),t=s&&s.events;if(!s||!t)return;c&&c.type&&(d=c.handler,c=c.type);if(!c||typeof c=="string"&&c.charAt(0)==="."){c=c||"";for(h in t)f.event.remove(a,h+c);return}c=c.split(" ");while(h=c[k++]){r=h,q=null,l=h.indexOf(".")<0,m=[],l||(m=h.split("."),h=m.shift(),n=new RegExp("(^|\\.)"+f.map(m.slice(0).sort(),B).join("\\.(?:.*\\.)?")+"(\\.|$)")),p=t[h];if(!p)continue;if(!d){for(j=0;j<p.length;j++){q=p[j];if(l||n.test(q.namespace))f.event.remove(a,r,q.handler,j),p.splice(j--,1)}continue}o=f.event.special[h]||{};for(j=e||0;j<p.length;j++){q=p[j];if(d.guid===q.guid){if(l||n.test(q.namespace))e==null&&p.splice(j--,1),o.remove&&o.remove.call(a,q);if(e!=null)break}}if(p.length===0||e!=null&&p.length===1)(!o.teardown||o.teardown.call(a,m)===!1)&&f.removeEvent(a,h,s.handle),g=null,delete t[h]}if(f.isEmptyObject(t)){var u=s.handle;u&&(u.elem=null),delete s.events,delete s.handle,f.isEmptyObject(s)&&f.removeData(a,b,!0)}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){var h=c.type||c,i=[],j;h.indexOf("!")>=0&&(h=h.slice(0,-1),j=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if(!!e&&!f.event.customEvent[h]||!!f.event.global[h]){c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.exclusive=j,c.namespace=i.join("."),c.namespace_re=new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)");if(g||!e)c.preventDefault(),c.stopPropagation();if(!e){f.each(f.cache,function(){var a=f.expando,b=this[a];b&&b.events&&b.events[h]&&f.event.trigger(c,d,b.handle.elem)});return}if(e.nodeType===3||e.nodeType===8)return;c.result=b,c.target=e,d=d!=null?f.makeArray(d):[],d.unshift(c);var k=e,l=h.indexOf(":")<0?"on"+h:"";do{var m=f._data(k,"handle");c.currentTarget=k,m&&m.apply(k,d),l&&f.acceptData(k)&&k[l]&&k[l].apply(k,d)===!1&&(c.result=!1,c.preventDefault()),k=k.parentNode||k.ownerDocument||k===c.target.ownerDocument&&a}while(k&&!c.isPropagationStopped());if(!c.isDefaultPrevented()){var n,o=f.event.special[h]||{};if((!o._default||o._default.call(e.ownerDocument,c)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)){try{l&&e[h]&&(n=e[l],n&&(e[l]=null),f.event.triggered=h,e[h]())}catch(p){}n&&(e[l]=n),f.event.triggered=b}}return c.result}},handle:function(c){c=f.event.fix(c||a.event);var d=((f._data(this,"events")||{})[c.type]||[]).slice(0),e=!c.exclusive&&!c.namespace,g=Array.prototype.slice.call(arguments,0);g[0]=c,c.currentTarget=this;for(var h=0,i=d.length;h<i;h++){var j=d[h];if(e||c.namespace_re.test(j.namespace)){c.handler=j.handler,c.data=j.data,c.handleObj=j;var k=j.handler.apply(this,g);k!==b&&(c.result=k,k===!1&&(c.preventDefault(),c.stopPropagation()));if(c.isImmediatePropagationStopped())break}}return c.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(a){if(a[f.expando])return a;var d=a;a=f.Event(d);for(var e=this.props.length,g;e;)g=this.props[--e],a[g]=d[g];a.target||(a.target=a.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement);if(a.pageX==null&&a.clientX!=null){var h=a.target.ownerDocument||c,i=h.documentElement,j=h.body;a.pageX=a.clientX+(i&&i.scrollLeft||j&&j.scrollLeft||0)-(i&&i.clientLeft||j&&j.clientLeft||0),a.pageY=a.clientY+(i&&i.scrollTop||j&&j.scrollTop||0)-(i&&i.clientTop||j&&j.clientTop||0)}a.which==null&&(a.charCode!=null||a.keyCode!=null)&&(a.which=a.charCode!=null?a.charCode:a.keyCode),!a.metaKey&&a.ctrlKey&&(a.metaKey=a.ctrlKey),!a.which&&a.button!==b&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);return a},guid:1e8,proxy:f.proxy,special:{ready:{setup:f.bindReady,teardown:f.noop},live:{add:function(a){f.event.add(this,M(a.origType,a.selector),f.extend({},a,{handler:L,guid:a.handler.guid}))},remove:function(a){f.event.remove(this,M(a.origType,a.selector),a)}},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}}},f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!this.preventDefault)return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?D:C):this.type=a,b&&f.extend(this,b),this.timeStamp=f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=D;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=D;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=D,this.stopPropagation()},isDefaultPrevented:C,isPropagationStopped:C,isImmediatePropagationStopped:C};var E=function(a){var b=a.relatedTarget,c=!1,d=a.type;a.type=a.data,b!==this&&(b&&(c=f.contains(this,b)),c||(f.event.handle.apply(this,arguments),a.type=d))},F=function(a){a.type=a.data,f.event.handle.apply(this,arguments)};f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={setup:function(c){f.event.add(this,b,c&&c.selector?F:E,a)},teardown:function(a){f.event.remove(this,b,a&&a.selector?F:E)}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(a,b){if(!f.nodeName(this,"form"))f.event.add(this,"click.specialSubmit",function(a){var b=a.target,c=f.nodeName(b,"input")||f.nodeName(b,"button")?b.type:"";(c==="submit"||c==="image")&&f(b).closest("form").length&&J("submit",this,arguments)}),f.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,c=f.nodeName(b,"input")||f.nodeName(b,"button")?b.type:"";(c==="text"||c==="password")&&f(b).closest("form").length&&a.keyCode===13&&J("submit",this,arguments)});else return!1},teardown:function(a){f.event.remove(this,".specialSubmit")}});if(!f.support.changeBubbles){var G,H=function(a){var b=f.nodeName(a,"input")?a.type:"",c=a.value;b==="radio"||b==="checkbox"?c=a.checked:b==="select-multiple"?c=a.selectedIndex>-1?f.map(a.options,function(a){return a.selected}).join("-"):"":f.nodeName(a,"select")&&(c=a.selectedIndex);return c},I=function(c){var d=c.target,e,g;if(!!x.test(d.nodeName)&&!d.readOnly){e=f._data(d,"_change_data"),g=H(d),(c.type!=="focusout"||d.type!=="radio")&&f._data(d,"_change_data",g);if(e===b||g===e)return;if(e!=null||g)c.type="change",c.liveFired=b,f.event.trigger(c,arguments[1],d)}};f.event.special.change={filters:{focusout:I,beforedeactivate:I,click:function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";(c==="radio"||c==="checkbox"||f.nodeName(b,"select"))&&I.call(this,a)},keydown:function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";(a.keyCode===13&&!f.nodeName(b,"textarea")||a.keyCode===32&&(c==="checkbox"||c==="radio")||c==="select-multiple")&&I.call(this,a)},beforeactivate:function(a){var b=a.target;f._data(b,"_change_data",H(b))}},setup:function(a,b){if(this.type==="file")return!1;for(var c in G)f.event.add(this,c+".specialChange",G[c]);return x.test(this.nodeName)},teardown:function(a){f.event.remove(this,".specialChange");return x.test(this.nodeName)}},G=f.event.special.change.filters,G.focus=G.beforeactivate}f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){function e(a){var c=f.event.fix(a);c.type=b,c.originalEvent={},f.event.trigger(c,null,c.target),c.isDefaultPrevented()&&a.preventDefault()}var d=0;f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.each(["bind","one"],function(a,c){f.fn[c]=function(a,d,e){var g;if(typeof a=="object"){for(var h in a)this[c](h,d,a[h],e);return this}if(arguments.length===2||d===!1)e=d,d=b;c==="one"?(g=function(a){f(this).unbind(a,g);return e.apply(this,arguments)},g.guid=e.guid||f.guid++):g=e;if(a==="unload"&&c!=="one")this.one(a,d,e);else for(var i=0,j=this.length;i<j;i++)f.event.add(this[i],a,g,d);return this}}),f.fn.extend({unbind:function(a,b){if(typeof a=="object"&&!a.preventDefault)for(var c in a)this.unbind(c,a[c]);else for(var d=0,e=this.length;d<e;d++)f.event.remove(this[d],a,b);return this},delegate:function(a,b,c,d){return this.live(b,c,d,a)},undelegate:function(a,b,c){return arguments.length===0?this.unbind("live"):this.die(b,null,c,a)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f.data(this,"lastToggle"+a.guid)||0)%d;f.data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var K={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};f.each(["live","die"],function(a,c){f.fn[c]=function(a,d,e,g){var h,i=0,j,k,l,m=g||this.selector,n=g?this:f(this.context);if(typeof a=="object"&&!a.preventDefault){for(var o in a)n[c](o,d,a[o],m);return this}if(c==="die"&&!a&&g&&g.charAt(0)==="."){n.unbind(g);return this}if(d===!1||f.isFunction(d))e=d||C,d=b;a=(a||"").split(" ");while((h=a[i++])!=null){j=w.exec(h),k="",j&&(k=j[0],h=h.replace(w,""));if(h==="hover"){a.push("mouseenter"+k,"mouseleave"+k);continue}l=h,K[h]?(a.push(K[h]+k),h=h+k):h=(K[h]||h)+k;if(c==="live")for(var p=0,q=n.length;p<q;p++)f.event.add(n[p],"live."+M(h,m),{data:d,selector:m,handler:e,origType:h,origHandler:e,preType:l});else n.unbind("live."+M(h,m),e)}return this}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.bind(b,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0)}),function(){function u(a,b,c,d,e,f){for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i){var j=!1;i=i[a];while(i){if(i.sizcache===c){j=d[i.sizset];break}if(i.nodeType===1){f||(i.sizcache=c,i.sizset=g);if(typeof b!="string"){if(i===b){j=!0;break}}else if(k.filter(b,[i]).length>0){j=i;break}}i=i[a]}d[g]=j}}}function t(a,b,c,d,e,f){for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i){var j=!1;i=i[a];while(i){if(i.sizcache===c){j=d[i.sizset];break}i.nodeType===1&&!f&&(i.sizcache=c,i.sizset=g);if(i.nodeName.toLowerCase()===b){j=i;break}i=i[a]}d[g]=j}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d=0,e=Object.prototype.toString,g=!1,h=!0,i=/\\/g,j=/\W/;[0,0].sort(function(){h=!1;return 0});var k=function(b,d,f,g){f=f||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return f;var i,j,n,o,q,r,s,t,u=!0,w=k.isXML(d),x=[],y=b;do{a.exec(""),i=a.exec(y);if(i){y=i[3],x.push(i[1]);if(i[2]){o=i[3];break}}}while(i);if(x.length>1&&m.exec(b))if(x.length===2&&l.relative[x[0]])j=v(x[0]+x[1],d);else{j=l.relative[x[0]]?[d]:k(x.shift(),d);while(x.length)b=x.shift(),l.relative[b]&&(b+=x.shift()),j=v(b,j)}else{!g&&x.length>1&&d.nodeType===9&&!w&&l.match.ID.test(x[0])&&!l.match.ID.test(x[x.length-1])&&(q=k.find(x.shift(),d,w),d=q.expr?k.filter(q.expr,q.set)[0]:q.set[0]);if(d){q=g?{expr:x.pop(),set:p(g)}:k.find(x.pop(),x.length===1&&(x[0]==="~"||x[0]==="+")&&d.parentNode?d.parentNode:d,w),j=q.expr?k.filter(q.expr,q.set):q.set,x.length>0?n=p(j):u=!1;while(x.length)r=x.pop(),s=r,l.relative[r]?s=x.pop():r="",s==null&&(s=d),l.relative[r](n,s,w)}else n=x=[]}n||(n=j),n||k.error(r||b);if(e.call(n)==="[object Array]")if(!u)f.push.apply(f,n);else if(d&&d.nodeType===1)for(t=0;n[t]!=null;t++)n[t]&&(n[t]===!0||n[t].nodeType===1&&k.contains(d,n[t]))&&f.push(j[t]);else for(t=0;n[t]!=null;t++)n[t]&&n[t].nodeType===1&&f.push(j[t]);else p(n,f);o&&(k(o,h,f,g),k.uniqueSort(f));return f};k.uniqueSort=function(a){if(r){g=h,a.sort(r);if(g)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},k.matches=function(a,b){return k(a,null,null,b)},k.matchesSelector=function(a,b){return k(b,null,null,[a]).length>0},k.find=function(a,b,c){var d;if(!a)return[];for(var e=0,f=l.order.length;e<f;e++){var g,h=l.order[e];if(g=l.leftMatch[h].exec(a)){var j=g[1];g.splice(1,1);if(j.substr(j.length-1)!=="\\"){g[1]=(g[1]||"").replace(i,""),d=l.find[h](g,b,c);if(d!=null){a=a.replace(l.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},k.filter=function(a,c,d,e){var f,g,h=a,i=[],j=c,m=c&&c[0]&&k.isXML(c[0]);while(a&&c.length){for(var n in l.filter)if((f=l.leftMatch[n].exec(a))!=null&&f[2]){var o,p,q=l.filter[n],r=f[1];g=!1,f.splice(1,1);if(r.substr(r.length-1)==="\\")continue;j===i&&(i=[]);if(l.preFilter[n]){f=l.preFilter[n](f,j,d,i,e,m);if(!f)g=o=!0;else if(f===!0)continue}if(f)for(var s=0;(p=j[s])!=null;s++)if(p){o=q(p,f,s,j);var t=e^!!o;d&&o!=null?t?g=!0:j[s]=!1:t&&(i.push(p),g=!0)}if(o!==b){d||(j=i),a=a.replace(l.match[n],"");if(!g)return[];break}}if(a===h)if(g==null)k.error(a);else break;h=a}return j},k.error=function(a){throw"Syntax error, unrecognized expression: "+a};var l=k.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!j.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&k.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!j.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&k.filter(b,a,!0)}},"":function(a,b,c){var e,f=d++,g=u;typeof b=="string"&&!j.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("parentNode",b,f,a,e,c)},"~":function(a,b,c){var e,f=d++,g=u;typeof b=="string"&&!j.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("previousSibling",b,f,a,e,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(i,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(i,"")},TAG:function(a,b){return a[1].replace(i,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||k.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&k.error(a[0]);a[0]=d++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(i,"");!f&&l.attrMap[g]&&(a[1]=l.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(i,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=k(b[3],null,null,c);else{var g=k.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(l.match.POS.test(b[0])||l.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!k(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=l.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||k.getText([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}k.error(e)},CHILD:function(a,b){var c=b[1],d=a;switch(c){case"only":case"first":while(d=d.previousSibling)if(d.nodeType===1)return!1;if(c==="first")return!0;d=a;case"last":while(d=d.nextSibling)if(d.nodeType===1)return!1;return!0;case"nth":var e=b[2],f=b[3];if(e===1&&f===0)return!0;var g=b[0],h=a.parentNode;if(h&&(h.sizcache!==g||!a.nodeIndex)){var i=0;for(d=h.firstChild;d;d=d.nextSibling)d.nodeType===1&&(d.nodeIndex=++i);h.sizcache=g}var j=a.nodeIndex-f;return e===0?j===0:j%e===0&&j/e>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=l.attrHandle[c]?l.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=l.setFilters[e];if(f)return f(a,c,b,d)}}},m=l.match.POS,n=function(a,b){return"\\"+(b-0+1)};for(var o in l.match)l.match[o]=new RegExp(l.match[o].source+/(?![^\[]*\])(?![^\(]*\))/.source),l.leftMatch[o]=new RegExp(/(^(?:.|\r|\n)*?)/.source+l.match[o].source.replace(/\\(\d+)/g,n));var p=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(q){p=function(a,b){var c=0,d=b||[];if(e.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var f=a.length;c<f;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var r,s;c.documentElement.compareDocumentPosition?r=function(a,b){if(a===b){g=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(r=function(a,b){if(a===b){g=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],h=a.parentNode,i=b.parentNode,j=h;if(h===i)return s(a,b);if(!h)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return s(e[k],f[k]);return k===c?s(a,f[k],-1):s(e[k],b,1)},s=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),k.getText=function(a){var b="",c;for(var d=0;a[d];d++)c=a[d],c.nodeType===3||c.nodeType===4?b+=c.nodeValue:c.nodeType!==8&&(b+=k.getText(c.childNodes));return b},function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(l.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},l.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(l.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(l.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=k,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){k=function(b,e,f,g){e=e||c;if(!g&&!k.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return p(e.getElementsByTagName(b),f);if(h[2]&&l.find.CLASS&&e.getElementsByClassName)return p(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return p([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return p([],f);if(i.id===h[3])return p([i],f)}try{return p(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var m=e,n=e.getAttribute("id"),o=n||d,q=e.parentNode,r=/^\s*[+~]/.test(b);n?o=o.replace(/'/g,"\\$&"):e.setAttribute("id",o),r&&q&&(e=e.parentNode);try{if(!r||q)return p(e.querySelectorAll("[id='"+o+"'] "+b),f)}catch(s){}finally{n||m.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)k[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}k.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!k.isXML(a))try{if(e||!l.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return k(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;l.order.splice(1,0,"CLASS"),l.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?k.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?k.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:k.contains=function(){return!1},k.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var v=function(a,b){var c,d=[],e="",f=b.nodeType?[b]:b;while(c=l.match.PSEUDO.exec(a))e+=c[0],a=a.replace(l.match.PSEUDO,"");a=l.relative[a]?a+"*":a;for(var g=0,h=f.length;g<h;g++)k(a,f[g],d);return k.filter(e,d)};f.find=k,f.expr=k.selectors,f.expr[":"]=f.expr.filters,f.unique=k.uniqueSort,f.text=k.getText,f.isXMLDoc=k.isXML,f.contains=k.contains}();var N=/Until$/,O=/^(?:parents|prevUntil|prevAll)/,P=/,/,Q=/^.[^:#\[\.,]*$/,R=Array.prototype.slice,S=f.expr.match.POS,T={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(V(this,a,!1),"not",a)},filter:function(a){return this.pushStack(V(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h,i,j={},k=1;if(g&&a.length){for(d=0,e=a.length;d<e;d++)i=a[d],j[i]||(j[i]=S.test(i)?f(i,b||this.context):i);while(g&&g.ownerDocument&&g!==b){for(i in j)h=j[i],(h.jquery?h.index(g)>-1:f(g).is(h))&&c.push({selector:i,elem:g,level:k});g=g.parentNode,k++}}return c}var l=S.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(l?l.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(U(c[0])||U(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c),g=R.call(arguments);N.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!T[a]?f.unique(e):e,(this.length>1||P.test(d))&&O.test(a)&&(e=e.reverse());return this.pushStack(e,a,g.join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|object|embed|option|style)/i,bb=/checked\s*(?:[^=]|=\s*.checked.)/i,bc=/\/(java|ecma)script/i,bd=/^\s*<!(?:\[CDATA\[|\-\-)/,be={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};be.optgroup=be.option,be.tbody=be.tfoot=be.colgroup=be.caption=be.thead,be.th=be.td,f.support.htmlSerialize||(be._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){f(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f(arguments[0]).toArray());return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!be[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bb.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bf(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bl)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i;b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof a[0]=="string"&&a[0].length<512&&i===c&&a[0].charAt(0)==="<"&&!ba.test(a[0])&&(f.support.checkClone||!bb.test(a[0]))&&(g=!0,h=f.fragments[a[0]],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[a[0]]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d=a.cloneNode(!0),e,g,h;if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bh(a,d),e=bi(a),g=bi(d);for(h=0;e[h];++h)g[h]&&bh(e[h],g[h])}if(b){bg(a,d);if(c){e=bi(a),g=bi(d);for(h=0;e[h];++h)bg(e[h],g[h])}}e=g=null;return d},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!_.test(k))k=b.createTextNode(k);else{k=k.replace(Y,"<$1></$2>");var l=(Z.exec(k)||["",""])[1].toLowerCase(),m=be[l]||be._default,n=m[0],o=b.createElement("div");o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=$.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&X.test(k)&&o.insertBefore(b.createTextNode(X.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof(r=k.length)=="number")for(i=0;i<r;i++)bk(k[i]);else bk(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||bc.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.expando,g=f.event.special,h=f.support.deleteExpando;for(var i=0,j;(j=a[i])!=null;i++){if(j.nodeName&&f.noData[j.nodeName.toLowerCase()])continue;c=j[f.expando];if(c){b=d[c]&&d[c][e];if(b&&b.events){for(var k in b.events)g[k]?f.event.remove(j,k):f.removeEvent(j,k,b.handle);b.handle&&(b.handle.elem=null)}h?delete j[f.expando]:j.removeAttribute&&j.removeAttribute(f.expando),delete d[c]}}}});var cv=/alpha\([^)]*\)/i,bn=/opacity=([^)]*)/,bo=/([A-Z]|^ms)/g,bp=/^-?\d+(?:px)?$/i,bq=/^-?\d/,br=/^([\-+])=([\-+.\de]+)/,bs={position:"absolute",visibility:"hidden",display:"block"},bt=["Left","Right"],bu=["Top","Bottom"],bv,bw,bx;f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bv(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=br.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bv)return bv(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return by(a,b,d);f.swap(a,bs,function(){e=by(a,b,d)});return e}},set:function(a,b){if(!bp.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return bn.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNaN(b)?"":"alpha(opacity="+b*100+")",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(cv,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=cv.test(g)?g.replace(cv,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bv(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bw=function(a,c){var d,e,g;c=c.replace(bo,"-$1").toLowerCase();if(!(e=a.ownerDocument.defaultView))return b;if(g=e.getComputedStyle(a,null))d=g.getPropertyValue(c),d===""&&!f.contains(a.ownerDocument.documentElement,a)&&(d=f.style(a,c));return d}),c.documentElement.currentStyle&&(bx=function(a,b){var c,d=a.currentStyle&&a.currentStyle[b],e=a.runtimeStyle&&a.runtimeStyle[b],f=a.style;!bp.test(d)&&bq.test(d)&&(c=f.left,e&&(a.runtimeStyle.left=a.currentStyle.left),f.left=b==="fontSize"?"1em":d||0,d=f.pixelLeft+"px",f.left=c,e&&(a.runtimeStyle.left=e));return d===""?"auto":d}),bv=bw||bx,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var cw=/%20/g,bA=/\[\]$/,bB=/\r?\n/g,bC=/#.*$/,bD=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bE=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bF=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bG=/^(?:GET|HEAD)$/,bH=/^\/\//,bI=/\?/,bJ=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bK=/^(?:select|textarea)/i,bL=/\s+/,bM=/([?&])_=[^&]*/,bN=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bO=f.fn.load,bP={},bQ={},bR,bS,bT=["*/"]+["*"];try{bR=e.href}catch(bU){bR=c.createElement("a"),bR.href="",bR=bR.href}bS=bN.exec(bR.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bO)return bO.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bJ,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bK.test(this.nodeName)||bE.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bB,"\r\n")}}):{name:b.name,value:c.replace(bB,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.bind(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?bX(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),bX(a,b);return a},ajaxSettings:{url:bR,isLocal:bF.test(bS[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bT},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bV(bP),ajaxTransport:bV(bQ),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?bZ(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=b$(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.resolveWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f._Deferred(),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bD.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.done,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bC,"").replace(bH,bS[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bL),d.crossDomain==null&&(r=bN.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bS[1]&&r[2]==bS[2]&&(r[3]||(r[1]==="http:"?80:443))==(bS[3]||(bS[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),bW(bP,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bG.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bI.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bM,"$1_="+x);d.url=y+(y===d.url?(bI.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bT+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=bW(bQ,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){s<2?w(-1,z):f.error(z)}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)bY(g,a[g],c,e);return d.join("&").replace(cw,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cx=f.now(),ca=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cx++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ca.test(b.url)||e&&ca.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(ca,l),b.url===j&&(e&&(k=k.replace(ca,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cy=a.ActiveXObject?function(){for(var a in cd)cd[a](0,1)}:!1,cc=0,cd;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ce()||cf()}:ce,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,cy&&delete cd[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cc,cy&&(cd||(cd={},f(a).unload(cy)),cd[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var cz={},ch,ci,cj=/^(?:toggle|show|hide)$/,ck=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cl,cm=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cn;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cq("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cr(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cq("hide",3),a,b,c);for(var d=0,e=this.length;d<e;d++)if(this[d].style){var g=f.css(this[d],"display");g!=="none"&&!f._data(this[d],"olddisplay")&&f._data(this[d],"olddisplay",g)}for(d=0;d<e;d++)this[d].style&&(this[d].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cq("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return this[e.queue===!1?"each":"queue"](function(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(f.support.inlineBlockNeedsLayout?(j=cr(this.nodeName),j==="inline"?this.style.display="inline-block":(this.style.display="inline",this.style.zoom=1)):this.style.display="inline-block"))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)k=new f.fx(this,b,i),h=a[i],cj.test(h)?k[h==="toggle"?d?"show":"hide":h]():(l=ck.exec(h),m=k.cur(),l?(n=parseFloat(l[2]),o=l[3]||(f.cssNumber[i]?"":"px"),o!=="px"&&(f.style(this,i,(n||1)+o),m=(n||1)/k.cur()*m,f.style(this,i,m+o)),l[1]&&(n=(l[1]==="-="?-1:1)*n+m),k.custom(m,n,o)):k.custom(m,h,""));return!0})},stop:function(a,b){a&&this.queue([]),this.each(function(){var a=f.timers,c=a.length;b||f._unmark(!0,this);while(c--)a[c].elem===this&&(b&&a[c](!0),a.splice(c,1))}),b||this.dequeue();return this}}),f.each({slideDown:cq("show",1),slideUp:cq("hide",1),slideToggle:cq("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default,d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue!==!1?f.dequeue(this):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,b,c){function g(a){return d.step(a)}var d=this,e=f.fx;this.startTime=cn||co(),this.start=a,this.end=b,this.unit=c||this.unit||(f.cssNumber[this.prop]?"":"px"),this.now=this.start,this.pos=this.state=0,g.elem=this.elem,g()&&f.timers.push(g)&&!cl&&(cl=setInterval(e.tick,e.interval))},show:function(){this.options.orig[this.prop]=f.style(this.elem,this.prop),this.options.show=!0,this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b=cn||co(),c=!0,d=this.elem,e=this.options,g,h;if(a||b>=e.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),e.animatedProperties[this.prop]=!0;for(g in e.animatedProperties)e.animatedProperties[g]!==!0&&(c=!1);if(c){e.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){d.style["overflow"+b]=e.overflow[a]}),e.hide&&f(d).hide();if(e.hide||e.show)for(var i in e.animatedProperties)f.style(d,i,e.orig[i]);e.complete.call(d)}return!1}e.duration==Infinity?this.now=b:(h=b-this.startTime,this.state=h/e.duration,this.pos=f.easing[e.animatedProperties[this.prop]](this.state,h,0,1,e.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){for(var a=f.timers,b=0;b<a.length;++b)a[b]()||a.splice(b--,1);a.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cl),cl=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit:a.elem[a.prop]=a.now}}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cA=/^t(?:able|d|h)$/i,ct=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cu(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);f.offset.initialize();var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.offset.supportsFixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.offset.doesNotAddBorder&&(!f.offset.doesAddBorderForTableAndCells||!cA.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.offset.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.offset.supportsFixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={initialize:function(){var a=c.body,b=c.createElement("div"),d,e,g,h,i=parseFloat(f.css(a,"marginTop"))||0,j="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";f.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"}),b.innerHTML=j,a.insertBefore(b,a.firstChild),d=b.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,this.doesNotAddBorder=e.offsetTop!==5,this.doesAddBorderForTableAndCells=h.offsetTop===5,e.style.position="fixed",e.style.top="20px",this.supportsFixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",this.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==i,a.removeChild(b),f.offset.initialize=f.noop},bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.offset.initialize(),f.offset.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=ct.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!ct.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cu(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cu(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a&&a.style?parseFloat(f.css(a,d,"padding")):null},f.fn["outer"+c]=function(a){var b=this[0];return b&&b.style?parseFloat(f.css(b,d,a?"margin":"border")):null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNaN(j)?i:j}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f})(window);var guiders=(function($){var o={};o.version="1.2.8";o._defaultSettings={attachTo:null,autoFocus:false,buttons:[{name:"Close"}],buttonCustomHTML:"",classString:null,closeOnEscape:false,description:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",highlight:null,isHashable:true,offset:{top:null,left:null},onClose:null,onHide:null,onShow:null,overlay:false,position:0,title:"Sample title goes here",width:400,xButton:false};o._htmlSkeleton=["<div class='guider'>","  <div class='guider_content'>","    <h1 class='guider_title'></h1>","    <div class='guider_close'></div>","    <p class='guider_description'></p>","    <div class='guider_buttons'>","    </div>","  </div>","  <div class='guider_arrow'>","  </div>","</div>"].join("");o._arrowSize=42;o._backButtonTitle="Back";o._buttonElement="<a></a>";o._buttonAttributes={"href":"javascript:void(0);"};o._closeButtonTitle="Close";o._currentGuiderID=null;o._guiders={};o._lastCreatedGuiderID=null;o._nextButtonTitle="Next";o._offsetNameMapping={"topLeft":11,"top":12,"topRight":1,"rightTop":2,"right":3,"rightBottom":4,"bottomRight":5,"bottom":6,"bottomLeft":7,"leftBottom":8,"left":9,"leftTop":10};o._windowHeight=0;o._addButtons=function(a){var b=a.elem.find(".guider_buttons");if(a.buttons===null||a.buttons.length===0){b.remove();return}for(var i=a.buttons.length-1;i>=0;i--){var c=a.buttons[i];var d=$(o._buttonElement,$.extend({"class":"guider_button","html":c.name},o._buttonAttributes,c.html||{}));if(typeof c.classString!=="undefined"&&c.classString!==null){d.addClass(c.classString)}b.append(d);var e=c.name.toLowerCase();if(c.onclick){d.bind("click",c.onclick)}else{switch(e){case o._closeButtonTitle.toLowerCase():d.bind("click",function(){o.hideAll();if(a.onClose){a.onClose(a,false)}});break;case o._nextButtonTitle.toLowerCase():d.bind("click",function(){!a.elem.data('locked')&&o.next()});break;case o._backButtonTitle.toLowerCase():d.bind("click",function(){!a.elem.data('locked')&&o.prev()});break}}}if(a.buttonCustomHTML!==""){var f=$(a.buttonCustomHTML);a.elem.find(".guider_buttons").append(f)}if(a.buttons.length===0){b.remove()}};o._addXButton=function(a){var b=a.elem.find(".guider_close");var c=$("<div></div>",{"class":"x_button","role":"button"});b.append(c);c.click(function(){o.hideAll();if(a.onClose){a.onClose(a,true)}})};o._wireEscape=function(b){$(document).keydown(function(a){if(a.keyCode==27||a.which==27){o.hideAll();if(b.onClose){b.onClose(b,true)}return false}})};o._unWireEscape=function(a){$(document).unbind("keydown")};o._attach=function(a){if(typeof a!=='object'){return}var b=$(a.attachTo);var c=a.elem.innerHeight();var d=a.elem.innerWidth();if(a.position===0||b.length===0){a.elem.css("position","fixed");a.elem.css("top",($(window).height()-c)/3+"px");a.elem.css("left",($(window).width()-d)/2+"px");return}var e=b.offset();var f=e.top;var g=e.left;var h=$("body").outerHeight(true)-$("body").outerHeight(false);f-=h;if(o._offsetNameMapping[a.position]){a.position=o._offsetNameMapping[a.position]}var i=b.innerHeight();var j=b.innerWidth();var k=0.9*o._arrowSize;var l={1:[-k-c,j-d],2:[0,k+j],3:[i/2-c/2,k+j],4:[i-c,k+j],5:[k+i,j-d],6:[k+i,j/2-d/2],7:[k+i,0],8:[i-c,-d-k],9:[i/2-c/2,-d-k],10:[0,-d-k],11:[-k-c,0],12:[-k-c,j/2-d/2]};var m=l[a.position];f+=m[0];g+=m[1];var n="absolute";if(b.css("position")=="fixed"){n="fixed";f-=$(window).scrollTop();g-=$(window).scrollLeft()}if(a.offset.top!==null){f+=a.offset.top}if(a.offset.left!==null){g+=a.offset.left}return a.elem.css({"position":n,"top":f,"left":g})};o._guiderById=function(a){if(typeof o._guiders[a]==="undefined"){throw"Cannot find guider with id "+a;}return o._guiders[a]};o._showOverlay=function(){$("#guider_overlay").fadeIn("fast",function(){if(this.style.removeAttribute){this.style.removeAttribute("filter")}})};o._highlightElement=function(a){$(a).addClass('guider_highlight')};o._dehighlightElement=function(a){$(a).removeClass('guider_highlight')};o._hideOverlay=function(){$("#guider_overlay").fadeOut("fast")};o._initializeOverlay=function(){if($("#guider_overlay").length===0){$("<div id=\"guider_overlay\"></div>").hide().appendTo("body")}};o._styleArrow=function(a){var b=a.position||0;if(!b){return}var c=$(a.elem.find(".guider_arrow"));var d={1:"guider_arrow_down",2:"guider_arrow_left",3:"guider_arrow_left",4:"guider_arrow_left",5:"guider_arrow_up",6:"guider_arrow_up",7:"guider_arrow_up",8:"guider_arrow_right",9:"guider_arrow_right",10:"guider_arrow_right",11:"guider_arrow_down",12:"guider_arrow_down"};c.addClass(d[b]);var e=a.elem.innerHeight();var f=a.elem.innerWidth();var g=o._arrowSize/2;var h={1:["right",g],2:["top",g],3:["top",e/2-g],4:["bottom",g],5:["right",g],6:["left",f/2-g],7:["left",g],8:["bottom",g],9:["top",e/2-g],10:["top",g],11:["left",g],12:["left",f/2-g]};var b=h[a.position];c.css(b[0],b[1]+"px")};o._showIfHashed=function(a){var b="guider=";var c=window.location.hash.indexOf(b);if(c!==-1){var d=window.location.hash.substr(c+b.length);if(a.id.toLowerCase()===d.toLowerCase()){o.show(a.id)}}};o.reposition=function(){var a=o._guiders[o._currentGuiderID];o._attach(a)};o.next=function(){var a=o._guiders[o._currentGuiderID];if(typeof a==="undefined"){return}a.elem.data('locked',true);var b=a.next||null;if(b!==null&&b!==""){var c=o._guiderById(b);var d=c.overlay?true:false;o.hideAll(d,true);if(a&&a.highlight){o._dehighlightElement(a.highlight)}o.show(b)}};o.prev=function(){var a=o._guiders[o._currentGuiderID];if(typeof a==="undefined"){return}if(a.prev===null){return}var b=o._guiders[a.prev];b.elem.data('locked',true);var c=b.id||null;if(c!==null&&c!==""){var d=o._guiderById(c);var e=d.overlay?true:false;o.hideAll(e,true);if(b&&b.highlight){o._dehighlightElement(b.highlight)}o.show(c)}};o.createGuider=function(a){if(a===null||a===undefined){a={}}myGuider=$.extend({},o._defaultSettings,a);myGuider.id=myGuider.id||String(Math.floor(Math.random()*1000));var b=$(o._htmlSkeleton);myGuider.elem=b;if(typeof myGuider.classString!=="undefined"&&myGuider.classString!==null){myGuider.elem.addClass(myGuider.classString)}myGuider.elem.css("width",myGuider.width+"px");var c=b.find(".guider_title");c.html(myGuider.title);b.find(".guider_description").html(myGuider.description);o._addButtons(myGuider);if(myGuider.xButton){o._addXButton(myGuider)}b.hide();b.appendTo("body");b.attr("id",myGuider.id);if(typeof myGuider.attachTo!=="undefined"&&myGuider!==null){o._attach(myGuider)&&o._styleArrow(myGuider)}o._initializeOverlay();o._guiders[myGuider.id]=myGuider;if(o._lastCreatedGuiderID!=null){myGuider.prev=o._lastCreatedGuiderID}o._lastCreatedGuiderID=myGuider.id;if(myGuider.isHashable){o._showIfHashed(myGuider)}return o};o.hideAll=function(d,e){e=e||false;$(".guider:visible").each(function(a,b){var c=o._guiderById($(b).attr('id'));if(c.onHide){c.onHide(c,e)}});$(".guider").fadeOut("fast");var f=o._guiders[o._currentGuiderID];if(f&&f.highlight){o._dehighlightElement(f.highlight)}if(typeof d!=="undefined"&&d===true){}else{o._hideOverlay()}return o};o.show=function(a){if(!a&&o._lastCreatedGuiderID){a=o._lastCreatedGuiderID}var b=o._guiderById(a);if(b.overlay){o._showOverlay();if(b.highlight){o._highlightElement(b.highlight)}}if(b.closeOnEscape){o._wireEscape(b)}else{o._unWireEscape(b)}if(b.onShow){b.onShow(b)}o._attach(b);b.elem.fadeIn("fast").data("locked",false);o._currentGuiderID=a;var c=o._windowHeight=$(window).height();var d=$(window).scrollTop();var e=b.elem.offset();var f=b.elem.height();var g=(d+c<e.top+f);var h=(e.top<d);if(b.autoFocus&&(g||h)){setTimeout(o.scrollToCurrent,10)}$(b.elem).trigger("guiders.show");return o};o.scrollToCurrent=function(){var a=o._guiders[o._currentGuiderID];if(typeof a==="undefined"){return}var b=o._windowHeight;var c=$(window).scrollTop();var d=a.elem.offset();var e=a.elem.height();var f=Math.round(Math.max(d.top+(e/2)-(b/2),0));window.scrollTo(0,f)};var p=undefined;$(window).resize(function(){if(typeof(p)!=="undefined"){clearTimeout(p)}p=setTimeout(function(){p=undefined;if(typeof(o)!=="undefined"){o.reposition()}},20)});return o}).call(this,jQuery);(function(b){b.fn.dragsort=function(k){var d=b.extend({},b.fn.dragsort.defaults,k),g=[],a=null,j=null;this.selector&&b("head").append("<style type='text/css'>"+(this.selector.split(",").join(" "+d.dragSelector+",")+" "+d.dragSelector)+" { cursor: pointer; }</style>");this.each(function(k,i){b(i).is("table")&&b(i).children().size()==1&&b(i).children().is("tbody")&&(i=b(i).children().get(0));var m={draggedItem:null,placeHolderItem:null,pos:null,offset:null,offsetLimit:null,scroll:null,container:i,init:function(){b(this.container).attr("data-listIdx",k).mousedown(this.grabItem).find(d.dragSelector).css("cursor","pointer");b(this.container).children(d.itemSelector).each(function(a){b(this).attr("data-itemIdx",a)})},grabItem:function(e){if(!(e.which!=1||b(e.target).is(d.dragSelectorExclude))){for(var c=e.target;!b(c).is("[data-listIdx='"+b(this).attr("data-listIdx")+"'] "+d.dragSelector);){if(c==this)return;c=c.parentNode}a!=null&&a.draggedItem!=null&&a.dropItem();b(e.target).css("cursor","move");a=g[b(this).attr("data-listIdx")];a.draggedItem=b(c).closest(d.itemSelector);var c=parseInt(a.draggedItem.css("marginTop")),f=parseInt(a.draggedItem.css("marginLeft"));a.offset=a.draggedItem.offset();a.offset.top=e.pageY-a.offset.top+(isNaN(c)?0:c)-1;a.offset.left=e.pageX-a.offset.left+(isNaN(f)?0:f)-1;if(!d.dragBetween)c=b(a.container).outerHeight()==0?Math.max(1,Math.round(0.5+b(a.container).children(d.itemSelector).size()*a.draggedItem.outerWidth()/b(a.container).outerWidth()))*a.draggedItem.outerHeight():b(a.container).outerHeight(),a.offsetLimit=b(a.container).offset(),a.offsetLimit.right=a.offsetLimit.left+b(a.container).outerWidth()-a.draggedItem.outerWidth(),a.offsetLimit.bottom=a.offsetLimit.top+c-a.draggedItem.outerHeight();var c=a.draggedItem.height(),f=a.draggedItem.width(),h=a.draggedItem.attr("style");a.draggedItem.attr("data-origStyle",h?h:"");d.itemSelector=="tr"?(a.draggedItem.children().each(function(){b(this).width(b(this).width())}),a.placeHolderItem=a.draggedItem.clone().attr("data-placeHolder",!0),a.draggedItem.after(a.placeHolderItem),a.placeHolderItem.children().each(function(){b(this).css({borderWidth:0,width:b(this).width()+1,height:b(this).height()+1}).html("&nbsp;")})):(a.draggedItem.after(d.placeHolderTemplate),a.placeHolderItem=a.draggedItem.next().css({height:c,width:f}).attr("data-placeHolder",!0));a.draggedItem.css({position:"absolute",opacity:0.8,"z-index":999,height:c,width:f});b(g).each(function(a,b){b.createDropTargets();b.buildPositionTable()});a.scroll={moveX:0,moveY:0,maxX:b(document).width()-b(window).width(),maxY:b(document).height()-b(window).height()};a.scroll.scrollY=window.setInterval(function(){if(d.scrollContainer!=window)b(d.scrollContainer).scrollTop(b(d.scrollContainer).scrollTop()+a.scroll.moveY);else{var c=b(d.scrollContainer).scrollTop();if(a.scroll.moveY>0&&c<a.scroll.maxY||a.scroll.moveY<0&&c>0)b(d.scrollContainer).scrollTop(c+a.scroll.moveY),a.draggedItem.css("top",a.draggedItem.offset().top+a.scroll.moveY+1)}},10);a.scroll.scrollX=window.setInterval(function(){if(d.scrollContainer!=window)b(d.scrollContainer).scrollLeft(b(d.scrollContainer).scrollLeft()+a.scroll.moveX);else{var c=b(d.scrollContainer).scrollLeft();if(a.scroll.moveX>0&&c<a.scroll.maxX||a.scroll.moveX<0&&c>0)b(d.scrollContainer).scrollLeft(c+a.scroll.moveX),a.draggedItem.css("left",a.draggedItem.offset().left+a.scroll.moveX+1)}},10);a.setPos(e.pageX,e.pageY);b(document).bind("selectstart",a.stopBubble);b(document).bind("mousemove",a.swapItems);b(document).bind("mouseup",a.dropItem);d.scrollContainer!=window&&b(window).bind("DOMMouseScroll mousewheel",a.wheel);return!1}},setPos:function(e,c){var f=c-this.offset.top,h=e-this.offset.left;d.dragBetween||(f=Math.min(this.offsetLimit.bottom,Math.max(f,this.offsetLimit.top)),h=Math.min(this.offsetLimit.right,Math.max(h,this.offsetLimit.left)));this.draggedItem.parents().each(function(){if(b(this).css("position")!="static"&&(!b.browser.mozilla||b(this).css("display")!="table")){var a=b(this).offset();f-=a.top;h-=a.left;return!1}});if(d.scrollContainer==window)c-=b(window).scrollTop(),e-=b(window).scrollLeft(),c=Math.max(0,c-b(window).height()+5)+Math.min(0,c-5),e=Math.max(0,e-b(window).width()+5)+Math.min(0,e-5);else var l=b(d.scrollContainer),g=l.offset(),c=Math.max(0,c-l.height()-g.top)+Math.min(0,c-g.top),e=Math.max(0,e-l.width()-g.left)+Math.min(0,e-g.left);a.scroll.moveX=e==0?0:e*d.scrollSpeed/Math.abs(e);a.scroll.moveY=c==0?0:c*d.scrollSpeed/Math.abs(c);this.draggedItem.css({top:f,left:h})},wheel:function(e){if((b.browser.safari||b.browser.mozilla)&&a&&d.scrollContainer!=window){var c=b(d.scrollContainer),f=c.offset();e.pageX>f.left&&e.pageX<f.left+c.width()&&e.pageY>f.top&&e.pageY<f.top+c.height()&&(f=e.detail?e.detail*5:e.wheelDelta/-2,c.scrollTop(c.scrollTop()+f),e.preventDefault())}},buildPositionTable:function(){var a=this.draggedItem==null?null:this.draggedItem.get(0),c=[];b(this.container).children(d.itemSelector).each(function(d,h){if(h!=a){var g=b(h).offset();g.right=g.left+b(h).width();g.bottom=g.top+b(h).height();g.elm=h;c.push(g)}});this.pos=c},dropItem:function(){if(a.draggedItem!=null){b(a.container).find(d.dragSelector).css("cursor","pointer");a.placeHolderItem.before(a.draggedItem);var e=a.draggedItem.attr("data-origStyle");a.draggedItem.attr("style",e);e==""&&a.draggedItem.removeAttr("style");a.draggedItem.removeAttr("data-origStyle");a.placeHolderItem.remove();b("[data-dropTarget]").remove();window.clearInterval(a.scroll.scrollY);window.clearInterval(a.scroll.scrollX);var c=!1;b(g).each(function(){b(this.container).children(d.itemSelector).each(function(a){parseInt(b(this).attr("data-itemIdx"))!=a&&(c=!0,b(this).attr("data-itemIdx",a))})});c&&d.dragEnd.apply(a.draggedItem);a.draggedItem=null;b(document).unbind("selectstart",a.stopBubble);b(document).unbind("mousemove",a.swapItems);b(document).unbind("mouseup",a.dropItem);d.scrollContainer!=window&&b(window).unbind("DOMMouseScroll mousewheel",a.wheel);return!1}},stopBubble:function(){return!1},swapItems:function(e){if(a.draggedItem==null)return!1;a.setPos(e.pageX,e.pageY);for(var c=a.findPos(e.pageX,e.pageY),f=a,h=0;c==-1&&d.dragBetween&&h<g.length;h++)c=g[h].findPos(e.pageX,e.pageY),f=g[h];if(c==-1||b(f.pos[c].elm).attr("data-placeHolder"))return!1;j==null||j.top>a.draggedItem.offset().top||j.left>a.draggedItem.offset().left?b(f.pos[c].elm).before(a.placeHolderItem):b(f.pos[c].elm).after(a.placeHolderItem);b(g).each(function(a,b){b.createDropTargets();b.buildPositionTable()});j=a.draggedItem.offset();return!1},findPos:function(a,b){for(var d=0;d<this.pos.length;d++)if(this.pos[d].left<a&&this.pos[d].right>a&&this.pos[d].top<b&&this.pos[d].bottom>b)return d;return-1},createDropTargets:function(){d.dragBetween&&b(g).each(function(){var d=b(this.container).find("[data-placeHolder]"),c=b(this.container).find("[data-dropTarget]");d.size()>0&&c.size()>0?c.remove():d.size()==0&&c.size()==0&&(b(this.container).append(a.placeHolderItem.removeAttr("data-placeHolder").clone().attr("data-dropTarget",!0)),a.placeHolderItem.attr("data-placeHolder",!0))})}};m.init();g.push(m)});return this};b.fn.dragsort.defaults={itemSelector:"li",dragSelector:"li",dragSelectorExclude:"input, textarea, a[href]",dragEnd:function(){},dragBetween:!1,placeHolderTemplate:"<li>&nbsp;</li>",scrollContainer:window,scrollSpeed:5}})(jQuery);(function(){var a={getSelection:function(){var b=this.jquery?this[0]:this;return(("selectionStart"in b&&function(){var c=b.selectionEnd-b.selectionStart;return{start:b.selectionStart,end:b.selectionEnd,length:c,text:b.value.substr(b.selectionStart,c)}})||(document.selection&&function(){b.focus();var d=document.selection.createRange();if(d==null){return{start:0,end:b.value.length,length:0}}var c=b.createTextRange();var e=c.duplicate();c.moveToBookmark(d.getBookmark());e.setEndPoint("EndToStart",c);return{start:e.text.length,end:e.text.length+d.text.length,length:d.text.length,text:d.text}})||function(){return{start:0,end:b.value.length,length:0}})()},replaceSelection:function(){var b=this.jquery?this[0]:this;var c=arguments[0]||"";return(("selectionStart"in b&&function(){b.value=b.value.substr(0,b.selectionStart)+c+b.value.substr(b.selectionEnd,b.value.length);return this})||(document.selection&&function(){b.focus();document.selection.createRange().text=c;return this})||function(){b.value+=c;return this})()}};jQuery.each(a,function(b){jQuery.fn[b]=this})})();(function(){var f={};var g=null;var j=null;var k=document.title;var l=null;var m=null;var n={};var o={width:7,height:9,font:'10px arial',colour:'#ffffff',background:'#F03D25',fallback:true};var p=(function(){var b=navigator.userAgent.toLowerCase();return function(a){return b.indexOf(a)!==-1}}());var q={chrome:p('chrome'),webkit:p('chrome')||p('safari'),safari:p('safari')&&!p('chrome'),mozilla:p('mozilla')&&!p('chrome')&&!p('safari')};var r=function(){var a=document.getElementsByTagName('link');for(var i=0,len=a.length;i<len;i++){if((a[i].getAttribute('rel')||'').match(/\bicon\b/)){return a[i]}}return false};var s=function(){var a=document.getElementsByTagName('link');var b=document.getElementsByTagName('head')[0];for(var i=0,len=a.length;i<len;i++){var c=(typeof(a[i])!=='undefined');if(c&&a[i].getAttribute('rel')==='icon'){b.removeChild(a[i])}}};var t=function(){if(!j||!g){var a=r();j=g=a?a.getAttribute('href'):'/favicon.ico'}return g};var u=function(){if(!m){m=document.createElement("canvas");m.width=16;m.height=16}return m};var v=function(a){s();var b=document.createElement('link');b.type='image/x-icon';b.rel='icon';b.href=a;document.getElementsByTagName('head')[0].appendChild(b)};var x=function(a){if(window.console)window.console.log(a)};var y=function(a,b){if(!u().getContext||q.safari||n.fallback==='force'){return z(a)}var c=u().getContext("2d");var b=b||'#000000';var a=a||0;var d=t();l=new Image();l.onload=function(){c.clearRect(0,0,16,16);c.drawImage(l,0,0,l.width,l.height,0,0,16,16);if(a>0)A(c,a,b);B()};if(!d.match(/^data/)){l.crossOrigin='anonymous'}l.src=d};var z=function(a){if(n.fallback){if(a>0){document.title='('+a+') '+k}else{document.title=k}}};var A=function(a,b,c){var d=(b+"").length-1;var e=n.width+(6*d);var w=16-e;var h=16-n.height;a.font=(q.webkit?'bold ':'')+n.font;a.fillStyle=n.background;a.strokeStyle=n.background;a.lineWidth=1;a.fillRect(w,h,e-1,n.height);a.beginPath();a.moveTo(w-0.5,h+1);a.lineTo(w-0.5,15);a.stroke();a.beginPath();a.moveTo(15.5,h+1);a.lineTo(15.5,15);a.stroke();a.beginPath();a.strokeStyle="rgba(0,0,0,0.3)";a.moveTo(w,16);a.lineTo(15,16);a.stroke();a.fillStyle=n.colour;a.textAlign="right";a.textBaseline="top";a.fillText(b,15,q.mozilla?7:6)};var B=function(){if(!u().getContext)return;v(u().toDataURL())};f.setOptions=function(a){n={};for(var b in o){n[b]=a.hasOwnProperty(b)?a[b]:o[b]}return this};f.setImage=function(a){g=a;B();return this};f.setBubble=function(a,b){if(isNaN(parseFloat(a))||!isFinite(a))return x('Bubble must be a number');y(a,b);return this};f.reset=function(){f.setImage(j)};f.setOptions(o);window.Tinycon=f})();(function($){var E={method:"GET",contentType:"json",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&times;",animateDropdown:true,tokenLimit:null,tokenDelimiter:",",preventDuplicates:false,tokenValue:"id",prePopulate:null,processPrePopulate:false,idPrefix:"token-input-",resultsFormatter:function(a){return"<li>"+a[this.propertyToSearch]+"</li>"},tokenFormatter:function(a){return"<li><p>"+a[this.propertyToSearch]+"</p></li>"},onResult:null,onAdd:null,onDelete:null,onReady:null};var F={tokenList:"token-input-list",token:"token-input-token",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token"};var G={BEFORE:0,AFTER:1,END:2};var H={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188};var I={init:function(a,b){var c=$.extend({},E,b||{});return this.each(function(){$(this).data("tokenInputObject",new $.TokenList(this,a,c))})},clear:function(){this.data("tokenInputObject").clear();return this},add:function(a){this.data("tokenInputObject").add(a);return this},remove:function(a){this.data("tokenInputObject").remove(a);return this},get:function(){return this.data("tokenInputObject").getTokens()}}$.fn.tokenInput=function(a){if(I[a]){return I[a].apply(this,Array.prototype.slice.call(arguments,1))}else{return I.init.apply(this,arguments)}};$.TokenList=function(l,m,n){if($.type(m)==="string"||$.type(m)==="function"){n.url=m;var o=computeURL();if(n.crossDomain===undefined){if(o.indexOf("://")===-1){n.crossDomain=false}else{n.crossDomain=(location.href.split(/\/+/g)[1]!==o.split(/\/+/g)[1])}}}else if(typeof(m)==="object"){n.local_data=m}if(n.classes){n.classes=$.extend({},F,n.classes)}else if(n.theme){n.classes={};$.each(F,function(a,b){n.classes[a]=b+"-"+n.theme})}else{n.classes=F}var p=[];var q=0;var r=new $.TokenList.Cache();var s;var t;var u=$("<input type=\"text\"  autocomplete=\"off\">").css({outline:"none"}).attr("id",n.idPrefix+l.id).focus(function(){if(n.tokenLimit===null||n.tokenLimit!==q){show_dropdown_hint()}}).blur(function(){hide_dropdown();$(this).val("")}).bind("keyup keydown blur update",resize_input).keydown(function(a){var b;var c;switch(a.keyCode){case H.LEFT:case H.RIGHT:case H.UP:case H.DOWN:if(!$(this).val()){b=A.prev();c=A.next();if((b.length&&b.get(0)===w)||(c.length&&c.get(0)===w)){if(a.keyCode===H.LEFT||a.keyCode===H.UP){deselect_token($(w),G.BEFORE)}else{deselect_token($(w),G.AFTER)}}else if((a.keyCode===H.LEFT||a.keyCode===H.UP)&&b.length){select_token($(b.get(0)))}else if((a.keyCode===H.RIGHT||a.keyCode===H.DOWN)&&c.length){select_token($(c.get(0)))}}else{var d=null;if(a.keyCode===H.DOWN||a.keyCode===H.RIGHT){d=$(y).next()}else{d=$(y).prev()}if(d.length){select_dropdown_item(d)}return false}break;case H.BACKSPACE:b=A.prev();if(!$(this).val().length){if(w){delete_token($(w));v.change()}else if(b.length){select_token($(b.get(0)))}return false}else if($(this).val().length===1){hide_dropdown()}else{setTimeout(function(){do_search()},5)}break;case H.TAB:case H.ENTER:case H.NUMPAD_ENTER:case H.COMMA:if(y){add_token($(y).data("tokeninput"));v.change();return false}break;case H.ESCAPE:hide_dropdown();return true;default:if(String.fromCharCode(a.which)){setTimeout(function(){do_search()},5)}break}});var v=$(l).hide().val("").focus(function(){u.focus()}).blur(function(){u.blur()});var w=null;var x=0;var y=null;var z=$("<ul />").addClass(n.classes.tokenList).click(function(a){var b=$(a.target).closest("li");if(b&&b.get(0)&&$.data(b.get(0),"tokeninput")){toggle_select_token(b)}else{if(w){deselect_token($(w),G.END)}u.focus()}}).mouseover(function(a){var b=$(a.target).closest("li");if(b&&w!==this){b.addClass(n.classes.highlightedToken)}}).mouseout(function(a){var b=$(a.target).closest("li");if(b&&w!==this){b.removeClass(n.classes.highlightedToken)}}).insertBefore(v);var A=$("<li />").addClass(n.classes.inputToken).appendTo(z).append(u);var B=$("<div>").addClass(n.classes.dropdown).appendTo("body").hide();var C=$("<tester/>").insertAfter(u).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:u.css("fontSize"),fontFamily:u.css("fontFamily"),fontWeight:u.css("fontWeight"),letterSpacing:u.css("letterSpacing"),whiteSpace:"nowrap"});v.val("");var D=n.prePopulate||v.data("pre");if(n.processPrePopulate&&$.isFunction(n.onResult)){D=n.onResult.call(v,D)}if(D&&D.length){$.each(D,function(a,b){insert_token(b);checkTokenLimit()})}if($.isFunction(n.onReady)){n.onReady.call()}this.clear=function(){z.children("li").each(function(){if($(this).children("input").length===0){delete_token($(this))}})}this.add=function(a){add_token(a)}this.remove=function(d){z.children("li").each(function(){if($(this).children("input").length===0){var a=$(this).data("tokeninput");var b=true;for(var c in d){if(d[c]!==a[c]){b=false;break}}if(b){delete_token($(this))}}})}this.getTokens=function(){return p}function checkTokenLimit(){if(n.tokenLimit!==null&&q>=n.tokenLimit){u.hide();hide_dropdown();return}}function resize_input(){if(t===(t=u.val())){return}var a=t.replace(/&/g,'&amp;').replace(/\s/g,' ').replace(/</g,'&lt;').replace(/>/g,'&gt;');C.html(a);u.width(C.width()+30)}function is_printable_character(a){return((a>=48&&a<=90)||(a>=96&&a<=111)||(a>=186&&a<=192)||(a>=219&&a<=222))}function insert_token(a){var b=n.tokenFormatter(a);b=$(b).addClass(n.classes.token).insertBefore(A);$("<span>"+n.deleteText+"</span>").addClass(n.classes.tokenDelete).appendTo(b).click(function(){delete_token($(this).parent());v.change();return false});var c={"id":a.id};c[n.propertyToSearch]=a[n.propertyToSearch];$.data(b.get(0),"tokeninput",a);p=p.slice(0,x).concat([c]).concat(p.slice(x));x++;update_hidden_input(p,v);q+=1;if(n.tokenLimit!==null&&q>=n.tokenLimit){u.hide();hide_dropdown()}return b}function add_token(c){var d=n.onAdd;if(q>0&&n.preventDuplicates){var e=null;z.children().each(function(){var a=$(this);var b=$.data(a.get(0),"tokeninput");if(b&&b.id===c.id){e=a;return false}});if(e){select_token(e);A.insertAfter(e);u.focus();return}}if(n.tokenLimit==null||q<n.tokenLimit){insert_token(c);checkTokenLimit()}u.val("");hide_dropdown();if($.isFunction(d)){d.call(v,c)}}function select_token(a){a.addClass(n.classes.selectedToken);w=a.get(0);u.val("");hide_dropdown()}function deselect_token(a,b){a.removeClass(n.classes.selectedToken);w=null;if(b===G.BEFORE){A.insertBefore(a);x--}else if(b===G.AFTER){A.insertAfter(a);x++}else{A.appendTo(z);x=q}u.focus()}function toggle_select_token(a){var b=w;if(w){deselect_token($(w),G.END)}if(b===a.get(0)){deselect_token(a,G.END)}else{select_token(a)}}function delete_token(a){var b=$.data(a.get(0),"tokeninput");var c=n.onDelete;var d=a.prevAll().length;if(d>x)d--;a.remove();w=null;u.focus();p=p.slice(0,d).concat(p.slice(d+1));if(d<x)x--;update_hidden_input(p,v);q-=1;if(n.tokenLimit!==null){u.show().val("").focus()}if($.isFunction(c)){c.call(v,b)}}function update_hidden_input(b,c){var d=$.map(b,function(a){return a[n.tokenValue]});c.val(d.join(n.tokenDelimiter))}function hide_dropdown(){B.hide().empty();y=null}function show_dropdown(){B.css({position:"absolute",top:$(z).offset().top+$(z).outerHeight(),left:$(z).offset().left,zindex:999}).show()}function show_dropdown_searching(){if(n.searchingText){B.html("<p>"+n.searchingText+"</p>");show_dropdown()}}function show_dropdown_hint(){if(n.hintText){B.html("<p>"+n.hintText+"</p>");show_dropdown()}}function highlight_term(a,b){return a.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")}function find_value_and_highlight_term(a,b,c){return a.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b+")(?![^<>]*>)(?![^&;]+;)","g"),highlight_term(b,c))}function populate_dropdown(d,e){if(e&&e.length){B.empty();var f=$("<ul>").appendTo(B).mouseover(function(a){select_dropdown_item($(a.target).closest("li"))}).mousedown(function(a){add_token($(a.target).closest("li").data("tokeninput"));v.change();return false}).hide();$.each(e,function(a,b){var c=n.resultsFormatter(b);c=find_value_and_highlight_term(c,b[n.propertyToSearch],d);c=$(c).appendTo(f);if(a%2){c.addClass(n.classes.dropdownItem)}else{c.addClass(n.classes.dropdownItem2)}if(a===0){select_dropdown_item(c)}$.data(c.get(0),"tokeninput",b)});show_dropdown();if(n.animateDropdown){f.slideDown("fast")}else{f.show()}}else{if(n.noResultsText){B.html("<p>"+n.noResultsText+"</p>");show_dropdown()}}}function select_dropdown_item(a){if(a){if(y){deselect_dropdown_item($(y))}a.addClass(n.classes.selectedDropdownItem);y=a.get(0)}}function deselect_dropdown_item(a){a.removeClass(n.classes.selectedDropdownItem);y=null}function do_search(){var a=u.val().toLowerCase();if(a&&a.length){if(w){deselect_token($(w),G.AFTER)}if(a.length>=n.minChars){show_dropdown_searching();clearTimeout(s);s=setTimeout(function(){run_search(a)},n.searchDelay)}else{hide_dropdown()}}}function run_search(d){var e=d+computeURL();var f=r.get(e);if(f){populate_dropdown(d,f)}else{if(n.url){var g=computeURL();var h={};h.data={};if(g.indexOf("?")>-1){var i=g.split("?");h.url=i[0];var j=i[1].split("&");$.each(j,function(a,b){var c=b.split("=");h.data[c[0]]=c[1]})}else{h.url=g}h.data[n.queryParam]=d;h.type=n.method;h.dataType=n.contentType;if(n.crossDomain){h.dataType="jsonp"}h.success=function(a){if($.isFunction(n.onResult)){a=n.onResult.call(v,a)}r.add(e,n.jsonContainer?a[n.jsonContainer]:a);if(u.val().toLowerCase()===d){populate_dropdown(d,n.jsonContainer?a[n.jsonContainer]:a)}};$.ajax(h)}else if(n.local_data){var k=$.grep(n.local_data,function(a){return a[n.propertyToSearch].toLowerCase().indexOf(d.toLowerCase())>-1});if($.isFunction(n.onResult)){k=n.onResult.call(v,k)}r.add(e,k);populate_dropdown(d,k)}}}function computeURL(){var a=n.url;if(typeof n.url=='function'){a=n.url.call()}return a}};$.TokenList.Cache=function(c){var d=$.extend({max_size:500},c);var e={};var f=0;var g=function(){e={};f=0};this.add=function(a,b){if(f>d.max_size){g()}if(!e[a]){f+=1}e[a]=b};this.get=function(a){return e[a]}}}(jQuery));var SnuOwnd={};(function(t){function _isspace(c){return c==' '||c=='\n'}function isspace(c){return/\s/.test(c)}function isalnum(c){return/[A-Za-z0-9]/.test(c)}function isalpha(c){return/[A-Za-z]/.test(c)}function ispunct(c){return/[\x20-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]/.test(c)}function urlHexCode(a){var b='0123456789ABCDEF';return'%'+b[(a&0xf0)>>4]+b[(a&0x0f)>>0]}function escapeUTF8Char(a){var b=a.charCodeAt(0);if(b<0x80){return urlHexCode(b)}else if((b>0x7f)&&(b<0x0800)){var c=urlHexCode(b>>6&0xff|0xc0);c+=urlHexCode(b>>0&0x3f|0x80);return c}else{var c=urlHexCode(b>>12&0xff|0xe0);c+=urlHexCode(b>>6&0x3f|0x80);c+=urlHexCode(b>>0&0x3f|0x80);return c}}function find_block_tag(a){var b=['p','dl','div','math','table','ul','del','form','blockquote','figure','ol','fieldset','h1','h6','pre','script','h5','noscript','style','iframe','h4','ins','h3','h2'];if(b.indexOf(a.toLowerCase())!=-1){return a.toLowerCase()}return''}function sdhtml_is_tag(a,b){var i;var c=0;var d=a.length;if(d<3||a[0]!='<')return HTML_TAG_NONE;i=1;if(a[i]=='/'){c=1;i++}var e=0;for(;i<d;++i,++e){if(e>=b.length)break;if(a[i]!=b[e])return HTML_TAG_NONE}if(i==d)return HTML_TAG_NONE;if(isspace(a[i])||a[i]=='>')return c?HTML_TAG_CLOSE:HTML_TAG_OPEN;return HTML_TAG_NONE}function unscape_text(a,b){var i=0,org;while(i<b.s.length){org=i;while(i<b.s.length&&b.s[i]!='\\')i++;if(i>org)a.s+=b.s.slice(org,i);if(i+1>=b.s.length)break;a.s+=b.s[i+1];i+=2}}var u=[7,7,7,7,7,7,7,7,7,0,0,7,7,0,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,0,0,1,0,0,0,2,3,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,5,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var v=["","&quot;","&amp;","&#39;","&#47;","&lt;","&gt;",""];function escape_html(a,b,c){var i=0,org,esc=0;while(i<b.length){org=i;while(i<b.length&&!(esc=u[b.charCodeAt(i)]))i++;if(i>org)a.s+=b.slice(org,i);if(i>=b.length)break;if(b[i]=='/'&&!c){a.s+='/'}else if(u[b.charCodeAt(i)]==7){}else{a.s+=v[esc]}i++}}var x=[2,2,2,2,2,2,2,2,2,0,0,2,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,1,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function escape_href(a,b){var i=0,org;while(i<b.length){org=i;while(i<b.length&&x[b.charCodeAt(i)]!=0)i++;if(i>org)a.s+=b.slice(org,i);if(i>=b.length)break;if(x[b.charCodeAt(i)]==2){i++;continue}switch(b[i]){case'&':a.s+='&amp;';break;case'\'':a.s+='&#x27;';break;default:a.s+=escapeUTF8Char(b[i])}i++}}function autolink_delim(a,b){var c,copen=0;var i;for(i=0;i<b;++i)if(a[i]=='<'){b=i;break}while(b>0){if('?!.,'.indexOf(a[b-1])!=-1)b--;else if(a[b-1]==';'){var d=b-2;while(d>0&&isalpha(a[d]))d--;if(d<b-2&&a[d]=='&')b=d;else b--}else break}if(b==0)return 0;c=a[b-1];switch(c){case'"':copen='"';break;case'\'':copen='\'';break;case')':copen='(';break;case']':copen='[';break;case'}':copen='{';break}if(copen!=0){var e=0;var f=0;var j=0;while(j<b){if(a[j]==copen)f++;else if(a[j]==c)e++;j++}if(e!=f)b--}return b}function check_domain(a,b){var i,np=0;if(!isalnum(a[0]))return 0;for(i=1;i<a.length-1;++i){if(a[i]=='.')np++;else if(!isalnum(a[i])&&a[i]!='-')break}if(b){return i}else{return np?i:0}}function sd_autolink_issafe(a){var b=["http://","https://","ftp://","mailto://","/","git://","steam://","irc://","news://","mumble://","ssh://","ircs://","#"];var i;for(i=0;i<b.length;++i){var c=b[i].length;if(a.length>c&&a.toLowerCase().indexOf(b[i])==0&&/[A-Za-z0-9#\/?]/.test(a[c]))return 1}return 0}function sd_autolink__url(a,b,c,d,e,f){var g=c.slice(d);var h,rewind=0,domain_len;if(e<4||c[d+1]!='/'||c[d+2]!='/')return 0;while(rewind<d&&isalpha(c[d-rewind-1]))rewind++;if(!sd_autolink_issafe(c.substr(d-rewind,e+rewind)))return 0;h="://".length;domain_len=check_domain(g.slice(h),f&S);if(domain_len==0)return 0;h+=domain_len;while(h<e&&!isspace(c[d+h]))h++;h=autolink_delim(g,h);if(h==0)return 0;b.s+=c.substr(d-rewind,h+rewind);a.p=rewind;return h}function sd_autolink__subreddit(a,b,c,d,e){var f=c.slice(d);var g;if(e<3)return 0;if(f.toLowerCase().indexOf('/r/')!=0)return 0;g="/r/".length;do{var h=g;var i=24;if(e>=g+10&&f.substr(g,10).toLowerCase()=='reddit.com'){g+=10;i=10}else{if(e>g+2&&f.substr(g,2)=='t:')g+=2;if(!isalnum(f[g]))return 0;g+=1}while(g<e&&(isalnum(f[g])||f[g]=='_'))g++;if(g-h<2||g-h>i)return 0}while(g<e&&f[g]=='+'&&g++);b.s+=f.slice(0,g);a.p=0;return g}function sd_autolink__username(a,b,c,d,e){var f=c.slice(d);var g;if(e<6)return 0;if(f.indexOf('/u/')!=0)return 0;g="/u/".length;if(!isalnum(f[g])&&f[g]!='_'&&f[g]!='-')return 0;g+=1;while(g<e&&(isalnum(f[g])||f[g]=='_'||f[g]=='-'))g++;b.s+=f.slice(0,g);a.p=0;return g}function sd_autolink__email(a,b,d,e,f,g){var h=d.slice(e);var i,rewind;var j=0,np=0;for(rewind=0;rewind<e;++rewind){var c=d[e-rewind-1];if(isalnum(c))continue;if(".+-_".indexOf(c)!=-1)continue;break}if(rewind==0)return 0;for(i=0;i<f;++i){var c=d[e+i];if(isalnum(c))continue;if(c=='@')j++;else if(c=='.'&&i<f-1)np++;else if(c!='-'&&c!='_')break}if(i<2||j!=1||np==0)return 0;i=autolink_delim(h,i);if(i==0)return 0;b.s+=d.substr(e-rewind,i+rewind);a.p=rewind;return i}function sd_autolink__www(a,b,c,d,e,f){var g=c.slice(d);var h;if(d>0&&!ispunct(c[d-1])&&!isspace(c[d-1]))return 0;if(e<4||(g.slice(0,4)!='www.'))return 0;h=check_domain(g,0);if(h==0)return 0;while(h<e&&!isspace(g[h]))h++;h=autolink_delim(g,h);if(h==0)return 0;b.s+=g.slice(0,h);a.p=0;return h}function Callbacks(a){if(a){for(var b in a){if(b in this)this[b]=a[b]}}}Callbacks.prototype={blockcode:null,blockquote:null,blockhtml:null,header:null,hrule:null,list:null,listitem:null,paragraph:null,table:null,table_row:null,table_cell:null,autolink:null,codespan:null,double_emphasis:null,emphasis:null,image:null,linebreak:null,link:null,raw_html_tag:null,triple_emphasis:null,strikethrough:null,superscript:null,entity:null,normal_text:null,doc_header:null,doc_footer:null};function Renderer(a,b){this.callbacks=a;this.context=b}function createCustomRenderer(a,b){return new Renderer(a,b)}t.createCustomRenderer=createCustomRenderer;function getRedditRenderer(){return new Renderer(getRedditCallbacks(),{nofollow:0,target:null,tocData:{headerCount:0,currentLevel:0,levelOffset:0},flags:be|bg|bj|bn|bm,link_attributes:function link_attributes(a,b,c){if(c.nofollow)a.s+=' rel="nofollow"';if(c.target!=null){a.s+=' target="'+c.target+'"'}}})}t.getRedditRenderer=getRedditRenderer;function createCustomCallbacks(a){return new Callbacks(a)}t.createCustomCallbacks=createCustomCallbacks;function getRedditCallbacks(){return new Callbacks({blockcode:cb_blockcode,blockquote:cb_blockquote,blockhtml:cb_blockhtml,header:cb_header,hrule:cb_hrule,list:cb_list,listitem:cb_listitem,paragraph:cb_paragraph,table:cb_table,table_row:cb_table_row,table_cell:cb_table_cell,autolink:cb_autolink,codespan:cb_codespan,double_emphasis:cb_double_emphasis,emphasis:cb_emphasis,image:cb_image,linebreak:cb_linebreak,link:cb_link,raw_html_tag:cb_raw_html_tag,triple_emphasis:cb_triple_emphasis,strikethrough:cb_strikethrough,superscript:cb_superscript,entity:null,normal_text:cb_normal_text,doc_header:null,doc_footer:null})}t.getRedditCallbacks=getRedditCallbacks;function getTocCallbacks(){return new Callbacks({blockcode:null,blockquote:null,blockhtml:null,header:cb_toc_header,hrule:null,list:null,listitem:null,paragraph:null,table:null,table_row:null,table_cell:null,autolink:null,codespan:cb_codespan,double_emphasis:cb_double_emphasis,emphasis:cb_emphasis,image:null,linebreak:null,link:cb_toc_link,raw_html_tag:null,triple_emphasis:cb_triple_emphasis,strikethrough:cb_strikethrough,superscript:cb_superscript,entity:null,normal_text:null,doc_header:null,doc_footer:cb_toc_finalize})}t.getTocCallbacks=getTocCallbacks;function cb_blockcode(a,b,c,d){if(a.s.length)a.s+='\n';if(c&&c.s.length){var i,cls;a.s+='<pre><code class="';for(i=0,cls=0;i<c.s.length;++i,++cls){while(i<c.s.length&&isspace(c.s[i]))i++;if(i<c.s.length){var e=i;while(i<c.s.length&&!isspace(c.s[i]))i++;if(c.s[e]=='.')e++;if(cls)a.s+=' ';escape_html(a,c.s.slice(e,i),false)}}a.s+='">'}else a.s+='<pre><code>';if(b)escape_html(a,b.s,false);a.s+='</code></pre>\n'}function cb_blockquote(a,b,c){if(a.s.length)a.s+='\n';a.s+='<blockquote>\n';if(b)a.s+=b.s;a.s+='</blockquote>\n'}function cb_blockhtml(a,b,c){var d,sz;if(!b)return;sz=b.s.length;while(sz>0&&b.s[sz-1]=='\n')sz--;d=0;while(d<sz&&b.s[d]=='\n')d++;if(d>=sz)return;if(a.s.length)a.s+='\n';a.s+=b.s.slice(d,sz);a.s+='\n'}function cb_header(a,b,c,d){if(a.s.length)a.s+='\n';if(d.flags&bk)a.s+='<h'+(+c)+'id="toc_'+(d.tocData.headerCount++)+'">';else a.s+='<h'+(+c)+'>';if(b)a.s+=b.s;a.s+='</h'+(+c)+'>\n'}function cb_hrule(a,b){if(a.s.length)a.s+='\n';a.s+=(b.flags&bm)?'<hr/>\n':'<hr>\n'}function cb_list(a,b,c,d){if(a.s.length)a.s+='\n';a.s+=(c&B?'<ol>\n':'<ul>\n');if(b)a.s+=b.s;a.s+=(c&B?'</ol>\n':'</ul>\n')}function cb_listitem(a,b,c,d){a.s+='<li>';if(b){var e=b.s.length;while(e&&b.s[e-1]=='\n')e--;a.s+=b.s.slice(0,e)}a.s+='</li>\n'}function cb_paragraph(a,b,c){var i=0;if(a.s.length)a.s+='\n';if(!b||!b.s.length)return;while(i<b.s.length&&isspace(b.s[i]))i++;if(i==b.s.length)return;a.s+='<p>';if(c.flags&bl){var d;while(i<b.s.length){d=i;while(i<b.s.length&&b.data[i]!='\n')i++;if(i>d)a.s+=b.s.slice(d,i);if(i>=b.s.length-1)break;cb_linebreak(a,c);i++}}else{a.s+=b.s.slice(i)}a.s+='</p>\n'}function cb_table(a,b,c,d){if(a.s.length)a.s+='\n';a.s+='<table><thead>\n';if(b)a.s+=b.s;a.s+='</thead><tbody>\n';if(c)a.s+=c.s;a.s+='</tbody></table>\n'}function cb_table_row(a,b,c){a.s+='<tr>\n';if(b)a.s+=b.s;a.s+='</tr>\n'}function cb_table_cell(a,b,c,d){if(c&bs){a.s+='<th'}else{a.s+='<td'}switch(c&br){case bq:a.s+=' align="center">';break;case bo:a.s+=' align="left">';break;case bp:a.s+=' align="right">';break;default:a.s+='>'}if(b)a.s+=b.s;if(c&bs){a.s+='</th>\n'}else{a.s+='</td>\n'}}function cb_autolink(a,b,c,d){var e=0;if(!b||!b.s.length)return 0;if((d.flags&bj)!=0&&!sd_autolink_issafe(b.s)&&c!=V)return 0;a.s+='<a href="';if(c==V)a.s+='mailto:';escape_href(a,b.s.slice(e));if(d.link_attributes){a.s+='"';d.link_attributes(a,b,d);a.s+='>'}else{a.s+='">'}if(b.s.indexOf('mailto:')==0){escape_html(a,b.s.slice(7),false)}else{escape_html(a,b.s,false)}a.s+='</a>';return 1}function cb_codespan(a,b,c){a.s+='<code>';if(b)escape_html(a,b.s,false);a.s+='</code>';return 1}function cb_double_emphasis(a,b,c){if(!b||!b.s.length)return 0;a.s+='<strong>'+b.s+'</strong>';return 1}function cb_emphasis(a,b,c){if(!b||!b.s.length)return 0;a.s+='<em>'+b.s+'</em>';return 1}function cb_image(a,b,c,d,e){if(!b||!b.s.length)return 0;a.s+='<img src="';escape_href(a,b.s);a.s+='" alt="';if(d&&d.s.length)escape_html(a,d.s,false);if(c&&c.s.length){a.s+='" title="';escape_html(a,c.s,false)}a.s+=(e.flags&bm?'"/>':'">');return 1}function cb_linebreak(a,b){a.s+=(b.flags&bm?'<br/>\n':'<br>\n');return 1}function cb_link(a,b,c,d,e){if(b!=null&&(e.flags&bj)!=0&&!sd_autolink_issafe(b.s))return 0;a.s+='<a href="';if(b&&b.s.length)escape_href(a,b.s);if(c&&c.s.length){a.s+='" title="';escape_html(a,c.s,false)}if(e.link_attributes){a.s+='"';e.link_attributes(a,b,e);a.s+='>'}else{a.s+='">'}if(d&&d.s.length)a.s+=d.s;a.s+='</a>';return 1}function cb_raw_html_tag(a,b,c){if((c.flags&bn)!=0){escape_html(a,b.s,false);return 1}if((c.flags&be)!=0)return 1;if((c.flags&bf)!=0&&sdhtml_is_tag(b.s,"style"))return 1;if((c.flags&bh)!=0&&sdhtml_is_tag(b.s,"a"))return 1;if((c.flags&bg)!=0&&sdhtml_is_tag(b.s,"img"))return 1;a.s+=b.s;return 1}function cb_triple_emphasis(a,b,c){if(!b||!b.s.length)return 0;a.s+='<strong><em>'+b.s+'</em></strong>';return 1}function cb_strikethrough(a,b,c){if(!b||!b.s.length)return 0;a.s+='<del>'+b.s+'</del>';return 1}function cb_superscript(a,b,c){if(!b||!b.s.length)return 0;a.s+='<sup>'+b.s+'</sup>';return 1}function cb_normal_text(a,b,c){if(b)escape_html(a,b.s,false)}function cb_toc_header(a,b,c,d){if(d.tocData.currentLevel==0){d.tocData.levelOffset=c-1}c-=d.tocData.levelOffset;if(c>d.tocData.currentLevel){while(c>d.tocData.currentLevel){a.s+='<ul>\n<li>\n';d.tocData.currentLevel++}}else if(c<d.tocData.currentLevel){a.s+='</li>\n';while(c<d.tocData.currentLevel){a.s+='</ul\n</li>\n';d.tocData.currentLevel--}a.s+='<li>\n'}else{a.s+='</li>\n<li>\n'}a.s+='<a href="#toc_'+d.tocData.headerCount++ +'">';if(b)escape_html(a,b.s,false);a.s+='</a>\n'}function cb_toc_link(a,b,c,d,e){if(d&&d.s)a.s+=d.s;return 1}function cb_toc_finalize(a,b){while(b.tocData.currentLevel>0){a.s+='</li>\n</ul>\n';b.tocData.currentLevel--}}function char_emphasis(a,b,d,e){var f=d.slice(e);var g=f.length;var c=f[0];var h;if(g>2&&f[1]!=c){if(c=='~'||_isspace(f[1])||(h=parse_emph1(a,b,f,c))==0)return 0;return h+1}if(f.length>3&&f[1]==c&&f[2]!=c){if(_isspace(f[2])||(h=parse_emph2(a,b,f,c))==0)return 0;return h+2}if(f.length>4&&f[1]==c&&f[2]==c&&f[3]!=c){if(c=='~'||_isspace(f[3])||(h=parse_emph3(a,b,f,c))==0)return 0;return h+3}return 0}function char_codespan(a,b,c,d){var e=c.slice(d);var f,nb=0,i,f_begin,f_end;while(nb<e.length&&e[nb]=='`')nb++;i=0;for(f=nb;f<e.length&&i<nb;f++){if(e[f]=='`')i++;else i=0}if(i<nb&&f>=e.length)return 0;f_begin=nb;while(f_begin<f&&e[f_begin]==' ')f_begin++;f_end=f-nb;while(f_end>nb&&e[f_end-1]==' ')f_end--;if(f_begin<f_end){var g=new Buffer(e.slice(f_begin,f_end));if(!b.callbacks.codespan(a,g,b.context))f=0}else{if(!b.callbacks.codespan(a,null,b.context))f=0}return f}function char_linebreak(a,b,c,d){var e=c.slice(d);if(d<2||c[d-1]!=' '||c[d-2]!=' ')return 0;a.s=a.s.trimRight();return b.callbacks.linebreak(a,b.context)?1:0}function char_link(a,c,d,e){var f=d.slice(e);var g=(e&&f[e-1]=='!'),level;var i=1,txt_e,link_b=0,link_e=0,title_b=0,title_e=0;var h=null;var k=null;var l=null;var m=null;var n=c.spanStack.length;var o=0,ret=0;var p=0,qtype=0;function cleanup(){c.spanStack.length=n;return ret?i:0}if((g&&!c.callbacks.image)||(!g&&!c.callbacks.link))return cleanup();for(level=1;i<f.length;i++){if(f[i]=='\n')o=1;else if(f[i-1]=='\\')continue;else if(f[i]=='[')level++;else if(f[i]==']'){level--;if(level<=0)break}}if(i>=f.length)return cleanup();txt_e=i;i++;while(i<f.length&&_isspace(f[i]))i++;if(i<f.length&&f[i]=='('){i++;while(i<f.length&&_isspace(f[i]))i++;link_b=i;while(i<f.length){if(f[i]=='\\')i+=2;else if(f[i]==')')break;else if(i>=1&&_isspace(f[i-1])&&(f[i]=='\''||f[i]=='"'))break;else i++}if(i>=f.length)return cleanup();link_e=i;if(f[i]=='\''||f[i]=='"'){qtype=f[i];p=1;i++;title_b=i;while(i<f.length){if(f[i]=='\\')i+=2;else if(f[i]==qtype){p=0;i++}else if((f[i]==')')&&!p)break;else i++}if(i>=f.length)return cleanup();title_e=i-1;while(title_e>title_b&&_isspace(f[title_e]))title_e--;if(f[title_e]!='\''&&f[title_e]!='"'){title_b=title_e=0;link_e=i}}while(link_e>link_b&&_isspace(f[link_e-1]))link_e--;if(f[link_b]=='<')link_b++;if(f[link_e-1]=='>')link_e--;if(link_e>link_b){k=new Buffer();c.spanStack.push(k);k.s+=f.slice(link_b,link_e)}if(title_e>title_b){l=new Buffer();c.spanStack.push(l);l.s+=f.slice(title_b,title_e)}i++}else if(i<f.length&&f[i]=='['){var q=new Buffer();var r=null;i++;link_b=i;while(i<f.length&&f[i]!=']')i++;if(i>=f.length)return cleanup();link_e=i;if(link_b==link_e){if(o){var b=new Buffer();c.spanStack.push(b);var j;for(j=1;j<txt_e;j++){if(f[j]!='\n')b.s+=f[j];else if(f[j-1]!=' ')b.s+=' '}q.s=b.s}else{q.s=f.slice(1)}}else{q.s=f.slice(link_b,link_e)}r=c.refs[q.s];if(!r)return cleanup();k=r.link;l=r.title;i++}else{var q=new Buffer();var r=null;if(o){var b=new Buffer();c.spanStack.push(b);var j;for(j=1;j<txt_e;j++){if(f[j]!='\n')b.s+=f[j];else if(f[j-1]!=' ')b.s+=' '}q.s=b.s}else{q.s=f.slice(1,txt_e)}r=c.refs[q.s];if(!r)return cleanup();k=r.link;l=r.title;i=txt_e+1}if(txt_e>1){h=new Buffer();c.spanStack.push(h);if(g){h.s+=f.slice(1,txt_e)}else{c.inLinkBody=1;parse_inline(h,c,f.slice(1,txt_e));c.inLinkBody=0}}if(k){m=new Buffer();c.spanStack.push(m);unscape_text(m,k)}else{return cleanup()}if(g){if(a.s.length&&a.s[a.s.length-1]=='!')a.s=a.s.slice(0,-1);ret=c.callbacks.image(a,m,l,h,c.context)}else{ret=c.callbacks.link(a,m,l,h,c.context)}return cleanup()}function char_langle_tag(a,b,c,d){var e=c.slice(d);var f={p:T};var g=tag_length(e,f);var h=new Buffer(e.slice(0,g));var i=0;if(g>2){if(b.callbacks.autolink&&f.p!=T){var j=new Buffer();b.spanStack.push(j);h.s=e.slice(1,g-2);unscape_text(j,h);i=b.callbacks.autolink(a,j,f.p,b.context);b.spanStack.pop()}else if(b.callbacks.raw_html_tag)i=b.callbacks.raw_html_tag(a,h,b.context)}if(!i)return 0;else return g}function char_escape(a,b,c,d){var e=c.slice(d);var f="\\`*_{}[]()#+-.!:|&<>/^~";var g=new Buffer();if(e.length>1){if(f.indexOf(e[1])==-1)return 0;if(b.callbacks.normal_text){g.s=e[1];b.callbacks.normal_text(a,g,b.context)}else a.s+=e[1]}else if(e.length==1){a.s+=e[0]}return 2}function char_entity(a,b,c,d){var e=c.slice(d);var f=1;var g=new Buffer();if(f<e.length&&e[f]=='#')f++;while(f<e.length&&isalnum(e[f]))f++;if(f<e.length&&e[f]==';')f++;else return 0;if(b.callbacks.entity){g.s=e.slice(0,f);b.callbacks.entity(a,g,b.context)}else a.s+=e.slice(0,f);return f}function char_autolink_url(a,b,c,d){var e=c.slice(d);var f=null;var g,rewind={p:null};if(!b.callbacks.autolink||b.inLinkBody)return 0;f=new Buffer();b.spanStack.push(f);if((g=sd_autolink__url(rewind,f,c,d,e.length,0))>0){if(rewind.p>0)a.s=a.s.slice(0,-rewind.p);b.callbacks.autolink(a,f,U,b.context)}b.spanStack.pop();return g}function char_autolink_email(a,b,c,d){var e=c.slice(d);var f=null;var g,rewind={p:null};if(!b.callbacks.autolink||b.inLinkBody)return 0;f=new Buffer();b.spanStack.push(f);if((g=sd_autolink__email(rewind,f,c,d,e.length,0))>0){if(rewind.p>0)a.s=a.s.slice(0,-rewind.p);b.callbacks.autolink(a,f,V,b.context)}b.spanStack.pop();return g}function char_autolink_www(a,b,c,d){var e=c.slice(d);var f=null,link_url=null,link_text=null;var g,rewind={p:null};if(!b.callbacks.link||b.inLinkBody)return 0;f=new Buffer();b.spanStack.push(f);if((g=sd_autolink__www(rewind,f,c,d,e.length,0))>0){link_url=new Buffer();b.spanStack.push(link_url);link_url.s+='http://';link_url.s+=f.s;if(rewind.p>0)a.s=a.s.slice(0,a.s.length-rewind.p);if(b.callbacks.normal_text){link_text=new Buffer();b.spanStack.push(link_text);b.callbacks.normal_text(link_text,f,b.context);b.callbacks.link(a,link_url,null,link_text,b.context);b.spanStack.pop()}else{b.callbacks.link(a,link_url,null,f,b.context)}b.spanStack.pop()}b.spanStack.pop();return g}function char_autolink_subreddit_or_username(a,b,c,d){var e=c.slice(d);var f=null;var g,rewind={p:null};if(!b.callbacks.autolink||b.inLinkBody)return 0;f=new Buffer();b.spanStack.push(f);if((g=sd_autolink__subreddit(rewind,f,c,d,e.length))>0){if(rewind.p>0)a.s=a.s.slice(0,-rewind.p);b.callbacks.autolink(a,f,U,b.context)}else if((g=sd_autolink__username(rewind,f,c,d,e.length))>0){if(rewind.p>0)a.s=a.s.slice(0,-rewind.p);b.callbacks.autolink(a,f,U,b.context)}b.spanStack.pop();return g}function char_superscript(a,b,c,d){var e=c.slice(d);var f=e.length;var g,sup_len;var h=null;if(!b.callbacks.superscript)return 0;if(f<2)return 0;if(e[1]=='('){g=sup_len=2;while(sup_len<f&&e[sup_len]!=')'&&e[sup_len-1]!='\\')sup_len++;if(sup_len==f)return 0}else{g=sup_len=1;while(sup_len<f&&!_isspace(e[sup_len]))sup_len++}if(sup_len-g==0)return(g==2)?3:0;h=new Buffer();b.spanStack.push(h);parse_inline(h,b,e.slice(g,sup_len));b.callbacks.superscript(a,h,b.context);b.spanStack.pop();return(g==2)?sup_len+1:sup_len}var y=[null,char_emphasis,char_codespan,char_linebreak,char_link,char_langle_tag,char_escape,char_entity,char_autolink_url,char_autolink_email,char_autolink_www,char_autolink_subreddit_or_username,char_superscript];var B=1;var C=2;var D=8;var E=0;var F=E++;var G=E++;var H=E++;var I=E++;var J=E++;var K=E++;var L=E++;var M=E++;var N=E++;var O=E++;var P=E++;var Q=E++;var R=E++;var S=(1<<0);E=0;var T=E++;var U=E++;var V=E++;var W=(1<<0);var X=(1<<1);var Y=(1<<2);var Z=(1<<3);var ba=(1<<4);var bb=(1<<6);var bc=(1<<7);var bd=(1<<8)var be=(1<<0);var bf=(1<<1);var bg=(1<<2);var bh=(1<<3);var bi=(1<<4);var bj=(1<<5);var bk=(1<<6);var bl=(1<<7);var bm=(1<<8);var bn=(1<<9);var bo=1;var bp=2;var bq=3;var br=3;var bs=4 function Buffer(a){this.s=a||""};function Markdown(){this.spanStack=[];this.blockStack=[];this.extensions=W|bc|Z|ba|X;var a=getRedditRenderer();this.context=a.context;this.inLinkBody=0;this.activeChars={};this.refs={}};Markdown.prototype.callbacks=getRedditCallbacks();Markdown.prototype.nestingLimit=16;function is_empty(a){var i;for(i=0;i<a.length&&a[i]!='\n';i++)if(a[i]!=' ')return 0;return i+1}function is_hrule(a){var i=0,n=0;var c;if(a.length<3)return 0;if(a[0]==' '){i++;if(a[1]==' '){i++;if(a[2]==' '){i++}}}if(i+2>=a.length||(a[i]!='*'&&a[i]!='-'&&a[i]!='_'))return 0;c=a[i];while(i<a.length&&a[i]!='\n'){if(a[i]==c)n++;else if(a[i]!=' ')return 0;i++}return n>=3}function prefix_codefence(a){var i=0,n=0;var c;if(a.length<3)return 0;if(a[0]==' '){i++;if(a[1]==' '){i++;if(a[2]==' '){i++}}}if(i+2>=a.length||!(a[i]=='~'||a[i]=='`'))return 0;c=a[i];while(i<a.length&&a[i]==c){n++;i++}if(n<3)return 0;return i}function is_codefence(a,b){var i=0,syn_len=0;i=prefix_codefence(a);if(i==0)return 0;while(i<a.length&&a[i]==' ')i++;var c;c=i;if(i<a.length&&a[i]=='{'){i++;c++;while(i<a.length&&a[i]!='}'&&a[i]!='\n'){syn_len++;i++}if(i==a.length||a[i]!='}')return 0;while(syn>0&&_isspace(a[syn_cursor+0])){c++;syn_len--}while(syn_len>0&&_isspace(a[c+syn_len-1]))syn_len--;i++}else{while(i<a.length&&!_isspace(a[i])){syn_len++;i++}}if(b)b.s=a.substr(c,syn_len);while(i<a.length&&a[i]!='\n'){if(!_isspace(a[i]))return 0;i++}return i+1}function find_emph_char(a,c){var i=1;while(i<a.length){while(i<a.length&&a[i]!=c&&a[i]!='`'&&a[i]!='[')i++;if(i==a.length)return 0;if(a[i]==c)return i;if(i&&a[i-1]=='\\'){i++;continue}if(a[i]=='`'){var b=0,bt;var d=0;while(i<a.length&&a[i]=='`'){i++;b++}if(i>=a.length)return 0;bt=0;while(i<a.length&&bt<b){if(!d&&a[i]==c)d=i;if(a[i]=='`')bt++;else bt=0;i++}if(i>=a.length)return d}else if(a[i]=='['){var d=0;var e;i++;while(i<a.length&&a[i]!=']'){if(!d&&a[i]==c)d=i;i++}i++;while(i<a.length&&(a[i]==' '||a[i]=='\n'))i++;if(i>=a.length)return d;switch(a[i]){case'[':e=']';break;case'(':e=')';break;default:if(d)return d;else continue}i++;while(i<a.length&&a[i]!=e){if(!d&&a[i]==c)d=i;i++}if(i>=a.length)return d;i++}}return 0}function parse_emph1(a,b,d,c){var e=d.slice(1);var i=0,len;var r;if(!b.callbacks.emphasis)return 0;if(e.length>1&&e[0]==c&&e[1]==c)i=1;while(i<e.length){len=find_emph_char(e.slice(i),c);if(!len)return 0;i+=len;if(i>=e.length)return 0;if(e[i]==c&&!_isspace(e[i-1])){if((b.extensions&W)&&(c=='_')){if(!(i+1==e.length||_isspace(e[i+1])||ispunct(e[i+1])))continue}var f=new Buffer();b.spanStack.push(f);parse_inline(f,b,e.slice(0,i));r=b.callbacks.emphasis(a,f,b.context);b.spanStack.pop();return r?i+1:0}}return 0}function parse_emph2(a,b,d,c){var e=d.slice(2);var i=0,len;var r;var f=(c=='~')?b.callbacks.strikethrough:b.callbacks.double_emphasis;if(!f)return 0;while(i<e.length){len=find_emph_char(e.slice(i),c);if(!len)return 0;i+=len;if(i+1<e.length&&e[i]==c&&e[i+1]==c&&i&&!_isspace(e[i-1])){var g=new Buffer();b.spanStack.push(g);parse_inline(g,b,e.slice(0,i));r=f(a,g,b.context);b.spanStack.pop();return r?i+2:0}i++}return 0}function parse_emph3(a,b,d,c){var e=d.slice(3);var i=0,len;var r;while(i<e.length){len=find_emph_char(e.slice(i),c);if(!len)return 0;i+=len;if(e[i]!=c||_isspace(e[i-1]))continue;if(i+2<e.length&&e[i+1]==c&&e[i+2]==c&&b.callbacks.triple_emphasis){var f=new Buffer();b.spanStack.push(f);parse_inline(f,b,e.slice(0,i));r=b.callbacks.triple_emphasis(a,f,b.context);b.spanStack.pop();return r?i+3:0}else if(i+1<e.length&&e[i+1]==c){len=parse_emph1(a,b,d.slice(1),c);if(!len)return 0;else return len-2}else{len=parse_emph2(a,b,e.slice(2),c);if(!len)return 0;else return len-1}}return 0}function is_atxheader(a,b){if(b[0]!='#')return false;if(a.extensions&bb){var c=0;while(c<b.length&&c<6&&b[c]=='#')c++;if(c<b.length&&b[c]!=' ')return false}return true}function is_headerline(a){var i=0;var b=a.length;if(a[i]=='='){for(i=1;i<b&&a[i]=='=';i++){}while(i<b&&a[i]==' ')i++;return(i>=b||a[i]=='\n')?1:0}if(a[i]=='-'){for(i=1;i<b&&a[i]=='-';i++){}while(i<b&&a[i]==' ')i++;return(i>=b||a[i]=='\n')?2:0}return 0}function is_next_headerline(a){var b=a.length;var i=0;while(i<b&&a[i]!='\n')i++;if(++i>=b)return 0;return is_headerline(a.slice(i))}function prefix_quote(a){var i=0;var b=a.length;if(i<b&&a[i]==' ')i++;if(i<b&&a[i]==' ')i++;if(i<b&&a[i]==' ')i++;if(i<b&&a[i]=='>'){if(i+1<b&&a[i+1]==' ')return i+2;return i+1}return 0}function prefix_code(a){if(a.length>3&&a[0]==' '&&a[1]==' '&&a[2]==' '&&a[3]==' ')return 4;return 0}function prefix_oli(a){var b=a.length;var i=0;if(i<b&&a[i]==' ')i++;if(i<b&&a[i]==' ')i++;if(i<b&&a[i]==' ')i++;if(i>=b||a[i]<'0'||a[i]>'9')return 0;while(i<b&&a[i]>='0'&&a[i]<='9')i++;if(i+1>=b||a[i]!='.'||a[i+1]!=' ')return 0;if(is_next_headerline(a.slice(i)))return 0;return i+2}function prefix_uli(a){var b=a.length;var i=0;if(i<b&&a[i]==' ')i++;if(i<b&&a[i]==' ')i++;if(i<b&&a[i]==' ')i++;if(i+1>=b||(a[i]!='*'&&a[i]!='+'&&a[i]!='-')||a[i+1]!=' ')return 0;if(is_next_headerline(a.slice(i)))return 0;return i+2}function is_mail_autolink(a){var i=0,nb=0;for(i=0;i<a.length;++i){if(isalnum(a[i]))continue;switch(a[i]){case'@':nb++;case'-':case'.':case'_':break;case'>':return(nb==1)?i+1:0;default:return 0}}return 0}function tag_length(a,b){var i,j;if(a.length<3)return 0;if(a[0]!='<')return 0;i=(a[1]=='/')?2:1;if(!isalnum(a[i]))return 0;b.p=T;while(i<a.length&&(isalnum(a[i])||a[i]=='.'||a[i]=='+'||a[i]=='-'))i++;if(i>1&&a[i]=='@'){if((j=is_mail_autolink(a.slice(i)))!=0){b.p=V;return i+j}}if(i>2&&a[i]==':'){b.p=U;i++}if(i>=a.length)b.p=T;else if(b.p){j=i;while(i<a.length){if(a[i]=='\\')i+=2;else if(a[i]=='>'||a[i]=='\''||a[i]=='"'||a[i]==' '||a[i]=='\n')break;else i++}if(i>=a.length)return 0;if(i>j&&a[i]=='>')return i+1;b.p=T}while(i<a.length&&a[i]!='>')i++;if(i>=a.length)return 0;return i+1}function parse_inline(a,b,c){var i=0,end=0;var d=0;var e=new Buffer();if(b.spanStack.length+b.blockStack.length>b.nestingLimit)return;while(i<c.length){while(end<c.length&&!(d=b.activeChars[c[end]])){end++}if(b.callbacks.normal_text){e.s=c.slice(i,end);b.callbacks.normal_text(a,e,b.context)}else a.s+=c.slice(i,end);if(end>=c.length)break;i=end;end=y[d](a,b,c,i);if(!end)end=i+1;else{i+=end;end=i}}}function parse_atxheader(a,b,c){var d=0;var i,end,skip;while(d<c.length&&d<6&&c[d]=='#')d++;for(i=d;i<c.length&&c[i]==' ';i++){}for(end=i;end<c.length&&c[end]!='\n';end++){}skip=end;while(end&&c[end-1]=='#')end--;while(end&&c[end-1]==' ')end--;if(end>i){var e=new Buffer();b.spanStack.push(e);parse_inline(e,b,c.slice(i,end));if(b.callbacks.header)b.callbacks.header(a,e,d,b.context);b.spanStack.pop()}return skip}function htmlblock_end(a,b,c){var i,w;if(a.length+3>=c.length||c.slice(2).toLowerCase()!=a||c[a.length+2]!='>')return 0;i=a.length+3;w=0;if(i<c.length&&(w=is_empty(c.slice(i)))==0)return 0;i+=w;w=0;if(i<c.length)w=is_empty(c.slice(i));return i+w}function parse_htmlblock(a,b,c,d){var i,j=0;var e=null;var f;var g=new Buffer(c);if(c.length<2||c[0]!='<')return 0;i=1;while(i<c.length&&c[i]!='>'&&c[i]!=' ')i++;if(i<c.length)e=find_block_tag(c.slice(1));if(!e){if(c.length>5&&c[1]=='!'&&c[2]=='-'&&c[3]=='-'){i=5;while(i<c.length&&!(c[i-2]=='-'&&c[i-1]=='-'&&c[i]=='>'))i++;i++;if(i<size)j=is_empty(c.slice(i));if(j){g.s=c.slice(0,i+j);if(d&&b.callbacks.blockhtml)b.callbacks.blockhtml(a,g,b.context);return g.s.length}}if(c.length>4&&(c[1]=='h'||c[1]=='H')&&(c[2]=='r'||c[2]=='R')){i=3;while(i<c.length&&c[i]!='>')i++;if(i+1<c.length){i++;j=is_empty(c.slice(i));if(j){g.s=c.slice(0,i+j);if(d&&b.callbacks.blockhtml)b.callbacks.blockhtml(a,g,b.context);return g.s.length}}}return 0}i=1;f=0;if(e!='ins'&&e!='del'){var h=e.length;i=1;while(i<c.length){i++;while(i<c.length&&!(c[i-1]=='<'&&c[i]=='/'))i++;if(i+2+h>=c.length)break;j=htmlblock_end(tag,b,c.slice(i-1));if(j){i+=j-1;f=1;break}}}if(!f)return 0;g.s=g.s.slice(0,i);if(d&&b.callbacks.blockhtml)b.callbacks.blockhtml(a,g,b.context);return i}function parse_blockquote(a,b,c){var d=c.length;var e,end=0,pre,work_size=0;var f="";var g=0;var h=new Buffer();b.blockStack.push(h);e=0;while(e<d){for(end=e+1;end<d&&c[end-1]!='\n';end++){}pre=prefix_quote(c.slice(e,end));if(pre)e+=pre;else if(is_empty(c.slice(e,end))&&(end>=d||(prefix_quote(c.slice(end))==0&&!is_empty(c.slice(end)))))break;if(e<end){f+=c.slice(e,end);work_size+=end-e}e=end}parse_block(h,b,f);if(b.callbacks.blockquote)b.callbacks.blockquote(a,h,b.context);b.blockStack.pop();return end}function parse_paragraph(a,b,c){var i=0,end=0;var d=0;var e=c.length;var f=new Buffer(c);while(i<e){for(end=i+1;end<e&&c[end-1]!='\n';end++){}if(prefix_quote(c.slice(i,end))!=0){end=i;break}var g=c.slice(i);if(is_empty(g)||(d=is_headerline(g))!=0)break;if(is_empty(g))break;if((d=is_headerline(g))!=0)break;if(is_atxheader(b,g)||is_hrule(g)||prefix_quote(g)){end=i;break}if((b.extensions&bd)&&!isalnum(c[i])){if(prefix_oli(g)||prefix_uli(g)){end=i;break}if(c[i]=='<'&&b.callbacks.blockhtml&&parse_htmlblock(a,b,g,0)){end=i;break}if((b.extensions&&Y)!=0&&is_codefence(g,null)!=0){end=i;break}}i=end}var h=i;while(h&&c[h-1]=='\n')h--;f.s=f.s.slice(0,h);if(!d){var j=new Buffer();b.blockStack.push(j);parse_inline(j,b,f.s);if(b.callbacks.paragraph)b.callbacks.paragraph(a,j,b.context);b.blockStack.pop()}else{var k=null;if(f.size){var l;i=f.s.length;while(h&&c[h]!='\n')h-=1;l=h+1;while(h&&c[h-1]=='\n')h-=1;f.s=f.s.slice(0,h);if(h>0){var j=new Buffer();b.blockStack.push(j);parse_inline(j,b,f.s);if(b.callbacks.paragraph)b.callbacks.paragraph(a,j,b.context);b.blockStack.pop();f.s=f.s.slice(l,i)}else f.s=f.s.slice(0,i)}k=new Buffer();b.spanStack.push(k);parse_inline(k,b,f.s);if(b.callbacks.header)b.callbacks.header(a,k,d,b.context);b.spanStack.pop()}return end}function parse_fencedcode(a,b,c){var d,end;var e=null;var f=new Buffer();d=is_codefence(c,f);if(d==0)return 0;e=new Buffer();b.blockStack.push(e);while(d<c.length){var g;var h=new Buffer();g=is_codefence(c.slice(d),h);if(g!=0&&h.s.length==0){d+=g;break}for(end=d+1;end<c.length&&c[end-1]!='\n';end++){}if(d<end){var i=c.slice(d,end);if(is_empty(i))e.s+='\n';else e.s+=i}d=end}if(e.s.length&&e.s[e.s.length-1]!='\n')e.s+='\n';if(b.callbacks.blockcode)b.callbacks.blockcode(a,e,f.s.length?f:null,b.context);b.blockStack.pop();return d}function parse_blockcode(a,b,c){var d=c.length;var e,end,pre;var f=null;b.blockStack.push(f=new Buffer());e=0;while(e<d){for(end=e+1;end<d&&c[end-1]!='\n';end++){};pre=prefix_code(c.slice(e,end));if(pre)e+=pre;else if(!is_empty(c.slice(e,end)))break;if(e<end){if(is_empty(c.slice(e,end)))f.s+='\n';else f.s+=c.slice(e,end)}e=end}var g=f.s.length;while(g&&f.s[g-1]=='\n')g-=1;f.s=f.s.slice(0,g);f.s+='\n';if(b.callbacks.blockcode)b.callbacks.blockcode(a,f,null,b.context);b.blockStack.pop();return e}function parse_listitem(a,b,c,d){var e=c.length;var f=null,inter=null;var g=0,end,pre,sublist=0,orgpre=0,i;var h=0,has_inside_empty=0,in_fence=0;while(orgpre<3&&orgpre<e&&c[orgpre]==' ')orgpre++;g=prefix_uli(c);if(!g)g=prefix_oli(c);if(!g)return 0;end=g;while(end<e&&c[end-1]!='\n')end++;b.spanStack.push(f=new Buffer());b.spanStack.push(inter=new Buffer());f.s+=c.slice(g,end);g=end;while(g<e){var j,has_next_oli;end++;while(end<e&&c[end-1]!='\n')end++;if(is_empty(c.slice(g,end))){h=1;g=end;continue}i=0;while(i<4&&g+i<end&&c[g+i]==' ')i++;pre=i;if(b.flags&Y){if(is_codefence(c.slice(g+i,end),null)!=0){in_fence=!in_fence}}if(!in_fence){j=prefix_uli(c.slice(g+i,end));has_next_oli=prefix_oli(c.slice(g+i,end))}if(h&&(((d.p&B)&&j)||(!(d.p&B)&&has_next_oli))){d.p|=D;break}if((j&&!is_hrule(c.slice(g+i,end)))||has_next_oli){if(h)has_inside_empty=1;if(pre==orgpre)break;if(!sublist)sublist=f.s.length}else if(h&&pre==0){d.p|=D;break}else if(h){f.s+='\n';has_inside_empty=1}h=0;f.s+=c.slice(g+i,end);g=end}if(has_inside_empty)d.p|=C;if(d.p&C){if(sublist&&sublist<f.s.length){parse_block(inter,b,f.s.slice(0,sublist));parse_block(inter,b,f.s.slice(sublist))}else parse_block(inter,b,f.s)}else{if(sublist&&sublist<f.s.length){parse_inline(inter,b,f.s.slice(0,sublist));parse_block(inter,b,f.s.slice(sublist))}else parse_inline(inter,b,f.s)}if(b.callbacks.listitem)b.callbacks.listitem(a,inter,d.p,b.context);b.spanStack.pop();b.spanStack.pop();return g}function parse_list(a,b,c,d){var e=c.length;var i=0,j;var f=null;b.blockStack.push(f=new Buffer());while(i<e){var g={p:d};j=parse_listitem(f,b,c.slice(i),g);d=g.p;i+=j;if(!j||(d&D))break}if(b.callbacks.list)b.callbacks.list(a,f,d,b.context);b.blockStack.pop();return i}function parse_table_row(a,b,c,d,e){var i=0,col;var f=null;if(!b.callbacks.table_cell||!b.callbacks.table_row)return;b.spanStack.push(f=new Buffer());if(i<c.length&&c[i]=='|')i++;for(col=0;col<d.length&&i<c.length;++col){var g,cell_end;var h;b.spanStack.push(h=new Buffer());while(i<c.length&&_isspace(c[i]))i++;g=i;while(i<c.length&&c[i]!='|')i++;cell_end=i-1;while(cell_end>g&&_isspace(c[cell_end]))cell_end--;parse_inline(h,b,c.slice(g,1+cell_end));b.callbacks.table_cell(f,h,d[col]|e,b.context);b.spanStack.pop();i++}for(;col<d.length;++col){var j=null;b.callbacks.table_cell(f,j,d[col]|e,b.context)}b.callbacks.table_row(a,f,b.context);b.spanStack.pop()}function parse_table_header(a,b,c,d){var i=0,col,header_end,under_end;var e=0;while(i<c.length&&c[i]!='\n')if(c[i++]=='|')e++;if(i==c.length||e==0)return 0;header_end=i;while(header_end>0&&_isspace(c[header_end-1]))header_end--;if(c[0]=='|')e--;if(header_end&&c[header_end-1]=='|')e--;d.p=new Array(e+1);for(var k=0;k<d.p.length;k++)d.p[k]=0;i++;if(i<c.length&&c[i]=='|')i++;under_end=i;while(under_end<c.length&&c[under_end]!='\n')under_end++;for(col=0;col<d.p.length&&i<under_end;++col){var f=0;while(i<under_end&&c[i]==' ')i++;if(c[i]==':'){i++;d.p[col]|=bo;f++}while(i<under_end&&c[i]=='-'){i++;f++}if(i<under_end&&c[i]==':'){i++;d.p[col]|=bp;f++}while(i<under_end&&c[i]==' ')i++;if(i<under_end&&c[i]!='|')break;if(f<1)break;i++}if(col<d.p.length)return 0;parse_table_row(a,b,c.slice(0,header_end),d.p,bs);return under_end+1}function parse_table(a,b,c){var i;var d,body_work;var e={p:null};b.spanStack.push(d=new Buffer());b.blockStack.push(body_work=new Buffer());i=parse_table_header(d,b,c,e);if(i>0){while(i<c.length){var f;var g=0;f=i;while(i<c.length&&c[i]!='\n')if(c[i++]=='|')g++;if(g==0||i==c.length){i=f;break}parse_table_row(body_work,b,c.slice(f,i),e.p,0);i++}if(b.callbacks.table)b.callbacks.table(a,d,body_work,b.context)}b.spanStack.pop();b.blockStack.pop();return i}function parse_block(a,b,c){var d=0,end,i;var e;if(b.spanStack.length+b.blockStack.length>b.nestingLimit)return;while(d<c.length){e=c.slice(d);end=c.length-d;if(is_atxheader(b,e))d+=parse_atxheader(a,b,e);else if(c[d]=='<'&&b.callbacks.blockhtml&&(i=parse_htmlblock(a,b,e,1))!=0)d+=i;else if((i=is_empty(e))!=0)d+=i;else if(is_hrule(e)){if(b.callbacks.hrule)b.callbacks.hrule(a,b.context);while(d<c.length&&c[d]!='\n')d++;d++}else if((b.extensions&Y)!=0&&(i=parse_fencedcode(a,b,e))!=0)d+=i;else if((b.extensions&X)!=0&&(i=parse_table(a,b,e))!=0)d+=i;else if(prefix_quote(e))d+=parse_blockquote(a,b,e);else if(prefix_code(e))d+=parse_blockcode(a,b,e);else if(prefix_uli(e))d+=parse_list(a,b,e,0);else if(prefix_oli(e))d+=parse_list(a,b,e,B);else{d+=parse_paragraph(a,b,e)}}}function is_ref(a,b,c,d){var i=0;var e,idEnd;var f,linkEnd;var g,titleEnd;var h;if(b+3>=c)return 0;if(a[b]==' '){i=1;if(a[b+1]==' '){i=2;if(a[b+2]==' '){i=3;if(a[b+3]==' ')return 0}}}i+=b;if(a[i]!='[')return 0;i++;e=i;while(i<c&&a[i]!='\n'&&a[i]!='\r'&&a[i]!=']')i++;if(i>=c||a[i]!=']')return 0;idEnd=i;i++;if(i>=c||a[i]!=':')return 0;i++;while(i<c&&a[i]==' ')i++;if(i<c&&(a[i]=='\n'||a[i]=='\r')){i++;if(i<c&&a[i]=='\r'&&a[i-1]=='\n')i++}while(i<c&&a[i]==' ')i++;if(i>=c)return 0;if(a[i]=='<')i++;f=i;while(i<c&&a[i]!=' '&&a[i]!='\n'&&a[i]!='\r')i++;if(a[i-1]=='>')linkEnd=i-1;else linkEnd=i;while(i<c&&a[i]==' ')i++;if(i<c&&a[i]!='\n'&&a[i]!='\r'&&a[i]!='\''&&a[i]!='"'&&a[i]!='(')return 0;h=0;if(i>=c||a[i]=='\r'||a[i]=='\n')h=i;if(i+1<c&&a[i]=='\n'&&a[i+1]=='\r')h=i+1;if(h){i=h+1;while(i<c&&a[i]==' ')i++}g=titleEnd=0;if(i+1<c&&(a[i]=='\''||a[i]=='"'||a[i]=='(')){i++;g=i;while(i<c&&a[i]!='\n'&&a[i]!='\r')i++;if(i+1<c&&a[i]=='\n'&&a[i+1]=='\r')titleEnd=i+1;else titleEnd=i;i-=1;while(i>g&&a[i]==' ')i-=1;if(i>g&&(a[i]=='\''||a[i]=='"'||a[i]==')')){h=titleEnd;titleEnd=i}}if(!h||linkEnd==f)return 0;var j=a.slice(e,idEnd);var k=a.slice(f,linkEnd);var l=null;if(titleEnd>g)l=a.slice(g,titleEnd);d.refs[j]={id:j,link:new Buffer(k),title:new Buffer(l)};return h}function expand_tabs(a,b){var i=0,tab=0;while(i<b.length){var c=i;while(i<b.length&&b[i]!='\t'){i++;tab++}if(i>c)a.s+=b.slice(c,i);if(i>=b.length)break;do{a.s+=' ';tab++}while(tab%4);i++}}function render(a){var b=new Buffer();var c=0,end;this.refs={};while(c<a.length){if(end=is_ref(a,c,a.length,this))c=end;else{end=c;while(end<a.length&&a[end]!='\n'&&a[end]!='\r')end++;if(end>c)expand_tabs(b,a.slice(c,end));while(end<a.length&&(a[end]=='\n'||a[end]=='\r')){if(a[end]=='\n'||(end+1<a.length&&a[end+1]!='\n'))b.s+='\n';end++}c=end}}var d=new Buffer();if(this.callbacks.doc_header)this.callbacks.doc_header(d,this.context);if(b.s.length){if(b.s[b.s.length-1]!='\n'&&b.s[b.s.length-1]!='\r')b.s+='\n';parse_block(d,this,b.s)}if(this.callbacks.doc_footer)this.callbacks.doc_footer(d,this.context);return d.s}Markdown.prototype['render']=render;t.getParser=function getParser(a,b,c){var d=new Markdown();if(a)d.callbacks=a.callbacks;if(c)d.nestingLimit=c;if(a)d.context=context;if(b!=undefined&&b!=null)d.extensions=b;var e=d.callbacks;if(e.emphasis||e.double_emphasis||e.triple_emphasis){d.activeChars['*']=G;d.activeChars['_']=G;if(d.extensions&ba)d.activeChars['~']=G}if(e.codespan)d.activeChars['`']=H;if(e.linebreak)d.activeChars['\n']=I;if(e.image||e.link)d.activeChars['[']=J;d.activeChars['<']=K;d.activeChars['\\']=L;d.activeChars['&']=M;if(d.extensions&Z){d.activeChars[':']=N;d.activeChars['@']=O;d.activeChars['w']=P;d.activeChars['/']=Q}if(d.extensions&bc)d.activeChars['^']=R;return d}t.HTML_SKIP_HTML=be;t.HTML_SKIP_STYLE=bf;t.HTML_SKIP_IMAGES=bg;t.HTML_SKIP_LINKS=bh;t.HTML_EXPAND_TABS=bi;t.HTML_SAFELINK=bj;t.HTML_TOC=bk;t.HTML_HARD_WRAP=bl;t.HTML_USE_XHTML=bm;t.HTML_ESCAPE=bn;t.MKDEXT_NO_INTRA_EMPHASIS=W;t.MKDEXT_TABLES=X;t.MKDEXT_FENCED_CODE=Y;t.MKDEXT_AUTOLINK=Z;t.MKDEXT_STRIKETHROUGH=ba;t.MKDEXT_SPACE_HEADERS=bb;t.MKDEXT_SUPERSCRIPT=bc;t.MKDEXT_LAX_SPACING=bd;t['SD_AUTOLINK_SHORT_DOMAINS']=S;t.MKDA_NOT_AUTOLINK=T;t.MKDA_NORMAL=U;t.MKDA_EMAIL=V})(typeof(exports)!='undefined'?exports:SnuOwnd);var RESVersion="4.1.3";var tokenizeCSS='ul.token-input-list-facebook { overflow: hidden; height: auto !important; height: 1%; width: 400px; border: 1px solid #96bfe8; cursor: text; font-size: 12px; font-family: Verdana; min-height: 1px; z-index: 1010; margin: 0; padding: 0; background-color: #fff; list-style-type: none; clear: left; }';tokenizeCSS+='ul.token-input-list-facebook li input { border: 0; width: 100px; padding: 3px 8px; background-color: white; margin: 2px 0; -webkit-appearance: caret; }';tokenizeCSS+='li.token-input-token-facebook { overflow: hidden;  height: auto !important;  height: 15px; margin: 3px; padding: 1px 3px; background-color: #eff2f7; color: #000; cursor: default; border: 1px solid #ccd5e4; font-size: 11px; border-radius: 5px; -moz-border-radius: 5px; -webkit-border-radius: 5px; float: left; white-space: nowrap; }';tokenizeCSS+='li.token-input-token-facebook p { display: inline; padding: 0; margin: 0;}';tokenizeCSS+='li.token-input-token-facebook span { color: #a6b3cf; margin-left: 5px; font-weight: bold; cursor: pointer;}';tokenizeCSS+='li.token-input-selected-token-facebook { background-color: #5670a6; border: 1px solid #3b5998; color: #fff;}';tokenizeCSS+='li.token-input-input-token-facebook { float: left; margin: 0; padding: 0; list-style-type: none;}';tokenizeCSS+='div.token-input-dropdown-facebook { position: absolute; width: 400px; background-color: #fff; overflow: hidden; border-left: 1px solid #ccc; border-right: 1px solid #ccc; border-bottom: 1px solid #ccc; cursor: default; font-size: 11px; font-family: Verdana; z-index: 1001; }';tokenizeCSS+='div.token-input-dropdown-facebook p { margin: 0; padding: 5px; font-weight: bold; color: #777;}';tokenizeCSS+='div.token-input-dropdown-facebook ul { margin: 0; padding: 0;}';tokenizeCSS+='div.token-input-dropdown-facebook ul li { background-color: #fff; padding: 3px; margin: 0; list-style-type: none;}';tokenizeCSS+='div.token-input-dropdown-facebook ul li.token-input-dropdown-item-facebook { background-color: #fff;}';tokenizeCSS+='div.token-input-dropdown-facebook ul li.token-input-dropdown-item2-facebook { background-color: #fff;}';tokenizeCSS+='div.token-input-dropdown-facebook ul li em { font-weight: bold; font-style: normal;}';tokenizeCSS+='div.token-input-dropdown-facebook ul li.token-input-selected-dropdown-item-facebook { background-color: #3b5998; color: #fff;}';var guidersCSS='.guider { background: #FFF; border: 1px solid #666; font-family: arial; position: absolute; outline: none; z-index: 100000005 !important; padding: 4px 12px; width: 500px; z-index: 100; -moz-box-shadow: 0 0px 8px #111; -webkit-box-shadow: 0 0px 8px #111; box-shadow: 0 0px 8px #111; -moz-border-radius: 4px; -webkit-border-radius: 4px; border-radius: 4px;}';guidersCSS+='.guider_buttons { height: 36px; position: relative; width: 100%; }';guidersCSS+='.guider_content { position: relative; }';guidersCSS+='.guider_description { margin-bottom: 10px; }';guidersCSS+='.guider_content h1 { color: #1054AA; float: left; font-size: 21px; }';guidersCSS+='.guider_close { float: right; padding: 10px 0 0; }';guidersCSS+='.x_button { background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAIAAAD9iXMrAAAACXBIWXMAAAsTAAALEwEAmpwYAAABe0lEQVQoFT2RT0/CQBDFd7tbqIULiAaMgK1ngSqFCyHwyaFANS1+BEDigRgIFORAQv/5lhI32eR1duY3b6Z0vvg+Ho+M0TAMGWPx5VBKCSH/OpPJ8OVyqaqKqqqcsSgKophKkpTUIBX6dDptNhuON13X7wq3F4RgkEQJnpCr1c9sNgOFhUHgebvpdNrpdNAiiiIwt1vPdd1er8c5D4IAvAjm8vl8LpebTCZ4SKXSu91+Mh7XajX1Jv17OMCs4PlBBCutVgvIwcBqGIZt269GvVqtwAalMUD8OiYhKGo2Tfv9w7Isw3jTNA3FOGiIHA6FLcByTIjn7dfrdaFwv1gsKuWSoigXntgAxxXGKYHx8WjUqL9gfMdxhta43+/LMpeYHITxled5h5FIquv6Exjw6rifw+Gw2+2ez2eMLOZF62w2a5pm+fEhaYRIu23O51+Kkkpyrn1lmRWLxcQrKmEG+vlZAwQaxRwXa0NUHHzE4i/7vh8TCSTEoEul0h9jNtRZlgw9UAAAAABJRU5ErkJggg==); cursor: pointer; height: 13px; width: 13px; }';guidersCSS+='.guider_content p { clear: both; color: #333; font-size: 13px; }';guidersCSS+='.guider_button { background: -moz-linear-gradient(top, #5CA9FF 0%, #3D79C3 100%); background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #5CA9FF), color-stop(100%, #3D79C3)); background-color: #4A95E0; border: solid 1px #4B5D7E; color: #FFF; cursor: pointer; display: inline-block; float: right; font-size: 75%; font-weight: bold; margin-left: 6px; min-width: 40px; padding: 3px 5px; text-align: center; text-decoration: none; -moz-border-radius: 2px; -webkit-border-radius: 2px; border-radius: 2px; }';guidersCSS+='#guider_overlay { background-color: #000; width: 100%; height: 100%; position: fixed; top: 0px; left: 0px; opacity: 0.5; filter: alpha(opacity=50); z-index: 1000; }';guidersCSS+='.guider_arrow { width: 42px; height: 42px; position: absolute; display: none; background-repeat: no-repeat; z-index: 100000006 !important; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAACoCAMAAAChZYy6AAABelBMVEX///8zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzN+fn4zMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzPe3t4zMzMzMzN2dnYzMzMzMzPV1dUzMzMzMzMzMzMzMzMzMzN8fHwzMzOEhIQzMzPa2tozMzMzMzNtbW0zMzNzc3MzMzMzMzPR0dFtbW1xcXHS0tIzMzMzMzNxcXHh4eEzMzMzMzPi4uIzMzMzMzMzMzMzMzMzMzMzMzOEhITPz8+MjIwzMzMzMzMzMzOHh4czMzMzMzPZ2dkzMzMzMzPPz88zMzPW1tYzMzMzMzPV1dVvb28zMzMzMzMzMzOBgYEzMzPY2NiBgYHh4eHd3d3Nzc3o6OikpKQzMzPe3t7R0dEzMzPZ2dna2tqHh4czMzMzMzP///+41NW+AAAAfXRSTlMAAAECBA0HCBUfDhYsYy4gPU07CyF4PFCLjnVhA3ZMYC1PuxSMOmJ0jSscivBOGbY+eepVDDZ3Hrk/vgbuKn+yNLUJKOmxs+pZU7TwMgXcEhcmHRNun+SzNw+HvnJe6Eok50vsZArrpHFSNbyJ137v7ufmkyXv6F/s6qFWWFA9DhkAAAWkSURBVHhe7djpU+LKHsfh3ARiQBE0ioIIKoSwCKiAiAguuG+Ay7jv+z4uozNq/vebDub8OImdpOq8O3W+L62nPkVZZTc24aEokiQMjWUnaBNlCEcicb+5zhAeSy/mLYwhPDebPHY2iJjWxcvrBb4jZggLwn4i0NnRZAAL4k4S7SJu1sOCtHNtDBRtYByLgepjoIDn290+PEYENoPFQAFPR90+b3PY4kcYQ+VNSpgLZ/wp2kPhqIxHFRioeq+jUf7Ny+VXVtkcRcoUs6OpW37vIF0pm3MUUMwep7bXks4Kc2YCit2Pi8ur64x1iQSK39199rCUM0SfnrMvJdoAfdjgk5uWLf0PsLAT2P3MFsusSYcuDLv6bTGuGLfS2r+sXhGetvU12pkU7SFlioE2EbbUW2tPiG/gjatVDYEC7EHQARBHfykhjv7sCSkgho4g2I2BQAHaZYijI0OhwWC3owsghv4eCmhBoH+0IWz5veAOxpwiNAPEHcUfXoB6B3zYzmCg/rXxzy8juOL0KRsZm1sWNLc8NxZhPQTFRtKz79p0fTYdYSmCmogvfhT+aMn9QnIxPkERJO0Pe91DWjTBH+f9NEmQJrPdGQz8xsuTQIfTYkZ/4VQd0xUb1MgmOmMNTB1FEHJ2BCfP2+UoytZ3dUNWHW2qRr+yjmAIkx34KwrZnu/pOIrSKIrNQrT5KwrZ1h79KMpa7Q5b6KdWVDc7L0eV2V9KOQPR2mwjZCHqlqPKrKtXGfXJUUW2TZmdlqPKbIsyOxmFqDp7ox+FrF4UssNAR91eiGpmX3FROds/XBMNQ1Sd7bO5FqryKOrjIKqZneK9YT+K4rOn1ezj7RuXgSgmu6MXhU8beBCEH9t7XCaFolrZ2O6GIFysHeQhisnauU/+6e4ymV5JeRDQyDLFbPL5/spZWYUoJpuKFzez2etKmYUoJktby5aXwwwDX9qwWQ/NbpVK1jOQeEuZlujckrGbhBSncP+NJCnKYwhSJnqCZQ3BOrM/HokYgow9vJgeMwDr7V1O78fsnCEYC7oL78va0CpCR3dwMDAkXu3GoHRZ68PQ0NeFpgEbHd221lAPgtJwsAWgPCxsQ/Bvlx4eunoU1xge9gqKqWEfgjcAgaphv2sYoJqSHjrF2EV4ClA5OFTiRS6GigsI4ClpYsvF7OduYAcgji5tWTaT/MYDACylSy/Z5ycAGjRXOsze3xmiS9bM9dXlxQ99SpjOmIozubY99ahLqZy5XEkf7PG3U0c6lKRy7OpKnvO+8dHRVxyVux465c+EOa/PHR2dxFI1np7EURmbaLPfEm6W8IwmJUiEGUtDc5PP3T4PGCgWDygoFnd0to8DBorHQHVx4hyoPj4BqoWdIg4k9oFq4lgHX1hfBqCJj5Ozc8YOeEseDniD14bxy8j4Ffcv3f/UI9HUP1ZR9OUpR6MvT7qUyp1ZS6UtlvaQGArSzGQOXyxlK03pUA9brlxns5vFeMpEfkfhJKBXK86r++dktoj+IZX3HfWkVtLJy7sn/pOzW00klqKoP3+wdiEIG7uxxnrIqilpSmW4vW3xQH4I2PpaUFZFIRr28lOCuJ3+NsgqKYqaM9zb7SOiC65TyKooRNGGIauiKGrhfNEjBFEWPq2KUjQT9rpHJQhZJZWjzb7oq0x7XTYHyqopijZAFGVbpayCQnQSKGQVFEWb3NNCzW6qWSWFqDqroBCtWY+craXVaPuMjCBrR9laWo3Oyway3ShbS6VohxyF/QpVszVUinaiqDrbJWa/KEQH1PRnTZaA6DgCGlkCE5U3Ego67GYpS2CikB2Us0Q16oQoLosoVYeiCQGzITlLyNFzHB0JBJ1SlpCiMRTFZ2NdjJglqtHACZ7+/sqix7/8MY+i+KwbPQCQ0pNisrCvRf8UPtCTYvWhcl3Q3Hv1odL48+f/AZYqoYKwlk9uAAAAAElFTkSuQmCC); }  ';guidersCSS+='.guider_arrow_right { display: block; background-position: 0px 0px; right: -42px; }';guidersCSS+='.guider_arrowdown { display: block; background-position: 0px -42px; bottom: -42px; }';guidersCSS+='.guider_arrow_up { display: block; background-position: 0px -126px; top: -42px; }';guidersCSS+='.guider_arrow_left { display: block; background-position: 0px -84px; left: -42px;}';var escapeLookups={"&":"&amp;",'"':"&quot","<":"&lt;",">":"&gt;"};function escapeHTML(a){return(a==null)?null:a.toString().replace(/[&"<>]/g,function(m){return escapeLookups[m]})};var MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver||null;function insertAfter(a,b){if((typeof(a)=='undefined')||(a==null)){console.log(arguments.callee.caller)}else if((typeof(a.parentNode)!='undefined')&&(typeof(a.nextSibling)!='undefined')){if(a.parentNode==null){console.log(arguments.callee.caller)}else{a.parentNode.insertBefore(b,a.nextSibling)}}};function createElementWithID(a,b,c){var d=document.createElement(a);if(b!=null){d.setAttribute('id',b)}if((typeof(c)!='undefined')&&(c!='')){d.setAttribute('class',c)}return d};if(typeof(navigator)=='undefined')navigator=window.navigator;if(typeof(Function.prototype.bind)=='undefined'){Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a||null,Array.prototype.slice.call(arguments))}}}var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var i=0;i<a.length;i++){var b=a[i].string;var c=a[i].prop;this.versionSearchString=a[i].versionSearch||a[i].identity;if(b){if(b.indexOf(a[i].subString)!=-1)return a[i].identity}else if(c)return a[i].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b==-1)return;return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();var safeJSON={parse:function(a,b,c){try{if(typeof(safari)!='undefined'){if(a.substring(0,2)=='s{'){a=a.substring(1,a.length)}}return JSON.parse(a)}catch(error){if(c)return{};if(b){var d='Error caught: JSON parse failure on the following data from "'+b+'": <textarea rows="5" cols="50">'+a+'</textarea><br>RES can delete this data to stop errors from happening, but you might want to copy/paste it to a text file so you can more easily re-enter any lost information.';alert(d,function(){localStorage.setItem(b+'.error',a);RESStorage.removeItem(b)})}else{alert('Error caught: JSON parse failure on the following data: '+a)}return{}}}}function keyArrayCompare(a,b){if(typeof(b)=='number'){b=[b,false,false,false]}else if(b.length==4){b.push(false)}if(a.length!=b.length)return false;for(var i=0;i<b.length;i++){if(a[i].compare){if(!a[i].compare(b[i]))return false}if(a[i]!==b[i])return false}return true}function operaUpdateCallback(a){RESUtils.compareVersion(a)}function operaForcedUpdateCallback(a){RESUtils.compareVersion(a,true)}function hasClass(a,b){if((typeof(a)=='undefined')||(a==null)){if(typeof(console)!='undefined'){console.log(arguments.callee.caller)}return false}return a.className.match(new RegExp('(\\s|^)'+b+'(\\s|$)'))}function addClass(a,b){if(a==null){console.log(arguments.callee.caller)}if(!hasClass(a,b))a.className+=" "+b}function removeClass(a,b){if(hasClass(a,b)){var c=new RegExp('(\\s|^)'+b+'(\\s|$)');a.className=a.className.replace(c,' ')}}xhrQueue={count:0,onloads:[]};if(typeof(self.on)=='function'){self.on('message',function(a){switch(a.name){case'GM_xmlhttpRequest':xhrQueue.onloads[a.XHRID](a.response);break;case'compareVersion':var b=false;if(typeof(a.message.forceUpdate)!='undefined')b=true;RESUtils.compareVersion(a.message,b);break;case'loadTweet':var c=a.response;var d=modules['styleTweaks'].tweetExpando;$(d).html('<form class="usertext"><div class="usertext-body"><div class="md"><div><img style="display: block;" src="'+escapeHTML(c.user.profile_image_url)+'"></div>'+escapeHTML(c.user.screen_name)+': '+escapeHTML(c.text)+'</div></div></form>');d.style.display='block';addClass(d,'twitterLoaded');break;case'getLocalStorage':if(typeof(a.message.importedFromForeground)=='undefined'){var e={requestType:'saveLocalStorage',data:localStorage}self.postMessage(e)}else{setUpRESStorage(a.message)}break;case'saveLocalStorage':setUpRESStorage(a.message);break;case'localStorage':RESStorage.setItem(a.itemName,a.itemValue,true);break;default:break}})}function safariMessageHandler(a){switch(a.name){case'GM_xmlhttpRequest':xhrQueue.onloads[a.message.XHRID](a.message);break;case'compareVersion':var b=false;if(typeof(a.message.forceUpdate)!='undefined')b=true;RESUtils.compareVersion(a.message,b);break;case'loadTweet':var c=a.message;var d=modules['styleTweaks'].tweetExpando;$(d).html('<form class="usertext"><div class="usertext-body"><div class="md"><div><img style="display: block;" src="'+escapeHTML(c.user.profile_image_url)+'"></div>'+escapeHTML(c.user.screen_name)+': '+escapeHTML(c.text)+'</div></div></form>');d.style.display='block';addClass(d,'twitterLoaded');break;case'getLocalStorage':if(typeof(a.message.importedFromForeground)=='undefined'){var e={requestType:'saveLocalStorage',data:localStorage}safari.self.tab.dispatchMessage('saveLocalStorage',e)}else{setUpRESStorage(a.message)}break;case'saveLocalStorage':setUpRESStorage(a.message);break;case'localStorage':RESStorage.setItem(a.message.itemName,a.message.itemValue,true);break;default:break}}function operaMessageHandler(b){var c=b.data;switch(c.msgType){case'GM_xmlhttpRequest':xhrQueue.onloads[c.XHRID](c.data);break;case'compareVersion':var d=false;if(typeof(c.data.forceUpdate)!='undefined')d=true;RESUtils.compareVersion(c.data,d);break;case'loadTweet':var e=c.data;var f=modules['styleTweaks'].tweetExpando;$(f).html('<form class="usertext"><div class="usertext-body"><div class="md"><div><img style="display: block;" src="'+escapeHTML(e.user.profile_image_url)+'"></div>'+escapeHTML(e.user.screen_name)+': '+escapeHTML(e.text)+'</div></div></form>');f.style.display='block';addClass(f,'twitterLoaded');break;case'getLocalStorage':if(typeof(c.data.importedFromForeground)=='undefined'){var g={requestType:'saveLocalStorage',data:localStorage}opera.extension.postMessage(JSON.stringify(g))}else{if(location.hostname.match('reddit')){setUpRESStorage(c.data)}}break;case'saveLocalStorage':setUpRESStorage(c.data);if(location.hostname.match('reddit')){}break;case'localStorage':if((typeof(RESStorage)!='undefined')&&(typeof(RESStorage.setItem)=='function')){RESStorage.setItem(c.itemName,c.itemValue,true)}else{function waitForRESStorage(a){if((typeof(RESStorage)!='undefined')&&(typeof(RESStorage.setItem)=='function')){RESStorage.setItem(a.itemName,a.itemValue,true)}else{setTimeout(function(){waitForRESStorage(a)},200)}}var h={itemName:c.itemName,itemValue:c.itemValue};waitForRESStorage(h)}break;default:break}}if(typeof(chrome)!='undefined'){chrome.extension.onMessage.addListener(function(a,b,c){switch(a.requestType){case'localStorage':RESStorage.setItem(a.itemName,a.itemValue,true);break;default:break}})}if(typeof(safari)!='undefined'){window.onunload=function(){};safari.self.addEventListener("message",safariMessageHandler,false)}if(typeof(opera)!='undefined'){sessionStorage=window.sessionStorage;localStorage=window.localStorage;location=window.location;XMLHttpRequest=window.XMLHttpRequest}if(typeof(unsafeWindow)!='undefined'){if((typeof(unsafeWindow.console)!='undefined')&&(typeof(self.on)!='function')){console=unsafeWindow.console}else if(typeof(console)=='undefined'){console={log:function(a){return false}}}}if((typeof GM_deleteValue=='undefined')||(typeof GM_addStyle=='undefined')){GM_addStyle=function(a){var b=document.createElement('style');b.textContent=a;var c=document.getElementsByTagName('head')[0];if(c){c.appendChild(b)}}GM_deleteValue=function(a){localStorage.removeItem(a)}GM_getValue=function(a,b){var c=localStorage.getItem(a);if(!c)return b;var d=c[0];c=c.substring(1);switch(d){case'b':return c=='true';case'n':return Number(c);default:return c}}GM_log=function(a){console.log(a)}GM_registerMenuCommand=function(a,b){}GM_setValue=function(a,b){b=(typeof b)[0]+b;localStorage.setItem(a,b)}if(BrowserDetect.browser=="Explorer"){GM_xmlhttpRequest=function(a){var b=(a.url.indexOf(location.hostname)==-1);if((typeof(a.onload)!='undefined')&&(b)){a.requestType='GM_xmlhttpRequest';var c=new XDomainRequest();c.onload=function(){a.onload(c)}c.onerror=function(){if(a.onerror){a.onerror(c)}}c.open(a.method,a.url);c.send(a.data);return c}else{var c=new XMLHttpRequest();c.onreadystatechange=function(){if(a.onreadystatechange){a.onreadystatechange(c)};if(c.readyState==4&&a.onload){a.onload(c)}}c.onerror=function(){if(a.onerror){a.onerror(c)}}try{c.open(a.method,a.url,true)}catch(e){if(a.onerror){a.onerror({readyState:4,responseHeaders:'',responseText:'',responseXML:'',status:403,statusText:'Forbidden'})};return}if(a.headers){for(var d in a.headers){c.setRequestHeader(d,a.headers[d])}}c.send(a.data);return c}}}if(typeof(chrome)!='undefined'){GM_xmlhttpRequest=function(b){var c=(b.url.indexOf(location.hostname)==-1);if((typeof(b.onload)!='undefined')&&(c)){b.requestType='GM_xmlhttpRequest';if(typeof(b.onload)!='undefined'){chrome.extension.sendMessage(b,function(a){b.onload(a)})}}else{var d=new XMLHttpRequest();d.onreadystatechange=function(){if(b.onreadystatechange){b.onreadystatechange(d)};if(d.readyState==4&&b.onload){b.onload(d)}}d.onerror=function(){if(b.onerror){b.onerror(d)}}try{d.open(b.method,b.url,true)}catch(e){if(b.onerror){b.onerror({readyState:4,responseHeaders:'',responseText:'',responseXML:'',status:403,statusText:'Forbidden'})};return}if(b.headers){for(var f in b.headers){d.setRequestHeader(f,b.headers[f])}}d.send(b.data);return d}}}else if(typeof(safari)!='undefined'){GM_xmlhttpRequest=function(a){a.requestType='GM_xmlhttpRequest';var b=(a.url.indexOf(location.hostname)==-1);if((typeof(a.onload)!='undefined')&&(b)){a.XHRID=xhrQueue.count;xhrQueue.onloads[xhrQueue.count]=a.onload;safari.self.tab.dispatchMessage("GM_xmlhttpRequest",a);xhrQueue.count++}else{var c=new XMLHttpRequest();c.onreadystatechange=function(){if(a.onreadystatechange){a.onreadystatechange(c)};if(c.readyState==4&&a.onload){a.onload(c)}}c.onerror=function(){if(a.onerror){a.onerror(c)}}try{c.open(a.method,a.url,true)}catch(e){if(a.onerror){a.onerror({readyState:4,responseHeaders:'',responseText:'',responseXML:'',status:403,statusText:'Forbidden'})};return}if(a.headers){for(var d in a.headers){c.setRequestHeader(d,a.headers[d])}}c.send(a.data);return c}}}else if(typeof(opera)!='undefined'){GM_xmlhttpRequest=function(a){a.requestType='GM_xmlhttpRequest';var b=(a.url.indexOf(location.hostname)==-1);if((typeof(a.onload)!='undefined')&&(b)){a.XHRID=xhrQueue.count;xhrQueue.onloads[xhrQueue.count]=a.onload;opera.extension.postMessage(JSON.stringify(a));xhrQueue.count++}else{var c=new XMLHttpRequest();c.onreadystatechange=function(){if(a.onreadystatechange){a.onreadystatechange(c)};if(c.readyState==4&&a.onload){a.onload(c)}}c.onerror=function(){if(a.onerror){a.onerror(c)}}try{c.open(a.method,a.url,true)}catch(e){if(a.onerror){a.onerror({readyState:4,responseHeaders:'',responseText:'',responseXML:'',status:403,statusText:'Forbidden'})};return}if(a.headers){for(var d in a.headers){c.setRequestHeader(d,a.headers[d])}}c.send(a.data);return c}}}else if(typeof(self.on)=='function'){GM_xmlhttpRequest=function(a){a.requestType='GM_xmlhttpRequest';if(typeof(a.onload)!='undefined'){a.XHRID=xhrQueue.count;xhrQueue.onloads[xhrQueue.count]=a.onload;self.postMessage(a);xhrQueue.count++}}}}else{var oldgmx=GM_xmlhttpRequest;GM_xmlhttpRequest=function(a){setTimeout(function(){oldgmx(a)},0)}}var modules={};var RESUtils={css:'',addCSS:function(a){this.css+=a},insertParam:function(a,b,c){var d='&';if(a.indexOf('?')==-1)d='?';return a+d+b+'='+c},isMatchURL:function(a){var b=location.href;var c=modules[a].exclude;var d=modules[a].include;if(typeof(c)!='undefined'){for(var i=0,len=c.length;i<len;i++){if(c[i].test(b)){return false}}}for(var i=0,len=d.length;i<len;i++){if(d[i].test(b)){return true}}return false},getOptionsFirstRun:[],getOptions:function(a){if(this.getOptionsFirstRun[a]){return modules[a].options}var b=RESStorage.getItem('RESoptions.'+a);var c=new Date();if((b)&&(b!='undefined')&&(b!=null)){var d=safeJSON.parse(b,'RESoptions.'+a);var e=modules[a].options;var f=false;for(var g in e){if(typeof(d[g])=='undefined'){f=true;d[g]=e[g]}else{e[g].value=d[g].value}}modules[a].options=e;if(f){RESStorage.setItem('RESoptions.'+a,JSON.stringify(modules[a].options))}}else{RESStorage.setItem('RESoptions.'+a,JSON.stringify(modules[a].options))}this.getOptionsFirstRun[a]=true;return modules[a].options},getUrlParams:function(){var a={},queryString=location.search.substring(1),re=/([^&=]+)=([^&]*)/g,m;while(m=re.exec(queryString)){a[decodeURIComponent(m[1])]=decodeURIComponent(m[2])}return a},setOption:function(a,b,c){if(b.match(/_[\d]+$/)){b=b.replace(/_[\d]+$/,'')}var d=this.getOptions(a);var e;if(c==""){e=''}else if((isNaN(c))||(typeof(c)=='boolean')||(typeof(c)=='object')){e=c}else if(c.indexOf('.')){e=parseFloat(c)}else{e=parseInt(c)}d[b].value=e;modules[a].options=d;RESStorage.setItem('RESoptions.'+a,JSON.stringify(modules[a].options));return true},click:function(a,b){var b=b||0;var c=document.createEvent('MouseEvents');c.initMouseEvent('click',true,true,window,0,1,1,1,1,false,false,false,false,b,null);a.dispatchEvent(c)},mousedown:function(a,b){var b=b||0;var c=document.createEvent('MouseEvents');c.initMouseEvent('mousedown',true,true,window,0,1,1,1,1,false,false,false,false,b,null);a.dispatchEvent(c)},loggedInUser:function(){if(typeof(this.loggedInUserCached)=='undefined'){var a=document.querySelector('#header-bottom-right > span.user > a');if((a!=null)&&(!hasClass(a,'login-required'))){this.loggedInUserCached=a.innerHTML}else{this.loggedInUserCached=null}}return this.loggedInUserCached},loggedInUserInfo:function(e){if(RESUtils.loggedInUser()==null)return false;RESUtils.loggedInUserInfoCallbacks.push(e);var f=RESStorage.getItem('RESUtils.userInfoCache.'+RESUtils.loggedInUser())||'{}';var g=safeJSON.parse(f);var h=(g!=null)?parseInt(g.lastCheck)||0:0;var i=new Date();if((i.getTime()-h)>300000){if(!RESUtils.loggedInUserInfoRunning){RESUtils.loggedInUserInfoRunning=true;GM_xmlhttpRequest({method:"GET",url:location.protocol+"//"+location.hostname+"/user/"+RESUtils.loggedInUser()+"/about.json?app=res",onload:function(a){var b=JSON.parse(a.responseText);var c={lastCheck:i.getTime(),userInfo:b}RESStorage.setItem('RESUtils.userInfoCache.'+RESUtils.loggedInUser(),JSON.stringify(c));while(RESUtils.loggedInUserInfoCallbacks.length){var d=RESUtils.loggedInUserInfoCallbacks.pop();d(c.userInfo)}RESUtils.loggedInUserInfoRunning=false}})}}else{while(RESUtils.loggedInUserInfoCallbacks.length){var j=RESUtils.loggedInUserInfoCallbacks.pop();j(g.userInfo)}}},loggedInUserInfoCallbacks:[],commentsRegex:/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]*comments\/[-\w\.\/]*/i,friendsCommentsRegex:/https?:\/\/([a-z]+).reddit.com\/r\/friends\/*comments\/?/i,inboxRegex:/https?:\/\/([a-z]+).reddit.com\/message\/[-\w\.\/]*/i,profileRegex:/https?:\/\/([a-z]+).reddit.com\/user\/[-\w\.#=]*\/?(comments)?\/?(\?([a-z]+=[a-zA-Z0-9_%]*&?)*)?$/i,submitRegex:/https?:\/\/([a-z]+).reddit.com\/([-\w\.\/]*\/)?submit\/?$/i,prefsRegex:/https?:\/\/([a-z]+).reddit.com\/prefs\/?/i,pageType:function(){if(typeof(this.pageTypeSaved)=='undefined'){var a='';var b=location.href.split('#')[0];if(RESUtils.profileRegex.test(b)){a='profile'}else if((RESUtils.commentsRegex.test(b))||(RESUtils.friendsCommentsRegex.test(b))){a='comments'}else if(RESUtils.inboxRegex.test(b)){a='inbox'}else if(RESUtils.submitRegex.test(b)){a='submit'}else if(RESUtils.prefsRegex.test(b)){a='prefs'}else{a='linklist'}this.pageTypeSaved=a}return this.pageTypeSaved},matchRE:/https?:\/\/(?:[a-z]+).reddit.com\/r\/([\w\.\+]+).*/i,matchDOM:/https?:\/\/(?:[a-z]+).reddit.com\/domain\/([\w\.\+]+).*/i,currentSubreddit:function(a){if(typeof(this.curSub)=='undefined'){var b=location.href.match(RESUtils.matchRE);if(b!=null){this.curSub=b[1];if(a)return(b[1].toLowerCase()==a.toLowerCase());return b[1]}else{if(a)return false;return null}}else{if(a)return(this.curSub.toLowerCase()==a.toLowerCase());return this.curSub}},currentDomain:function(a){if(typeof(this.curDom)=='undefined'){var b=location.href.match(RESUtils.matchDOM);if(b!=null){this.curDom=b[1];if(a)return(b[1].toLowerCase()==a.toLowerCase());return b[1]}else{if(a)return false;return null}}else{if(a)return(this.curDom.toLowerCase()==a.toLowerCase());return this.curDom}},currentUserProfile:function(){if(typeof(this.curUserProfile)=='undefined'){var a=location.href.match(/https?:\/\/(?:[a-z]+).reddit.com\/user\/([\w\.]+).*/i);if(a!=null){this.curUserProfile=a[1];return a[1]}else{return null}}else{return this.curUserProfile}},getXYpos:function(a){var b=0,leftValue=0;while(a){leftValue+=a.offsetLeft;b+=a.offsetTop;a=a.offsetParent}return{'x':leftValue,'y':b}},elementInViewport:function(a){var b=this.getHeaderOffset();var c=a.offsetTop-b;var d=a.offsetLeft;var e=a.offsetWidth;var f=a.offsetHeight;while(a.offsetParent){a=a.offsetParent;c+=a.offsetTop;d+=a.offsetLeft}return(c>=window.pageYOffset&&d>=window.pageXOffset&&(c+f)<=(window.pageYOffset+window.innerHeight-b)&&(d+e)<=(window.pageXOffset+window.innerWidth))},setMouseXY:function(e){e=e||window.event;var a={x:0,y:0};if(e.pageX||e.pageY){a.x=e.pageX;a.y=e.pageY}else{a.x=e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft;a.y=e.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop}RESUtils.mouseX=a.x;RESUtils.mouseY=a.y},elementUnderMouse:function(a){var b=a.offsetTop;var c=a.offsetLeft;var d=a.offsetWidth;var e=a.offsetHeight;var f=c+d;var g=b+e;if((RESUtils.mouseX>=c)&&(RESUtils.mouseX<=f)&&(RESUtils.mouseY>=b)&&(RESUtils.mouseY<=g)){return true}else{return false}},scrollTo:function(x,y){var a=this.getHeaderOffset();window.scrollTo(x,y-a)},getHeaderOffset:function(){if(typeof(this.headerOffset)=='undefined'){this.headerOffset=0;switch(modules['betteReddit'].options.pinHeader.value){case'none':break;case'sub':this.theHeader=document.querySelector('#sr-header-area');break;case'subanduser':this.theHeader=document.querySelector('#sr-header-area');break;case'header':this.theHeader=document.querySelector('#header');break}if(this.theHeader){this.headerOffset=this.theHeader.offsetHeight+6}}return this.headerOffset},setSelectValue:function(a,b){for(var i=0,len=a.length;i<len;i++){if((a[i])&&(a[i].value==b)){a[i].selected=true}}},stripHTML:function(a){var b=/<\/?[^>]+>/gi;a=a.replace(b,"");return a},sanitizeHTML:function(f){var g=$.parseXML('<root>'+f+'</root>');$(g).find('root :not(h1,h2,h3,h4,h5,h6,span,div,code,br,hr,p,a,img,pre,blockquote,table,thead,tbody,tfoot,tr,th,td,strong,em,i,b,u,ul,ol,li,dl,dt,dd)').each(function(i,e,a){$(this).replaceWith($(this.childNodes))});$(g).find('root *').each(function(i,b){var c=$.map(this.attributes,function(a){return a.name});var d=this;var e=this.tagName;$.each(c,function(i,a){if(e=='a'&&a=='href')return;else if(e=='img'&&a=='src')return;else if(a=='title')return;else if(a='alt')return;else d.removeAttribute(a)})});var h=new XMLSerializer().serializeToString(g);return h.slice(6,-7)},fadeElementOut:function(a,b,c){if(a.getAttribute('isfading')=='in'){return false}a.setAttribute('isfading','out');b=b||0.1;if(a.style.opacity=='')a.style.opacity='1';if(a.style.opacity<=0){a.style.display='none';a.setAttribute('isfading',false);if(c)c();return true}else{var d=parseFloat(a.style.opacity)-b;if(d<b)d=0;a.style.opacity=d;setTimeout(function(){RESUtils.fadeElementOut(a,b,c)},100)}},fadeElementIn:function(a,b,c){c=c||1;if(a.getAttribute('isfading')=='out'){return false}a.setAttribute('isfading','in');b=b||0.1;if((a.style.display=='none')||(a.style.display=='')){a.style.opacity=0;a.style.display='block'}if(a.style.opacity>=c){a.setAttribute('isfading',false);a.style.opacity=c;return true}else{var d=parseFloat(a.style.opacity)+parseFloat(b);if(d>c)d=c;a.style.opacity=d;setTimeout(function(){RESUtils.fadeElementIn(a,b,c)},100)}},setNewNotification:function(){$('#RESSettingsButton, .gearIcon').addClass('newNotification').click(function(){location.href='/r/RESAnnouncements'})},firstRun:function(){if(RESStorage.getItem('RES.firstRun.'+RESVersion)==null){RESStorage.setItem('RES.firstRun.'+RESVersion,'true');RESUtils.openLinkInNewTab('http://redditenhancementsuite.com/whatsnew.html?v='+RESVersion,false)}},checkForUpdate:function(){if(RESUtils.currentSubreddit('RESAnnouncements')){RESStorage.removeItem('RES.newAnnouncement','true')}var c=new Date();var d=parseInt(RESStorage.getItem('RESLastUpdateCheck'))||0;if((c.getTime()-d)>86400000){var e=RESStorage.getItem('RES.lastAnnouncementID');$.getJSON('/r/RESAnnouncements/.json?limit=1&app=res',function(a){RESStorage.setItem('RESLastUpdateCheck',c.getTime());var b=a.data.children[0].data.id;if(b!=e){RESStorage.setItem('RES.newAnnouncement','true');RESUtils.setNewNotification()}RESStorage.setItem('RES.lastAnnouncementID',b)})}},proEnabled:function(){return((typeof(modules['RESPro'])!='undefined')&&(modules['RESPro'].isEnabled()))},niceKeyCode:function(a){var b='';var c,niceString;if(typeof(a)=='string'){var d=a.split(',');if(d.length){if(d[1]=='true')b+='alt-';if(d[2]=='true')b+='ctrl-';if(d[3]=='true')b+='shift-';if(d[4]=='true')b+='command-'}c=parseInt(a)}else if(typeof(a)=='object'){c=parseInt(a[0]);if(a[1])b+='alt-';if(a[2])b+='ctrl-';if(a[3])b+='shift-';if(a[4])b+='command-'}switch(c){case 8:niceString="backspace";break;case 9:niceString="tab";break;case 13:niceString="enter";break;case 16:niceString="shift";break;case 17:niceString="ctrl";break;case 18:niceString="alt";break;case 19:niceString="pause/break";break;case 20:niceString="caps lock";break;case 27:niceString="escape";break;case 33:niceString="page up";break;case 34:niceString="page down";break;case 35:niceString="end";break;case 36:niceString="home";break;case 37:niceString="left arrow";break;case 38:niceString="up arrow";break;case 39:niceString="right arrow";break;case 40:niceString="down arrow";break;case 45:niceString="insert";break;case 46:niceString="delete";break;case 91:niceString="left window";break;case 92:niceString="right window";break;case 93:niceString="select key";break;case 96:niceString="numpad 0";break;case 97:niceString="numpad 1";break;case 98:niceString="numpad 2";break;case 99:niceString="numpad 3";break;case 100:niceString="numpad 4";break;case 101:niceString="numpad 5";break;case 102:niceString="numpad 6";break;case 103:niceString="numpad 7";break;case 104:niceString="numpad 8";break;case 105:niceString="numpad 9";break;case 106:niceString="multiply";break;case 107:niceString="add";break;case 109:niceString="subtract";break;case 110:niceString="decimal point";break;case 111:niceString="divide";break;case 112:niceString="F1";break;case 113:niceString="F2";break;case 114:niceString="F3";break;case 115:niceString="F4";break;case 116:niceString="F5";break;case 117:niceString="F6";break;case 118:niceString="F7";break;case 119:niceString="F8";break;case 120:niceString="F9";break;case 121:niceString="F10";break;case 122:niceString="F11";break;case 123:niceString="F12";break;case 144:niceString="num lock";break;case 145:niceString="scroll lock";break;case 186:niceString=";";break;case 187:niceString="=";break;case 188:niceString=",";break;case 189:niceString="-";break;case 190:niceString=".";break;case 191:niceString="/";break;case 192:niceString="`";break;case 219:niceString="[";break;case 220:niceString="\\";break;case 221:niceString="]";break;case 222:niceString="'";break;default:niceString=String.fromCharCode(c);break}return b+niceString},niceDate:function(d,a){d=d||new Date();var b=d.getFullYear();var c=(d.getMonth()+1);c=(c<10)?'0'+c:c;var e=d.getDate();e=(e<10)?'0'+e:e;var f=b+'-'+c+'-'+e;if(a){f=c+'-'+e+'-'+b}return f},niceDateTime:function(d,a){d=d||new Date();var b=RESUtils.niceDate(d);var c=d.getHours();c=(c<10)?'0'+c:c;var e=d.getMinutes();e=(e<10)?'0'+e:e;var f=d.getSeconds();f=(f<10)?'0'+f:f;var g=b+' '+c+':'+e+':'+f;return g},niceDateDiff:function(a,b){var c=a.getUTCMonth()+1;var e=a.getUTCDate();var g=a.getUTCFullYear();if(b==null)b=new Date();var h;var i;var j;var k=b.getUTCFullYear();var l=b.getUTCMonth()+1;var n=b.getUTCDate();var y=1;var o=1;var d=1;var p=0;var q=0;var f=28;if((k/4)-parseInt(k/4)==0){f=29}var m=[31,f,31,30,31,30,31,31,30,31,30,31];h=k-(g);i=l-c;if(i<0){i=i+12;h--}j=n-e;if(j<0){if(i>0){var r=c+l;if(r>=12){r=r-12}if(r<0){r=r+12}j=j+m[r];i--;if(i<0){h--;i=i+12}}else{j=0}}var s='';if(h==0){y=0}if(i==0){o=0}if(j==0){d=0}if((y==1)&&(o==1)){q=1}if((y==1)&&(d==1)){q=1}if((o==1)&&(d==1)){p=1}if(y==1){if(h==1){s+=h+" year"}else{s+=h+" years"}}if((q==1)&&(p==0)){s+=" and "}if((q==1)&&(p==1)){s+=", "}if(o==1){if(i==1){s+=i+" month"}else{s+=i+" months"}}if(p==1){s+=" and "}if(d==1){if(j==1){s+=j+" day"}else{s+=j+" days"}}if(s==''){s='0 days'}return s},checkIfSubmitting:function(){this.checkedIfSubmitting=true;if((location.href.match(/\/r\/[\w]+\/submit\/?/i))||(location.href.match(/reddit.com\/submit\/?/i))){var f=document.getElementById('sr-autocomplete');if(f){var g=f.value;var h=document.querySelector('textarea[name=title]');if(typeof(this.thisSubRedditInputListener)=='undefined'){this.thisSubRedditInputListener=true;f.addEventListener('change',function(e){RESUtils.checkIfSubmitting()},false)}if((g.toLowerCase()=='enhancement')||(g.toLowerCase()=='resissues')){RESUtils.addCSS('#submittingToEnhancement { display: none; min-height: 300px; font-size: 14px; line-height: 15px; margin-top: 10px; width: 518px; position: absolute; z-index: 999; } #submittingToEnhancement ol { margin-left: 10px; margin-top: 15px; list-style-type: decimal; } #submittingToEnhancement li { margin-left: 25px; }');RESUtils.addCSS('.submittingToEnhancementButton { border: 1px solid #444444; border-radius: 2px; padding: 3px 6px; cursor: pointer; display: inline-block; margin-top: 12px; }');RESUtils.addCSS('#RESBugReport, #RESFeatureRequest { display: none; }');RESUtils.addCSS('#RESSubmitOptions .submittingToEnhancementButton { margin-top: 30px; }');var i=document.getElementById('text-desc');this.submittingToEnhancement=createElementWithID('div','submittingToEnhancement','RESDialogSmall');var j=" 					<h3>Submitting to r/Enhancement</h3> 					<div class=\"RESDialogContents\"> 						<div id=\"RESSubmitOptions\"> 							What kind of a post do you want to submit to r/Enhancement? So that we can better support you, please choose from the options below, and please take care to read the instructions, thanks!<br> 							<div id=\"RESSubmitBug\" class=\"submittingToEnhancementButton\">I want to submit a bug report</div><br> 							<div id=\"RESSubmitFeatureRequest\" class=\"submittingToEnhancementButton\">I want to submit a feature request</div><br> 							<div id=\"RESSubmitOther\" class=\"submittingToEnhancementButton\">I want to submit a general question or other item</div> 						</div> 						<div id=\"RESBugReport\"> 							Are you sure you want to submit a bug report? We get a lot of duplicates and it would really help if you took a moment to read the following: <br> 							<ol> 								<li>Have you searched /r/RESIssues to see if someone else has reported it?</li> 								<li>Have you checked the <a target=\"_blank\" href=\"http://redditenhancementsuite.com:8080/wiki/index.php?title=Category:FAQ\">RES FAQ?</a></li> 								<li>Are you sure it's a bug with RES specifically? Do you have any other userscripts/extensions running?  How about addons like BetterPrivacy, Ghostery, CCleaner, etc?</li> 							</ol> 							<br> 							Please also check out the latest known / popular bugs first:<br> 							<ul id=\"RESKnownBugs\"><li style=\"color: red;\">Loading...</li></ul> 							<span id=\"submittingBug\" class=\"submittingToEnhancementButton\">I still want to submit a bug!</span> 						</div> 						<div id=\"RESFeatureRequest\"> 							So you want to request a feature, great!  Please just consider the following, first:<br> 							<ol> 								<li>Have you searched /r/Enhancement to see if someone else has requested it?</li> 								<li>Is it something that would appeal to Reddit as a whole?  Personal or subreddit specific requests usually aren't added to RES.</li> 							</ol> 							<br> 							Please also check out the latest known popular feature requests first:<br> 							<ul id=\"RESKnownFeatureRequests\"><li style=\"color: red;\">Loading...</li></ul> 							<span id=\"submittingFeature\" class=\"submittingToEnhancementButton\">I still want to submit a feature request!<span> 						</div> 					</div>";$(this.submittingToEnhancement).html(j);insertAfter(i,this.submittingToEnhancement);setTimeout(function(){$('#RESSubmitBug').click(function(){$('#RESSubmitOptions').fadeOut(function(){$('#RESBugReport').fadeIn();GM_xmlhttpRequest({method:"GET",url:'http://redditenhancementsuite.com/knownbugs.json',onload:function(c){$('#RESKnownBugs').html('');var d=safeJSON.parse(c.responseText);$.each(d,function(a,b){$('#RESKnownBugs').append('<li><a target="_blank" href="'+b.url+'">'+b.description+'</a></li>')})}})})});$('#RESSubmitFeatureRequest').click(function(){$('#RESSubmitOptions').fadeOut(function(){$('#RESFeatureRequest').fadeIn();$.getJSON('http://redditenhancementsuite.com/knownfeaturerequests.json',function(c){$('#RESKnownFeatureRequests').html('');$.each(c,function(a,b){$('#RESKnownFeatureRequests').append('<li><a target="_blank" href="'+b.url+'">'+b.description+'</a></li>')})})})});$('#submittingBug').click(function(){$('#sr-autocomplete').val('RESIssues');$('li a.text-button').click();$('#submittingToEnhancement').fadeOut();var a;if(typeof(self.on)=='function'){a='Firefox'}else if(typeof(chrome)!='undefined'){a='Chrome'}else if(typeof(safari)!='undefined'){a='Safari'}else if(typeof(opera)!='undefined'){a='Opera'}else{a='Unknown'}var b="- RES Version: "+RESVersion+"\n";b+="- Browser: "+BrowserDetect.browser+"\n";if(typeof(navigator)=='undefined')navigator=window.navigator;b+="- Browser Version: "+BrowserDetect.version+"\n";b+="- Cookies Enabled: "+navigator.cookieEnabled+"\n";b+="- Platform: "+BrowserDetect.OS+"\n";b+="- Did you search /r/RESIssues before submitting this: No. That, or I didn't notice this text here and edit it!\n\n";$('.usertext-edit textarea').val(b);h.value='[bug] Please describe your bug here. If you have screenshots, please link them in the selftext.'});$('#submittingFeature').click(function(){$('#sr-autocomplete').val('Enhancement');$('#submittingToEnhancement').fadeOut();h.value='[feature request] Please summarize your feature request here, and elaborate in the selftext.'});$('#RESSubmitOther').click(function(){$('#sr-autocomplete').val('Enhancement');$('#submittingToEnhancement').fadeOut();h.value=''});$('#submittingToEnhancement').fadeIn()},1000)}else if(typeof(this.submittingToEnhancement)!='undefined'){this.submittingToEnhancement.parentNode.removeChild(this.submittingToEnhancement);if(h.value=='Submitting a bug? Please read the box above...'){h.value=''}}}}},urlencode:function(a){return escape(this._utf8_encode(a)).replace('+','%2B')},urldecode:function(a){return this._utf8_decode(unescape(a))},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");var b="";for(var n=0;n<a.length;n++){var c=a.charCodeAt(n);if(c<128){b+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){b+=String.fromCharCode((c>>6)|192);b+=String.fromCharCode((c&63)|128)}else{b+=String.fromCharCode((c>>12)|224);b+=String.fromCharCode(((c>>6)&63)|128);b+=String.fromCharCode((c&63)|128)}}return b},_utf8_decode:function(a){var b="";var i=0;var c=c1=c2=0;while(i<a.length){c=a.charCodeAt(i);if(c<128){b+=String.fromCharCode(c);i++}else if((c>191)&&(c<224)){c2=a.charCodeAt(i+1);b+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2}else{c2=a.charCodeAt(i+1);c3=a.charCodeAt(i+2);b+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3}}return b},isEmpty:function(a){for(var b in a){if(a.hasOwnProperty(b))return false}return true},openLinkInNewTab:function(a,b){if(typeof(chrome)!='undefined'){var c={requestType:'openLinkInNewTab',linkURL:a,button:b};chrome.extension.sendMessage(c)}else if(typeof(safari)!='undefined'){c={requestType:'openLinkInNewTab',linkURL:a,button:b}safari.self.tab.dispatchMessage("openLinkInNewTab",c)}else if(typeof(opera)!='undefined'){c={requestType:'openLinkInNewTab',linkURL:a,button:b}opera.extension.postMessage(JSON.stringify(c))}else if(typeof(self.on)=='function'){c={requestType:'openLinkInNewTab',linkURL:a,button:b}self.postMessage(c)}else{window.open(a)}},notification:function(b,c){var d;if(typeof(b.message)=='undefined'){if(typeof(b)=='string'){d=b}else{return false}}else{d=b.message}var f=(typeof(b.header)=='undefined')?'Notification:':b.header;if(typeof(this.notificationCount)=='undefined'){this.adFrame=document.body.querySelector('#ad-frame');if(this.adFrame){this.adFrame.style.display='none'}this.notificationCount=0;this.notificationTimers=[];this.RESNotifications=createElementWithID('div','RESNotifications');document.body.appendChild(this.RESNotifications)}var g=document.createElement('div');addClass(g,'RESNotification');g.setAttribute('id','RESNotification-'+this.notificationCount);$(g).html('<div class="RESNotificationHeader"><h3>'+f+'</h3><div class="RESNotificationClose RESCloseButton">&times;</div></div><div class="RESNotificationContent">'+d+'</div>');var h=g.querySelector('.RESNotificationClose');h.addEventListener('click',function(e){var a=e.target.parentNode.parentNode;RESUtils.closeNotification(a)},false);this.setCloseNotificationTimer(g,c);this.RESNotifications.style.display='block';this.RESNotifications.appendChild(g);RESUtils.fadeElementIn(g,0.2,1);this.notificationCount++},setCloseNotificationTimer:function(e,a){a=a||3000;var b=(typeof(e.currentTarget)!='undefined')?e.currentTarget:e;var c=b.getAttribute('id').split('-')[1];addClass(b,'timerOn');clearTimeout(RESUtils.notificationTimers[c]);var d=setTimeout(function(){RESUtils.closeNotification(b)},a);RESUtils.notificationTimers[c]=d;b.addEventListener('mouseover',RESUtils.cancelCloseNotificationTimer,false);b.removeEventListener('mouseout',RESUtils.setCloseNotification,false)},cancelCloseNotificationTimer:function(e){var a=e.currentTarget.getAttribute('id').split('-')[1];removeClass(e.currentTarget,'timerOn');clearTimeout(RESUtils.notificationTimers[a]);e.target.removeEventListener('mouseover',RESUtils.cancelCloseNotification,false);e.currentTarget.addEventListener('mouseout',RESUtils.setCloseNotificationTimer,false)},closeNotification:function(a){RESUtils.fadeElementOut(a,0.1,RESUtils.notificationClosed)},notificationClosed:function(a){var b=RESUtils.RESNotifications.querySelectorAll('.RESNotification');var c=0;for(var i=0,len=b.length;i<len;i++){if(b[i].style.opacity=='0'){b[i].parentNode.removeChild(b[i]);c++}}if(c==b.length){RESUtils.RESNotifications.style.display='none';if(RESUtils.adFrame)RESUtils.adFrame.style.display='block'}},toggleButton:function(c,d,f,g,h){d=d||false;var i=(d)?'CHECKED':'';f=f||'on';g=g||'off';var j=document.createElement('div');j.setAttribute('class','toggleButton');j.setAttribute('id',c+'Container');var k='';if(h){k=' tableOption="true"'}$(j).html('<span class="toggleOn">'+f+'</span><span class="toggleOff">'+g+'</span><input id="'+c+'" type="checkbox" '+k+i+'>');j.addEventListener('click',function(e){var a=this.querySelector('input[type=checkbox]');var b=a.checked;a.checked=!b;(!b)?addClass(this,'enabled'):removeClass(this,'enabled')},false);if(d)addClass(j,'enabled');return j},addCommas:function(a){a+='';var x=a.split('.');var b=x[0];var c=x.length>1?'.'+x[1]:'';var d=/(\d+)(\d{3})/;while(d.test(b)){b=b.replace(d,'$1'+','+'$2')}return b+c},xhrCache:function(a){var b={requestType:'XHRCache',operation:a};if(typeof(chrome)!='undefined'){chrome.extension.sendMessage(b)}else if(typeof(safari)!='undefined'){safari.self.tab.dispatchMessage('XHRCache',b)}else if(typeof(opera)!='undefined'){opera.extension.postMessage(JSON.stringify(b))}else if(typeof(self.on)=='function'){self.postMessage(b)}},initObservers:function(){if(RESUtils.pageType()=='comments'){var d=document.querySelector('.commentarea > div.sitetable');if(MutationObserver&&d){var e=new MutationObserver(function(c){c.forEach(function(b){if($(b.addedNodes[0]).hasClass('comment')){RESUtils.watchers.newComments.forEach(function(a){if(a)a(b.addedNodes[0])})}})});e.observe(d,{attributes:false,childList:true,characterData:false})}else{if(d){d.addEventListener('DOMNodeInserted',function(b){if((b.target.tagName=='DIV')&&(b.target.getAttribute('id')&&b.target.getAttribute('id').indexOf('siteTable')!=-1)){RESUtils.watchers.newComments.forEach(function(a){if(a)a(b.target)})}},true)}}}else{var d=document.querySelector('#siteTable');if(MutationObserver&&d){var e=new MutationObserver(function(c){c.forEach(function(b){if(b.addedNodes[0].id.indexOf('siteTable')!=-1){$(b.addedNodes[0]).find('.entry div.expando').each(function(){RESUtils.addSelfTextObserver(this)});RESUtils.watchers.siteTable.forEach(function(a){if(a)a(b.addedNodes[0])})}})});e.observe(d,{attributes:false,childList:true,characterData:false})}else{if(d){d.addEventListener('DOMNodeInserted',function(b){if((b.target.tagName=='DIV')&&(b.target.getAttribute('id')&&b.target.getAttribute('id').indexOf('siteTable')!=-1)){RESUtils.watchers.siteTable.forEach(function(a){if(a)a(b.target)})}},true)}}}$('.entry div.expando').each(function(){RESUtils.addSelfTextObserver(this)});$('.morecomments a').click(RESUtils.addNewCommentObserverToTarget);$('.thing .child').each(function(){RESUtils.addNewCommentFormObserver(this)})},addNewCommentObserverToTarget:function(e){var a=$(e.currentTarget).closest('.sitetable')[0];if(!$(a).hasClass('hasObserver')){$(a).addClass('hasObserver');RESUtils.addNewCommentObserver(a)}},addNewCommentObserver:function(c){var d=c;if(MutationObserver){var e=new MutationObserver(function(b){RESUtils.watchers.newComments.forEach(function(a){$(b[0].target).find('.thing .child').each(function(){RESUtils.addNewCommentFormObserver(this)});$(b[0].target).find('.morecomments a').click(RESUtils.addNewCommentObserverToTarget);a(b[0].target)});e.disconnect()});e.observe(d,{attributes:false,childList:true,characterData:false})}else{d.addEventListener('DOMNodeInserted',function(b){if((b.target.tagName=='DIV')&&(hasClass(b.target,'thing'))){RESUtils.watchers.newComments.forEach(function(a){if(a)a(b.target)})}},true)}},addNewCommentFormObserver:function(e){var f=e;if(MutationObserver){var g=new MutationObserver(function(b){var c=$(b[0].target).children('form');if((c)&&(c.length==1)){RESUtils.watchers.newCommentsForms.forEach(function(a){a(c[0])})}else{var d=$(b[0].target).children('div.sitetable');if((d)&&(d.length==1)){RESUtils.watchers.newComments.forEach(function(a){a(d[0])})}}});g.observe(f,{attributes:false,childList:true,characterData:false})}else{f.addEventListener('DOMNodeInserted',function(b){if(b.target.tagName=='FORM'){RESUtils.watchers.newCommentsForms.forEach(function(a){if(a)a(b.target)})}},true)}},addSelfTextObserver:function(d){var e=d;if(MutationObserver){var f=new MutationObserver(function(b){var c=$(b[0].target).find('form');if((c)&&(c.length>0)){RESUtils.watchers.selfText.forEach(function(a){a(c[0])})}});f.observe(e,{attributes:false,childList:true,characterData:false})}else{e.addEventListener('DOMNodeInserted',function(b){if(b.target.tagName=='FORM'){RESUtils.watchers.newCommentsForms.forEach(function(a){if(a)a(b.target)})}},true)}},watchForElement:function(a,b){switch(a){case'siteTable':RESUtils.watchers.siteTable.push(b);break;case'newComments':RESUtils.watchers.newComments.push(b);break;case'selfText':RESUtils.watchers.selfText.push(b);break;case'newCommentsForms':RESUtils.watchers.newCommentsForms.push(b);break}},watchers:{siteTable:[],newComments:[],selfText:[],newCommentsForms:[]},COMMENT_CODE_REGEX:/^\/\w+$/,isCommentCode:function(a){var b=a.innerHTML;var c=a.getAttribute("href");return!b&&this.COMMENT_CODE_REGEX.test(c)}}var gdAlert={container:false,overlay:"",init:function(a){var b='#alert_message { '+'display: none;'+'opacity: 0.0;'+'background-color: #EFEFEF;'+'border: 1px solid black;'+'color: black;'+'font-size: 10px;'+'padding: 20px;'+'padding-left: 60px;'+'padding-right: 60px;'+'position: fixed!important;'+'position: absolute;'+'width: 400px;'+'float: left;'+'z-index: 10000;'+'text-align: left;'+'left: auto;'+'top: auto;'+'}'+'#alert_message .button {'+'border: 1px solid black;'+'font-weight: bold;'+'font-size: 10px;'+'padding: 4px;'+'padding-left: 7px;'+'padding-right: 7px;'+'float: left;'+'background-color: #DFDFDF;'+'cursor: pointer;'+'}'+'#alert_message span {'+'display: block;'+'margin-bottom: 15px;	'+'}';GM_addStyle(b);gdAlert.populateContainer(a)},populateContainer:function(a){gdAlert.container=createElementWithID('div','alert_message');gdAlert.container.appendChild(document.createElement('span'));if(typeof(a)=='function'){this.okButton=document.createElement('input');this.okButton.setAttribute('type','button');this.okButton.setAttribute('value','confirm');this.okButton.addEventListener('click',a,false);this.okButton.addEventListener('click',gdAlert.close,false);var b=document.createElement('input');b.setAttribute('type','button');b.setAttribute('value','cancel');b.addEventListener('click',gdAlert.close,false);gdAlert.container.appendChild(this.okButton);gdAlert.container.appendChild(b)}else{var b=document.createElement('input');b.setAttribute('type','button');b.setAttribute('value','ok');b.addEventListener('click',gdAlert.close,false);gdAlert.container.appendChild(b)}var c=document.createElement('br');c.setAttribute('style','clear: both');gdAlert.container.appendChild(c);document.body.appendChild(gdAlert.container)},open:function(a,b){if(gdAlert.isOpen){console.log('there is already an alert open. break out.');return}gdAlert.isOpen=true;gdAlert.populateContainer(b);$(gdAlert.container.getElementsByTagName("SPAN")[0]).html(a);gdAlert.container.getElementsByTagName("INPUT")[0].focus();gdAlert.container.getElementsByTagName("INPUT")[0].focus();gdAlert.overlay=document.createElement("DIV");gdAlert.overlay.style.width=gdAlert.getPageSize()[0]+"px";gdAlert.overlay.style.height=gdAlert.getPageSize()[1]+"px";gdAlert.overlay.style.backgroundColor='#333333';gdAlert.overlay.style.top='0';gdAlert.overlay.style.left='0';gdAlert.overlay.style.position='absolute';gdAlert.overlay.style.zIndex='9999';document.body.appendChild(gdAlert.overlay);var c=[document.documentElement.scrollLeft,document.documentElement.scrollTop];var d=c[1]+(window.innerHeight);var e=c[0];gdAlert.container.style.top=((d/2)-90)+"px";gdAlert.container.style.left=((gdAlert.getPageSize()[0]/2)-155)+"px";RESUtils.fadeElementIn(gdAlert.container,0.3);RESUtils.fadeElementIn(gdAlert.overlay,0.3)},close:function(){gdAlert.isOpen=false;RESUtils.fadeElementOut(gdAlert.container,0.3);RESUtils.fadeElementOut(gdAlert.overlay,0.3)},getPageSize:function(){var a,yScroll;if(window.innerHeight&&window.scrollMaxY){a=window.innerWidth+window.scrollMaxX;yScroll=window.innerHeight+window.scrollMaxY}else if(document.body.scrollHeight>document.body.offsetHeight){a=document.body.scrollWidth;yScroll=document.body.scrollHeight}else{a=document.body.offsetWidth;yScroll=document.body.offsetHeight}var b,windowHeight;if(self.innerHeight){if(document.documentElement.clientWidth){b=document.documentElement.clientWidth}else{b=self.innerWidth}windowHeight=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){b=document.documentElement.clientWidth;windowHeight=document.documentElement.clientHeight}else if(document.body){b=document.body.clientWidth;windowHeight=document.body.clientHeight}if(yScroll<windowHeight){pageHeight=windowHeight}else{pageHeight=yScroll}if(a<b){pageWidth=a}else{pageWidth=b}return[pageWidth,pageHeight]}}var alert=function(a,b){if(gdAlert.container==false){gdAlert.init(b)}gdAlert.open(a,b)}function GMSVtoFFSS(){var a=unsafeWindow.console;for(var b in localStorage){RESStorage.setItem(b,localStorage[b])}localStorage.setItem('copyComplete','true');localStorage.removeItem('RES.lsTest');RESUtils.notification('Data transfer complete. You may now uninstall the Greasemonkey script')}RESUtils.addCSS(tokenizeCSS);RESUtils.addCSS(guidersCSS);var RESConsole={modalOverlay:'',RESConsoleContainer:'',RESConsolePanels:[],RESMenuItems:[],RESConfigPanelOptions:null,RESConsoleModulesPanel:createElementWithID('div','RESConsoleModulesPanel','RESPanel'),RESConsoleConfigPanel:createElementWithID('div','RESConsoleConfigPanel','RESPanel'),RESConsoleAboutPanel:createElementWithID('div','RESConsoleAboutPanel','RESPanel'),RESConsoleProPanel:createElementWithID('div','RESConsoleProPanel','RESPanel'),addConsoleLink:function(){this.userMenu=document.querySelector('#header-bottom-right');if(this.userMenu){var a=$("<span id='openRESPrefs'><span id='RESSettingsButton' title='RES Settings'></span>").mouseenter(RESConsole.showPrefsDropdown);$(this.userMenu).find("ul").after(a).after("<span class='separator'>|</span>");this.RESPrefsLink=a[0]}},addConsoleDropdown:function(){this.gearOverlay=createElementWithID('div','RESMainGearOverlay');this.gearOverlay.setAttribute('class','RESGearOverlay');$(this.gearOverlay).html('<div class="gearIcon"></div>');this.prefsDropdown=createElementWithID('div','RESPrefsDropdown','RESDropdownList');$(this.prefsDropdown).html('<ul id="RESDropdownOptions"><li id="SettingsConsole">settings console</li></ul>');var a=this.prefsDropdown.querySelector('#SettingsConsole');a.addEventListener('click',function(){RESConsole.hidePrefsDropdown();RESConsole.open()},true);$(this.prefsDropdown).mouseleave(function(){RESConsole.hidePrefsDropdown()});$(this.prefsDropdown).mouseenter(function(){clearTimeout(RESConsole.prefsTimer)});$(this.gearOverlay).mouseleave(function(){RESConsole.prefsTimer=setTimeout(function(){RESConsole.hidePrefsDropdown()},1000)});document.body.appendChild(this.gearOverlay);document.body.appendChild(this.prefsDropdown);if(RESStorage.getItem('RES.newAnnouncement','true')){RESUtils.setNewNotification()}},showPrefsDropdown:function(e){var a=parseInt($(RESConsole.userMenu).offset().top+1);var b=parseInt($(RESConsole.RESPrefsLink).offset().left-6);$('#RESMainGearOverlay').css('height',$('#header-bottom-right').outerHeight()+'px');$('#RESMainGearOverlay').css('left',b+'px');$('#RESMainGearOverlay').css('top',a+'px');RESConsole.prefsDropdown.style.top=parseInt(a+$(RESConsole.userMenu).outerHeight())+'px';RESConsole.prefsDropdown.style.right='0px';RESConsole.prefsDropdown.style.display='block';$('#RESMainGearOverlay').show()},hidePrefsDropdown:function(e){removeClass(RESConsole.RESPrefsLink,'open');$('#RESMainGearOverlay').hide();RESConsole.prefsDropdown.style.display='none'},resetModulePrefs:function(){prefs={'userTagger':true,'betteReddit':true,'singleClick':true,'subRedditTagger':true,'uppersAndDowners':true,'keyboardNav':true,'commentPreview':true,'showImages':true,'showKarma':true,'usernameHider':false,'accountSwitcher':true,'styleTweaks':true,'filteReddit':true,'spamButton':false,'RESPro':false};this.setModulePrefs(prefs);return prefs},getAllModulePrefs:function(a){if((!a)&&(typeof(this.getAllModulePrefsCached)!='undefined'))return this.getAllModulePrefsCached;if(RESStorage.getItem('RES.modulePrefs')!=null){var b=safeJSON.parse(RESStorage.getItem('RES.modulePrefs'),'RES.modulePrefs')}else if(RESStorage.getItem('modulePrefs')!=null){var b=safeJSON.parse(RESStorage.getItem('modulePrefs'),'modulePrefs');RESStorage.removeItem('modulePrefs');this.setModulePrefs(b)}else{b=this.resetModulePrefs()}if(b==null){b={}}var c={};for(var i in modules){if(b[i]){c[i]=b[i]}else if((b[i]==null)||(i=='dashboard')){c[i]=true}else{c[i]=false}}if((typeof(c)!='undefined')&&(c!='undefined')&&(c)){this.getAllModulePrefsCached=c;return c}},getModulePrefs:function(a){if(a){var b=this.getAllModulePrefs();return b[a]}else{alert('no module name specified for getModulePrefs')}},setModulePrefs:function(a){if(a!=null){RESStorage.setItem('RES.modulePrefs',JSON.stringify(a));return a}else{alert('error - no prefs specified')}},create:function(){this.RESConsoleContainer=createElementWithID('div','RESConsole');this.modalOverlay=createElementWithID('div','modalOverlay');this.modalOverlay.addEventListener('click',function(e){e.preventDefault();return false},true);document.body.appendChild(this.modalOverlay);var a=createElementWithID('div','RESConsoleHeader');var b=createElementWithID('div','RESConsoleTopBar');this.logo='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAeCAMAAABHRo19AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACxFBMVEXw8/wAAAD+//8EBAQSEhIPDw/w8/v+/v4JCQkHBwcCAgKSk5W8vLz9SADz8/MtLS0iIiIcHBz/VAAYGBmRkZFkZGUkJCQVFhZiYmOZmp2QkpfQ09r9/f3n6vA5OTkvLy//TAAxMTEUFRTl5eVqa2zu8fnt7/fV19ydnqCen6Lt8Pj/TwDk5ORaWlrg4ug1NTUpKSrX19cgICDp6/J6enrFxcW1trpDQ0M7OzwnJyenp6f6TQAXFxj/WACFhojr6+uNjpBHR0cfHx+vr7GSkpJMTEwYGBg+Pj5cXF3CwsJISEj29vYQEBDe3t7+SwBmZmixsbH19fXo6OhQUFAgICJgYWXHyM3q7PTs7vW3uLvb3eKqq650dXbS09js7/aTlJY5OjmUlJeenp7r7vWWl5n8/Px4eHihoqWEhYfO0NTj5euDg4Pa3OGRkpTJy8/g4ODe4Obc3Nzv8vqjo6O1tbW3uLyrq6t1dXX5ya5/f3/5xqxZWVqKiopra2v4uJb99vLCw8fFxsouLS6Oj5Hs7OzY2t+jpKZ4eXv2tY8NDQ35WQny8vJkZGT2lWGQkJB8fHzi5OrLzNFAQUPm6O/3f0W7u7v3oXP4dTb2nXH62MX3pHb87+bn5+dWV1dvb3E0NDT4lWP3jFP4vJn2cS79+vaJioxNTU376d72f0H4Wwf2fT7759z9+fX1lmH4XAv2bSb40bheX2A6Ojr9+vj76t/9+vf76+H5XxVGRkZxcnPQ0te+vr52dnaztLfExMT2tZFYWFhSUlLV1dVwcXL52MS4uLiysrKam5rW1tZPT1CVlZWYmJiUlJRHR0ipqq0qKiqzs7P39/fq6urj4+P89fH09PT6+vo4ODjq7PNsbW4oKCh0dHTv7++3t7fk5u2IiYtFRUU3NzdPT0/Kysru7u6NjY1tbW1gYGBfX19sbGyHh4fh4eEzPXfuAAACPElEQVR4Xq3SQ9fkQBTH4bpVSdru17Zt28bYtm3btm3btm37S8yk0oteTKc7c+a3uf/Nc3JyEvT/48KF69Uhu7dk3AfaZ48PRiHgUwLdpGLdtFbecrkPOxvjuSRcmp2vaIsQt6gdLME4UtlGGs6NFW7+GIw7Qidp2BAq3KaQWg650mwC9LSs6JpRfZG03PTo32reMrmzIW3IlGaSZY/W+aCcoY/xq1SCKXAC5xAaGObkFoSmZoK3uaxqlgzL6vol3UohjIpDLWq6J4jaaNZUnsb4syMCsHU5o10q4015sZAshp2LuuCu4DSZFzJrrh0GURj3Ai8BNHrQ08TdyvZXDsDzYBD+W4OJK5bFh9nGIaRuKKTTxw5fOtJTUCtWjh3H31NQiCdOso2DiVlXSsXGDN+M6XRdnlmtmUNXYrGaLPhD3IFvoQfQrH4KkMdRsjgiK2IZXcurs4zHVvFrdSasQTaeTFu7DtPWa4yaDXSd0xh9N22mMyUVieItWwW8bfuOnbvo2r1n7779mOZ6QByHHsRChw4fsXwsz6OPsdDxE0i0kyQA20rLFIhjzuW0TVxIgpB4Z+AsBRXn1RZTdeEivXFyFbLXJTaJvmkDNJgLrly95iR3juTt9eIbyH6ucJPq2hJGQQiru63lbbriDocc6C7cu1/BgwcPH9U/4cdT9TNQIcd6/oK8fFWbg4Vev0n0I6VvkcO9A38Fq495X5T3wZkhLvAROZ6KYT59Lvvy9VvU9x8/1fW/DEygHfEbNdeCkgdk4HMAAAAASUVORK5CYII=';this.loader='data:image/gif;base64,R0lGODlhHQAWANUAAESatESetEyetEyitEyivFSivFSmvFymvFyqvGSqvGSqxGSuxGyuxGyyxHSyxHS2xHS2zHy2zHy6zIS6zIS+zIy+zIzCzIzC1JTG1JzK1JzK3JzO3KTO3KTS3KzS3KzW3LTW3LTW5LTa5Lza5Lze5MTe5MTi5MTi7Mzi7Mzm7NTm7NTq7Nzq7Nzq9Nzu9OTu9OTy9Ozy9Oz29Oz2/PT2/PT6/Pz6/Pz+/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/h1CdWlsdCB3aXRoIEdJRiBNb3ZpZSBHZWFyIDQuMAAh+QQIBgAAACwAAAAAHQAWAAAG/sCbcEgs3myyEIzjQr2MUGjrgpFMrJIMhxTtei4SbPhKwXCeXaLren00GIuHlSLxzNJDD4NOWST8CwsUgxEjeEIcDYN0ICkjFA4UFYMcRXckIS8XKysTCJKSGCMkHBUXpwwXRC8UGheLpgsMDBKmF6YWF7kODYY3LmawoKcXCxIKFMSnkBIELDczIxODk2SmpoMFbg8XDg4SAAoTNTUY1BcTDQsKCw2nGGAMBAUJDQcCDZ8yNzESya8NFDCAEFAChoO6GGSowEDDggsq0HhIZisVixkwQFDBkIHCARQ1XICosSIGEYe5MFjAsE8IigwcYWa402VEyoNmRozgkEFDbs8MBRS0jJJCwAOcMn1u4MBTA4UHNdLIgIAOg08NGphqZWAggohDHBIEqMCRqZYMEjZMMPBgaJcYcDAcQMBhwgMOGOg9AOHrUIkQ8hJQQKDgQaQFEQ4ZuRABxSwREtqWcKHYiIwaWm6UGBG18o0gACH5BAgGAAAALAAAAAAdABYAAAb+wJtwSCwKXabWBjaS2YxQowqDkUysEg4GFe1+LtgrVkKddYsvCRbSYCwcEgpl4jGfhR3GnLJILP4JchQQJXdCHhCCEiApIxUNFZESGkUzNCsaMBwjMRQFE3IVGCMkHBYXFBcQGEM1NhRUexWqCRAQsxcWuBcXEQgkQjEXGYIUFanIDxENEry5F48SByo3MCWCx1fGzlcHCxKQEggUAgYWrqjGcg0LCguQuVUNBwUJbgIKDBFmMKi4DfnYKCBDhUqDCRgWYFDmAoYQDs2cMcCwYkaMEBYKUjiAAsaMDzFgxCDiocEpDBcwjBSSIkMGDRkwWHDYJUSqghg2jBjB4eVzSwwKINA4Y0JAhIIuYcLkoKFnAwc1zsyYYCFC0pccsmZNcNCDoQ4FCmAQ1TPr2A4JClCIeufFggcUAkDg8ECCBwkF4F4YYYhlCAQFHEwwwECCAwcINDzpK2QGBQ4gFEwAsSDDDA4vGBOxUaMfFw5cNN8IAgAh+QQIBgAAACwAAAAAHQAWAAAG/sCbcEgsClcqlAc2qtWMUCOKc5FYrZyK6xmFhizWiURMxmBm3SIMMp48GoyFQ0Kpc9BpIcchpiz+gHUUESd5Qh4QghIhKCMUDhQVFBIYRTMvMxgtIxw1GAJ0khkiJRwUF6gRGUNOGRUYghQYEQgSEBcWFBa7uGAEIUI1p7GSFRUXg3MRqKgWFwoRCSs3LiPIkhRkyKgSDggFj3UHEwcEFk8ZoXUNCn8OqBjIDQj0Cg0CCA8PMTctsMcX4jBwwI6SGQsZAnJYcKrBCn43ODxgFvBCixkwvpjJQIGBChU3RqioAVFIiAjOMFjAIGNICgwZNGTA4ABGmhATzZjhMIJTacyYNClwiVLCgKyNP2VyWIqhgIOhUGQkwyBT6VIOGRSA4WCIg4AGHDNgZYrBawEMUKO0aCCBAYALGRiUZVCLwoMRhoS80IDgQIQGBuY0SJDgRMm8MCiguJAgZgIUL23mlcLyBQbJk28EAQAh+QQIBgAAACwAAAAAHQAWAAAG/sCbcEgsClWwEElFstWMUGPpM5FUJxTMBUaLRkcUq2QsplwwXS8R5hBDGoxFm0LXyNRDj4OCXSQWgAl0FBEpeEIce3QSISlgDhUUFRAXRTQqNRwlKhgzGgUQgxkjJRxmFxcTHEMzLyRmgxQaFIIQFReRqBcWFxIDH0MYsZKSu2MMhLoWtwzNKjctHsJ0FWPFqBMLCAIXDxEXBw4MARhPHhKSkXCADbdnFA4KfggNBaASMDecxBcN8g7+JGAYiArEggwOHHRogOLODQ8NdF1YgKHFjCRnBlqQ0MKEjRRN8g0JcWoghhhDUmTIoCEDBQUio3hQYMEkhg0jRnBgyTMLcEovJhbUHLiypQYNOzlIABDhiZcYLx/wbMmh6k4IGbAe0jBgQi+kGapi4FABAAIOP9WsiCDBnksHHDAceEABAgMTh4TMqIBggYQDCCREWHBgAYxneYW0wPCiwQIQEh686FAusREQHmyE4FDDhuUbQQAAIfkECAYAAAAsAAAAAB0AFgAABv7Am3BILN5sqhlHVUrVaMaosSSSUCTYygUTm0mlKKxkIiZTKJrat/hqkCcPhrxhpVQw3rXwA6FMKAoLgoJnVyl6QhwMhRIfKCQUDhV2EBdFNSc0IhwvGiocCH12GSMlHBQXqRIcQzMoKhMWhRQZFwwSERd2uhcWvRQFHkMef4UVkxcVVgtXqRYYWg4HDSs3LRgYs2apvRMGCgJjDxcKoQIYNjcjEWe6DQyBDVpbFg8JDAsGDAcCDxQuN1DwSgVvwYMGCiRgyyYBxQILExR8iBBCzY0QDXz5YoChxQwYIZ5hyAANRokYLkQ8IfJhHoZnMYagyEBTA4QDMNZwMCAS23aGESM6ZNAwlGaFPGByLaRZMwMHDRwaBKCQ7osMCQUk1NQAlYPXlxoUaECE4QCGCKuccqDpwUEABh5eIFoRKUCCqBKIJbgg4V4LREJmPFAQ4UGBRQ0QIJjgggTgISpGmFDwwAODCy0mbHhshIaHQxdG3KhRFXAQACH5BAgGAAAALAAAAAAdABYAAAb+wJtwSCzeaiwYxwVyxWrGqBEVklAkksmFspxJpalHdoydZDu0b7HlME8ejAVDTKFULlC1MAShTCgLCguDC3V+J182QxmFdRIeKSMUDnYUEBhGJy4rGDAeJRwMlHYZI6B3FxcPHUM0ISwVlXUYGA0QWhRbFhe7FhUIHkI1JVaGsbEXERILf6mpuxEDDCs3LncWdRVYuc4WBgsCDxUNFA8CEAUXNzYnVrEUDXEKDXcYFxURB3IICgoCDRhY3EDRLFUDQRAOSqCFAV4KZRgQcMDAYQiJB7xSMcCwggaMEBVoZaAlA0XHEDBqKBLSAZU9DDGGoNCAIYMGBwdiftFQwAJ1Q4ojRnDIYLOoBC9fVORiOFKDTQ0coi44oE7NjAYCKBB1CnVD1JoVDlTUcwEgAy4Zog7lcMDAQhd6qmFIAEBCBgUWODhokKHBgQY648Jg0CCCvwgUEhxIwCFoXCIqXGRIUFOBBxINSDyO4mnGCgoubMDYLCQIACH5BAgGAAAALAAAAAAdABYAAAb+wJtwSCzeaq+W59WZuWrGqFHFkVAkkolFMkrRpFIUZJLFlsmiGLi4gmApjwaD0ZhQ7hfbejhyUOwLCQuDC3d3JWB6QhoIhhEgKCMUfhUVEBlGKCcwFyonHhwOEHcVGCMkHBUXFxUNHEM1HigZFBWGpRENFKsXFr2/FA0hQjAtdoa1uxcSDwyjqr4XfwIKLDcxyYZktau+CgkGDRcPERQBDo1HJ8fSDQsKCw2qGNIQBQsMCQcMAggaLTdQlOPFQIGzBgokYFhIYQGIDA0yFAqR4csNExC6XWBwgcUMGCFKLVwYo0WJGiVW2FB0Q4OWVQtlDJmFQUOGCAlgrOFw4MJ9SAwcRozokEGDhg0cLDiYsWbFlpEZMBQtyoFDBgYOLkABM+NAAQsZpmqoWjUDhwYFPuy5sYwCgppmrVot8EBCBRdrX2AoIADDhAVhGZQ6YEDC1rUrGEwyUIBChAUIFpAwtZaIixkQHEpYUOKqC5aVh7AoYcNDhRozXoQWEgQAIfkECAYAAAAsAAAAAB0AFgAABv7Am3BILN5ostNo5ZmtbMaosZWhUCQTSUVSItWk0hIES5aQJ6UXuLgyZyONBcMhsVIw37VwBJlYFwmACwt2FCNgUEIZCFZZICkjFA4UFRQRG0YuITIaIi0eGBARdhohJRwXqRcLGUQeIRx+dn4SCxWptxYXt1sRIUIuK5V2FZWpEw0OCxYUqbpWBgYsR8NWW3W4FxYOCIMWEg4XAggMFDY1IpW3FHEKCw23GBeSAgoNDAINBQcbLTcqD5rNY6CAAQSCEjAopMAAg4cFGBw0QJFhhpATE1StwrBiRgwQdzBkwEABBo0QNFacKILhgSqFMYak0JAhg4YIEGKC8cDggnZChRxGjOBQk6aGWjLWrKDw4OdIoxqIcnBgwUIeKTEMKFBo0yaHr0Q1GCBwSA9JBwe6fs3AwcKBC+Bc6LkRg0IBBBrmcGDHoYKAtDrnomhwAd8yBggUPAjxoMRcIjFgJJAAYgEEE2NqWHzMpkWNCx5usFDD+UYQACH5BAgGAAAALAAAAAAdABYAAAb+wJtwSCzeajWRqjSKqYxQ6OuCkVgnFMlpVItGR1fJxCrJUkYvb3EliYwfjLijPN501cKQw7zo+ymAEyJqNkIaCYBZICgjFHsVFRIcRjQcMCEbMSESD1gVFBkiJRwWFxQXCxhEIRkeiaeOEgqnFRcVpbUXViBCLSUYr5+fpgsQCqYXyaYUCQQsR8CAn2MUuRcWEgcOC4ALFgcEDBI2NRymtRQNfg25GBMNAQgMDQUJCAUZaS4OFsMMfQ4aKJCAoaAFCBJGLPiEoIQHGEJInFKWqsUMTRQKZrjg4IUNES1klCiCgYGygjGGoMigIUOGahC9bLJQsOCGESM6tGSpYYFwgRlqUgSs6ZKlSw4tQU24EyXGAQgYXGpoqYGDVXMCDozEA+yAggwYrlqV0CBDgwZp8MyQUOABBgMUODiI0MGBgAQhVuAZUqKaAgEQKCBI0CAjA717h9QogaBqggshEnCwkTYxkRU0VkxQYcNETMtBAAAh+QQIBgAAACwAAAAAHQAWAAAG/sCbcEgs3mo0kAuEaq2MUOiLgpFYKZLLaBTthrATSViMrYRe3WILLHk0GAuHhILt1NLDDyNMWSgWCQsLFBNYXHg3HIN0EiApIxQOFBWEHEU1Nh4oKRgvJREMk5MYIyUclBcXCxdEKBcedIUXFAwPCpOpFhSpqQ8Qhy0dHHR0lKgXChIIu7kYWA4DLUcchaJ8vLoUBhELEhYMEg0A4DY1GbMVsw2CCg3pGFUMAgftBgcLBxcyNzEQzBQNFDBwEFACPAwXJjTwEOEBhgQeSMAQIoKChXQXGGBYMSOGiAoHLSxQcePECRsoZhDBoCAVQgwxhqDAoCGDBngqu0A6CI/DdJYONoMaKLCvS4oDDQ5moGlzA4cNSzNEuNNFhoIKFjAE1eCUg9cIARaUQMTBgQAIN716lZr1gIOJeGY0yBehgFaNHBAMYEBiLKIbJDg8KGBgwgMECRxUgNAg5l8hNjQwgAQRw4IUMKQ9JuLiRsUaMEYUfRwEADs=';b.setAttribute('class','RESDialogTopBar');$(b).html('<img id="RESLogo" src="'+this.logo+'"><h1>reddit enhancement suite</h1>');a.appendChild(b);this.RESConsoleVersion=createElementWithID('div','RESConsoleVersion');$(this.RESConsoleVersion).text('v'+RESVersion);b.appendChild(this.RESConsoleVersion);var c=createElementWithID('a','RESConsoleSubredditLink');$(c).text('/r/Enhancement');c.setAttribute('href','http://reddit.com/r/Enhancement');c.setAttribute('alt','The RES Subreddit');b.appendChild(c);var d=createElementWithID('span','RESClose','RESCloseButton');$(d).text('X');d.addEventListener('click',function(e){e.preventDefault();RESConsole.close()},true);b.appendChild(d);this.categories=[];for(var i in modules){if((typeof(modules[i].category)!='undefined')&&(this.categories.indexOf(modules[i].category)==-1)){this.categories.push(modules[i].category)}}this.categories.sort();var f=this.categories.concat(['About RES']);var g=createElementWithID('ul','RESMenu');for(var i=0;i<f.length;i++){var h=document.createElement('li');$(h).text(f[i]);h.setAttribute('id','Menu-'+f[i]);h.addEventListener('click',function(e){e.preventDefault();RESConsole.menuClick(this)},true);g.appendChild(h)}a.appendChild(g);this.RESConsoleContainer.appendChild(a);RESConsole.RESMenuItems=g.querySelectorAll('li');this.RESConsoleContent=createElementWithID('div','RESConsoleContent');this.RESConsoleContainer.appendChild(this.RESConsoleContent);document.body.appendChild(this.RESConsoleContainer)},drawConfigPanel:function(c){c=c||this.categories[0];$(this.RESConsoleConfigPanel).html('');this.RESConfigPanelSelector=createElementWithID('select','RESConfigPanelSelector');var d=document.createElement('option');d.setAttribute('value','');$(d).text('Select Module');this.RESConfigPanelSelector.appendChild(d);var f=[];for(var i in modules){if(modules[i].category==c)f.push(i)}f.sort(function(a,b){if(modules[a].moduleName.toLowerCase()>modules[b].moduleName.toLowerCase())return 1;return-1});this.RESConfigPanelModulesPane=createElementWithID('div','RESConfigPanelModulesPane');for(var i=0,len=f.length;i<len;i++){var g=createElementWithID('div','module-'+f[i]);addClass(g,'moduleButton');var h=f[i];$(g).text(modules[h].moduleName);if(modules[h].isEnabled()){addClass(g,'enabled')}g.setAttribute('moduleID',modules[h].moduleID);g.addEventListener('click',function(e){RESConsole.drawConfigOptions(this.getAttribute('moduleID'));RESConsole.RESConsoleContent.scrollTop=0},false);this.RESConfigPanelModulesPane.appendChild(g);if(i==0)var j=g}this.RESConsoleConfigPanel.appendChild(this.RESConfigPanelModulesPane);this.RESConfigPanelOptions=createElementWithID('div','RESConfigPanelOptions');$(this.RESConfigPanelOptions).html('<h1>RES Module Configuration</h1> Select a module from the column at the left to enable or disable it, and configure its various options.');this.RESConsoleConfigPanel.appendChild(this.RESConfigPanelOptions);this.RESConsoleContent.appendChild(this.RESConsoleConfigPanel);RESUtils.click(j)},drawOptionInput:function(a,b,c,d){switch(c.type){case'textarea':var e=createElementWithID('textarea',b);e.setAttribute('type','textarea');e.setAttribute('moduleID',a);$(e).html(escapeHTML(c.value));break;case'text':var e=createElementWithID('input',b);e.setAttribute('type','text');e.setAttribute('moduleID',a);e.setAttribute('value',c.value);break;case'list':var e=createElementWithID('input',b);e.setAttribute('class','RESInputList');e.setAttribute('type','text');e.setAttribute('moduleID',a);existingOptions=c.value;if(typeof(existingOptions)=='undefined')existingOptions='';var f=[];var g=existingOptions.split(',');for(var i=0,len=g.length;i<len;i++){if(g[i]!='')f.push({id:g[i],name:g[i]})}setTimeout(function(){$(e).tokenInput(c.source,{method:"POST",queryParam:"query",theme:"facebook",allowCustomEntry:true,onResult:(typeof(c.onResult)=='function')?c.onResult:null,prePopulate:f,hintText:(typeof(c.hintText)=='string')?c.hintText:null})},100);break;case'password':var e=createElementWithID('input',b);e.setAttribute('type','password');e.setAttribute('moduleID',a);e.setAttribute('value',c.value);break;case'boolean':var e=RESUtils.toggleButton(b,c.value,null,null,d);break;case'enum':if(typeof(c.values)=='undefined'){alert('misconfigured enum option in module: '+a)}else{var e=createElementWithID('div',b);e.setAttribute('class','enum');for(var j=0;j<c.values.length;j++){var h=c.values[j].display;var k=c.values[j].value;var l=createElementWithID('input',b+'-'+j);if(d)l.setAttribute('tableOption','true');l.setAttribute('type','radio');l.setAttribute('name',b);l.setAttribute('moduleID',a);l.setAttribute('value',c.values[j].value);var m=((c.value==null)&&(c.values[j].value==''));if((c.value==c.values[j].value)||m){l.setAttribute('checked','checked')}var n=document.createTextNode(' '+c.values[j].name+' ');e.appendChild(l);e.appendChild(n);var o=document.createElement('br');e.appendChild(o)}}break;case'keycode':var e=createElementWithID('input',b);e.setAttribute('type','text');e.setAttribute('class','keycode');e.setAttribute('moduleID',a);e.setAttribute('value',c.value);break;default:console.log('misconfigured option in module: '+a);break}if(d){e.setAttribute('tableOption','true')}return e},enableModule:function(a,b){var c=this.getAllModulePrefs(true);(b)?c[a]=true:c[a]=false;this.setModulePrefs(c)},drawConfigOptions:function(m){var n=RESConsole.RESConsoleConfigPanel.querySelectorAll('.moduleButton');for(var i=0,len=n.length;i<len;i++){(n[i].getAttribute('moduleID')==m)?addClass(n[i],'active'):removeClass(n[i],'active')}RESConsole.currentModule=m;var o=RESUtils.getOptions(m);var p=0;this.RESConfigPanelOptions.setAttribute('style','display: block;');$(this.RESConfigPanelOptions).html('');var q=document.createElement('div');addClass(q,'moduleHeader');$(q).html('<span class="moduleName">'+modules[m].moduleName+'</span>');var r=document.createElement('div');addClass(r,'moduleToggle');if(m=='dashboard')r.style.display='none';$(r).html('<span class="toggleOn">on</span><span class="toggleOff">off</span>');if(modules[m].isEnabled())addClass(r,'enabled');r.setAttribute('moduleID',m);r.addEventListener('click',function(e){var a=RESConsole.RESConfigPanelModulesPane.querySelector('.active');var b=!(!hasClass(this,'enabled'));if(b){removeClass(a,'enabled')removeClass(this,'enabled')addClass(RESConsole.moduleOptionsScrim,'visible');$('#moduleOptionsSave').hide()}else{addClass(a,'enabled');addClass(this,'enabled');removeClass(RESConsole.moduleOptionsScrim,'visible');$('#moduleOptionsSave').fadeIn()}RESConsole.enableModule(this.getAttribute('moduleID'),!b)},true);q.appendChild(r);for(var i in o){var s=createElementWithID('input','moduleOptionsSave');s.setAttribute('type','button');s.setAttribute('value','save options');s.addEventListener('click',function(e){RESConsole.saveCurrentModuleOptions(e)},true);this.RESConsoleConfigPanel.appendChild(s);var t=createElementWithID('div','moduleOptionsSaveStatus','saveStatus');q.appendChild(t);break}var u=document.createElement('div');addClass(u,'moduleDescription');$(u).html(modules[m].description);q.appendChild(u);this.RESConfigPanelOptions.appendChild(q);var v=createElementWithID('div','allOptionsContainer');this.RESConfigPanelOptions.appendChild(v);for(var i in o){if(!(o[i].noconfig)){p++;var w=createElementWithID('div',null,'optionContainer');var x=document.createElement('label');x.setAttribute('for',i);$(x).text(i);var y=createElementWithID('div',null,'optionDescription');$(y).html(o[i].description);w.appendChild(x);if(o[i].type=='table'){addClass(y,'table');if(typeof(o[i].fields)=='undefined'){alert('misconfigured table option in module: '+m+' - options of type "table" must have fields defined')}else{var z=[];var A=document.createElement('table');A.setAttribute('moduleID',m);A.setAttribute('optionName',i);A.setAttribute('class','optionsTable');var B=document.createElement('thead');var C=document.createElement('tr');A.appendChild(B);for(var j=0;j<o[i].fields.length;j++){z[j]=o[i].fields[j].name;var D=document.createElement('th');$(D).text(o[i].fields[j].name);C.appendChild(D)}D=document.createElement('th');$(D).text('delete');C.appendChild(D);B.appendChild(C);A.appendChild(B);var E=document.createElement('tbody');E.setAttribute('id','tbody_'+i);for(var j=0;j<o[i].value.length;j++){var F=document.createElement('tr');for(var k=0;k<o[i].fields.length;k++){var G=document.createElement('td');G.className='hasTableOption';var H=o[i].fields[k];var I=i+'_'+o[i].fields[k].name;H.value=o[i].value[j][k];var J=I+'_'+j;var K=this.drawOptionInput(m,J,H,true);G.appendChild(K);F.appendChild(G)}G=document.createElement('td');var L=document.createElement('div');L.className='deleteButton';L.addEventListener('click',RESConsole.deleteOptionRow);G.appendChild(L);F.appendChild(G);E.appendChild(F)}A.appendChild(E);var M=A}w.appendChild(y);w.appendChild(M);var N=o[i].addRowText||'Add Row';var O=document.createElement('input');addClass(O,'addRowButton');O.setAttribute('type','button');O.setAttribute('value',N);O.setAttribute('optionName',i);O.setAttribute('moduleID',m);O.addEventListener('click',function(){var a=this.getAttribute('optionName');var b='tbody_'+a;var c=document.getElementById(b);var d=document.createElement('tr');var e=(c.querySelectorAll('tr'))?c.querySelectorAll('tr').length+1:1;for(var i=0,len=modules[m].options[a].fields.length;i<len;i++){var f=document.createElement('td');f.className='hasTableOption';var g=modules[m].options[a].fields[i];if(g.type!='enum')g.value='';var h=a+'_'+e;var j=RESConsole.drawOptionInput(m,h,g,true);f.appendChild(j);d.appendChild(f);var k=d.querySelector('input[type=text]');if(!k)k=d.querySelector('textarea');if(k){setTimeout(function(){k.focus()},200)}}G=document.createElement('td');var l=document.createElement('div');l.className='deleteButton';l.addEventListener('click',RESConsole.deleteOptionRow);G.appendChild(l);d.appendChild(G);c.appendChild(d)},true);w.appendChild(O)}else{if((o[i].type=='text')||(o[i].type=='password')||(o[i].type=='keycode'))addClass(y,'textInput');var M=this.drawOptionInput(m,i,o[i]);w.appendChild(M);w.appendChild(y)}var P=document.createElement('div');P.setAttribute('class','clear');w.appendChild(P);v.appendChild(w)}}var Q=this.RESConfigPanelOptions.querySelectorAll('.keycode');if(Q.length>0){this.keyCodeModal=createElementWithID('div','keyCodeModal');$(this.keyCodeModal).text('Press a key (or combination with shift, alt and/or ctrl) to assign this action.');document.body.appendChild(this.keyCodeModal);for(var i=0,len=Q.length;i<len;i++){Q[i].style.border='1px solid red';Q[i].style.display='none';thisKeyCodeDisplay=createElementWithID('input',Q[i].getAttribute('id')+'-display');thisKeyCodeDisplay.setAttribute('type','text');thisKeyCodeDisplay.setAttribute('capturefor',Q[i].getAttribute('id'));thisKeyCodeDisplay.setAttribute('displayonly','true');thisKeyCodeDisplay.setAttribute('value',RESUtils.niceKeyCode(Q[i].value.toString()));thisKeyCodeDisplay.addEventListener('blur',function(e){RESConsole.keyCodeModal.setAttribute('style','display: none;')},true);thisKeyCodeDisplay.addEventListener('focus',function(e){window.addEventListener('keydown',function(e){if((RESConsole.captureKey)&&(e.keyCode!=16)&&(e.keyCode!=17)&&(e.keyCode!=18)){e.preventDefault();document.getElementById(RESConsole.captureKeyID).value=e.keyCode+','+e.altKey+','+e.ctrlKey+','+e.shiftKey+','+e.metaKey;var a=[e.keyCode,e.altKey,e.ctrlKey,e.shiftKey,e.metaKey];document.getElementById(RESConsole.captureKeyID+'-display').value=RESUtils.niceKeyCode(a);RESConsole.keyCodeModal.style.display='none';RESConsole.captureKey=false}},true);thisXY=RESUtils.getXYpos(this,true);RESConsole.keyCodeModal.setAttribute('style','display: block; top: '+RESUtils.mouseY+'px; left: '+RESUtils.mouseX+'px;');RESConsole.keyCodeModal.style.display='block';RESConsole.captureKey=true;RESConsole.captureKeyID=this.getAttribute('capturefor')},true);insertAfter(Q[i],thisKeyCodeDisplay)}}if(p==0){var R=createElementWithID('div','noOptions');addClass(R,'optionContainer');$(R).text('There are no configurable options for this module');this.RESConfigPanelOptions.appendChild(R)}else{this.moduleOptionsScrim=createElementWithID('div','moduleOptionsScrim');if(modules[m].isEnabled()){removeClass(RESConsole.moduleOptionsScrim,'visible');$('#moduleOptionsSave').fadeIn()}else{addClass(RESConsole.moduleOptionsScrim,'visible');$('#moduleOptionsSave').fadeOut()}v.appendChild(this.moduleOptionsScrim)}},deleteOptionRow:function(e){var a=e.target.parentNode.parentNode;$(a).remove()},saveCurrentModuleOptions:function(e){e.preventDefault();var a=this.RESConfigPanelOptions;var b=a.querySelectorAll('input, textarea');for(var i=0,len=b.length;i<len;i++){var c=(b[i].getAttribute('id')!=null)&&(b[i].getAttribute('id').indexOf('token-input-')==-1);if((c)&&(b[i].getAttribute('type')!='button')&&(b[i].getAttribute('displayonly')!='true')&&(b[i].getAttribute('tableOption')!='true')){if(b[i].getAttribute('type')=='radio'){var d=b[i].getAttribute('name')}else{var d=b[i].getAttribute('id')}var f=RESConsole.currentModule;if(b[i].getAttribute('type')=='checkbox'){var g=!!b[i].checked}else if(b[i].getAttribute('type')=='radio'){if(b[i].checked){var g=b[i].value}}else{if((b[i].getAttribute('class'))&&(b[i].getAttribute('class').indexOf('keycode')>=0)){var h=b[i].value.split(',');var g=[parseInt(h[0]),(h[1]=='true'),(h[2]=='true'),(h[3]=='true'),(h[4]=='true')]}else{var g=b[i].value}}if(typeof(g)!='undefined'){RESUtils.setOption(f,d,g)}}}var m=a.querySelectorAll('.optionsTable');if(typeof(m)!='undefined'){for(var i=0,len=m.length;i<len;i++){var f=m[i].getAttribute('moduleID');var d=m[i].getAttribute('optionName');var n=m[i].querySelector('tbody');var o=n.querySelectorAll('tr');if(typeof(o)!='undefined'){var p=[];var q=0;for(var j=0;j<o.length;j++){var r=[];var s=o[j].querySelectorAll('td.hasTableOption');var t=false;for(var k=0;k<s.length;k++){var b=s[k].querySelectorAll('input[tableOption=true], textarea[tableOption=true]');var g=null;for(var l=0;l<b.length;l++){if(b[l].getAttribute('type')=='checkbox'){(b[l].checked)?g=true:g=false}else if(b[l].getAttribute('type')=='radio'){if(b[l].checked){g=b[l].value}}else{if((b[l].getAttribute('class'))&&(b[l].getAttribute('class').indexOf('keycode')>=0)){var h=b[l].value.split(',');g=[parseInt(h[0]),(h[1]=='true'),(h[2]=='true'),(h[3]=='true')]}else{g=b[l].value}}if((g!='')&&(b[l].getAttribute('type')!='radio')){t=true}}if(g||t){r.push(g)}}if((t)&&(r!=null)){p[q]=r;q++}}if(p==null){p=[]}if(typeof(g)!='undefined'){RESUtils.setOption(f,d,p)}}}}var u=document.getElementById('moduleOptionsSaveStatus');if(u){$(u).text('Options have been saved...');u.setAttribute('style','display: block; opacity: 1')}RESUtils.fadeElementOut(u,0.1)if(f=='RESPro')RESStorage.removeItem('RESmodules.RESPro.lastAuthFailed')},drawAboutPanel:function(){var d=this.RESConsoleAboutPanel;var e=' <div id="RESAboutPane"> 	<div id="Button-DonateRES" class="moduleButton active">Donate</div> 	<div id="Button-AboutRES" class="moduleButton">About RES</div> 	<div id="Button-RESTeam" class="moduleButton">About the RES Team</div> </div> <div id="RESAboutDetails"> 	<div id="DonateRES" class="aboutPanel"> 		<h3>Contribute to support RES</h3> 		<p>RES is entirely free - as in beer, as in open source, as in everything.  If you like our work, a contribution would be greatly appreciated.</p> 		<p>When you contribute, you make it possible for the team to cover hosting costs and other expenses so that we can focus on doing what we do best: making your Reddit experience even better.</p> 		<p> 		<strong style="font-weight: bold;">Dwolla is the preferred method of contribution</strong>, because it charges much smaller fees than PayPal and Google: <br><br>		<a target="_blank" href="https://www.dwolla.com/u/812-686-0217"><img src="https://www.dwolla.com/content/images/btn-donate-with-dwolla.png"></a>		</p> 		<p> 		We also do have PayPal: <br> 		<form action="https://www.paypal.com/cgi-bin/webscr" method="post"><input type="hidden" name="cmd" value="_s-xclick"><input type="hidden" name="hosted_button_id" value="S7TAR7QU39H22"><input type="image" src="https://www.paypalobjects.com/en_US/i/logo/PayPal_mark_60x38.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!"><img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1"></form> 		</p> 		<p></p> 		<p></p> 		<p> 		Or Google Checkout: 		<form action="https://checkout.google.com/api/checkout/v2/checkoutForm/Merchant/474530516020369" id="BB_BuyButtonForm" method="post" name="BB_BuyButtonForm" target="_top"> 			<input name="item_name_1" type="hidden" value="Purchase - Reddit Enhancement Suite"/> 			<input name="item_description_1" type="hidden" value="purchase"/> 			<input name="item_quantity_1" type="hidden" value="1"/> 			$<input name="item_price_1" type="text" value="" size="2" /> 			<input name="item_currency_1" type="hidden" value="USD"/> 			<input name="_charset_" type="hidden" value="utf-8"/> 			<input alt="" src="https://checkout.google.com/buttons/buy.gif?merchant_id=474530516020369&amp;w=117&amp;h=48&amp;style=white&amp;variant=text&amp;loc=en_US" type="image"/> 		</form> 		</p> 	</div> 	<div id="AboutRES" class="aboutPanel"> 		<h3>About RES</h3> 		<p>Author: <a target="_blank" href="http://www.honestbleeps.com/">honestbleeps</a><br></p> 		<p>Description: Reddit Enhancement Suite is a collection of modules that makes browsing reddit a whole lot easier.</p> 		<p>It\'s built with <a target="_blank" href="http://redditenhancementsuite.com/api">an API</a> that allows you to contribute and include your own modules!</p> 		<p>If you\'ve got bug reports or issues with RES, please see the <a target="_blank" href="http://www.reddit.com/r/RESIssues/">RESIssues</a> subreddit. If you\'d like to follow progress on RES, or you\'d like to converse with other users, please see the <a target="_blank" href="http://www.reddit.com/r/Enhancement/">Enhancement subreddit.</a> </p> 		<p>If you want to contact me directly with suggestions, bug reports or just want to say you appreciate the work, an <a href="mailto:steve@honestbleeps.com">email</a> would be great.</p> 		<p>License: Reddit Enhancement Suite is released under the <a target="_blank" href="http://www.gnu.org/licenses/gpl-3.0.html">GPL v3.0</a>.</p> 		<p><strong>Note:</strong> Reddit Enhancement Suite will check, at most once a day, to see if a new version is available.  No data about you is sent to me nor is it stored.</p> 	</div> 	<div id="RESTeam" class="aboutPanel"> 		<h3>About the RES Team</h3> 		<p>Steve Sobel (<a target="_blank" href="http://www.reddit.com/user/honestbleeps/">honestbleeps</a>) is the primary developer of RES.  Beyond that, there are a number of people who have contributed code, design and/or great ideas to RES.  To read more about the RES team, visit <a target="_blank" href="http://redditenhancementsuite.com/about.html">the RES website.</a></p> 	</div> </div> 		'$(d).html(e);$(d).find('.moduleButton').click(function(){$('.moduleButton').removeClass('active');$(this).addClass('active');var a=$(this).attr('id');var b=a.replace('Button-','');var c=$(this).parent().parent().find('.aboutPanel:visible');$(c).fadeOut(function(){$('#'+b).fadeIn()})});this.RESConsoleContent.appendChild(d)},drawProPanel:function(){RESConsoleProPanel=this.RESConsoleProPanel;var a=document.createElement('div');$(a).html('RES Pro allows you to save your preferences to the RES Pro server.<br><br><strong>Please note:</strong> this is beta functionality right now. Please don\'t consider this to be a "backup" solution just yet. To start, you will need to <a target="_blank" href="http://redditenhancementsuite.com/register.php">register for a PRO account</a> first, then email <a href="mailto:steve@honestbleeps.com">steve@honestbleeps.com</a> with your RES Pro username to get access.');RESConsoleProPanel.appendChild(a);this.proSetupButton=createElementWithID('div','RESProSetup');this.proSetupButton.setAttribute('class','RESButton');$(this.proSetupButton).text('Configure RES Pro');this.proSetupButton.addEventListener('click',function(e){e.preventDefault();modules['RESPro'].configure()},false);RESConsoleProPanel.appendChild(this.proSetupButton);this.proSaveButton=createElementWithID('div','RESProSave');this.proSaveButton.setAttribute('class','RESButton');$(this.proSaveButton).text('Save Module Options');this.proSaveButton.addEventListener('click',function(e){e.preventDefault();modules['RESPro'].authenticate(modules['RESPro'].savePrefs())},false);RESConsoleProPanel.appendChild(this.proSaveButton);this.proSaveCommentsSaveButton=createElementWithID('div','RESProSaveCommentsSave');this.proSaveCommentsSaveButton.setAttribute('class','RESButton');$(this.proSaveCommentsSaveButton).text('Save saved comments to Server');this.proSaveCommentsSaveButton.addEventListener('click',function(e){e.preventDefault();modules['RESPro'].authenticate(modules['RESPro'].saveModuleData('saveComments'))},false);RESConsoleProPanel.appendChild(this.proSaveCommentsSaveButton);this.proSubredditManagerSaveButton=createElementWithID('div','RESProSubredditManagerSave');this.proSubredditManagerSaveButton.setAttribute('class','RESButton');$(this.proSubredditManagerSaveButton).text('Save subreddits to server');this.proSubredditManagerSaveButton.addEventListener('click',function(e){e.preventDefault();modules['RESPro'].authenticate(modules['RESPro'].saveModuleData('subredditManager'))},false);RESConsoleProPanel.appendChild(this.proSubredditManagerSaveButton);this.proSaveCommentsGetButton=createElementWithID('div','RESProGetSavedComments');this.proSaveCommentsGetButton.setAttribute('class','RESButton');$(this.proSaveCommentsGetButton).text('Get saved comments from Server');this.proSaveCommentsGetButton.addEventListener('click',function(e){e.preventDefault();modules['RESPro'].authenticate(modules['RESPro'].getModuleData('saveComments'))},false);RESConsoleProPanel.appendChild(this.proSaveCommentsGetButton);this.proSubredditManagerGetButton=createElementWithID('div','RESProGetSubredditManager');this.proSubredditManagerGetButton.setAttribute('class','RESButton');$(this.proSubredditManagerGetButton).text('Get subreddits from Server');this.proSubredditManagerGetButton.addEventListener('click',function(e){e.preventDefault();modules['RESPro'].authenticate(modules['RESPro'].getModuleData('subredditManager'))},false);RESConsoleProPanel.appendChild(this.proSubredditManagerGetButton);this.proGetButton=createElementWithID('div','RESProGet');this.proGetButton.setAttribute('class','RESButton');$(this.proGetButton).text('Get options from Server');this.proGetButton.addEventListener('click',function(e){e.preventDefault();modules['RESPro'].authenticate(modules['RESPro'].getPrefs())},false);RESConsoleProPanel.appendChild(this.proGetButton);this.RESConsoleContent.appendChild(RESConsoleProPanel)},open:function(){this.drawConfigPanel();this.drawAboutPanel();RESConsole.RESConsolePanels=this.RESConsoleContent.querySelectorAll('.RESPanel');this.isOpen=true;var a=document.getElementById('ad-frame');if((typeof(a)!='undefined')&&(a!=null)){a.style.display='none'}removeClass(this.modalOverlay,'fadeOut');addClass(this.modalOverlay,'fadeIn');removeClass(this.RESConsoleContainer,'slideOut');addClass(this.RESConsoleContainer,'slideIn');RESConsole.menuClick(RESConsole.RESMenuItems[0])},close:function(){$('#moduleOptionsSave').fadeOut();this.isOpen=false;var a=document.getElementById('ad-frame');if((typeof(a)!='undefined')&&(a!=null)){a.style.display='block'}removeClass(this.modalOverlay,'fadeIn');addClass(this.modalOverlay,'fadeOut');removeClass(this.RESConsoleContainer,'slideIn');addClass(this.RESConsoleContainer,'slideOut');if(typeof(RESConsole.keyCodeModal)!='undefined'){RESConsole.keyCodeModal.style.display='none';RESConsole.captureKey=false}},menuClick:function(a){if(a)var b=a.getAttribute('id');var c=RESConsole.RESMenuItems;for(var i=0;i<c.length;i++){removeClass(c[i],'active')}addClass(a,'active');var d=RESConsole.RESConsolePanels;for(var i=0;i<d.length;i++){d[i].setAttribute('style','display: none')}switch(b){case'Menu-Enable Modules':this.RESConsoleModulesPanel.setAttribute('style','display: block');break;case'Menu-Configure Modules':this.RESConfigPanelSelector.selectedIndex=0;this.RESConsoleConfigPanel.setAttribute('style','display: block');break;case'Menu-About RES':this.RESConsoleAboutPanel.setAttribute('style','display: block');break;case'Menu-RES Pro':this.RESConsoleProPanel.setAttribute('style','display: block');break;default:var e=b.split('-');var f=e[e.length-1];this.RESConfigPanelSelector.selectedIndex=0;this.RESConsoleConfigPanel.setAttribute('style','display: block');this.drawConfigPanel(f);break}}};modules['subRedditTagger']={moduleID:'subRedditTagger',moduleName:'Subreddit Tagger',category:'Filters',options:{subReddits:{type:'table',addRowText:'+add tag',fields:[{name:'subreddit',type:'text'},{name:'doesntContain',type:'text'},{name:'tag',type:'text'}],value:[],description:'Set your subreddits below. For that subreddit, if the title of the post doesn\'t contain what you place in the "doesn\'t contain" field, the subreddit will be tagged with whatever you specify.'}},description:'Adds tags to posts on subreddits (i.e. [SMT] on SomebodyMakeThis when the user leaves it out)',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[\?]*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},go:function(){if((this.isEnabled())&&(this.isMatchURL())){this.checkForOldSettings();this.SRTDoesntContain=[];this.SRTTagWith=[];this.loadSRTRules();RESUtils.watchForElement('siteTable',modules['subRedditTagger'].scanTitles);this.scanTitles()}},loadSRTRules:function(){var a=this.options.subReddits.value;for(var i=0,len=a.length;i<len;i++){var b=a[i];if(b){modules['subRedditTagger'].SRTDoesntContain[b[0].toLowerCase()]=b[1];modules['subRedditTagger'].SRTTagWith[b[0].toLowerCase()]=b[2]}}},scanTitles:function(a){var b='#siteTable > .thing > DIV.entry';if(a){b='.thing > DIV.entry'}else{a=document}var c=a.querySelectorAll(b);for(var i=0,len=c.length;i<len;i++){var d=c[i].querySelector('A.subreddit');if((typeof(d)!='undefined')&&(d!=null)){var e=d.innerHTML.toLowerCase();if(typeof(modules['subRedditTagger'].SRTDoesntContain[e])!='undefined'){var f=c[i].querySelector('a.title');if(!(hasClass(f,'srTagged'))){addClass(f,'srTagged');var g=modules['subRedditTagger'].SRTDoesntContain[e];var h=modules['subRedditTagger'].SRTTagWith[e];if(f.text.indexOf(g)==-1){$(f).html(escapeHTML(h)+' '+f.textContent)}}}}}},checkForOldSettings:function(){var a=[];var b=0;while(RESStorage.getItem('subreddit_'+b)){var c=RESStorage.getItem('subreddit_'+b).replace(/\"/g,"");var d=c.split("|");a[b]=d;RESStorage.removeItem('subreddit_'+b);b++}if(b>0){RESUtils.setOption('subRedditTagger','subReddits',a)}}};modules['uppersAndDowners']={moduleID:'uppersAndDowners',moduleName:'Uppers and Downers Enhanced',category:'UI',options:{showSigns:{type:'boolean',value:false,description:'Show +/- signs next to upvote/downvote tallies.'},applyToLinks:{type:'boolean',value:true,description:'Uppers and Downers on links.'},postUpvoteStyle:{type:'text',value:'color:rgb(255, 139, 36); font-weight:normal;',description:'CSS style for post upvotes'},postDownvoteStyle:{type:'text',value:'color:rgb(148, 148, 255); font-weight:normal;',description:'CSS style for post upvotes'},commentUpvoteStyle:{type:'text',value:'color:rgb(255, 139, 36); font-weight:bold;',description:'CSS style for comment upvotes'},commentDownvoteStyle:{type:'text',value:'color:rgb(148, 148, 255); font-weight:bold;',description:'CSS style for comment upvotes'},forceVisible:{type:'boolean',value:false,description:'Force upvote/downvote counts to be visible (when subreddit CSS tries to hide them)'}},description:'Displays up/down vote counts on comments.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/?(?:\??[\w]+=[\w]+&?)*/i,/https?:\/\/([a-z]+).reddit.com\/r\/[\w]+\/?(?:\??[\w]+=[\w]+&?)*$/i,/https?:\/\/([a-z]+).reddit.com\/user\/[-\w\.]+/i,/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]+\/comments\/[-\w\.]+/i,/https?:\/\/([a-z]+).reddit.com\/comments\/[-\w\.]+/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){var a=(this.options.forceVisible.value)?'; visibility: visible !important; opacity: 1 !important; display: inline-block !important;':'';var b='.res_comment_ups { '+this.options.commentUpvoteStyle.value+a+' } .res_comment_downs { '+this.options.commentDownvoteStyle.value+a+' }';b+='.res_post_ups { '+this.options.postUpvoteStyle.value+a+' } .res_post_downs { '+this.options.postDownvoteStyle.value+a+' }';RESUtils.addCSS(b)}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){if(typeof(this.options.showTimestamp)!='undefined'){delete this.options.showTimestamp;RESStorage.setItem('RESoptions.uppersAndDowners',JSON.stringify(modules['uppersAndDowners'].options))}if(RESUtils.pageType()=='comments'){this.commentsWithMoos=[];this.moreCommentsIDs=[];this.applyUppersAndDownersToComments();RESUtils.watchForElement('newComments',modules['uppersAndDowners'].applyUppersAndDownersToComments)}else if(RESUtils.pageType()=='profile'){this.commentsWithMoos=[];this.moreCommentsIDs=[];this.applyUppersAndDownersToMixed();RESUtils.watchForElement('siteTable',modules['uppersAndDowners'].applyUppersAndDownersToMixed)}else if((RESUtils.pageType()=='linklist')&&(this.options.applyToLinks.value)){this.linksWithMoos=[];this.applyUppersAndDownersToLinks();RESUtils.watchForElement('siteTable',modules['uppersAndDowners'].applyUppersAndDownersToLinks)}}},applyUppersAndDownersToComments:function(d){if(!d){d=document.body}if(hasClass(d,'comment')){modules['uppersAndDowners'].allComments=[d]}else{modules['uppersAndDowners'].allComments=d.querySelectorAll('div.comment')}modules['uppersAndDowners'].allCommentsCount=modules['uppersAndDowners'].allComments.length;modules['uppersAndDowners'].allCommentsi=0;(function(){var a=Math.min((modules['uppersAndDowners'].allCommentsCount-modules['uppersAndDowners'].allCommentsi),15);for(var i=0;i<a;i++){var b=modules['uppersAndDowners'].allCommentsi;var c=modules['uppersAndDowners'].allComments[b];modules['uppersAndDowners'].showUppersAndDownersOnComment(c);modules['uppersAndDowners'].allCommentsi++}if(modules['uppersAndDowners'].allCommentsi<modules['uppersAndDowners'].allCommentsCount){setTimeout(arguments.callee,1000)}})()},applyUppersAndDownersToMixed:function(a){a=a||document.body;var b=a.querySelectorAll('div.thing.link, div.thing.comment');var c='regular';if(modules['uppersAndDowners'].options.showSigns.value){var d='+';var e='-'}else{var d='';var e=''}for(var i=0,len=b.length;i<len;i++){if(hasClass(b[i],'link')){var f=b[i].getAttribute('data-ups');var g=b[i].getAttribute('data-downs');var h=b[i].querySelector('p.tagline');if((typeof(h)!='undefined')&&(h!=null)){var j=$("<span> (<span class='res_post_ups'>"+d+f+"</span>|<span class='res_post_downs'>"+e+g+"</span>) </span>");if(c=='regular'){$(h).prepend(j)}else{$(h).after(j)}}}else{modules['uppersAndDowners'].showUppersAndDownersOnComment(b[i])}}},showUppersAndDownersOnComment:function(a){if(a.getAttribute('data-votesvisible')=='true')return;a.setAttribute('data-votesvisible','true');var b=a.querySelector('p.tagline');var c=a.getAttribute('data-ups');var d=a.getAttribute('data-downs');var e,closeparen,mooups,moodowns,voteUps,voteDowns,pipe;var f=document.createDocumentFragment();if(modules['uppersAndDowners'].options.showSigns.value){c='+'+c;d='-'+d}e=document.createTextNode(" (");f.appendChild(e);mooups=document.createElement("span");mooups.className="res_comment_ups";voteUps=document.createTextNode(c);mooups.appendChild(voteUps);f.appendChild(mooups);pipe=document.createTextNode("|");b.appendChild(pipe);moodowns=document.createElement("span");moodowns.className="res_comment_downs";voteDowns=document.createTextNode(d);moodowns.appendChild(voteDowns);f.appendChild(moodowns);closeparen=document.createTextNode(")");f.appendChild(closeparen);f.appendChild(e);f.appendChild(mooups);f.appendChild(pipe);f.appendChild(moodowns);f.appendChild(closeparen);b.appendChild(f)},applyUppersAndDownersToLinks:function(a){a=a||document.body;var b=a.querySelectorAll('div.thing.link');var c='regular';if(modules['uppersAndDowners'].options.showSigns.value){var d='+';var e='-'}else{var d='';var e=''}for(var i=0,len=b.length;i<len;i++){var f=b[i].getAttribute('data-ups');var g=b[i].getAttribute('data-downs');var h=b[i].querySelector('p.tagline');if((typeof(h)!='undefined')&&(h!=null)){var j=$("<span> (<span class='res_post_ups'>"+d+f+"</span>|<span class='res_post_downs'>"+e+g+"</span>) </span>");if(c=='regular'){$(h).prepend(j)}else{$(h).after(j)}}}}};modules['keyboardNav']={moduleID:'keyboardNav',moduleName:'Keyboard Navigation',category:'UI',options:{focusBorder:{type:'text',value:'1px dashed #888888',description:'Border style of focused element'},focusBGColor:{type:'text',value:'#F0F3FC',description:'Background color of focused element'},focusBGColorNight:{type:'text',value:'#666',description:'Background color of focused element in Night Mode'},focusFGColorNight:{type:'text',value:'#DDD',description:'Foreground color of focused element in Night Mode'},autoSelectOnScroll:{type:'boolean',value:false,description:'Automatically select the topmost element for keyboard navigation on window scroll'},scrollOnExpando:{type:'boolean',value:true,description:'Scroll window to top of link when expando key is used (to keep pics etc in view)'},scrollStyle:{type:'enum',values:[{name:'directional',value:'directional'},{name:'page up/down',value:'page'},{name:'lock to top',value:'top'}],value:'directional',description:'When moving up/down with keynav, when and how should RES scroll the window?'},commentsLinkNumbers:{type:'boolean',value:true,description:'Assign number keys (e.g. [1]) to links within selected comment'},commentsLinkNumberPosition:{type:'boolean',type:'enum',values:[{name:'Place on right',value:'right'},{name:'Place on left',value:'left'}],value:'right',description:'Which side commentsLinkNumbers are displayed'},commentsLinkNewTab:{type:'boolean',value:true,description:'Open number key links in a new tab'},clickFocus:{type:'boolean',value:true,description:'Move keyboard focus to a link or comment when clicked with the mouse'},onHideMoveDown:{type:'boolean',value:true,description:'After hiding a link, automatically select the next link'},onVoteMoveDown:{type:'boolean',value:false,description:'After voting on a link, automatically select the next link'},toggleHelp:{type:'keycode',value:[191,false,false,true],description:'Show help'},toggleCmdLine:{type:'keycode',value:[190,false,false,false],description:'Show/hide commandline box'},hide:{type:'keycode',value:[72,false,false,false],description:'Hide link'},moveUp:{type:'keycode',value:[75,false,false,false],description:'Move up (previous link or comment)'},moveDown:{type:'keycode',value:[74,false,false,false],description:'Move down (next link or comment)'},moveTop:{type:'keycode',value:[75,false,false,true],description:'Move to top of list (on link pages)'},moveBottom:{type:'keycode',value:[74,false,false,true],description:'Move to bottom of list (on link pages)'},moveUpSibling:{type:'keycode',value:[75,false,false,true],description:'Move to previous sibling (in comments) - skips to previous sibling at the same depth.'},moveDownSibling:{type:'keycode',value:[74,false,false,true],description:'Move to next sibling (in comments) - skips to next sibling at the same depth.'},moveToParent:{type:'keycode',value:[80,false,false,false],description:'Move to parent (in comments).'},followLink:{type:'keycode',value:[13,false,false,false],description:'Follow link (hold shift to open it in a new tab) (link pages only)'},followLinkNewTab:{type:'keycode',value:[13,false,false,true],description:'Follow link in new tab (link pages only)'},followLinkNewTabFocus:{type:'boolean',value:true,description:'When following a link in new tab - focus the tab?'},toggleExpando:{type:'keycode',value:[88,false,false,false],description:'Toggle expando (image/text/video) (link pages only)'},previousGalleryImage:{type:'keycode',value:[219,false,false,false],description:'View the previous image of an inline gallery.'},nextGalleryImage:{type:'keycode',value:[221,false,false,false],description:'View the next image of an inline gallery.'},toggleViewImages:{type:'keycode',value:[88,false,false,true],description:'Toggle "view images" button'},toggleChildren:{type:'keycode',value:[13,false,false,false],description:'Expand/collapse comments (comments pages only)'},followComments:{type:'keycode',value:[67,false,false,false],description:'View comments for link (shift opens them in a new tab)'},followCommentsNewTab:{type:'keycode',value:[67,false,false,true],description:'View comments for link in a new tab'},followLinkAndCommentsNewTab:{type:'keycode',value:[76,false,false,false],description:'View link and comments in new tabs'},followLinkAndCommentsNewTabBG:{type:'keycode',value:[76,false,false,true],description:'View link and comments in new background tabs'},upVote:{type:'keycode',value:[65,false,false,false],description:'Upvote selected link or comment'},downVote:{type:'keycode',value:[90,false,false,false],description:'Downvote selected link or comment'},save:{type:'keycode',value:[83,false,false,false],description:'Save the current link'},reply:{type:'keycode',value:[82,false,false,false],description:'Reply to current comment (comment pages only)'},followSubreddit:{type:'keycode',value:[82,false,false,false],description:'Go to subreddit of selected link (link pages only)'},followSubredditNewTab:{type:'keycode',value:[82,false,false,true],description:'Go to subreddit of selected link in a new tab (link pages only)'},inbox:{type:'keycode',value:[73,false,false,false],description:'Go to inbox'},inboxNewTab:{type:'keycode',value:[73,false,false,true],description:'Go to inbox in a new tab'},frontPage:{type:'keycode',value:[70,false,false,false],description:'Go to front page'},subredditFrontPage:{type:'keycode',value:[70,false,false,true],description:'Go to subreddit front page'},nextPage:{type:'keycode',value:[78,false,false,false],description:'Go to next page (link list pages only)'},prevPage:{type:'keycode',value:[80,false,false,false],description:'Go to prev page (link list pages only)'},link1:{type:'keycode',value:[49,false,false,false],description:'Open first link within comment.',noconfig:true},link2:{type:'keycode',value:[50,false,false,false],description:'Open link #2 within comment.',noconfig:true},link3:{type:'keycode',value:[51,false,false,false],description:'Open link #3 within comment.',noconfig:true},link4:{type:'keycode',value:[52,false,false,false],description:'Open link #4 within comment.',noconfig:true},link5:{type:'keycode',value:[53,false,false,false],description:'Open link #5 within comment.',noconfig:true},link6:{type:'keycode',value:[54,false,false,false],description:'Open link #6 within comment.',noconfig:true},link7:{type:'keycode',value:[55,false,false,false],description:'Open link #7 within comment.',noconfig:true},link8:{type:'keycode',value:[56,false,false,false],description:'Open link #8 within comment.',noconfig:true},link9:{type:'keycode',value:[57,false,false,false],description:'Open link #9 within comment.',noconfig:true},link10:{type:'keycode',value:[48,false,false,false],description:'Open link #10 within comment.',noconfig:true}},description:'Keyboard navigation for reddit!',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){var a,focusFGColorNight,focusBGColor,focusBGColorNight;if(typeof(this.options.focusBorder)=='undefined'){a='1px dashed #888888'}else{a=this.options.focusBorder.value}if(typeof(this.options.focusBGColor)=='undefined'){focusBGColor='#F0F3FC'}else{focusBGColor=this.options.focusBGColor.value}if(!(this.options.focusBGColorNight.value)){focusBGColorNight='#666'}else{focusBGColorNight=this.options.focusBGColorNight.value}if(!(this.options.focusFGColorNight.value)){focusFGColorNight='#DDD'}else{focusFGColorNight=this.options.focusFGColorNight.value}var b='outline';if(typeof(opera)!='undefined')b='border';RESUtils.addCSS(' 				.keyHighlight { '+b+': '+a+'; background-color: '+focusBGColor+'; } 				.res-nightmode .keyHighlight, .res-nightmode .keyHighlight .usertext-body, .res-nightmode .keyHighlight .usertext-body .md, .res-nightmode .keyHighlight .usertext-body .md p, .res-nightmode .keyHighlight .noncollapsed, .res-nightmode .keyHighlight .noncollapsed .md, .res-nightmode .keyHighlight .noncollapsed .md p { background-color: '+focusBGColorNight+' !important; color: '+focusFGColorNight+' !important;} 				.res-nightmode .keyHighlight a.title:first-of-type {color: '+focusFGColorNight+' !important; } 				#keyHelp { display: none; position: fixed; height: 90%; overflow-y: auto; right: 20px; top: 20px; z-index: 1000; border: 2px solid #AAAAAA; border-radius: 5px 5px 5px 5px; -moz-border-radius: 5px 5px 5px 5px; -webkit-border-radius: 5px 5px 5px 5px; width: 300px; padding: 5px; background-color: #ffffff; } 				#keyHelp th { font-weight: bold; padding: 2px; border-bottom: 1px dashed #dddddd; } 				#keyHelp td { padding: 2px; border-bottom: 1px dashed #dddddd; } 				#keyHelp td:first-child { width: 70px; } 				#keyCommandLineWidget { font-size: 14px; display: none; position: fixed; top: 200px; left: 50%; margin-left: -275px; z-index: 9999; width: 550px; border: 3px solid #555555; border-radius: 10px 10px 10px 10px; -moz-border-radius: 10px 10px 10px 10px; -webkit-border-radius: 10px 10px 10px 10px; padding: 10px; background-color: #333333; color: #CCCCCC; opacity: 0.95; } 				#keyCommandInput { width: 240px; background-color: #999999; margin-right: 10px; } 				#keyCommandInputTip { margin-top: 5px; color: #99FF99; } 				#keyCommandInputTip ul { font-size: 11px; list-style-type: disc; }  				#keyCommandInputTip li { margin-left: 15px; }  				#keyCommandInputError { margin-top: 5px; color: red; font-weight: bold; } 				.keyNavAnnotation { font-size: 9px; position: relative; top: -6px; } 			')}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){this.keyboardNavLastIndexCache=safeJSON.parse(RESStorage.getItem('RESmodules.keyboardNavLastIndex'),false,true);if(!this.keyboardNavLastIndexCache){this.keyboardNavLastIndexCache={};var a=new Date().getTime();for(idx in RESStorage){if(idx.match(/keyboardNavLastIndex/)){var b=idx.replace('RESmodules.keyboardNavLastIndex.','');this.keyboardNavLastIndexCache[b]={index:RESStorage[idx],updated:a}RESStorage.removeItem(idx)}}this.keyboardNavLastIndexCache.lastScan=a;RESStorage.setItem('RESmodules.keyboardNavLastIndex',JSON.stringify(this.keyboardNavLastIndexCache))}else{var a=new Date().getTime();if((typeof(this.keyboardNavLastIndexCache.lastScan)=='undefined')||(a-this.keyboardNavLastIndexCache.lastScan>21600000)){for(idx in this.keyboardNavLastIndexCache){if((typeof(this.keyboardNavLastIndexCache[idx])=='object')&&(a-this.keyboardNavLastIndexCache[idx].updated>3600000)){delete this.keyboardNavLastIndexCache[idx]}}this.keyboardNavLastIndexCache.lastScan=a;RESStorage.setItem('RESmodules.keyboardNavLastIndex',JSON.stringify(this.keyboardNavLastIndexCache))}}if(this.options.autoSelectOnScroll.value){window.addEventListener('scroll',modules['keyboardNav'].handleScroll,false)}if(typeof(this.options.scrollTop)!='undefined'){if(this.options.scrollTop.value)this.options.scrollStyle.value='top';delete this.options.scrollTop;RESStorage.setItem('RESoptions.keyboardNav',JSON.stringify(modules['keyboardNav'].options))}this.drawHelp();this.attachCommandLineWidget();window.addEventListener('keydown',function(e){modules['keyboardNav'].handleKeyPress(e)},true);this.scanPageForKeyboardLinks();if(RESUtils.pageType()=='comments'){RESUtils.watchForElement('newComments',modules['keyboardNav'].scanPageForNewKeyboardLinks)}else{RESUtils.watchForElement('siteTable',modules['keyboardNav'].scanPageForNewKeyboardLinks)}}},scanPageForNewKeyboardLinks:function(){modules['keyboardNav'].scanPageForKeyboardLinks(true)},setKeyIndex:function(){var a=location.href;if(a.substr(-1)=='/')a=a.substr(0,a.length-1);if(typeof(this.keyboardNavLastIndexCache[a])=='undefined'){this.keyboardNavLastIndexCache[a]={}}var b=new Date().getTime();this.keyboardNavLastIndexCache[a]={index:this.activeIndex,updated:b}RESStorage.setItem('RESmodules.keyboardNavLastIndex',JSON.stringify(this.keyboardNavLastIndexCache))},handleScroll:function(e){if(modules['keyboardNav'].scrollTimer)clearTimeout(modules['keyboardNav'].scrollTimer);modules['keyboardNav'].scrollTimer=setTimeout(modules['keyboardNav'].handleScrollAfterTimer,300)},handleScrollAfterTimer:function(){if((!modules['keyboardNav'].recentKeyPress)&&(!RESUtils.elementInViewport(modules['keyboardNav'].keyboardLinks[modules['keyboardNav'].activeIndex]))){for(var i=0,len=modules['keyboardNav'].keyboardLinks.length;i<len;i++){if(RESUtils.elementInViewport(modules['keyboardNav'].keyboardLinks[i])){modules['keyboardNav'].keyUnfocus(modules['keyboardNav'].keyboardLinks[modules['keyboardNav'].activeIndex]);modules['keyboardNav'].activeIndex=i;modules['keyboardNav'].keyFocus(modules['keyboardNav'].keyboardLinks[modules['keyboardNav'].activeIndex]);break}}}},attachCommandLineWidget:function(){this.commandLineWidget=createElementWithID('div','keyCommandLineWidget');this.commandLineInput=createElementWithID('input','keyCommandInput');this.commandLineInput.setAttribute('type','text');this.commandLineInput.addEventListener('blur',function(e){modules['keyboardNav'].toggleCmdLine(false)},false);this.commandLineInput.addEventListener('keyup',function(e){if(e.keyCode==27){modules['keyboardNav'].toggleCmdLine(false)}else{modules['keyboardNav'].cmdLineHelper(e.target.value)}},false);this.commandLineInputTip=createElementWithID('div','keyCommandInputTip');this.commandLineInputError=createElementWithID('div','keyCommandInputError');this.commandLineForm=createElementWithID('form','keyCommandForm');this.commandLineForm.appendChild(this.commandLineInput);var a=document.createTextNode('type a command, ? for help, esc to close');this.commandLineForm.appendChild(a);this.commandLineForm.appendChild(this.commandLineInputTip);this.commandLineForm.appendChild(this.commandLineInputError);this.commandLineForm.addEventListener('submit',modules['keyboardNav'].cmdLineSubmit,false);this.commandLineWidget.appendChild(this.commandLineForm);document.body.appendChild(this.commandLineWidget)},cmdLineHelper:function(a){var b=a.split(' ');var c=b[0];b.splice(0,1);var a=b.join(' ');if(c.slice(0,2)=='r/'){var d=c.slice(2);this.cmdLineShowTip('navigate to subreddit: '+d)}else if(c.slice(0,2)=='u/'){var e=c.slice(2);this.cmdLineShowTip('navigate to user profile: '+e)}else if(c.slice(0,1)=='/'){var d=c.slice(1);this.cmdLineShowTip('sort by ([n]ew, [t]op, [h]ot, [c]ontroversial): '+d)}else if(c=='tag'){if((typeof(this.cmdLineTagUsername)=='undefined')||(this.cmdLineTagUsername=='')){var f=modules['keyboardNav'].keyboardLinks[modules['keyboardNav'].activeIndex];var g=f.querySelector('a.author');this.cmdLineTagUsername=g.innerHTML}var h='tag user '+this.cmdLineTagUsername;if(a){h+=' as: '+a}this.cmdLineShowTip(h)}else if(c=='user'){var h='go to profile';if(a){h+=' for: '+a}this.cmdLineShowTip(h)}else if(c=='sw'){this.cmdLineShowTip('Switch users to: '+a)}else if(c=='m'){this.cmdLineShowTip('View messages.')}else if(c=='mm'){this.cmdLineShowTip('View moderator mail.')}else if(c=='ls'){this.cmdLineShowTip('Toggle lightSwitch.')}else if(c=='srstyle'){var h='toggle subreddit style';if(a){h+=' for: '+a}else{if(RESUtils.currentSubreddit()){h+=' for: '+RESUtils.currentSubreddit()}}this.cmdLineShowTip(h)}else if(c=='XHRCache'){this.cmdLineShowTip('clear - clear the cache (use if inline images aren\'t loading properly)')}else if(c.slice(0,1)=='?'){var h='Currently supported commands:';h+='<ul>';h+='<li>r/[subreddit] - navigates to subreddit</li>';h+='<li>/n, /t, /h or /c - goes to new, top, hot or controversial sort of current subreddit</li>';h+='<li>[number] - navigates to the link with that number (comments pages) or rank (link pages)</li>';h+='<li>tag [text] - tags author of currently selected link/comment as text</li>';h+='<li>sw [username] - switch users to [username]</li>';h+='<li>user [username] - view profile for [username]</li>';h+='<li>m - go to inbox</li>';h+='<li>mm - go to moderator mail</li>';h+='<li>ls - toggle lightSwitch</li>';h+='<li>srstyle [subreddit] [on|off] - toggle subreddit style on/off (if no subreddit is specified, uses current subreddit)</li>';h+='<li>RESStorage [get|set|update|remove] [key] [value] - For debug use only, you shouldn\'t mess with this unless you know what you\'re doing.</li>';h+='<li>XHRCache clear - manipulate the XHR cache </li>';h+='</ul>';this.cmdLineShowTip(h)}else{this.cmdLineShowTip('')}},cmdLineShowTip:function(a){$(this.commandLineInputTip).html(a)},cmdLineShowError:function(a){$(this.commandLineInputError).html(a)},toggleCmdLine:function(a){var b=(((a==null)||(a==true))&&(this.commandLineWidget.style.display!='block'))delete this.cmdLineTagUsername;if(b){this.cmdLineShowError('');this.commandLineWidget.style.display='block';setTimeout(function(){modules['keyboardNav'].commandLineInput.focus()},20);this.commandLineInput.value=''}else{modules['keyboardNav'].commandLineInput.blur();this.commandLineWidget.style.display='none'}},cmdLineSubmit:function(e){e.preventDefault();$(modules['keyboardNav'].commandLineInputError).html('');var d=modules['keyboardNav'].commandLineInput.value;if(d.indexOf('r/')!=-1){d=d.replace('/r/','').replace('r/','');location.href='/r/'+d}else if(d.indexOf('u/')!=-1){d=d.replace('/u/','').replace('u/','');location.href='/u/'+d}else if(d.indexOf('/')==0){d=d.slice(1);switch(d){case'n':d='new';break;case't':d='top';break;case'h':d='hot';break;case'c':d='controversial';break}validSorts=['new','top','hot','controversial'];if(validSorts.indexOf(d)!=-1){if(RESUtils.currentUserProfile()){location.href='/user/'+RESUtils.currentUserProfile()+'?sort='+d}else if(RESUtils.currentSubreddit()){location.href='/r/'+RESUtils.currentSubreddit()+'/'+d}else{location.href='/'+d}}else{modules['keyboardNav'].cmdLineShowError('invalid sort command - must be [n]ew, [t]op, [h]ot or [c]ontroversial');return false}}else if(!(isNaN(parseInt(d)))){if(RESUtils.pageType()=='comments'){modules['keyboardNav'].commentLink(parseInt(d)-1)}else if(RESUtils.pageType()=='linklist'){modules['keyboardNav'].keyUnfocus(modules['keyboardNav'].keyboardLinks[modules['keyboardNav'].activeIndex]);modules['keyboardNav'].activeIndex=parseInt(d)-1;modules['keyboardNav'].keyFocus(modules['keyboardNav'].keyboardLinks[modules['keyboardNav'].activeIndex]);modules['keyboardNav'].followLink()}}else{var f=d.split(' ');var g=f[0];f.splice(0,1);var h=f.join(' ');switch(g){case'tag':var j=modules['keyboardNav'].keyboardLinks[modules['keyboardNav'].activeIndex];var k=j.querySelector('a.userTagLink');if(k){RESUtils.click(k);setTimeout(function(){if(h!=''){document.getElementById('userTaggerTag').value=h}},20)}break;case'sw':if(h.length<=1){modules['keyboardNav'].cmdLineShowError('No username specified.');return false}else{var l=modules['accountSwitcher'].options.accounts.value;var m=false;for(var i=0,len=l.length;i<len;i++){var n=l[i];if(n[0]==h){m=true}}if(m){modules['accountSwitcher'].switchTo(h)}else{modules['keyboardNav'].cmdLineShowError('No such username in accountSwitcher.');return false}}break;case'user':if(h.length<=1){modules['keyboardNav'].cmdLineShowError('No username specified.');return false}else{location.href='/user/'+h}break;case'userinfo':if(h.length<=1){modules['keyboardNav'].cmdLineShowError('No username specified.');return false}else{GM_xmlhttpRequest({method:"GET",url:location.protocol+"//"+location.hostname+"/user/"+h+"/about.json?app=res",onload:function(a){alert(a.responseText)}})}break;case'userbadge':if(h.length<=1){modules['keyboardNav'].cmdLineShowError('No username specified.');return false}else{GM_xmlhttpRequest({method:"GET",url:location.protocol+"//"+location.hostname+"/user/"+h+"/about.json?app=res",onload:function(a){var b=JSON.parse(a.responseText);var c=', .id-t2_'+b.data.id+':before';alert(c)}})}break;case'm':location.href='/message/inbox/';break;case'mm':location.href='/message/moderator/';break;case'ls':RESUtils.click(modules['styleTweaks'].lightSwitch);break;case'srstyle':var o;var p;var f=h.split(' ');if(f.length==2){o=f[0];p=f[1]}else{o=RESUtils.currentSubreddit();p=f[0]}if(!o){modules['keyboardNav'].cmdLineShowError('No subreddit specified.');return false}if(p=='on'){toggle=true}else if(p=='off'){toggle=false}else{modules['keyboardNav'].cmdLineShowError('You must specify "on" or "off".');return false}var q=(toggle)?'enabled':'disabled';modules['styleTweaks'].toggleSubredditStyle(toggle,o);RESUtils.notification('Subreddit style '+q+' for subreddit: '+o,4000);break;case'notification':RESUtils.notification(h,4000);break;case'RESStorage':var f=h.split(' ');if(f.length<2){modules['keyboardNav'].cmdLineShowError('You must specify "get [key]", "update [key]" or "set [key] [value]"')}else{var g=f[0];var r=f[1];if(f.length>2){f.splice(0,2);var s=f.join(' ')}if(g=='get'){alert('Value of RESStorage['+r+']: <br><br><textarea rows="5" cols="50">'+RESStorage.getItem(r)+'</textarea>')}else if(g=='update'){var t=new Date().getTime();alert('Value of RESStorage['+r+']: <br><br><textarea id="RESStorageUpdate'+t+'" rows="5" cols="50">'+RESStorage.getItem(r)+'</textarea>',function(){var a=document.getElementById('RESStorageUpdate'+t);if(a){var b=a.value;RESStorage.setItem(r,b)}})}else if(g=='remove'){RESStorage.removeItem(r);alert('RESStorage['+r+'] deleted')}else if(g=='set'){RESStorage.setItem(r,s);alert('RESStorage['+r+'] set to:<br><br><textarea rows="5" cols="50">'+s+'</textarea>')}else{modules['keyboardNav'].cmdLineShowError('You must specify either "get [key]" or "set [key] [value]"')}}break;case'XHRCache':var f=h.split(' ');if(f.length<1){modules['keyboardNav'].cmdLineShowError('Operation required [clear]')}else{switch(f[0]){case'clear':RESUtils.xhrCache('clear');break;default:modules['keyboardNav'].cmdLineShowError('The only accepted operation is <tt>clear</tt>');break}}break;case'?':return false;break;default:modules['keyboardNav'].cmdLineShowError('unknown command - type ? for help');return false;break}}modules['keyboardNav'].toggleCmdLine(false)},scanPageForKeyboardLinks:function(b){if(typeof(b)=='undefined'){b=false}this.pageType=RESUtils.pageType();switch(this.pageType){case'linklist':case'profile':var c=document.querySelector('#siteTable');var d=document.querySelectorAll('#siteTable');if(d.length==2){c=d[1]}if(c){this.keyboardLinks=document.body.querySelectorAll('div.linklisting .entry');if(!b){if((this.keyboardNavLastIndexCache[location.href])&&(this.keyboardNavLastIndexCache[location.href].index>0)){this.activeIndex=this.keyboardNavLastIndexCache[location.href].index}else{this.activeIndex=0}if((this.keyboardNavLastIndexCache[location.href])&&(this.keyboardNavLastIndexCache[location.href].index>=this.keyboardLinks.length)){this.activeIndex=0}}}break;case'comments':this.keyboardLinks=document.body.querySelectorAll('#siteTable .entry, div.content > div.commentarea .entry');if(!(b)){this.activeIndex=0}break;case'inbox':var c=document.querySelector('#siteTable');if(c){this.keyboardLinks=c.querySelectorAll('.entry');this.activeIndex=0}break}if((typeof(this.keyboardLinks)!='undefined')&&(this.options.clickFocus.value)){for(var i=0,len=this.keyboardLinks.length;i<len;i++){this.keyboardLinks[i].setAttribute('keyIndex',i);this.keyboardLinks[i].parentNode.addEventListener('click',(function(e){var a=parseInt(this.getAttribute('keyIndex'));if(modules['keyboardNav'].activeIndex!=a){modules['keyboardNav'].keyUnfocus(modules['keyboardNav'].keyboardLinks[modules['keyboardNav'].activeIndex]);modules['keyboardNav'].activeIndex=a;modules['keyboardNav'].keyFocus(modules['keyboardNav'].keyboardLinks[modules['keyboardNav'].activeIndex])}}).bind(this.keyboardLinks[i]),true)}this.keyFocus(this.keyboardLinks[this.activeIndex])}},recentKey:function(){modules['keyboardNav'].recentKeyPress=true;clearTimeout(modules['keyboardNav'].recentKey);modules['keyboardNav'].recentKeyTimer=setTimeout(function(){modules['keyboardNav'].recentKeyPress=false},1000)},keyFocus:function(a){if((typeof(a)!='undefined')&&(hasClass(a,'keyHighlight'))){return false}else if(typeof(a)!='undefined'){addClass(a,'keyHighlight');if((this.pageType=='linklist')||(this.pageType=='profile')){this.setKeyIndex()}if((this.pageType=='comments')&&(this.options.commentsLinkNumbers.value)){var b=a.querySelectorAll('div.md a');var c=0;for(var i=0,len=b.length;i<len;i++){if(!(hasClass(b[i],'madeVisible')||hasClass(b[i],'toggleImage')||hasClass(b[i],'noKeyNav')||RESUtils.isCommentCode(b[i]))){var d=document.createElement('span');c++;$(d).text('['+c+'] ');d.title='press '+c+' to open link';addClass(d,'keyNavAnnotation');if(modules['keyboardNav'].options.commentsLinkNumberPosition.value=='right'){insertAfter(b[i],d)}else{b[i].parentNode.insertBefore(d,b[i])}}}}}},handleKeyLink:function(a){var b=0;if((modules['keyboardNav'].options.commentsLinkNewTab.value)||e.ctrlKey){b=1}if(hasClass(a,'toggleImage')){RESUtils.click(a);return false}var c=a.getAttribute('href');var d=(c.indexOf('reddit')!=-1)&&(c.indexOf('comments')!=-1)&&(c.indexOf('#')!=-1);if((!d)&&(b==1)){if(typeof(chrome)!='undefined'){var f={requestType:'keyboardNav',linkURL:c,button:b};chrome.extension.sendMessage(f)}else if(typeof(safari)!='undefined'){var f={requestType:'keyboardNav',linkURL:c,button:b}safari.self.tab.dispatchMessage("keyboardNav",f)}else if(typeof(opera)!='undefined'){var f={requestType:'keyboardNav',linkURL:c,button:b}opera.extension.postMessage(JSON.stringify(f))}else if(typeof(self.on)=='function'){var f={requestType:'keyboardNav',linkURL:c,button:b}self.postMessage(f)}else{window.open(this.getAttribute('href'))}}else{location.href=this.getAttribute('href')}},keyUnfocus:function(a){removeClass(a,'keyHighlight');if(this.pageType=='comments'){var b=a.querySelectorAll('div.md .keyNavAnnotation');for(var i=0,len=b.length;i<len;i++){b[i].parentNode.removeChild(b[i])}}},drawHelp:function(){var a=createElementWithID('div','keyHelp');var b=document.createElement('table');a.appendChild(b);var c=document.createElement('thead');var d=document.createElement('tr');var e=document.createElement('th');$(e).text('Key');d.appendChild(e);var f=document.createElement('th');$(f).text('Function');d.appendChild(f);c.appendChild(d);b.appendChild(c);var g=document.createElement('tbody');var h=new RegExp(/^link[\d]+$/i);for(var i in this.options){if((this.options[i].type=='keycode')&&(!h.test(i))){var j=document.createElement('tr');var k=document.createElement('td');var l=this.options[i].value;if(typeof(l)=='string'){keyCodeAarray=parseInt(l)}if(typeof(l)=='number'){l=[l,false,false,false,false]}$(k).html(RESUtils.niceKeyCode(l));j.appendChild(k);var m=document.createElement('td');$(m).html(this.options[i].description);j.appendChild(m);g.appendChild(j)}}b.appendChild(g);document.body.appendChild(a)},handleKeyPress:function(e){var a=(typeof(konami)=='undefined')||(!konami.almostThere)if((document.activeElement.tagName=='BODY')&&(a)){var b=[e.keyCode,e.altKey,e.ctrlKey,e.shiftKey,e.metaKey];switch(this.pageType){case'linklist':case'profile':switch(true){case keyArrayCompare(b,this.options.moveUp.value):this.moveUp();break;case keyArrayCompare(b,this.options.moveDown.value):this.moveDown();break;case keyArrayCompare(b,this.options.moveTop.value):this.moveTop();break;case keyArrayCompare(b,this.options.moveBottom.value):this.moveBottom();break;case keyArrayCompare(b,this.options.followLink.value):this.followLink();break;case keyArrayCompare(b,this.options.followLinkNewTab.value):e.preventDefault();this.followLink(true);break;case keyArrayCompare(b,this.options.followComments.value):this.followComments();break;case keyArrayCompare(b,this.options.followCommentsNewTab.value):e.preventDefault();this.followComments(true);break;case keyArrayCompare(b,this.options.toggleExpando.value):this.toggleExpando();break;case keyArrayCompare(b,this.options.previousGalleryImage.value):this.previousGalleryImage();break;case keyArrayCompare(b,this.options.nextGalleryImage.value):this.nextGalleryImage();break;case keyArrayCompare(b,this.options.toggleViewImages.value):this.toggleViewImages();break;case keyArrayCompare(b,this.options.followLinkAndCommentsNewTab.value):e.preventDefault();this.followLinkAndComments();break;case keyArrayCompare(b,this.options.followLinkAndCommentsNewTabBG.value):e.preventDefault();this.followLinkAndComments(true);break;case keyArrayCompare(b,this.options.upVote.value):this.upVote(true);break;case keyArrayCompare(b,this.options.downVote.value):this.downVote(true);break;case keyArrayCompare(b,this.options.save.value):this.saveLink();break;case keyArrayCompare(b,this.options.inbox.value):e.preventDefault();this.inbox();break;case keyArrayCompare(b,this.options.inboxNewTab.value):e.preventDefault();this.inbox(true);break;case keyArrayCompare(b,this.options.frontPage.value):e.preventDefault();this.frontPage();break;case keyArrayCompare(b,this.options.nextPage.value):e.preventDefault();this.nextPage();break;case keyArrayCompare(b,this.options.prevPage.value):e.preventDefault();this.prevPage();break;case keyArrayCompare(b,this.options.toggleHelp.value):this.toggleHelp();break;case keyArrayCompare(b,this.options.toggleCmdLine.value):this.toggleCmdLine();break;case keyArrayCompare(b,this.options.hide.value):this.hide();break;case keyArrayCompare(b,this.options.followSubreddit.value):this.followSubreddit();break;case keyArrayCompare(b,this.options.followSubredditNewTab.value):this.followSubreddit(true);break;default:break}break;case'comments':switch(true){case keyArrayCompare(b,this.options.toggleHelp.value):this.toggleHelp();break;case keyArrayCompare(b,this.options.toggleCmdLine.value):this.toggleCmdLine();break;case keyArrayCompare(b,this.options.moveUp.value):this.moveUp();break;case keyArrayCompare(b,this.options.moveDown.value):this.moveDown();break;case keyArrayCompare(b,this.options.moveUpSibling.value):this.moveUpSibling();break;case keyArrayCompare(b,this.options.moveDownSibling.value):this.moveDownSibling();break;case keyArrayCompare(b,this.options.moveToParent.value):this.moveToParent();break;case keyArrayCompare(b,this.options.toggleChildren.value):this.toggleChildren();break;case keyArrayCompare(b,this.options.followLinkNewTab.value):if(this.activeIndex==0){e.preventDefault();this.followLink(true)}break;case keyArrayCompare(b,this.options.save.value):if(this.activeIndex==0){this.saveLink()}else{this.saveComment()}break;case keyArrayCompare(b,this.options.toggleExpando.value):this.toggleAllExpandos();break;case keyArrayCompare(b,this.options.previousGalleryImage.value):this.previousGalleryImage();break;case keyArrayCompare(b,this.options.nextGalleryImage.value):this.nextGalleryImage();break;case keyArrayCompare(b,this.options.toggleViewImages.value):this.toggleViewImages();break;case keyArrayCompare(b,this.options.upVote.value):this.upVote();break;case keyArrayCompare(b,this.options.downVote.value):this.downVote();break;case keyArrayCompare(b,this.options.reply.value):e.preventDefault();this.reply();break;case keyArrayCompare(b,this.options.inbox.value):e.preventDefault();this.inbox();break;case keyArrayCompare(b,this.options.inboxNewTab.value):e.preventDefault();this.inbox(true);break;case keyArrayCompare(b,this.options.frontPage.value):e.preventDefault();this.frontPage();break;case keyArrayCompare(b,this.options.subredditFrontPage.value):e.preventDefault();this.frontPage(true);break;case keyArrayCompare(b,this.options.link1.value):e.preventDefault();this.commentLink(0);break;case keyArrayCompare(b,this.options.link2.value):e.preventDefault();this.commentLink(1);break;case keyArrayCompare(b,this.options.link3.value):e.preventDefault();this.commentLink(2);break;case keyArrayCompare(b,this.options.link4.value):e.preventDefault();this.commentLink(3);break;case keyArrayCompare(b,this.options.link5.value):e.preventDefault();this.commentLink(4);break;case keyArrayCompare(b,this.options.link6.value):e.preventDefault();this.commentLink(5);break;case keyArrayCompare(b,this.options.link7.value):e.preventDefault();this.commentLink(6);break;case keyArrayCompare(b,this.options.link8.value):e.preventDefault();this.commentLink(7);break;case keyArrayCompare(b,this.options.link9.value):e.preventDefault();this.commentLink(8);break;case keyArrayCompare(b,this.options.link10.value):e.preventDefault();this.commentLink(9);break;default:break}break;case'inbox':switch(true){case keyArrayCompare(b,this.options.toggleHelp.value):this.toggleHelp();break;case keyArrayCompare(b,this.options.toggleCmdLine.value):this.toggleCmdLine();break;case keyArrayCompare(b,this.options.moveUp.value):this.moveUp();break;case keyArrayCompare(b,this.options.moveDown.value):this.moveDown();break;case keyArrayCompare(b,this.options.toggleChildren.value):this.toggleChildren();break;case keyArrayCompare(b,this.options.upVote.value):this.upVote();break;case keyArrayCompare(b,this.options.downVote.value):this.downVote();break;case keyArrayCompare(b,this.options.reply.value):e.preventDefault();this.reply();break;case keyArrayCompare(b,this.options.frontPage.value):e.preventDefault();this.frontPage();break;default:break}break}}else{}},toggleHelp:function(){(document.getElementById('keyHelp').style.display=='block')?this.hideHelp():this.showHelp()},showHelp:function(){RESUtils.fadeElementIn(document.getElementById('keyHelp'),0.3)},hideHelp:function(){RESUtils.fadeElementOut(document.getElementById('keyHelp'),0.3)},hide:function(){var a=this.keyboardLinks[this.activeIndex].querySelector('form.hide-button > span > a');RESUtils.click(a);if(this.options.onHideMoveDown.value){this.moveDown()}},followSubreddit:function(a){var b=this.keyboardLinks[this.activeIndex].querySelector('A.subreddit');if(b){var c=b.getAttribute('href');if(a){var d=(this.options.followLinkNewTabFocus.value)?0:1;if(typeof(chrome)!='undefined'){var e={requestType:'keyboardNav',linkURL:c,button:d};chrome.extension.sendMessage(e)}else if(typeof(safari)!='undefined'){var e={requestType:'keyboardNav',linkURL:c,button:d}safari.self.tab.dispatchMessage("keyboardNav",e)}else if(typeof(opera)!='undefined'){var e={requestType:'keyboardNav',linkURL:c,button:d}opera.extension.postMessage(JSON.stringify(e))}else if(typeof(self.on)=='function'){var e={requestType:'keyboardNav',linkURL:c,button:d}self.postMessage(e)}else{window.open(c)}}else{location.href=c}}},moveUp:function(){if(this.activeIndex>0){this.keyUnfocus(this.keyboardLinks[this.activeIndex]);this.activeIndex--;var a=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex]);while((a.x==0)&&(a.y==0)&&(this.activeIndex>0)){this.activeIndex--;a=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex])}this.keyFocus(this.keyboardLinks[this.activeIndex]);if((!(RESUtils.elementInViewport(this.keyboardLinks[this.activeIndex])))||(this.options.scrollStyle.value=='top')){RESUtils.scrollTo(0,a.y)}modules['keyboardNav'].recentKey()}},moveDown:function(){if(this.activeIndex<this.keyboardLinks.length-1){this.keyUnfocus(this.keyboardLinks[this.activeIndex]);this.activeIndex++;var a=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex]);while((a.x==0)&&(a.y==0)&&(this.activeIndex<this.keyboardLinks.length-1)){this.activeIndex++;a=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex])}this.keyFocus(this.keyboardLinks[this.activeIndex]);if(this.options.scrollStyle.value=='top'){RESUtils.scrollTo(0,a.y)}else if((!(RESUtils.elementInViewport(this.keyboardLinks[this.activeIndex])))){var b=this.keyboardLinks[this.activeIndex].offsetHeight;if(this.options.scrollStyle.value=='page'){RESUtils.scrollTo(0,a.y)}else{RESUtils.scrollTo(0,a.y-window.innerHeight+b+5)}}if((RESUtils.pageType()=='linklist')&&(this.activeIndex==(this.keyboardLinks.length-1)&&(modules['neverEndingReddit'].isEnabled()&&modules['neverEndingReddit'].options.autoLoad.value))){this.nextPage()}modules['keyboardNav'].recentKey()}},moveTop:function(){this.keyUnfocus(this.keyboardLinks[this.activeIndex]);this.activeIndex=0;this.keyFocus(this.keyboardLinks[this.activeIndex]);var a=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex]);if(!(RESUtils.elementInViewport(this.keyboardLinks[this.activeIndex]))){RESUtils.scrollTo(0,a.y)}modules['keyboardNav'].recentKey()},moveBottom:function(){this.keyUnfocus(this.keyboardLinks[this.activeIndex]);this.activeIndex=this.keyboardLinks.length-1;this.keyFocus(this.keyboardLinks[this.activeIndex]);var a=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex]);if(!(RESUtils.elementInViewport(this.keyboardLinks[this.activeIndex]))){RESUtils.scrollTo(0,a.y)}modules['keyboardNav'].recentKey()},moveDownSibling:function(){if(this.activeIndex<this.keyboardLinks.length-1){this.keyUnfocus(this.keyboardLinks[this.activeIndex]);var a=this.keyboardLinks[this.activeIndex].parentNode;var b=a.querySelectorAll('.entry').length;this.activeIndex+=b;var c=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex]);while((c.x==0)&&(c.y==0)&&(this.activeIndex<this.keyboardLinks.length-1)){this.activeIndex++;c=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex])}if((this.pageType=='linklist')||(this.pageType=='profile')){this.setKeyIndex()}this.keyFocus(this.keyboardLinks[this.activeIndex]);if(!(RESUtils.elementInViewport(this.keyboardLinks[this.activeIndex]))){RESUtils.scrollTo(0,c.y)}}modules['keyboardNav'].recentKey()},moveUpSibling:function(){if(this.activeIndex<this.keyboardLinks.length-1){this.keyUnfocus(this.keyboardLinks[this.activeIndex]);var a=this.keyboardLinks[this.activeIndex].parentNode;if(a.previousSibling!=null){var b=a.previousSibling.previousSibling.querySelectorAll('.entry').length}else{var b=1}this.activeIndex-=b;var c=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex]);while((c.x==0)&&(c.y==0)&&(this.activeIndex<this.keyboardLinks.length-1)){this.activeIndex++;c=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex])}if((this.pageType=='linklist')||(this.pageType=='profile')){this.setKeyIndex()}this.keyFocus(this.keyboardLinks[this.activeIndex]);if(!(RESUtils.elementInViewport(this.keyboardLinks[this.activeIndex]))){RESUtils.scrollTo(0,c.y)}}modules['keyboardNav'].recentKey()},moveToParent:function(){if((this.activeIndex<this.keyboardLinks.length-1)&&(this.activeIndex>1)){var a=this.keyboardLinks[this.activeIndex].parentNode;if(!hasClass(a.parentNode.parentNode.parentNode,'content')){if(a!=null){this.keyUnfocus(this.keyboardLinks[this.activeIndex]);var b=a.parentNode.parentNode.previousSibling;var c=parseInt(b.getAttribute('keyindex'));this.activeIndex=c;this.keyFocus(this.keyboardLinks[this.activeIndex]);var d=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex]);if(!(RESUtils.elementInViewport(this.keyboardLinks[this.activeIndex]))){RESUtils.scrollTo(0,d.y)}}}}modules['keyboardNav'].recentKey()},toggleChildren:function(){if(this.activeIndex==0){this.followLink()}else{var a=this.keyboardLinks[this.activeIndex].querySelector('div.collapsed');var b=this.keyboardLinks[this.activeIndex].querySelector('div.noncollapsed');if(a.style.display!='none'){thisToggle=a.querySelector('a.expand')}else{moreComments=b.querySelector('span.morecomments > a');if(moreComments){thisToggle=moreComments}else{thisToggle=b.querySelector('a.expand')}contThread=b.querySelector('span.deepthread > a');if(contThread){thisToggle=contThread}}RESUtils.click(thisToggle)}},toggleExpando:function(){var a=this.keyboardLinks[this.activeIndex].querySelector('.expando-button');if(a){RESUtils.click(a);if(this.options.scrollOnExpando.value){var b=RESUtils.getXYpos(this.keyboardLinks[this.activeIndex]);RESUtils.scrollTo(0,b.y)}}},previousGalleryImage:function(){var a=this.keyboardLinks[this.activeIndex].querySelector('.RESGalleryControls .previous');if(a){RESUtils.click(a)}},nextGalleryImage:function(){var a=this.keyboardLinks[this.activeIndex].querySelector('.RESGalleryControls .next');if(a){RESUtils.click(a)}},toggleViewImages:function(){var a=document.body.querySelector('#viewImagesButton');if(a){RESUtils.click(a)}},toggleAllExpandos:function(){var a=this.keyboardLinks[this.activeIndex].querySelectorAll('.expando-button');if(a){for(var i=0,len=a.length;i<len;i++){RESUtils.click(a[i])}}},followLink:function(a){var b=this.keyboardLinks[this.activeIndex].querySelector('a.title');var c=b.getAttribute('href');if(a){var d=(this.options.followLinkNewTabFocus.value)?0:1;if(typeof(chrome)!='undefined'){var e={requestType:'keyboardNav',linkURL:c,button:d};chrome.extension.sendMessage(e)}else if(typeof(safari)!='undefined'){var e={requestType:'keyboardNav',linkURL:c,button:d}safari.self.tab.dispatchMessage("keyboardNav",e)}else if(typeof(opera)!='undefined'){var e={requestType:'keyboardNav',linkURL:c,button:d}opera.extension.postMessage(JSON.stringify(e))}else if(typeof(self.on)=='function'){var e={requestType:'keyboardNav',linkURL:c,button:d}self.postMessage(e)}else{window.open(c)}}else{location.href=c}},followComments:function(a){var b=this.keyboardLinks[this.activeIndex].querySelector('a.comments');var c=b.getAttribute('href');if(a){if(typeof(chrome)!='undefined'){var d={requestType:'keyboardNav',linkURL:c};chrome.extension.sendMessage(d)}else if(typeof(safari)!='undefined'){var d={requestType:'keyboardNav',linkURL:c}safari.self.tab.dispatchMessage("keyboardNav",d)}else if(typeof(opera)!='undefined'){var d={requestType:'keyboardNav',linkURL:c}opera.extension.postMessage(JSON.stringify(d))}else if(typeof(self.on)=='function'){var d={requestType:'keyboardNav',linkURL:c}self.postMessage(d)}else{window.open(c)}}else{location.href=c}},followLinkAndComments:function(a){var b=this.keyboardLinks[this.activeIndex].querySelector('.redditSingleClick');RESUtils.mousedown(b,a)},upVote:function(a){if(typeof(this.keyboardLinks[this.activeIndex])=='undefined')return false;if(this.keyboardLinks[this.activeIndex].previousSibling.tagName=='A'){var b=this.keyboardLinks[this.activeIndex].previousSibling.previousSibling.querySelector('div.up')||this.keyboardLinks[this.activeIndex].previousSibling.previousSibling.querySelector('div.upmod')}else{var b=this.keyboardLinks[this.activeIndex].previousSibling.querySelector('div.up')||this.keyboardLinks[this.activeIndex].previousSibling.querySelector('div.upmod')}RESUtils.click(b);if(a&&this.options.onVoteMoveDown.value){this.moveDown()}},downVote:function(a){if(typeof(this.keyboardLinks[this.activeIndex])=='undefined')return false;if(this.keyboardLinks[this.activeIndex].previousSibling.tagName=='A'){var b=this.keyboardLinks[this.activeIndex].previousSibling.previousSibling.querySelector('div.down')||this.keyboardLinks[this.activeIndex].previousSibling.previousSibling.querySelector('div.downmod')}else{var b=this.keyboardLinks[this.activeIndex].previousSibling.querySelector('div.down')||this.keyboardLinks[this.activeIndex].previousSibling.querySelector('div.downmod')}RESUtils.click(b);if(a&&this.options.onVoteMoveDown.value){this.moveDown()}},saveLink:function(){var a=this.keyboardLinks[this.activeIndex].querySelector('form.save-button > span > a');if(a)RESUtils.click(a)},saveComment:function(){var a=this.keyboardLinks[this.activeIndex].querySelector('.saveComments');if(a)RESUtils.click(a)},reply:function(){if((this.activeIndex>0)||(RESUtils.pageType('comments')!=true)){if((RESUtils.pageType('comments'))&&(this.activeIndex==0)&&(!location.href.match('/message/'))){$('.usertext-edit textarea:first').focus()}else{var a=this.keyboardLinks[this.activeIndex].querySelectorAll('ul.buttons > li > a');for(var i=0,len=a.length;i<len;i++){if(a[i].innerHTML=='reply'){RESUtils.click(a[i])}}}}else{infoBar=document.body.querySelector('.infobar');if(infoBar){var b=this.keyboardLinks[this.activeIndex].querySelector('ul.buttons > li > a.comments');location.href=b.getAttribute('href')}else{var c=document.querySelector('.commentarea textarea[name=text]');c.focus()}}},inbox:function(a){var b=location.protocol+'//'+location.hostname+'/message/inbox/';if(a){if(typeof(chrome)!='undefined'){var c={requestType:'keyboardNav',linkURL:b};chrome.extension.sendMessage(c)}else if(typeof(safari)!='undefined'){var c={requestType:'keyboardNav',linkURL:b}safari.self.tab.dispatchMessage("keyboardNav",c)}else if(typeof(opera)!='undefined'){var c={requestType:'keyboardNav',linkURL:b}opera.extension.postMessage(JSON.stringify(c))}else{window.open(b)}}else{location.href=location.protocol+'//'+location.hostname+'/message/inbox/'}},frontPage:function(a){var b=location.protocol+'//'+location.hostname+'/';if(a){b+='r/'+RESUtils.currentSubreddit()}location.href=b},nextPage:function(){if((modules['neverEndingReddit'].isEnabled())&&(modules['neverEndingReddit'].progressIndicator)){RESUtils.click(modules['neverEndingReddit'].progressIndicator);this.moveBottom()}else{var a=document.body.querySelectorAll('.content .nextprev a');if(a.length>0){var b=a[a.length-1];location.href=b.getAttribute('href')}}},prevPage:function(){if(modules['neverEndingReddit'].isEnabled()){return false}else{var a=document.body.querySelectorAll('.content .nextprev a');if(a.length>0){var b=a[0];location.href=b.getAttribute('href')}}},commentLink:function(a){if(this.options.commentsLinkNumbers.value){var b=this.keyboardLinks[this.activeIndex].querySelectorAll('div.md a:not(.expando-button):not(.madeVisible)');if(typeof(b[a])!='undefined'){var c=b[a];if((c.nextSibling)&&(typeof(c.nextSibling.tagName)!='undefined')&&(hasClass(c.nextSibling,'expando-button'))){c=c.nextSibling}this.handleKeyLink(c)}}}};modules['userTagger']={moduleID:'userTagger',moduleName:'User Tagger',category:'Users',options:{hardIgnore:{type:'boolean',value:false,description:'If "hard ignore" is off, only post titles and comment text is hidden. If it is on, the entire block is hidden (or in comments, collapsed).'},colorUser:{type:'boolean',value:true,description:'Color users based on cumulative upvotes / downvotes'},storeSourceLink:{type:'boolean',value:true,description:'By default, store a link to the link/comment you tagged a user on'},hoverInfo:{type:'boolean',value:true,description:'Show information on user (karma, how long they\'ve been a redditor) on hover.'},hoverDelay:{type:'text',value:400,description:'Delay, in milliseconds, before hover tooltip loads. Default is 400.'},fadeDelay:{type:'text',value:200,description:'Delay, in milliseconds, before hover tooltip fades away. Default is 200.'},fadeSpeed:{type:'text',value:0.3,description:'Fade animation\'s speed. Default is 0.3, the range is 0-1. Setting the speed to 1 will disable the animation.'},USDateFormat:{type:'boolean',value:false,description:'Show date (redditor since...) in US format (i.e. 08-31-2010)'},vwNumber:{type:'boolean',value:true,description:'Show the number (i.e. [+6]) rather than [vw]'},vwTooltip:{type:'boolean',value:true,description:'Show the vote weight tooltip on hover (i.e. "your votes for...")'}},description:'Adds a great deal of customization around users - tagging them, ignoring them, and more.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},include:Array(/^https?:\/\/([-\w\.]+\.)?reddit\.com\/[-\w\.]*/i),beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){var a='.comment .tagline { display: inline; }';a+='#userTaggerToolTip { display: none; position: absolute; width: 334px; height: 248px; }';a+='#userTaggerToolTip label { margin-top: 5px; clear: both; float: left; width: 110px; }';a+='#userTaggerToolTip input[type=text], #userTaggerToolTip select { margin-top: 5px; float: left; width: 195px; border: 1px solid #c7c7c7; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; margin-bottom: 6px; }';a+='#userTaggerToolTip input[type=checkbox] { margin-top: 5px; float: left; }';a+='#userTaggerToolTip input[type=submit] { cursor: pointer; position: absolute; right: 16px; bottom: 16px; padding-top: 3px; padding-bottom: 3px; padding-left: 5px; padding-right: 5px; font-size: 12px; color: #ffffff; border: 1px solid #636363; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; background-color: #5cc410; } ';a+='#userTaggerToolTip .toggleButton { margin-top: 5px; margin-bottom: 5px; }';a+='#userTaggerClose { position: absolute; right: 7px; top: 7px; z-index: 11; }';a+='.ignoredUserComment { color: #CACACA; padding: 3px; font-size: 10px; }';a+='.ignoredUserPost { color: #CACACA; padding: 3px; font-size: 10px; }';a+='a.voteWeight { text-decoration: none; color: #336699; }';a+='a.voteWeight:hover { text-decoration: none; }';a+='#authorInfoToolTip { display: none; position: absolute; width: 412px; z-index: 10001; }';a+='#authorInfoToolTip .authorLabel { float: left; width: 140px; margin-bottom: 12px; }';a+='#authorInfoToolTip .authorDetail { float: left; width: 240px; margin-bottom: 12px; }';a+='#authorInfoToolTip .blueButton { float: right; margin-left: 8px; cursor: pointer; margin-top: 12px; padding-top: 3px; padding-bottom: 3px; padding-left: 5px; padding-right: 5px; font-size: 12px; color: #ffffff !important; border: 1px solid #636363; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; background-color: #107ac4; }';a+='#authorInfoToolTip .redButton { float: right; margin-left: 8px; cursor: pointer; margin-top: 12px; padding-top: 3px; padding-bottom: 3px; padding-left: 5px; padding-right: 5px; font-size: 12px; color: #ffffff !important; border: 1px solid #bc3d1b; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; background-color: #ff5757; }';a+='#benefits { width: 200px; margin-left: 0px; }';a+='#userTaggerToolTip #userTaggerVoteWeight { width: 30px; }';a+='.RESUserTagImage { display: inline-block; width: 16px; height: 8px; background-image: url(\'http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png\'); background-repeat: no-repeat; background-position: -16px -137px; }';a+='.userTagLink { display: inline-block; }';a+='.hoverHelp { margin-left: 3px; cursor: pointer; color: #336699; text-decoration: underline; }';a+='.userTagLink.hasTag, #userTaggerPreview { display: inline-block; padding: 0px 4px 0px 4px; border: 1px solid #c7c7c7; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; }';a+='#userTaggerPreview { float: left; height: 16px; margin-bottom: 10px; }';a+='#userTaggerToolTip .toggleButton .toggleOn { background-color: #107ac4; color: #ffffff;  }';a+='#userTaggerToolTip .toggleButton.enabled .toggleOn { background-color: #dddddd ; color: #636363; }';a+='#userTaggerToolTip .toggleButton.enabled .toggleOff { background-color: #d02020; color: #ffffff; }';a+='#userTaggerToolTip .toggleButton .toggleOff { background-color: #dddddd; color: #636363; } ';a+='#userTaggerTable th { -moz-user-select: none; -webkit-user-select: none; -o-user-select: none; user-select: none; }'css+='#userTaggerTable tbody .deleteButton { cursor: pointer; width: 16px; height: 16px; background-image: url(data:image/gif;base64,R0lGODlhEAAQAOZOAP///3F6hcopAJMAAP/M//Hz9OTr8ZqksMTL1P8pAP9MDP9sFP+DIP8zAO7x8/D1/LnEz+vx+Flha+Ln7OLm61hhayk0QCo1QMfR2eDo8b/K1M/U2pqiqcfP15WcpcLK05ymsig0P2lyftnf5naBi8XJzZ6lrJGdqmBqdKissYyZpf/+/puotNzk66ayvtbc4rC7x9Xd5n+KlbG7xpiirnJ+ivDz9KKrtrvH1Ojv9ePq8HF8h2x2gvj9/yYyPmRueFxlb4eRm+71+kFLVdrb3c/X4KOnrYGMl3uGke/0+5Sgq1ZfaY6Xn/X4+f///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAE4ALAAAAAAQABAAAAexgE6CggGFAYOIiAEPEREPh4lOhpOUgwEAmJmaABuQAUktMUUYGhAwLiwnKp41REYmHB5MQUcyN0iQTjsAHU05ICM4SjMQJIg8AAgFBgcvE5gUJYgiycsHDisCApjagj/VzAACBATa5AJOKOAHAAMMDOTvA05A6w7tC/kL804V9uIKAipA52QJgA82dNAQRyBBgwYJyjmRgKmHkAztHA4YAJHfEB8hLFxI0W4AACcbnQQCADs=)}';RESUtils.addCSS(a)}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){this.usernameRE=/(?:u|user)\/([\w\-]+)/;var a=RESStorage.getItem('RESmodules.userTagger.tags');this.tags=null;if(typeof(a)!='undefined')this.tags=safeJSON.parse(a,'RESmodules.userTagger.tags',true);if(this.tags==null){this.updateTagStorage()}if(RESUtils.currentSubreddit('dashboard')){modules['dashboard'].addTab('userTaggerContents','My User Tags');var b=$('<div class="show">Show:</div>')var c=$('<select id="tagFilter"><option>tagged users</option><option>all users</option></select>')$(b).append(c);$('#userTaggerContents').append(b);$('#tagFilter').change(function(){modules['userTagger'].drawUserTagTable()});var d=parseInt(modules['dashboard'].options['tagsPerPage'].value);if(d){var f=document.createElement('div');f.id='tagPageControls';f.className='RESGalleryControls';f.page=1;f.pageCount=1;var g=document.createElement("a");g.className='previous noKeyNav';g.addEventListener('click',function(e){if(f.page==1){f.page=f.pageCount}else{f.page-=1}modules['userTagger'].drawUserTagTable()});f.appendChild(g);var h=document.createElement('span');h.className='RESGalleryLabel';h.textContent="1 of 2";f.appendChild(h);var i=document.createElement("a");i.className='next noKeyNav';i.addEventListener('click',function(e){if(f.page==f.pageCount){f.page=1}else{f.page+=1}modules['userTagger'].drawUserTagTable()});f.appendChild(i);$('#userTaggerContents').append(f)}var j=$('<table id="userTaggerTable" />');$(j).append('<thead><tr><th sort="" class="active">Username <span class="sortAsc"></span></th><th sort="tag">Tag</th><th sort="ignore">Ignored</th><th sort="color">Color</th><th sort="votes">Vote Weight</th></tr></thead><tbody></tbody>');$('#userTaggerContents').append(j);$('#userTaggerTable thead th').click(function(e){e.preventDefault();if($(this).hasClass('delete')){return false}if($(this).hasClass('active')){$(this).toggleClass('descending')}$(this).addClass('active');$(this).siblings().removeClass('active').find('SPAN').remove();$(this).find('.sortAsc, .sortDesc').remove();($(e.target).hasClass('descending'))?$(this).append('<span class="sortDesc" />'):$(this).append('<span class="sortAsc" />');modules['userTagger'].drawUserTagTable($(e.target).attr('sort'),$(e.target).hasClass('descending'))});this.drawUserTagTable()}this.authorInfoCache=[];if(this.options.colorUser.value){this.attachVoteHandlers(document.body)}this.userTaggerToolTip=createElementWithID('div','userTaggerToolTip','RESDialogSmall');var k='<h3>Tag User</h3><div id="userTaggerToolTipContents" class="RESDialogContents clear">';k+='<form name="userTaggerForm" action=""><input type="hidden" id="userTaggerName" value="">';k+='<label for="userTaggerTag">Tag</label> <input type="text" id="userTaggerTag" value="">';k+='<div id="userTaggerClose" class="RESCloseButton">&times;</div>';k+='<label for="userTaggerColor">Color</label> <select id="userTaggerColor">';for(var l in this.bgToTextColorMap){var m=l;if(m=='none')m='';k+='<option style="background-color: '+l+'; color: '+this.bgToTextColorMap[l]+'!important" value="'+m+'">'+l+'</option>'}k+='</select>';k+='<label for="userTaggerPreview">Preview</label> <span id="userTaggerPreview"></span>';k+='<label for="userTaggerIgnore">Ignore</label>';k+='<label for="userTaggerLink">Link<span class="hoverHelp" title="add a link for this user (shows up in hover pane)">?</span></label> <input type="text" id="userTaggerLink" value="">';k+='<label for="userTaggerVoteWeight">Vote Weight<span class="hoverHelp" title="manually edit vote weight for this user">?</span></label> <input type="text" size="2" id="userTaggerVoteWeight" value="">';k+='<div class="clear"></div><input type="submit" id="userTaggerSave" value="Save"></form></div>';$(this.userTaggerToolTip).html(k);var n=this.userTaggerToolTip.querySelector('label[for=userTaggerIgnore]');insertAfter(n,RESUtils.toggleButton('userTaggerIgnore',false,'no','yes'));this.userTaggerTag=this.userTaggerToolTip.querySelector('#userTaggerTag');this.userTaggerTag.addEventListener('keyup',modules['userTagger'].updateTagPreview,false);this.userTaggerColor=this.userTaggerToolTip.querySelector('#userTaggerColor');this.userTaggerColor.addEventListener('change',modules['userTagger'].updateTagPreview,false);this.userTaggerPreview=this.userTaggerToolTip.querySelector('#userTaggerPreview');var o=this.userTaggerToolTip.querySelector('#userTaggerSave');o.setAttribute('type','submit');o.setAttribute('value','â save tag');o.addEventListener('click',function(e){e.preventDefault();modules['userTagger'].saveTagForm()},false);var p=this.userTaggerToolTip.querySelector('#userTaggerClose');p.addEventListener('click',function(e){modules['userTagger'].closeUserTagPrompt()},false);this.userTaggerForm=this.userTaggerToolTip.querySelector('FORM');this.userTaggerForm.addEventListener('submit',function(e){e.preventDefault();modules['userTagger'].saveTagForm()},true);document.body.appendChild(this.userTaggerToolTip);if(this.options.hoverInfo.value){this.authorInfoToolTip=createElementWithID('div','authorInfoToolTip','RESDialogSmall');this.authorInfoToolTipHeader=document.createElement('h3');this.authorInfoToolTip.appendChild(this.authorInfoToolTipHeader);this.authorInfoToolTipCloseButton=createElementWithID('div','authorInfoToolTipClose','RESCloseButton');$(this.authorInfoToolTipCloseButton).text('X');this.authorInfoToolTip.appendChild(this.authorInfoToolTipCloseButton);this.authorInfoToolTipCloseButton.addEventListener('click',function(e){if(typeof(modules['userTagger'].hideTimer)!='undefined'){clearTimeout(modules['userTagger'].hideTimer)}modules['userTagger'].hideAuthorInfo()},false);this.authorInfoToolTipContents=createElementWithID('div','authorInfoToolTipContents','RESDialogContents');this.authorInfoToolTip.appendChild(this.authorInfoToolTipContents);this.authorInfoToolTip.addEventListener('mouseover',function(e){if(typeof(modules['userTagger'].hideTimer)!='undefined'){clearTimeout(modules['userTagger'].hideTimer)}},false);this.authorInfoToolTip.addEventListener('mouseout',function(e){if(e.target.getAttribute('class')!='hoverAuthor'){modules['userTagger'].hideTimer=setTimeout(function(){modules['userTagger'].hideAuthorInfo()},modules['userTagger'].options.fadeDelay.value)}},false);document.body.appendChild(this.authorInfoToolTip)}document.getElementById('userTaggerTag').addEventListener('keydown',function(e){if(e.keyCode==27){modules['userTagger'].closeUserTagPrompt()}},true);this.applyTags();RESUtils.watchForElement('siteTable',modules['userTagger'].attachVoteHandlers);RESUtils.watchForElement('siteTable',modules['userTagger'].applyTags);var q=new RegExp(/https?:\/\/([a-z]+).reddit.com\/user\/[-\w\.]+\/?/i);if(q.test(location.href)){var r=document.querySelector('.titlebox .fancy-toggle-button');if((typeof(r)!='undefined')&&(r!=null)){var s=document.querySelector('a.author');if((typeof(s)!='undefined')&&(s!=null)){var t=s.getAttribute('title');(t!=null)?t=t.substring(8,t.length-1):t=''}else{var t=''}}}}},attachVoteHandlers:function(a){var b=a.querySelectorAll('.arrow');this.voteStates=[];for(var i=0,len=b.length;i<len;i++){var c=Math.floor(i/2);if(typeof(this.voteStates[c])=='undefined'){this.voteStates[c]=0}if(hasClass(b[i],'upmod')){this.voteStates[c]=1}else if(hasClass(b[i],'downmod')){this.voteStates[c]=-1}b[i].setAttribute('pairNum',c);if(RESUtils.loggedInUser()){b[i].addEventListener('click',modules['userTagger'].handleVoteClick,true)}}},handleVoteClick:function(e){var a=RESStorage.getItem('RESmodules.userTagger.tags');if(typeof(a)!='undefined')modules['userTagger'].tags=safeJSON.parse(a,'RESmodules.userTagger.tags',true);if(e.target.getAttribute('onclick').indexOf('unvotable')==-1){var b=e.target.getAttribute('pairNum');if(b)b=parseInt(b);var c=this.parentNode.nextSibling.querySelector('p.tagline a.author');if(c==null&&hasClass(this.parentNode.nextSibling,'thumbnail')){c=this.parentNode.nextSibling.nextSibling.querySelector('p.tagline a.author')}if(c){var d=this.parentNode.nextSibling.querySelector('.voteWeight');if(!d)d=this.parentNode.parentNode.querySelector('.voteWeight');var f=c.text;var g=0;if(typeof(modules['userTagger'].tags[f])!='undefined'){if(typeof(modules['userTagger'].tags[f].votes)!='undefined'){g=parseInt(modules['userTagger'].tags[f].votes)}}else{modules['userTagger'].tags[f]={}}var h='';((hasClass(this,'up'))||(hasClass(this,'upmod')))?h='up':h='down';switch(h){case'up':if(hasClass(this,'up')){g--;modules['userTagger'].voteStates[b]=0}else{g++;if(modules['userTagger'].voteStates[b]==-1){g++}modules['userTagger'].voteStates[b]=1}break;case'down':if(hasClass(this,'down')){g++;modules['userTagger'].voteStates[b]=0}else{g--;if(modules['userTagger'].voteStates[b]==1){g--}modules['userTagger'].voteStates[b]=-1}break}modules['userTagger'].tags[f].votes=g;RESStorage.setItem('RESmodules.userTagger.tags',JSON.stringify(modules['userTagger'].tags));modules['userTagger'].colorUser(d,f,g)}}},drawUserTagTable:function(f,g){this.currentSortMethod=f||this.currentSortMethod;this.descending=(g==null)?this.descending:g==true;var h=[];var j=$('#tagFilter').val();for(var i in this.tags){if(j=='tagged users'){if(typeof(this.tags[i].tag)!='undefined')h.push(i)}else{h.push(i)}}switch(this.currentSortMethod){case'tag':h.sort(function(a,b){var c=(typeof(modules['userTagger'].tags[a].tag)=='undefined')?'zzzzz':modules['userTagger'].tags[a].tag.toLowerCase();var d=(typeof(modules['userTagger'].tags[b].tag)=='undefined')?'zzzzz':modules['userTagger'].tags[b].tag.toLowerCase();return(c>d)?1:(d>c)?-1:0});if(this.descending)h.reverse();break;case'ignore':h.sort(function(a,b){var c=(typeof(modules['userTagger'].tags[a].ignore)=='undefined')?'z':'a';var d=(typeof(modules['userTagger'].tags[b].ignore)=='undefined')?'z':'a';return(c>d)?1:(d>c)?-1:0});if(this.descending)h.reverse();break;case'color':h.sort(function(a,b){var c=(typeof(modules['userTagger'].tags[a].color)=='undefined')?'zzzzz':modules['userTagger'].tags[a].color.toLowerCase();var d=(typeof(modules['userTagger'].tags[b].color)=='undefined')?'zzzzz':modules['userTagger'].tags[b].color.toLowerCase();return(c>d)?1:(d>c)?-1:0});if(this.descending)h.reverse();break;case'votes':h.sort(function(a,b){var c=(typeof(modules['userTagger'].tags[a].votes)=='undefined')?0:modules['userTagger'].tags[a].votes;var d=(typeof(modules['userTagger'].tags[b].votes)=='undefined')?0:modules['userTagger'].tags[b].votes;return(c>d)?1:(d>c)?-1:(a.toLowerCase()>b.toLowerCase())});if(this.descending)h.reverse();break;default:h.sort(function(a,b){return(a.toLowerCase()>b.toLowerCase())?1:(b.toLowerCase()>a.toLowerCase())?-1:0});if(this.descending)h.reverse();break}$('#userTaggerTable tbody').html('');var k=parseInt(modules['dashboard'].options['tagsPerPage'].value);var l=h.length;var m=0;var n=l;if(k){var o=$('#tagPageControls');var p=o.prop('page');var q=Math.ceil(l/k);p=Math.min(p,q);p=Math.max(p,1);o.prop('page',p).prop('pageCount',q);o.find('.RESGalleryLabel').text(p+' of '+q);m=k*(p-1);n=Math.min(l,k*p)}for(var i=m;i<n;i++){var r=h[i];var s=(typeof(this.tags[r].tag)=='undefined')?'':this.tags[r].tag;var t=(typeof(this.tags[r].votes)=='undefined')?0:this.tags[r].votes;var u=(typeof(this.tags[r].color)=='undefined')?'':this.tags[r].color;var v=(typeof(this.tags[r].ignore)=='undefined')?'no':'yes';var w=document.createElement('a');if(s==''){w.setAttribute('class','userTagLink RESUserTagImage')}else{w.setAttribute('class','userTagLink hasTag')}$(w).html(escapeHTML(s));if(u){w.setAttribute('style','background-color: '+u+'; color: '+this.bgToTextColorMap[u]+'!important')}w.setAttribute('username',r);w.setAttribute('title','set a tag');w.setAttribute('href','javascript:void(0)');w.addEventListener('click',function(e){modules['userTagger'].openUserTagPrompt(e.target,this.getAttribute('username'))},true);$('#userTaggerTable tbody').append('<tr><td><a class="author" href="/user/'+r+'">'+r+'</a> <span class="deleteButton" user="'+r+'"></span></td><td id="tag_'+i+'"></td><td id="ignore_'+i+'">'+v+'</td><td><span style="color: '+u+'">'+u+'</span></td><td>'+t+'</td></tr>');$('#tag_'+i).append(w)}$('#userTaggerTable tbody .deleteButton').click(function(e){var a=$(this).attr('user');var b=confirm("Are you sure you want to delete the tag for user: "+a+"?");if(b){delete modules['userTagger'].tags[a];RESStorage.setItem('RESmodules.userTagger.tags',JSON.stringify(modules['userTagger'].tags));$(this).closest('tr').remove()}})},saveTagForm:function(){var a=document.getElementById('userTaggerName').value;var b=document.getElementById('userTaggerTag').value;var c=document.getElementById('userTaggerColor').value;var d=document.getElementById('userTaggerIgnore').checked;var e=document.getElementById('userTaggerLink').value;var f=parseInt(document.getElementById('userTaggerVoteWeight').value);if(isNaN(f))f=0;modules['userTagger'].setUserTag(a,b,c,d,e,f)},bgToTextColorMap:{'none':'black','aqua':'black','black':'white','blue':'white','fuchsia':'white','gray':'white','green':'white','lime':'black','maroon':'white','navy':'white','olive':'black','orange':'black','purple':'white','red':'black','silver':'black','teal':'white','white':'black','yellow':'black'},openUserTagPrompt:function(a,b){var c=RESUtils.getXYpos(a);this.clickedTag=a;var d=document.querySelector('#userTaggerToolTip h3');d.textContent='Tag '+b;document.getElementById('userTaggerName').value=b;var e=null;var f=null;if(typeof(this.tags[b])!='undefined'){if(typeof(this.tags[b].tag)!='undefined'){document.getElementById('userTaggerTag').value=this.tags[b].tag}else{document.getElementById('userTaggerTag').value=''}if(typeof(this.tags[b].ignore)!='undefined'){document.getElementById('userTaggerIgnore').checked=this.tags[b].ignore;var g=document.getElementById('userTaggerIgnoreContainer');if(this.tags[b].ignore)addClass(g,'enabled')}else{document.getElementById('userTaggerIgnore').checked=false}if(typeof(this.tags[b].votes)!='undefined'){document.getElementById('userTaggerVoteWeight').value=this.tags[b].votes}else{document.getElementById('userTaggerVoteWeight').value=''}if(typeof(this.tags[b].link)!='undefined'){document.getElementById('userTaggerLink').value=this.tags[b].link}else{document.getElementById('userTaggerLink').value=''}if(typeof(this.tags[b].color)!='undefined'){RESUtils.setSelectValue(document.getElementById('userTaggerColor'),this.tags[b].color)}else{document.getElementById('userTaggerColor').selectedIndex=0}}else{document.getElementById('userTaggerTag').value='';document.getElementById('userTaggerIgnore').checked=false;document.getElementById('userTaggerVoteWeight').value='';document.getElementById('userTaggerLink').value='';if(this.options.storeSourceLink.value){var h=$(a).closest('.entry');var i=$(h).find('a.title');if(i.length){document.getElementById('userTaggerLink').value=$(i).attr('href')}else{var j=$(h).find('.flat-list.buttons li.first a');if(j.length){document.getElementById('userTaggerLink').value=$(j).attr('href')}}}document.getElementById('userTaggerColor').selectedIndex=0}this.userTaggerToolTip.setAttribute('style','display: block; top: '+c.y+'px; left: '+c.x+'px;');document.getElementById('userTaggerTag').focus();modules['userTagger'].updateTagPreview();return false},updateTagPreview:function(){$(modules['userTagger'].userTaggerPreview).text(modules['userTagger'].userTaggerTag.value);var a=modules['userTagger'].userTaggerColor[modules['userTagger'].userTaggerColor.selectedIndex].value;modules['userTagger'].userTaggerPreview.style.backgroundColor=a;modules['userTagger'].userTaggerPreview.style.color=modules['userTagger'].bgToTextColorMap[a]},closeUserTagPrompt:function(){this.userTaggerToolTip.setAttribute('style','display: none');if(modules['keyboardNav'].isEnabled()){var a=this.userTaggerToolTip.querySelectorAll('INPUT, BUTTON');for(var i=0,len=a.length;i<len;i++){a[i].blur()}}},setUserTag:function(a,b,c,d,e,f,g){if(((b!=null)&&(b!=''))||(d)){if(b=='')b='ignored';if(typeof(this.tags[a])=='undefined')this.tags[a]={};this.tags[a].tag=b;this.tags[a].link=e;if(c!=''){this.tags[a].color=c}if(d){this.tags[a].ignore=true}else{delete this.tags[a].ignore}if(!g){this.clickedTag.setAttribute('class','userTagLink hasTag');this.clickedTag.setAttribute('style','background-color: '+c+'; color: '+this.bgToTextColorMap[c]+'!important');$(this.clickedTag).html(escapeHTML(b))}}else{if(typeof(this.tags[a])!='undefined'){delete this.tags[a].tag;delete this.tags[a].color;delete this.tags[a].link;if(this.tags[a].tag=='ignored')delete this.tags[a].tag;delete this.tags[a].ignore}if(!g){this.clickedTag.setAttribute('style','background-color: none');this.clickedTag.setAttribute('class','userTagLink RESUserTagImage');$(this.clickedTag).html('')}}if(typeof(this.tags[a])!='undefined'){this.tags[a].votes=(isNaN(f))?0:f}if(!g){var h=this.clickedTag.parentNode.parentNode.querySelector('a.voteWeight');if(h){this.colorUser(h,a,f)}}if(RESUtils.isEmpty(this.tags[a]))delete this.tags[a];RESStorage.setItem('RESmodules.userTagger.tags',JSON.stringify(this.tags));this.closeUserTagPrompt()},applyTags:function(c){if(c==null)c=document;modules['userTagger'].authors=c.querySelectorAll('.noncollapsed a.author, p.tagline a.author, #friend-table span.user a, .sidecontentbox .author, div.md a[href^="/u/"], .usertable a.author');modules['userTagger'].authorCount=modules['userTagger'].authors.length;modules['userTagger'].authori=0;(function(){var a=Math.min((modules['userTagger'].authorCount-modules['userTagger'].authori),15);for(var i=0;i<a;i++){var b=modules['userTagger'].authori;modules['userTagger'].applyTagToAuthor(modules['userTagger'].authors[b]);modules['userTagger'].authori++}if(modules['userTagger'].authori<modules['userTagger'].authorCount){setTimeout(arguments.callee,1000)}})()},applyTagToAuthor:function(b){var c=[];if((b)&&(!(hasClass(b,'userTagged')))&&(typeof(b)!='undefined')&&(b!=null)){if(this.options.hoverInfo.value){b.addEventListener('mouseover',function(e){modules['userTagger'].showTimer=setTimeout(function(){modules['userTagger'].showAuthorInfo(b)},modules['userTagger'].options.hoverDelay.value)},false);b.addEventListener('mouseout',function(e){clearTimeout(modules['userTagger'].showTimer)},false)}var d=b.href.match(this.usernameRE);if(d)var f=d[1];var g=false;if((f)&&(f.substr(0,3)=='/u/')){g=true;f=f.substr(3)}if(!g){addClass(b,'userTagged');if(typeof(c[f])=='undefined'){var h=0;var i=null;var j=null;var k=null;if((this.tags!=null)&&(typeof(this.tags[f])!='undefined')){if(typeof(this.tags[f].votes)!='undefined'){h=parseInt(this.tags[f].votes)}if(typeof(this.tags[f].tag)!='undefined'){i=this.tags[f].tag}if(typeof(this.tags[f].color)!='undefined'){j=this.tags[f].color}if(typeof(this.tags[f].ignore)!='undefined'){k=this.tags[f].ignore}}c[f]={tag:i,color:j,ignore:k,votes:h}}var l=document.createDocumentFragment();var m=document.createElement('a');if(!(i)){m.setAttribute('class','userTagLink RESUserTagImage')}else{m.setAttribute('class','userTagLink hasTag')}$(m).html(escapeHTML(i));if(j){m.setAttribute('style','background-color: '+j+'; color: '+this.bgToTextColorMap[j]+'!important')}m.setAttribute('username',f);m.setAttribute('title','set a tag');m.setAttribute('href','javascript:void(0)');m.addEventListener('click',function(e){modules['userTagger'].openUserTagPrompt(e.target,this.getAttribute('username'))},true);var n=document.createElement('span');addClass(n,'RESUserTag');n.appendChild(m);l.appendChild(n);if(this.options.colorUser.value){var o=document.createDocumentFragment();var p=document.createTextNode(' ');o.appendChild(p);var q=document.createElement('a');q.setAttribute('href','javascript:void(0)');q.setAttribute('class','voteWeight');$(q).text('[vw]');q.addEventListener('click',function(e){var a=this.parentNode.querySelector('.userTagLink');modules['userTagger'].openUserTagPrompt(a,a.getAttribute('username'))},true);this.colorUser(q,f,c[f].votes);o.appendChild(q);l.appendChild(o)}insertAfter(b,l);k=c[f].ignore;if(k&&(RESUtils.pageType('profile')!=true)){if(this.options.hardIgnore.value){if(RESUtils.pageType()=='comments'){var r=b.parentNode.parentNode.querySelector('.usertext');if(r){$(r).textContent=f+' is an ignored user';addClass(r,'ignoredUserComment');var s=r.parentNode.querySelector('a.expand');RESUtils.click(s)}}else{var t=b.parentNode.parentNode.parentNode;t.style.display='none';if(t.previousSibling){t.previousSibling.style.display='none'}}}else{if(RESUtils.pageType()=='comments'){var r=b.parentNode.parentNode.querySelector('.usertext');if(r){r.textContent=f+' is an ignored user';addClass(r,'ignoredUserComment')}}else{var t=b.parentNode.parentNode.parentNode.querySelector('p.title');if(t){setTimeout(function(){t.textContent=f+' is an ignored user'},100);t.setAttribute('class','ignoredUserPost')}}}}}}},colorUser:function(a,b,c){if(this.options.colorUser.value){c=parseInt(c);var d=255;var e=255;var f=255;var g='+';if(c>0){d=Math.max(0,(255-(8*c)));e=255;f=Math.max(0,(255-(8*c)))}else if(c<0){d=255;e=Math.max(0,(255-Math.abs(8*c)));f=Math.max(0,(255-Math.abs(8*c)));g=''}g=g+c;var h='rgb('+d+','+e+','+f+')';if(a!=null){if(c==0){a.style.display='none'}else{a.style.display='inline';a.style.backgroundColor=h;if(this.options.vwNumber.value)a.textContent='['+g+']';if(this.options.vwTooltip.value)a.setAttribute('title','your votes for '+escapeHTML(b)+': '+escapeHTML(g))}}}},showAuthorInfo:function(e){var f=(hasClass(e,'friend'))?true:false;var g=RESUtils.getXYpos(e);var h=e.href.match(this.usernameRE);if(h)var i=h[1];$(this.authorInfoToolTipHeader).html('<a href="/user/'+escapeHTML(i)+'">'+escapeHTML(i)+'</a> (<a href="/user/'+escapeHTML(i)+'/submitted/">Links</a>) (<a href="/user/'+escapeHTML(i)+'/comments/">Comments</a>)');RESUtils.loggedInUserInfo(function(a){var b='t2_'+a.data.id;if(f){var c='<span class="fancy-toggle-button toggle" style="display: inline-block; margin-left: 12px;"><a class="option active remove" href="#" tabindex="100" onclick="return toggle(this, unfriend(\''+e.textContent+'\', \''+b+'\', \'friend\'), friend(\''+e.textContent+'\', \''+b+'\', \'friend\'))">- friends</a><a class="option add" href="#">+ friends</a></span>'}else{var c='<span class="fancy-toggle-button toggle" style="display: inline-block; margin-left: 12px;"><a class="option active add" href="#" tabindex="100" onclick="return toggle(this, friend(\''+e.textContent+'\', \''+b+'\', \'friend\'), unfriend(\''+e.textContent+'\', \''+b+'\', \'friend\'))">+ friends</a><a class="option remove" href="#">- friends</a></span>'}var d=$(c);$(modules['userTagger'].authorInfoToolTipHeader).append(d)});$(this.authorInfoToolTipContents).html('<a class="hoverAuthor" href="/user/'+escapeHTML(i)+'">'+escapeHTML(i)+'</a>:<br><img src="'+RESConsole.loader+'"> loading...');if((window.innerWidth-g.x)<=412){this.authorInfoToolTip.setAttribute('style','top: '+(g.y-14)+'px; left: '+(g.x-180)+'px;')}else{this.authorInfoToolTip.setAttribute('style','top: '+(g.y-14)+'px; left: '+(g.x-10)+'px;')}if(this.options.fadeSpeed.value<0||this.options.fadeSpeed.value>1||isNaN(this.options.fadeSpeed.value)){this.options.fadeSpeed.value=0.3}RESUtils.fadeElementIn(this.authorInfoToolTip,this.options.fadeSpeed.value);setTimeout(function(){if(!RESUtils.elementUnderMouse(modules['userTagger'].authorInfoToolTip)){modules['userTagger'].hideAuthorInfo()}},1000);if(typeof(this.authorInfoCache[i])!='undefined'){this.writeAuthorInfo(this.authorInfoCache[i])}else{GM_xmlhttpRequest({method:"GET",url:location.protocol+"//"+location.hostname+"/user/"+i+"/about.json?app=res",onload:function(a){var b=JSON.parse(a.responseText);modules['userTagger'].authorInfoCache[i]=b;modules['userTagger'].writeAuthorInfo(b)}})}},writeAuthorInfo:function(a){var b=a.data.created;var d=new Date(b*1000);var c='<div class="authorLabel">Redditor since:</div> <div class="authorDetail">'+RESUtils.niceDate(d,this.options.USDateFormat.value)+' ('+RESUtils.niceDateDiff(d)+')</div>';c+='<div class="authorLabel">Link Karma:</div> <div class="authorDetail">'+escapeHTML(a.data.link_karma)+'</div>';c+='<div class="authorLabel">Comment Karma:</div> <div class="authorDetail">'+escapeHTML(a.data.comment_karma)+'</div>';if((typeof(modules['userTagger'].tags[a.data.name])!='undefined')&&(modules['userTagger'].tags[a.data.name].link)){c+='<div class="authorLabel">Link:</div> <div class="authorDetail"><a target="_blank" href="'+escapeHTML(modules['userTagger'].tags[a.data.name].link)+'">website link</a></div>'}c+='<div class="clear"></div><div class="bottomButtons">';c+='<a target="_blank" class="blueButton" href="http://www.reddit.com/message/compose/?to='+escapeHTML(a.data.name)+'"><img src="/static/mailgray.png"> send message</a>';if(a.data.is_gold){c+='<a target="_blank" class="blueButton" href="http://www.reddit.com/gold">User has Reddit Gold</a>'}else{c+='<a target="_blank" class="blueButton" href="http://www.reddit.com/gold?goldtype=gift&recipient='+escapeHTML(a.data.name)+'">Gift Reddit Gold</a>'}if((modules['userTagger'].tags[a.data.name])&&(modules['userTagger'].tags[a.data.name].ignore)){c+='<div class="redButton" id="ignoreUser" user="'+escapeHTML(a.data.name)+'">&empty; Unignore</div>'}else{c+='<div class="blueButton" id="ignoreUser" user="'+escapeHTML(a.data.name)+'">&empty; Ignore</div>'}c+='<div class="clear"></div></div>';$(this.authorInfoToolTipContents).html(c);this.authorInfoToolTipIgnore=this.authorInfoToolTipContents.querySelector('#ignoreUser');this.authorInfoToolTipIgnore.addEventListener('click',modules['userTagger'].ignoreUser,false)},ignoreUser:function(e){if(hasClass(e.target,'blueButton')){removeClass(e.target,'blueButton');addClass(e.target,'redButton');$(e.target).html('&empty; Unignore');var a=true}else{removeClass(e.target,'redButton');addClass(e.target,'blueButton');$(e.target).html('&empty; Ignore');var a=false}var b=e.target.getAttribute('user');var c,thisLink,thisVotes,thisTag;if(modules['userTagger'].tags[b]){c=modules['userTagger'].tags[b].color||'';thisLink=modules['userTagger'].tags[b].link||'';thisVotes=modules['userTagger'].tags[b].votes||0;thisTag=modules['userTagger'].tags[b].tag||''}if((a)&&(thisTag=='')){thisTag='ignored'}else if((!a)&&(thisTag=='ignored')){thisTag=''}modules['userTagger'].setUserTag(b,thisTag,c,a,thisLink,thisVotes,true)},hideAuthorInfo:function(a){if(this.options.fadeSpeed.value<0||this.options.fadeSpeed.value>1||isNaN(this.options.fadeSpeed.value)){this.options.fadeSpeed.value=0.3}RESUtils.fadeElementOut(this.authorInfoToolTip,this.options.fadeSpeed.value)},updateTagStorage:function(){(typeof(unsafeWindow)!='undefined')?ls=unsafeWindow.localStorage:ls=localStorage;var a={};var b=[];for(var i=0,len=ls.length;i<len;i++){var c=null;if(ls.key(i))c=ls.key(i).split('.');if(c){var d=c[0];switch(d){case'reddituser':var e=c[1];if(typeof(a[c[2]])=='undefined'){a[c[2]]={}}if(e=='votes'){a[c[2]].votes=ls.getItem(ls.key(i))}else if(e=='tag'){a[c[2]].tag=ls.getItem(ls.key(i))}else if(e=='color'){a[c[2]].color=ls.getItem(ls.key(i))}else if(e=='ignore'){a[c[2]].ignore=ls.getItem(ls.key(i))}var f='reddituser.'+e+'.'+c[2];b.push(f);break;default:break}}}this.tags=a;RESStorage.setItem('RESmodules.userTagger.tags',JSON.stringify(this.tags));for(var i=0,len=b.length;i<len;i++){ls.removeItem(b[i])}}};modules['betteReddit']={moduleID:'betteReddit',moduleName:'betteReddit',category:'UI',options:{fullCommentsLink:{type:'boolean',value:true,description:'add "full comments" link to comment replies, etc'},fullCommentsText:{type:'text',value:'full comments',description:'text of full comments link'},commentsLinksNewTabs:{type:'boolean',value:false,description:'Open links found in comments in a new tab'},fixSaveLinks:{type:'boolean',value:true,description:'Make "save" links change to "unsave" links when clicked'},fixHideLinks:{type:'boolean',value:true,description:'Make "hide" links change to "unhide" links when clicked, and provide a 5 second delay prior to hiding the link'},searchSubredditByDefault:{type:'boolean',value:true,description:'Search the current subreddit by default when using the search box, instead of all of reddit.'},showUnreadCount:{type:'boolean',value:true,description:'Show unread message count next to orangered?'},showUnreadCountInTitle:{type:'boolean',value:false,description:'Show unread message count in page/tab title?'},showUnreadCountInFavicon:{type:'boolean',value:true,description:'Show unread message count in favicon?'},videoTimes:{type:'boolean',value:true,description:'Show lengths of videos when possible'},videoUploaded:{type:'boolean',value:false,description:'Show upload date of videos when possible'},toolbarFix:{type:'boolean',value:true,description:'Don\'t use Reddit Toolbar when linking to sites that may not function (twitter, youtube and others)'},pinHeader:{type:'enum',values:[{name:'None',value:'none'},{name:'Subreddit Bar only',value:'sub'},{name:'User Bar',value:'userbar'},{name:'Subreddit Bar and User bar',value:'subanduser'},{name:'Full Header',value:'header'}],value:'none',description:'Pin the subreddit bar or header to the top, even when you scroll.'},turboSelfText:{type:'boolean',value:true,description:'Preload selftext data to make selftext expandos faster (preloads after first expando)'},showInputLength:{type:'boolean',value:true,description:'When submitting, display the number of characters entered in the title and text fields and indicate when you go over the 300 character limit for titles.'}},description:'Adds a number of interface enhancements to Reddit, such as "full comments" links, the ability to unhide accidentally hidden posts, and more',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/.*/i),go:function(){if((this.isEnabled())&&(this.isMatchURL())){if((this.options.toolbarFix.value)&&((RESUtils.pageType()=='linklist')||RESUtils.pageType()=='comments')){this.toolbarFix()}if((RESUtils.pageType()=='comments')&&(this.options.commentsLinksNewTabs.value)){this.commentsLinksNewTabs()}if(((RESUtils.pageType()=='inbox')||((RESUtils.pageType()=='comments')&&(RESUtils.currentSubreddit('friends'))))&&(this.options.fullCommentsLink.value)){this.fullComments()}if((RESUtils.pageType()=='profile')&&(location.href.split('/').indexOf(RESUtils.loggedInUser())!=-1)){this.editMyComments()}if(((RESUtils.pageType()=='linklist')||(RESUtils.pageType()=='comments'))&&(this.options.fixSaveLinks.value)){this.fixSaveLinks()}if(((RESUtils.pageType()=='linklist')||(RESUtils.pageType()=='comments'))&&(this.options.fixHideLinks.value)){this.fixHideLinks()}if((this.options.turboSelfText.value)&&(RESUtils.pageType()=='linklist')){this.setUpTurboSelfText()}if(this.options.showUnreadCountInFavicon.value){var a='data:image/x-icon;base64,AAABAAIAEBAAAAAAAABoBQAAJgAAACAgAAAAAAAAqAgAAI4FAAAoAAAAEAAAACAAAAABAAgAAAAAAEABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///wBBRP4Aq5qHAFNOSgCkpv4A4Mu0AA8Q/gCAc2cAzM7+ADYvKQCys7QA/urQAGVo/gCGh4kA1NbYAMWvmgBjZWYA5efoAJucngD//+MAwcPFACIk/gCbinkAycGtADo8PgDz2sIAal5RADAy/gBvcHEA9PbzALijkACMfm8AqqmoALCy/gCAgHsAc2piAMnMzwDBw/4AXVxcAJGUlwDOuKMAR0dHANfDrABLTv4Aubu+ADIzNQBbVlEA++HJAP/23ACho6UAa2RdAJOEdQD3+P4A2tzeAO7UvACEeW4AjY2KALCfjgBsa2oArq6uAM/R0wB2cGwA//DWAKOYiACCg4MAemxfAPDw8ABOSkYA4+PjAMm7pgBeWlYAgHt3AGZhWwBtamQA+t7EAGVbUgB7b2QAoaGgAP7kzADdyLEA9Pf6AP774ACwnIoAZ15VAJiHdwBbXWAAy8vLAIh8cAC0oY0AZ2VkALy+vwD+7dMA9t3FAHJwbgB/f38Aqq2vAP//5wB4bWMA7ta/AHVqXwCCfXsAmYp8AIJ1aQDS0tIApKSkAP7jyQDOuaYA/vjeAH1xZQCBgYEArp2MAJ2enwD5+v4A//LYAH5zaQD13MMAd2xhAJWFdgD+69IA/ujPAGxsbABycXAAtqOPAN/IsQDLu6YA/v7+AP/84QD/+t8A/vfbAP7v1QD64MgA1dfZAH5+fgD//uIA/v7jAP/43QD+990AZVxTAP/x1wD+8tcA/u7UAOTk4wCYiHgA///kAP/+4wD++t8A/vneAP743QD/79UA/u3SAP7s0gD+69EA/unQAPXcxACrra8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AD8/Pz8/Pz8/Pz8/Pz8/Pz8/XV1dKY8IYgiPKV1dXV0/P11QVDubPYQ9mztUUF1dP4krRC1+V26Fbld+LUQrXT+UiiV+fiFoQ2ghfn4lil0/P15+fn5+fn5+fn5+fl5dPx8qfn4iHAl+CRwifn4qHz9IHTx+BQcmfiYHBX48HUg/PjYZDh5+fn5+fh4OGTY+P0YzOCBKOTILcCNJIDgzRj8/XV1dfFkXClUQGl1qXV0/P11dXTB4XWdrXV1YRzpdPz9dXV1dXV1vZBhCVlEEXT8/XV1dXV2DY0xtQCRaZl0/P11dXV1dXV1dXV1dXV1dPz8/Pz8/Pz8/Pz8/Pz8/Pz8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAACAAAABAAAAAAQAIAAAAAACABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AJSr/AJmJegCIjf4AREZIANzFsADGy/4AUFb/ACgjHwBpamsAAAD/AP/mzQCmp6cA2dnaAL29vgDl6P4AYllPAMWzoAAQEhQAMjQ2AHp7fQCxtv4AlZaWAP784AASFv4A7NfAALGgjwCCdGYAy8vLAPPz9ACJiosARz83AFZNRAB1aV0A1Nj+AFJTVQCzs7MAjX9yAFtdXwDi4uIAqJaGALyplgDRvagAMiwnABkbHQB9g/4ACgoKAOLPuQD+8dcA6+vrAGphVwCdnp4A9t3GAD43LwB0dHQAgYOEADw8PAAdIf8A0tLSAPf5/wC5vv4AxcXGAJ+QgAAbFxMA3eH/AGJjZACtra0A9+rSAE9HQADs7/4AIyQmAHl1aQAsLzEATE5QAEpP/wAhHRoAXFJIAI+PjwAeICIAAwUHAD9BQgBWWFoAwa6bAMm8qAATEA0A///nAOnSuwAVFxgA3d3dAHltYACJe20AlIV2APj4+AA4My4A/vfcAP7s0gDUwa0AuaSSAPviyQA4ODgAt7e3AKGiogAODg8AKyssAMvP/gCBh/4ALiklAIR3awDOzs8A38u2AH9wYwAIBgQAb2NYADYwKgD7+/sA8PDwAPPbxABJS00AwcLCABke/gDY2/8ADgwJAAUDAgAjIB0A+eXMAF9gYgCbm5sAkpOUABQSEQBEPDUAUVFRAIWFhQAZGRkAIyMjAPP1/gDp7P4AtaORAAYHBwAfGxgA39/gAC8xMwDv2cIASUE4AK+vsADmz7kAAQMFABAQEAD+6dAAMSokAEE4MQBVS0EAyLWhAGVlZQCai30AjIyMAP7+4wAUFBQA/vneAP7z2gD+7tUALy8vADs1LgComYgA/f39APb29gAbHR8A/ePLAPngyADb29sAQkRGAEZISgDWw68A07+qAFpQRgBkW1EAvquYAHZ2dgCWh3gADw0MACAiJAD8584ANTc5ADc5OwDZxrEAV1dXAAMCAgDiy7UAjI2PAAwLCwDb3/4Aw7CcAJ+foACDdmgAoZGCABIUFgAjHxoAJSUlAPbcxADIzf4A79fAAOzZwgC3vP4A59G7AOLNtwBdXV0Av62aAAQEBAAGBQQACQgHABYWFgD09PUAFxocADAzNQDDw8MAWE5FAMOynwBaXF0AbmJWAGBiYwC3opAAAgEBABISEgD+6M8A/OXNADAqJgAyLSkANi8oADQ1NgDTvakAtba3AMGwnQBkWk8Aq6ytAG1jWQBjZWYAnY+AAP//5QD+9dsA+N7GAODNtwDRv6oAw66bAAcICQD+/v4A+vr6ABQRDgD5+fkAFhgZAP/43QAaGhoA8fHxAP/w1gD/7dMA6urqAP///wAAVvz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8VgD8NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTX8AKA1NTU1NTU1NagM/fz8oKCg/KDfqDU1NTU1NTU1NaAAoDU1NTU1NQz8p63CWq4gIJciA5g1oJQ1NTU1NTU1oACgNTU1Naf8uCKLz8NJq9knStX4z/ZNEmDfNTU1NTWgAPw1NTX9Gq/dRzhtXQEBAQEBAaQOF7cAgmH8NTU1NfwAoDU1oNhVtJD09PT09PSlHqT09PT09B1RAOwx7zU1oACgNaDOAEL19PT09CWDhtKd+mSbXfT09PROACb8NTWgAKDgy3sK9PT09PTNALl/D9ZDsdLF+/T09PRmAM5gNaAA/PyuRwEBAQEBAU4dAQEBAQEBdIR0AQEBAQFSxLWo/ADuV93p9PT09PT09PT09PT09PT09PT09PT09IwA8pSgABgqijL09PT09PT09PT09PT09PT09PT09PT09EccoKAAnLBn0/T09PT09COH9PT09PT09GlG9PT09PT0jRxfoADtcQBZAQEBATwICwJBAQEBATxLCzp5AQEBAQFY48n5AIlQkzf09PT0BwsLC2r09PT0xwsLCy709PT0Zc9HLJ8AlhVlADv09PQQGQsLyvT09PSIeAsLPfT09PfSmR5Q3ACVvPSDZ6n09PQjLhb09PT09PS+BD309PTTOYX79NXBAG/UdAG53g0BAQEBAQEBAQEBAQEBAQEBPmihdAH+kmIARGsT23YAALaQXfT09PT09PT09PT0PiTdAKrmNC1y7gD5dVuC186sIdDDJIAPWf4yjB3Afk/doufxIHpV6I5fAKBjoKCglN+gzLKPQNGK82cv0FU2wa1glN+UyHWgY6AA/DU1NTU1NTWnoKBjkSspAD8wdf2gDDU1DJQMqDU1/ACgNTU1NTU1NTU1NainlPx8bPmoNTU1Y5Tlv3XfxjWgAKA1NTU1NTU1NTU1NTU1MeprlDU1NajgEbqKTGHfNaAAoDU1NTU1NTU1NTU1NTWUsLq7pzVjnlySdygFCX2ooAD8NTU1NTU1NTU1NTU1NWN1vcLt/Y5UxOsBAQ4ABgz8AKA1NTU1NTU1NTU1NTU1NfxF4kheky+z5HP0H3DIY6AAoDU1NTU1NTU1NTU1NTU1YBuB4TOj8G6LphQAmmA1oACgNTU1NTU1NTU1NTU1NTU1qMiU/GCnlMvB2lNgNTWgAPw1NTU1NTU1NTU1NTU1NTXvY+81NTU1p6D8lDU1NfwAVvz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8VgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAP////8K';$('head link[rel="shortcut icon"], head link[rel="icon"]').attr('href',a)}if((modules['betteReddit'].options.toolbarFix.value)&&(RESUtils.pageType()=='linklist')){RESUtils.watchForElement('siteTable',modules['betteReddit'].toolbarFix)}if((RESUtils.pageType()=='inbox')&&(modules['betteReddit'].options.fullCommentsLink.value)){RESUtils.watchForElement('siteTable',modules['betteReddit'].fullComments)}if(((RESUtils.pageType()=='linklist')||(RESUtils.pageType()=='comments'))&&(modules['betteReddit'].options.fixSaveLinks.value)){RESUtils.watchForElement('siteTable',modules['betteReddit'].fixSaveLinks)}if(((RESUtils.pageType()=='linklist')||(RESUtils.pageType()=='comments'))&&(modules['betteReddit'].options.fixHideLinks.value)){RESUtils.watchForElement('siteTable',modules['betteReddit'].fixHideLinks)}if((RESUtils.pageType()=='comments')&&(modules['betteReddit'].options.commentsLinksNewTabs.value)){RESUtils.watchForElement('newComments',modules['betteReddit'].commentsLinksNewTabs)}if((RESUtils.currentSubreddit()!=null)&&(this.options.searchSubredditByDefault.value)){if(location.href.indexOf('/r/'+RESUtils.currentSubreddit()+'/search')==-1){this.searchSubredditByDefault()}}if((this.options.videoTimes.value)&&((RESUtils.pageType()=='linklist')||(RESUtils.pageType()=='comments'))){this.getVideoTimes();RESUtils.watchForElement('siteTable',modules['betteReddit'].getVideoTimes)}if((RESUtils.loggedInUser()!=null)&&((this.options.showUnreadCount.value)||(this.options.showUnreadCountInTitle.value)||(this.options.showUnreadCountInFavicon.value))){RESUtils.addCSS('#mail { top: 2px; min-width: 16px !important; width: auto !important; background-repeat: no-repeat !important; line-height: 8px !important; }');RESUtils.addCSS('#mail.havemail { top: 2px !important; }');if((typeof(chrome)!='undefined')||(typeof(safari)!='undefined')){RESUtils.addCSS('#mail.havemail { top: 0px; }')}this.showUnreadCount()}switch(this.options.pinHeader.value){case'header':this.pinHeader();$('body').addClass('pinHeader-header');break;case'sub':this.pinSubredditBar();$('body').addClass('pinHeader-sub');break;case'subanduser':this.pinSubredditBar();this.pinUserBar();$('body').addClass('pinHeader-subanduser');break;case'userbar':this.pinUserBar();$('body').addClass('pinHeader-userbar');break;default:break}if((RESUtils.pageType()=='submit')&&(this.options.showInputLength.value)){this.showInputLength()}}},commentsLinksNewTabs:function(a){a=a||document.body;var b=a.querySelectorAll('div.md a');for(var i=0,len=b.length;i<len;i++){b[i].target='_blank'}},setUpTurboSelfText:function(){modules['betteReddit'].selfTextHash={};$('.expando-button.selftext:not(".twitter")').live('click',modules['betteReddit'].showSelfText);$('#siteTable').data('jsonURL',location.href+'.json');RESUtils.watchForElement('siteTable',modules['betteReddit'].setNextSelftextURL)},setNextSelftextURL:function(a){if(modules['neverEndingReddit'].nextPageURL){var b=modules['neverEndingReddit'].nextPageURL.replace('/?','/.json?');$(a).data('jsonURL',b)}},showSelfText:function(a){var b=$(a.target).parent().parent().attr('data-fullname');if(typeof(modules['betteReddit'].selfTextHash[b])=='undefined'){var c=$(a.target).closest('.sitetable.linklisting').data('jsonURL');modules['betteReddit'].getSelfTextData(c)}else{if($(a.target).hasClass('collapsed')){$(a.target).removeClass('collapsed');$(a.target).addClass('expanded');$(a.target).parent().find('.expando').html('<form class="usertext"><div class="usertext-body">'+$('<div/>').html(modules['betteReddit'].selfTextHash[b]).text()+'</div></form>').show()}else{$(a.target).removeClass('expanded');$(a.target).addClass('collapsed');$(a.target).parent().find('.expando').hide()}}},getSelfTextData:function(a){$.getJSON(a,modules['betteReddit'].applyTurboSelfText)},applyTurboSelfText:function(a){var b=a.data.children;for(var i=0,len=b.length;i<len;i++){var c=b[i].data.name;if(i==0){var d=$('.id-'+c).closest('.sitetable.linklisting');$(d).find('.expando-button.selftext').removeAttr('onclick')}modules['betteReddit'].selfTextHash[c]=b[i].data.selftext_html}},showUnreadCount:function(){if(typeof(this.mail)=='undefined'){this.mail=document.querySelector('#mail');if(this.mail){this.mailCount=createElementWithID('a','mailCount');this.mailCount.display='none';this.mailCount.setAttribute('href','/message/unread');insertAfter(this.mail,this.mailCount)}}if(this.mail){$(modules['betteReddit'].mail).html('');if(hasClass(this.mail,'havemail')){var e=parseInt(RESStorage.getItem('RESmodules.betteReddit.msgCount.lastCheck.'+RESUtils.loggedInUser()))||0;var f=new Date();if((f.getTime()-e)>300000){GM_xmlhttpRequest({method:"GET",url:location.protocol+'//'+location.hostname+"/message/unread/.json?mark=false&app=res",onload:function(a){var b=new Date();RESStorage.setItem('RESmodules.betteReddit.msgCount.lastCheck.'+RESUtils.loggedInUser(),b.getTime());var c=JSON.parse(a.responseText);var d=c.data.children.length;RESStorage.setItem('RESmodules.betteReddit.msgCount.'+RESUtils.loggedInUser(),d);modules['betteReddit'].setUnreadCount(d)}})}else{var g=RESStorage.getItem('RESmodules.betteReddit.msgCount.'+RESUtils.loggedInUser());modules['betteReddit'].setUnreadCount(g)}}else{modules['betteReddit'].setUnreadCount(0);RESStorage.setItem('RESmodules.betteReddit.msgCount.lastCheck.'+RESUtils.loggedInUser(),0)}}},setUnreadCount:function(a){if(a>0){if(this.options.showUnreadCountInTitle.value){var b='['+a+'] '+document.title.replace(/^\[[\d]+\]\s/,'');document.title=b}if(this.options.showUnreadCountInFavicon.value){Tinycon.setBubble(a)}if(this.options.showUnreadCount.value){modules['betteReddit'].mailCount.display='inline-block'modules['betteReddit'].mailCount.textContent='['+a+']';if(modules['neverEndingReddit'].NREMailCount){modules['neverEndingReddit'].NREMailCount.display='inline-block'modules['neverEndingReddit'].NREMailCount.textContent='['+a+']'}}}else{var b=document.title.replace(/^\[[\d]+\]\s/,'');document.title=b;if(modules['betteReddit'].mailCount){modules['betteReddit'].mailCount.display='none';$(modules['betteReddit'].mailCount).html('');if(modules['neverEndingReddit'].NREMailCount){modules['neverEndingReddit'].NREMailCount.display='none'$(modules['neverEndingReddit'].NREMailCount).html('')}}if(this.options.showUnreadCountInFavicon.value){Tinycon.setBubble(0)}}},toolbarFixLinks:['etsy.com','youtube.com','youtu.be','twitter.com','teamliquid.net','flickr.com','github.com','battle.net','play.google.com','plus.google.com'],checkToolbarLink:function(a){for(var i=0,len=this.toolbarFixLinks.length;i<len;i++){if(a.indexOf(this.toolbarFixLinks[i])!=-1)return true}return false},toolbarFix:function(a){var b=a||document;var c=b.querySelectorAll('div.entry a.title');for(var i=0,len=c.length;i<len;i++){if(modules['betteReddit'].checkToolbarLink(c[i].getAttribute('href'))){c[i].removeAttribute('onmousedown')}if(c[i].getAttribute('srcurl')){if(modules['betteReddit'].checkToolbarLink(c[i].getAttribute('srcurl'))){c[i].removeAttribute('onmousedown')}}}},fullComments:function(a){var b=a||document;var c=b.querySelectorAll('#siteTable .entry');for(var i=0,len=c.length;i<len;i++){var d=c[i].querySelector('A.bylink');var e='';if((typeof(d)!='undefined')&&(d!=null)){e=d.getAttribute('href')}if(e!=''){thisCommentsSplit=e.split("/");thisCommentsSplit.pop();e=thisCommentsSplit.join("/");linkList=c[i].querySelector('.flat-list');var f=document.createElement('li');$(f).html('<a class="redditFullComments" href="'+escapeHTML(e)+'">'+escapeHTML(this.options.fullCommentsText.value)+'</a>');linkList.appendChild(f)}}},editMyComments:function(a){var b=a||document;var c=b.querySelectorAll('#siteTable .entry');for(var i=0,len=c.length;i<len;i++){var d=c[i].querySelector('A.bylink');var e='';if((typeof(d)!='undefined')&&(d!=null)){e=d.getAttribute('href')}if(e!=''){permalink=c[i].querySelector('.flat-list li.first');var f=document.createElement('li');$(f).html('<a onclick="return edit_usertext(this)" href="javascript:void(0);">edit</a>');insertAfter(permalink,f)}}},fixSaveLinks:function(a){var b=a||document;var c=b.querySelectorAll('FORM.save-button > SPAN > A');for(var i=0,len=c.length;i<len;i++){c[i].removeAttribute('onclick');c[i].setAttribute('action','save');c[i].addEventListener('click',modules['betteReddit'].saveLink,false)}var d=document.querySelectorAll('FORM.unsave-button > SPAN > A');for(var i=0,len=c.length;i<len;i++){if(typeof(d[i])!='undefined'){d[i].removeAttribute('onclick');d[i].setAttribute('action','unsave');d[i].addEventListener('click',modules['betteReddit'].saveLink,false)}}},fixHideLinks:function(a){var b=a||document;var c=b.querySelectorAll('FORM.hide-button > SPAN > A');for(var i=0,len=c.length;i<len;i++){c[i].removeAttribute('onclick');c[i].setAttribute('action','hide');c[i].addEventListener('click',modules['betteReddit'].hideLinkEventHandler,false)}var d=document.querySelectorAll('FORM.unhide-button > SPAN > A');for(var i=0,len=c.length;i<len;i++){if(typeof(d[i])!='undefined'){d[i].removeAttribute('onclick');d[i].setAttribute('action','unhide');d[i].addEventListener('click',modules['betteReddit'].hideLinkEventHandler,false)}}},saveLink:function(e){if(e)modules['betteReddit'].saveLinkClicked=e.target;if(modules['betteReddit'].saveLinkClicked.getAttribute('action')=='unsave'){$(modules['betteReddit'].saveLinkClicked).text('unsaving...')}else{$(modules['betteReddit'].saveLinkClicked).text('saving...')}if(modules['betteReddit'].modhash){var c=modules['betteReddit'].saveLinkClicked.getAttribute('action');var d=modules['betteReddit'].saveLinkClicked.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;var f=/id-([\w]+)/i;var g=f.exec(d.getAttribute('class'));var h=g[1];if(c=='unsave'){var i='unsaved';var j=location.protocol+'//'+location.hostname+'/api/unsave'}else{var i='saved';var j=location.protocol+'//'+location.hostname+'/api/save'}var k='id='+h+'&executed='+i+'&uh='+modules['betteReddit'].modhash+'&renderstyle=html';GM_xmlhttpRequest({method:"POST",url:j,data:k,headers:{"Content-Type":"application/x-www-form-urlencoded"},onload:function(a){if(a.status==200){if(modules['betteReddit'].saveLinkClicked.getAttribute('action')=='unsave'){$(modules['betteReddit'].saveLinkClicked).text('save');modules['betteReddit'].saveLinkClicked.setAttribute('action','save')}else{$(modules['betteReddit'].saveLinkClicked).text('unsave');modules['betteReddit'].saveLinkClicked.setAttribute('action','unsave')}}else{delete modules['betteReddit'].modhash;alert('Sorry, there was an error trying to '+modules['betteReddit'].saveLinkClicked.getAttribute('action')+' your submission. Try clicking again.')}}})}else{GM_xmlhttpRequest({method:"GET",url:location.protocol+'//'+location.hostname+'/api/me.json?app=res',onload:function(a){var b=safeJSON.parse(a.responseText);if(typeof(b.data)=='undefined'){alert('Sorry, there was an error trying to '+modules['betteReddit'].saveLinkClicked.getAttribute('action')+' your submission. You may have third party cookies disabled. You will need to either enable third party cookies, or add an exception for *.reddit.com')}else if((typeof(b.data.modhash)!='undefined')&&(b.data.modhash)){modules['betteReddit'].modhash=b.data.modhash;modules['betteReddit'].saveLink()}}})}},hideLinkEventHandler:function(e){modules['betteReddit'].hideLink(e.target)},hideLink:function(c){if(c.getAttribute('action')=='unhide'){$(c).text('unhiding...')}else{$(c).text('hiding...')}if(modules['betteReddit'].modhash){var d=c.getAttribute('action');var e=c.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;var f=/id-([\w]+)/i;var g=f.exec(e.getAttribute('class'));var h=g[1];if(d=='unhide'){var i='unhidden';var j='http://'+location.hostname+'/api/unhide'}else{var i='hidden';var j='http://'+location.hostname+'/api/hide'}var k='id='+h+'&executed='+i+'&uh='+modules['betteReddit'].modhash+'&renderstyle=html';if(RESUtils.currentSubreddit()){k+='&r='+RESUtils.currentSubreddit()}GM_xmlhttpRequest({method:"POST",url:j,data:k,headers:{"Content-Type":"application/x-www-form-urlencoded"},onload:function(a){if(a.status==200){if(c.getAttribute('action')=='unhide'){$(c).text('hide');c.setAttribute('action','hide');if(typeof(modules['betteReddit'].hideTimer)!='undefined')clearTimeout(modules['betteReddit'].hideTimer)}else{$(c).text('unhide');c.setAttribute('action','unhide');modules['betteReddit'].hideTimer=setTimeout(function(){modules['betteReddit'].hideFader(c)},5000)}}else{delete modules['betteReddit'].modhash;alert('Sorry, there was an error trying to '+c.getAttribute('action')+' your submission. Try clicking again.')}}})}else{GM_xmlhttpRequest({method:"GET",url:location.protocol+'//'+location.hostname+'/api/me.json?app=res',onload:function(a){var b=safeJSON.parse(a.responseText);if(typeof(b.data)=='undefined'){alert('Sorry, there was an error trying to '+c.getAttribute('action')+' your submission. You may have third party cookies disabled. You will need to either enable third party cookies, or add an exception for *.reddit.com')}else if((typeof(b.data.modhash)!='undefined')&&(b.data.modhash)){modules['betteReddit'].modhash=b.data.modhash;modules['betteReddit'].hideLink(c)}}})}},hideFader:function(a){var b=a.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;RESUtils.fadeElementOut(b,0.3)},searchSubredditByDefault:function(){var a=document.body.querySelector('INPUT[name=restrict_sr]');if(a){a.checked=true}},getVideoTimes:function(a){a=a||document;var b=a.querySelectorAll('a.title[href*="youtube.com"]');if(b){var c=new RegExp(/[\[|\(][0-9]*:[0-9]*[\]|\)]/),ytLinks=[];for(var i=0,len=b.length;i<len;i+=1){if(!b[i].innerHTML.match(c)){ytLinks.push(b[i])}}b=ytLinks;var d=/\?v=([\w\-]{11})&?/i;var e=/\[[\d]+:[\d]+\]/i;var f=modules['betteReddit'].youtubeLinkIDs=[];modules['betteReddit'].youtubeLinkRefs={};for(var i=0,len=b.length;i<len;i++){var g=d.exec(b[i].getAttribute('href'));if(g){var h='"'+g[1]+'"';modules['betteReddit'].youtubeLinkIDs.push(h);modules['betteReddit'].youtubeLinkRefs[h]=b[i]}var j=e.exec(b[i].getAttribute('href'));var k=b[i].innerHTML.match(f);if(j&&!k){b[i].textContent+=' (@'+j[1]+')'}}modules['betteReddit'].getVideoJSON()}},getVideoJSON:function(){var k=modules['betteReddit'].youtubeLinkIDs.splice(0,8);if(k.length){var l=k.join('%7C');var m='http://gdata.youtube.com/feeds/api/videos?q='+l+'&v=2&fields=entry(id,title,media:group(yt:duration,yt:videoid,yt:uploaded))&alt=json';GM_xmlhttpRequest({method:"GET",url:m,onload:function(a){var b=safeJSON.parse(a.responseText,null,true);if((typeof(b.feed)!='undefined')&&(typeof(b.feed.entry)!='undefined')){for(var i=0,len=b.feed.entry.length;i<len;i++){var c='"'+b.feed.entry[i]['media$group']['yt$videoid']['$t']+'"';var d=b.feed.entry[i]['media$group']['yt$duration']['seconds'];var e=b.feed.entry[i]['title']['$t'];var f=Math.floor(d/60);var g=(d%60);if(g<10)g='0'+g;var h=' - ['+f+':'+g+']';if(modules['betteReddit'].options.videoUploaded.value){var j=b.feed.entry[i]['media$group']['yt$uploaded']['$t'];j=j.match(/[^T]*/);h+='['+j+']'}if(typeof(modules['betteReddit'].youtubeLinkRefs[c])!='undefined'){modules['betteReddit'].youtubeLinkRefs[c].textContent+=' '+h;modules['betteReddit'].youtubeLinkRefs[c].setAttribute('title','YouTube title: '+e)}}setTimeout(modules['betteReddit'].getVideoJSON,500)}}})}},pinSubredditBar:function(){var a=modules['subredditManager'].isEnabled();var b=document.getElementById('sr-header-area');if(b==null)return;var c=document.getElementById('header');var d=document.createElement('div');d.style.paddingTop=window.getComputedStyle(b,null).paddingTop;d.style.paddingBottom=window.getComputedStyle(b,null).paddingBottom;if(a)d.style.height=(parseInt(window.getComputedStyle(b,null).height)/3-3)+'px';else d.style.height=window.getComputedStyle(b,null).height;c.insertBefore(d,b);document.body.insertBefore(b,c);RESUtils.addCSS('#header-bottom-left { margin-top: 19px; }');RESUtils.addCSS('div#sr-header-area {position: fixed; z-index: 10000 !important; left: 0; right: 0; }');this.pinCommonElements(a)},pinUserBar:function(){this.userBarElement=document.getElementById('header-bottom-right');var a=$('#header-bottom-right').height();RESUtils.addCSS('#header-bottom-right:hover { opacity: 1 !important;  }');RESUtils.addCSS('#header-bottom-right { height: '+parseInt(a+1)+'px; }');window.addEventListener('scroll',modules['betteReddit'].handleScroll,false);this.pinCommonElements()},handleScroll:function(e){if(modules['betteReddit'].scrollTimer)clearTimeout(modules['betteReddit'].scrollTimer);modules['betteReddit'].scrollTimer=setTimeout(modules['betteReddit'].handleScrollAfterTimer,300)},handleScrollAfterTimer:function(e){if(RESUtils.elementInViewport(modules['betteReddit'].userBarElement)){modules['betteReddit'].userBarElement.setAttribute('style','');if(typeof(modules['accountSwitcher'].accountMenu)!='undefined'){$(modules['accountSwitcher'].accountMenu).attr('style','position: absolute;')}}else if(modules['betteReddit'].options.pinHeader.value==='subanduser'){if(typeof(modules['accountSwitcher'].accountMenu)!='undefined'){$(modules['accountSwitcher'].accountMenu).attr('style','position: fixed;')}modules['betteReddit'].userBarElement.setAttribute('style','position: fixed; z-index: 10000 !important; top: 19px; right: 0; opacity: 0.6; -webkit-transition:opacity 0.3s ease-in; -moz-transition:opacity 0.3s ease-in; -o-transition:opacity 0.3s ease-in; -ms-transition:opacity 0.3s ease-in; -transition:opacity 0.3s ease-in;')}else{if(typeof(modules['accountSwitcher'].accountMenu)!='undefined'){$(modules['accountSwitcher'].accountMenu).attr('style','position: fixed;')}modules['betteReddit'].userBarElement.setAttribute('style','position: fixed; z-index: 10000 !important; top: 0px; right: 0; opacity: 0.6; -webkit-transition:opacity 0.3s ease-in; -moz-transition:opacity 0.3s ease-in; -o-transition:opacity 0.3s ease-in; -ms-transition:opacity 0.3s ease-in; -transition:opacity 0.3s ease-in;')}},pinHeader:function(){var a=modules['subredditManager'].isEnabled();var b=document.getElementById('header');if(b==null)return;var c=document.createElement('div');c.id='RESPinnedHeaderSpacer';RESUtils.addCSS('#sr-header-area {left: 0; right: 0;}');c.style.height=$('#header').outerHeight()+"px";document.body.insertBefore(c,b.nextSibling);RESUtils.addCSS('#header, #RESAccountSwitcherDropdown {position:fixed;}');RESUtils.addCSS('#header {left: 0; right: 0; }');var d=$('#header').height()+15;RESUtils.addCSS('#RESNotifications { top: '+d+'px } ');this.pinCommonElements(a);if(document.getElementById('header-img')&&(!document.getElementById('header-img').complete))setTimeout(function(){if(document.getElementById('header-img').complete)document.getElementById('RESPinnedHeaderSpacer').style.height=window.getComputedStyle(document.getElementById('header'),null).height;else setTimeout(arguments.callee,10)},10)},pinCommonElements:function(a){if(a){RESUtils.addCSS('#RESSubredditGroupDropdown, #srList, #RESShortcutsAddFormContainer, #editShortcutDialog {position: fixed !important;}')}else{RESUtils.addCSS('#sr-more-link: {position: fixed;}');RESUtils.addCSS('div#subreddit_dropdown.drop-choices {position: fixed;}')}},showInputLength:function(){RESUtils.addCSS('.RESCharCounter { color: grey; float: right; }');RESUtils.addCSS('.RESCharCounter.tooLong { color: red; }');$('#title-field span.title').after($('<span>').attr('id','titleLength').attr('title','character limit: 300').addClass('RESCharCounter').text('0/300'));this.titleLength=$('#titleLength');$('#title-field textarea[name="title"]').bind('input',function(){var a=$(this).val().length;if(a>300){$(modules['betteReddit'].titleLength).text(a+'/300').addClass('tooLong')}else{$(modules['betteReddit'].titleLength).text(a+'/300').removeClass('tooLong')}});$('#text-field span.title + span').after($('<span>').attr('id','textLength').attr('title','character limit: 10,000').addClass('RESCharCounter').text('0/10000'));$('#text-field textarea[name="text"]').bind('input',function(){$('#textLength').text($(this).val().length+'/10000')})}};modules['singleClick']={moduleID:'singleClick',moduleName:'Single Click Opener',category:'UI',options:{openOrder:{type:'enum',values:[{name:'open comments then link',value:'commentsfirst'},{name:'open link then comments',value:'linkfirst'}],value:'commentsfirst',description:'What order to open the link/comments in.'},hideLEC:{type:'boolean',value:false,description:'Hide the [l=c] when the link is the same as the comments page'},openBackground:{type:'boolean',value:false,description:'Open the [l+c] link in background tabs'}},description:'Adds an [l+c] link that opens a link and the comments page in new tabs for you in one click.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[\?]*/i,/https?:\/\/([a-z]+).reddit.com\/r\/[-\w\._]*\//i),exclude:Array(/https?:\/\/([a-z]+).reddit.com\/r\/[-\w\._\/\?]*\/comments[-\w\._\/\?=]*/i),beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){RESUtils.addCSS('.redditSingleClick { color: #888888; font-weight: bold; cursor: pointer; padding: 0 1px; }')}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){this.applyLinks();RESUtils.watchForElement('siteTable',modules['singleClick'].applyLinks)}},applyLinks:function(d){var d=d||document;var f=d.querySelectorAll('#siteTable .entry, #siteTable_organic .entry');for(var i=0,len=f.length;i<len;i++){if((typeof(f[i])!='undefined')&&(!(hasClass(f[i],'lcTagged')))){addClass(f[i],'lcTagged')var g=f[i].querySelector('A.title');if(g!=null){var h=g.getAttribute('href');var j=f[i].querySelector('.comments');if(!(h.match(/^http/i))){h='http://'+document.domain+h}var k=f[i].querySelector('ul.flat-list');var l=document.createElement('li');var m=document.createElement('span');m.setAttribute('class','redditSingleClick');m.setAttribute('thisLink',h);m.setAttribute('thisComments',j);if(h!=j){m.textContent='[l+c]'}else if(!(modules['singleClick'].options.hideLEC.value)){m.textContent='[l=c]'}l.appendChild(m);k.appendChild(l);m.addEventListener('mousedown',function(e){e.preventDefault();var a=(modules['singleClick'].options.openBackground.value)?1:0;if(e.button!=2){var b=$(this).parent().parent().parent().find('a.title').attr('href');if(!(b.match(/^http/i))){b='http://'+document.domain+b}if(typeof(chrome)!='undefined'){var c={requestType:'singleClick',linkURL:b,openOrder:modules['singleClick'].options.openOrder.value,commentsURL:this.getAttribute('thisComments'),button:a,ctrl:e.ctrlKey};chrome.extension.sendMessage(c)}else if(typeof(safari)!='undefined'){var c={requestType:'singleClick',linkURL:b,openOrder:modules['singleClick'].options.openOrder.value,commentsURL:this.getAttribute('thisComments'),button:a,ctrl:e.ctrlKey}safari.self.tab.dispatchMessage("singleClick",c)}else if(typeof(opera)!='undefined'){var c={requestType:'singleClick',linkURL:b,openOrder:modules['singleClick'].options.openOrder.value,commentsURL:this.getAttribute('thisComments'),button:a,ctrl:e.ctrlKey}opera.extension.postMessage(JSON.stringify(c))}else if(typeof(self.on)=='function'){var c={requestType:'singleClick',linkURL:b,openOrder:modules['singleClick'].options.openOrder.value,commentsURL:this.getAttribute('thisComments'),button:a,ctrl:e.ctrlKey}self.postMessage(c)}else{var b=$(this).parent().parent().parent().find('a.title').attr('href');if(!(b.match(/^http/i))){b='http://'+document.domain+b}if(modules['singleClick'].options.openOrder.value=='commentsfirst'){if(b!=this.getAttribute('thisComments')){window.open(this.getAttribute('thisComments'))}window.open(b)}else{window.open(b);if(b!=this.getAttribute('thisComments')){window.open(this.getAttribute('thisComments'))}}}}},false)}}}}};modules['commentPreview']={moduleID:'commentPreview',moduleName:'Live Comment Preview',category:'Comments',options:{commentingAs:{type:'boolean',value:true,description:'Shows your currently logged in username to avoid posting from the wrong account.'},subredditAutocomplete:{type:'boolean',value:true,description:'Show subreddit autocomplete tool when typing in posts, comments and replies'},keyboardShortcuts:{type:'boolean',value:true,description:'Use keyboard shortcuts to apply styles to selected text'},macros:{type:'table',addRowText:'+add shortcut',fields:[{name:'label',type:'text'},{name:'text',type:'textarea'}],value:[],description:"Add buttons to insert frequently used snippets of text."}},description:'Provides a live preview of comments, as well as shortcuts for easier markdown.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]+\/comments\/[-\w\.]+/i,/https?:\/\/([a-z]+).reddit.com\/comments\/[-\w\.]+/i,/https?:\/\/([a-z]+).reddit.com\/message\/[-\w\.]*\/?[-\w\.]*/i,/https?:\/\/([a-z]+).reddit.com\/r\/[-\w\.]*\/submit\/?/i,/https?:\/\/([a-z]+).reddit.com\/user\/[-\w\.\/]*\/?/i,/https?:\/\/([a-z]+).reddit.com\/submit\/?/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){RESUtils.addCSS('.markdownEditor { white-space: nowrap;  }');RESUtils.addCSS('.markdownEditor a { margin-right: 8px; text-decoration: none; font-size: 11px; }');RESUtils.addCSS('.selectedItem { color: #ffffff; background-color: #5f99cf; }');RESUtils.addCSS('.RESDialogSmall.livePreview { position: relative; width: auto; margin-bottom: 15px; }');RESUtils.addCSS('.RESDialogSmall.livePreview .RESDialogContents h3 { font-weight: bold; }');RESUtils.addCSS('.RESMacroDropdownTitle, .RESMacroDropdownTitleOverlay { cursor: pointer; display: inline-block; font-size: 11px; text-decoration: underline; color: gray; padding-left: 2px; padding-right: 21px; background-image: url(http://www.redditstatic.com/droparrowgray.gif); background-position: 100% 50%; background-repeat: no-repeat; }');RESUtils.addCSS('.RESMacroDropdownTitleOverlay { cursor: pointer; }');RESUtils.addCSS('#RESMacroDropdown { display: none; }');RESUtils.addCSS('#RESMacroDropdownContainer { display: none; position: absolute; }');RESUtils.addCSS('#RESMacroDropdownList { margin-top: 0; width: auto; max-width: 300px; }');RESUtils.addCSS('#RESMacroDropdown li { padding-right: 10px; height: 25px; line-height: 24px; }')}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){if(this.options.subredditAutocomplete.value)this.subredditAutocomplete();this.converter=SnuOwnd.getParser();modules['commentPreview'].wireupCommentEditors();modules['commentPreview'].wireupViewSourceButtons(document.body);RESUtils.watchForElement('newCommentsForms',modules['commentPreview'].wireupCommentEditors);RESUtils.watchForElement('newComments',modules['commentPreview'].wireupViewSourceButtons)}},wireupViewSourceButtons:function(c){if(c==null)c=document;if((RESUtils.pageType()=='comments')||(RESUtils.pageType()=='inbox')){modules['commentPreview'].commentMenus=c.querySelectorAll('.entry .flat-list.buttons li:first-child');modules['commentPreview'].commentMenusCount=modules['commentPreview'].commentMenus.length;modules['commentPreview'].commentMenusi=0;(function(){var a=Math.min((modules['commentPreview'].commentMenusCount-modules['commentPreview'].commentMenusi),15);for(var i=0;i<a;i++){var b=document.createElement('li');$(b).html('<a href="javascript:void(0)">source</a>');b.addEventListener('click',modules['commentPreview'].viewSource,false);if(modules['commentPreview'].commentMenus[modules['commentPreview'].commentMenusi].nextSibling!=null){insertAfter(modules['commentPreview'].commentMenus[modules['commentPreview'].commentMenusi].nextSibling,b)}else{insertAfter(modules['commentPreview'].commentMenus[modules['commentPreview'].commentMenusi],b)}modules['commentPreview'].commentMenusi++}if(modules['commentPreview'].commentMenusi<modules['commentPreview'].commentMenusCount){setTimeout(arguments.callee,1000)}})()}},removeExistingPreview:function(a){var b=a.querySelectorAll('div.livePreview');for(var i=0,preview=null;preview=b[i];i++){preview.parentNode.removeChild(preview);break}},removeExistingEditor:function(a){var b=a.querySelectorAll('.markdownEditor, .commentingAs');for(var i=0,div=null;div=b[i];i++){div.parentNode.removeChild(div)}},addPreviewToParent:function(c){modules['commentPreview'].removeExistingPreview(c);modules['commentPreview'].removeExistingEditor(c);var d=document.createElement('div');d.setAttribute('class','RESDialogSmall livePreview');$(d).html('<h3>Live Preview</h3>');var f=document.createElement('div');f.setAttribute('class','md RESDialogContents');d.appendChild(f);f.parentNode.style.display='none';c.appendChild(d);var g=c.getElementsByTagName('textarea');if(g[0]){var h=g[0];var j=null;h.addEventListener('keyup',function(e){if(j)clearTimeout(j);j=setTimeout(function(){modules['commentPreview'].refreshPreview(f,h)},100)},false);if(modules['commentPreview'].options.keyboardShortcuts.value){h.addEventListener('keydown',function(e){if((e.ctrlKey||e.metaKey)&&(!e.shiftKey)&&(!e.altKey)){var a=$(e.target).getSelection().text.split('\n\n');var b='\n\n';for(var i=0,len=a.length;i<len;i++){toReplace=a[i];if(i==len-1)b='';if(toReplace!=''){switch(String.fromCharCode(e.keyCode)){case'I':e.preventDefault();if(((toReplace.substr(0,1)=='*')&&(toReplace.substr(0,2)!='**'))&&((toReplace.substr(-1)=='*')&&(toReplace.substr(-2)!='**'))){toReplace=toReplace.substr(1,toReplace.length-2)}else{toReplace='*'+toReplace+'*'}toReplace+=b;$(e.target).replaceSelection(toReplace,true);break;case'B':e.preventDefault();if((toReplace.substr(0,2)=='**')&&(toReplace.substr(-2)=='**')){toReplace=toReplace.substr(2,toReplace.length-4)}else{toReplace='**'+toReplace+'**'}toReplace+=b;$(e.target).replaceSelection(toReplace,true);break;case'S':e.preventDefault();if((toReplace.substr(0,2)=='~~')&&(toReplace.substr(-2)=='~~')){toReplace=toReplace.substr(2,toReplace.length-4)}else{toReplace='~~'+toReplace+'~~'}toReplace+=b;$(e.target).replaceSelection(toReplace,true);break}}}}},false)}f.textArea=h;modules['commentPreview'].addPreviewClearOnCommentSubmit(c,f)}return f},addPreviewClearOnCommentSubmit:function(a,b){var c=a.getElementsByTagName('button');for(var i=0,button=null;button=c[i];i++){if(button.getAttribute('class')=="save"){button.addEventListener('click',function(){$(b).html('')},false)}}},wireupCommentEditors:function(c){c=c||document.body;var d=$(c).find('div.usertext-edit').each(function(){var a=this;var b=modules['commentPreview'].addPreviewToParent(a);modules['commentPreview'].addMarkdownEditorToForm(a,b)})},refreshPreview:function(a,b){if(b.value==''){a.parentNode.style.display='none'}else{a.parentNode.style.display='block'}$(a).html(modules['commentPreview'].converter.render(b.value))},addMarkdownEditorToForm:function(f,g){var h=f.getElementsByTagName('textarea');if(!h[0])return;var i=h[0];i.setAttribute('tabIndex',0);var j=document.createElement('div');j.setAttribute('class','markdownEditor');f.insertBefore(j,f.firstChild);if((modules['commentPreview'].options.commentingAs.value)&&(!(modules['usernameHider'].isEnabled()))){var k=document.createElement('div');k.setAttribute('class','commentingAs');$(k).text('Commenting as: '+RESUtils.loggedInUser());f.insertBefore(k,f.firstChild)}var l=new modules['commentPreview'].EditControl('<b>Bold</b>',function(){modules['commentPreview'].tagSelection(i,'**','**');modules['commentPreview'].refreshPreview(g,i);i.focus()},'ctrl-b');var m=new modules['commentPreview'].EditControl('<i>Italic</i>',function(){modules['commentPreview'].tagSelection(i,'*','*');modules['commentPreview'].refreshPreview(g,i);i.focus()},'ctrl-i');var n=new modules['commentPreview'].EditControl('<del>strike</del>',function(){modules['commentPreview'].tagSelection(i,'~~','~~');modules['commentPreview'].refreshPreview(g,i);i.focus()},'ctrl-s');var o=new modules['commentPreview'].EditControl('<sup>sup</sup>',function(){modules['commentPreview'].tagSelection(i,'^','');modules['commentPreview'].refreshPreview(g,i);i.focus()});var p=new modules['commentPreview'].EditControl('Link',function(){linkSelection(i);modules['commentPreview'].refreshPreview(g,i);i.focus()});var q=new modules['commentPreview'].EditControl('|Quote',function(){modules['commentPreview'].prefixSelectionLines(i,'>');modules['commentPreview'].refreshPreview(g,i);i.focus()});var r=new modules['commentPreview'].EditControl('<span style="font-family: Courier New;">Code</span>',function(){modules['commentPreview'].prefixSelectionLines(i,'    ');modules['commentPreview'].refreshPreview(g,i);i.focus()});var s=new modules['commentPreview'].EditControl('&bull;Bullets',function(){modules['commentPreview'].prefixSelectionLines(i,'* ');modules['commentPreview'].refreshPreview(g,i);i.focus()});var t=new modules['commentPreview'].EditControl('1.Numbers',function(){modules['commentPreview'].prefixSelectionLines(i,'1. ');modules['commentPreview'].refreshPreview(g,i);i.focus()});var u=new modules['commentPreview'].EditControl('&#3232;\_&#3232;',function(){modules['commentPreview'].prefixCursor(modules['commentPreview'].macroTargetTextarea,'&#3232;\\\_&#3232;');modules['commentPreview'].refreshPreview(modules['commentPreview'].macroTargetPreview,modules['commentPreview'].macroTargetTextarea);modules['commentPreview'].macroTargetTextarea.focus()});var v=new modules['commentPreview'].EditControl('[Promote]',function(){var a=$(this).data('promoteCount')||0;a++;$(this).data('promoteCount',a);if(a>2){$(this).hide();modules['commentPreview'].lod();return false}modules['commentPreview'].prefixSelectionLines(modules['commentPreview'].macroTargetTextarea,'[Reddit Enhancement Suite](http://redditenhancementsuite.com)');modules['commentPreview'].refreshPreview(modules['commentPreview'].macroTargetPreview,modules['commentPreview'].macroTargetTextarea);modules['commentPreview'].macroTargetTextarea.focus()});var w=new modules['commentPreview'].EditControl('reddiquette',function(){var a=$(this).data('promoteCount')||0;a++;$(this).data('promoteCount',a);if(a>2){$(this).hide();return false}modules['commentPreview'].prefixCursor(i,'[reddiquette](http://www.reddit.com/help/reddiquette) ');modules['commentPreview'].refreshPreview(g,i);i.focus()});j.appendChild(l.create());j.appendChild(m.create());j.appendChild(n.create());j.appendChild(o.create());j.appendChild(p.create());j.appendChild(q.create());j.appendChild(r.create());j.appendChild(s.create());j.appendChild(t.create());j.appendChild(w.create());modules['commentPreview'].macroDropdownTitle=$('<span class="RESMacroDropdownTitle">macros</span>')$(j).append(modules['commentPreview'].macroDropdownTitle);if(typeof(modules['commentPreview'].macroDropdownContainer)=='undefined'){modules['commentPreview'].macroDropdownContainer=$('<span id="RESMacroDropdown"><span class="RESMacroDropdownTitleOverlay">macros</span></span>')modules['commentPreview'].macroDropdown=$('<ul id="RESMacroDropdownList" class="RESDropdownList"></ul>')var x=$('<li />');$(x).append(u.create());$(modules['commentPreview'].macroDropdown).append(x);x=$('<li />');$(x).append(v.create());$(modules['commentPreview'].macroDropdown).append(x);Array.prototype.slice.call(modules['commentPreview'].options['macros'].value).forEach(function(a,b,c){var d=$('<li />');$(d).append(new modules['commentPreview'].EditControl(a[0],function(){modules['commentPreview'].prefixCursor(modules['commentPreview'].macroTargetTextarea,a[1]);modules['commentPreview'].refreshPreview(modules['commentPreview'].macroTargetPreview,modules['commentPreview'].macroTargetTextarea);$(modules['commentPreview'].macroDropdownContainer).hide();modules['commentPreview'].macroTargetTextarea.focus()}).create());$(modules['commentPreview'].macroDropdown).append(d)});var x=$('<li><a href="javascript:void(0)">+ add macro</a>');$(x).click(modules['commentPreview'].manageMacros)$(modules['commentPreview'].macroDropdown).append(x);$(modules['commentPreview'].macroDropdownContainer).append(modules['commentPreview'].macroDropdown);$(modules['commentPreview'].macroDropdownContainer).mouseleave(function(e){$(this).hide()});$(document.body).append(modules['commentPreview'].macroDropdownContainer)}$(".RESMacroDropdownTitle").live('click',modules['commentPreview'].showMacroDropdown)},EditControl:function(a,b,c){this.create=function(){this.link=document.createElement('a');if(c)this.link.title=c;$(this.link).html(a);this.link.setAttribute('tabindex','1');this.link.href='javascript:;';this.link.execute=b;modules['commentPreview'].addEvent(this.link,'click','execute');return this.link}},tagSelection:function(a,b,c,d){var e=a.scrollTop;var f=a.selectionStart;var g=a.selectionEnd;var h=a.value.substring(f,g);var i='';if(h[h.length-1]==' '){i=' ';h=h.substring(0,h.length-1)}if(d){h=d(h)}a.value=a.value.substring(0,f)+b+h+c+i+a.value.substring(g);a.selectionStart=f+b.length;a.selectionEnd=g+b.length;a.scrollTop=e},linkSelection:function(b){var c=prompt("Enter the URL:","");if(c!=null){modules['commentPreview'].tagSelection(b,'[',']('+c.replace(/\(/,'\\(').replace(/\)/,'\\)')+')',function(a){return a.replace(/\[/,'\\[').replace(/\]/,'\\]').replace(/\(/,'\\(').replace(/\)/,'\\)')})}},prefixCursor:function(a,b){var c=a.scrollTop;var d=a.value;var e=a.selectionStart;d=d.slice(0,e)+b+d.slice(e);a.value=d;a.selectionStart+=b.length;a.scrollTop=c},prefixSelectionLines:function(a,b){var c=a.scrollTop;var d=a.selectionStart;var e=a.selectionEnd;var f=a.value.substring(d,e);var g=f.split('\n');var h='';for(var i=0;i<g.length;i++){h+=b+g[i];if((i+1)!=g.length){h+='\n'}}a.value=a.value.substring(0,d)+h+a.value.substring(e);a.scrollTop=c},addEvent:function(a,b,c){a.addEventListener(b,function(e){a[c](e)},false)},manageMacros:function(){RESConsole.open();RESConsole.menuClick(document.getElementById('Menu-Comments'));RESConsole.drawConfigOptions('commentPreview')},showMacroDropdown:function(e){modules['commentPreview'].macroTargetTextarea=$(e.target).parent().parent().find('textarea')[0];modules['commentPreview'].macroTargetPreview=$(e.target).parent().parent().find('.livePreview div.md')[0];var a=$(e.target).offset();var b=(a.left)+"px";var c=(a.top)+"px";$(modules['commentPreview'].macroDropdownContainer).css({position:'absolute',zIndex:50,left:b,top:c}).show()},lod:function(){if(typeof(this.firstlod)=='undefined'){this.firstlod=true;$('body').append('<div id="RESlod" style="display: none; position: fixed; left: 0; top: 0; right: 0; bottom: 0; background-color: #dddddd; opacity: 0.9; z-index: 99999;"><div style="position: relative; text-align: center; width: 400px; height: 300px; margin: auto;"><div style="font-size: 100px; margin-bottom: 10px;">&#3232;\_&#3232;</div> when you do this, people direct their frustrations at <b>me</b>... could we please maybe give this a rest?</div></div>')}$('#RESlod').fadeIn('slow',function(){setTimeout(function(){$('#RESlod').fadeOut('slow')},5000)})},viewSource:function(e){e.preventDefault();var g=e.target;if(g){var h=g.parentNode.parentNode.firstChild.firstChild;if(h){var i=g.parentNode.parentNode.previousSibling;if(typeof(i.querySelector)=='undefined')i=i.previousSibling;var j=i.querySelector('.viewSource');if(j){j.style.display='block'}else{var k=h.getAttribute('href');var l='comment';if(hasClass(h,'comments')){l='selftext'}if(k.indexOf('?context')!=-1){k=k.replace('?context=3','.json?')}else{k+='/.json'}modules['commentPreview'].viewSourceEle=g;modules['commentPreview'].viewSourceLink=l;k=RESUtils.insertParam(k,'app','res');GM_xmlhttpRequest({method:"GET",url:k,onload:function(a){var b=JSON.parse(a.responseText);var c=document.createElement('div');addClass(c,'usertext-edit');addClass(c,'viewSource');if(modules['commentPreview'].viewSourceLink=='comment'){var d=null;if(typeof(b[1])!='undefined'){d=b[1].data.children[0].data.body}else{d=b.data.children[0].data.body}$(c).html('<div><textarea rows="1" cols="1" name="text">'+d+'</textarea></div><div class="bottom-area"><div class="usertext-buttons"><button type="button" class="cancel">hide</button></div></div>')}else{var d=b[0].data.children[0].data.selftext;$(c).html('<div><textarea rows="1" cols="1" name="text">'+d+'</textarea></div><div class="bottom-area"><div class="usertext-buttons"><button type="button" class="cancel">hide</button></div></div>')}var e=c.querySelector('.cancel');e.addEventListener('click',modules['commentPreview'].hideSource,false);var f=modules['commentPreview'].viewSourceEle.parentNode.parentNode.previousSibling;if(typeof(f.querySelector)=='undefined')f=f.previousSibling;f.appendChild(c)}})}}}},hideSource:function(e){e.target.parentNode.parentNode.parentNode.style.display='none'},subredditAutocomplete:function(a){if(!this.subredditAutocompleteRunOnce){this.KEY={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188};if(!a)a=$('textarea:not([name=title])');this.subredditAutocompleteRunOnce=true;this.subredditAutocompleteCache={};this.subredditRE=/\W\/?r\/([\w\.]*)$/,this.subredditSkipRE=/\W\/?r\/([\w\.]*)\ $/,this.linkReplacementRE=/([^\w\[\(])\/r\/(\w*(?:\.\w*)?)([^\w\]\)])/g;modules['commentPreview'].subredditAutocompleteDropdown=$('<div id="subreddit_dropdown" class="drop-choices srdrop inuse" style="display:none; position:relative;"><a class="choice"></a></div>');$('body').append(modules['commentPreview'].subredditAutocompleteDropdown)}$(a).live('keyup',modules['commentPreview'].subredditAutocompleteTrigger);$(a).live('keydown',modules['commentPreview'].subredditAutocompleteNav)},subredditAutocompleteTrigger:function(a){if(/[^A-Za-z0-9 ]/.test(String.fromCharCode(a.keyCode))){return false}if(typeof(modules['commentPreview'].subredditAutoCompleteAJAXTimer)!='undefined')clearTimeout(modules['commentPreview'].subredditAutoCompleteAJAXTimer);modules['commentPreview'].currentTextArea=a.target;var b=modules['commentPreview'].subredditRE.exec(' '+a.target.value.substr(0,a.target.selectionStart));if(!b||b[1]==''||b[1].length>10){if((a.keyCode==32)||(a.keyCode==13)){b=modules['commentPreview'].subredditSkipRE.exec(' '+a.target.value.substr(0,a.target.selectionStart));if(b){modules['commentPreview'].addSubredditLink(b[1])}}return modules['commentPreview'].hideSubredditAutocompleteDropdown()}var c=b[1].toLowerCase();if(modules['commentPreview'].subredditAutocompleteCache[c])return modules['commentPreview'].updateSubredditAutocompleteDropdown(modules['commentPreview'].subredditAutocompleteCache[c],a.target);var d=a.target;modules['commentPreview'].subredditAutoCompleteAJAXTimer=setTimeout(function(){$.post('/api/search_reddit_names.json?app=res',{query:c},function(r){modules['commentPreview'].subredditAutocompleteCache[c]=r['names'];modules['commentPreview'].updateSubredditAutocompleteDropdown(r['names'],d);modules['commentPreview'].subredditAutocompleteDropdownSetNav(0)},"json")},200);$(this).blur(modules['commentPreview'].hideSubredditAutocompleteDropdown)},subredditAutocompleteNav:function(a){if($("#subreddit_dropdown").is(':visible')){switch(a.keyCode){case modules['commentPreview'].KEY.DOWN:case modules['commentPreview'].KEY.RIGHT:a.preventDefault();var b=$("#subreddit_dropdown a.choice");if(modules['commentPreview'].subredditAutocompleteDropdownNavidx<b.length-1)modules['commentPreview'].subredditAutocompleteDropdownNavidx++;modules['commentPreview'].subredditAutocompleteDropdownSetNav(modules['commentPreview'].subredditAutocompleteDropdownNavidx);break;case modules['commentPreview'].KEY.UP:case modules['commentPreview'].KEY.LEFT:a.preventDefault();if(modules['commentPreview'].subredditAutocompleteDropdownNavidx>0)modules['commentPreview'].subredditAutocompleteDropdownNavidx--;modules['commentPreview'].subredditAutocompleteDropdownSetNav(modules['commentPreview'].subredditAutocompleteDropdownNavidx);break;case modules['commentPreview'].KEY.TAB:case modules['commentPreview'].KEY.ENTER:a.preventDefault();var b=$("#subreddit_dropdown a.choice");RESUtils.mousedown(b[modules['commentPreview'].subredditAutocompleteDropdownNavidx]);break;case modules['commentPreview'].KEY.ESCAPE:a.preventDefault();modules['commentPreview'].hideSubredditAutocompleteDropdown();break}}},subredditAutocompleteDropdownSetNav:function(a){modules['commentPreview'].subredditAutocompleteDropdownNavidx=a;var b=$("#subreddit_dropdown a.choice");for(var i=0,len=b.length;i<len;i++){$(b[i]).removeClass('selectedItem');if(i==a)$(b[i]).addClass('selectedItem')}},hideSubredditAutocompleteDropdown:function(){$("#subreddit_dropdown").hide()},updateSubredditAutocompleteDropdown:function(a,b){$(b).after(modules['commentPreview'].subredditAutocompleteDropdown);if(!a.length)return modules['commentPreview'].hideSubredditAutocompleteDropdown();var c=modules['commentPreview'].subredditAutocompleteDropdown.children(":first");modules['commentPreview'].subredditAutocompleteDropdown.children().remove();for(var i=0,len=a.length;i<len;i++){if(i>10)break;var d=c.clone();d.text(a[i]);modules['commentPreview'].subredditAutocompleteDropdown.append(d);d.mousedown(modules['commentPreview'].updateSubredditAutocompleteTextarea)}modules['commentPreview'].subredditAutocompleteDropdown.show();if(typeof(modules['commentPreview'].subredditAutocompleteDropdownNavidx)=='undefined')modules['commentPreview'].subredditAutocompleteDropdownNavidx=0;modules['commentPreview'].subredditAutocompleteDropdownSetNav(modules['commentPreview'].subredditAutocompleteDropdownNavidx)},updateSubredditAutocompleteTextarea:function(a){modules['commentPreview'].hideSubredditAutocompleteDropdown();modules['commentPreview'].addSubredditLink(this.innerHTML)},addSubredditLink:function(a){var b=modules['commentPreview'].currentTextArea,caretPos=b.selectionStart,beforeCaret=b.value.substr(0,caretPos),afterCaret=b.value.substr(caretPos);var c='/r/'+a+' ';beforeCaret=beforeCaret.replace(/\/?r\/(\w*)\ ?$/,c);b.value=beforeCaret+afterCaret;b.selectionStart=b.selectionEnd=beforeCaret.length;b.focus()}};modules['usernameHider']={moduleID:'usernameHider',moduleName:'Username Hider',category:'Accounts',options:{displayText:{type:'text',value:'~anonymous~',description:'What to replace your username with, default is ~anonymous~'}},description:'This module hides your real username when you\'re logged in to reddit.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]*/i,/https?:\/\/reddit.com\/[-\w\.\/]*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},go:function(){if((this.isEnabled())&&(this.isMatchURL())){if(!RESUtils.loggedInUser())return false;var a=document.querySelector('#header-bottom-right > span > a');a.textContent=this.options.displayText.value;RESUtils.watchForElement('siteTable',modules['usernameHider'].hideUsername);RESUtils.watchForElement('newComments',modules['usernameHider'].hideUsername);this.hideUsername()}},hideUsername:function(a){a=a||document;var b=a.querySelectorAll('.author');for(var i=0,len=b.length;i<len;i++){if(b[i].textContent==RESUtils.loggedInUser()){b[i].textContent=modules['usernameHider'].options.displayText.value}}}};modules['showImages']={moduleID:'showImages',moduleName:'Inline Image Viewer',category:'UI',options:{maxWidth:{type:'text',value:'640',description:'Max width of image displayed onscreen'},maxHeight:{type:'text',value:'480',description:'Max height of image displayed onscreen'},openInNewWindow:{type:'boolean',value:true,description:'Open images in a new tab/window when clicked?'},hideNSFW:{type:'boolean',value:false,description:'If checked, do not show images marked NSFW.'},autoExpandSelfText:{type:'boolean',value:true,description:'When loading selftext from an Aa+ expando, auto reveal images.'},imageZoom:{type:'boolean',value:true,description:'Allow dragging to resize/zoom images.'},markVisited:{type:'boolean',value:true,description:'Mark links visited when you view images (does eat some resources).'},sfwHistory:{type:'enum',value:'add',values:[{name:'Add links to history',value:'add'},{name:'Color links, but do not add to history',value:'color'},{name:'Do not add or color links.',value:'none'}],description:'Keeps NSFW links from being added to your browser history <span style="font-style: italic">by the markVisited feature</span>.<br/>				<span style="font-style: italic">If you chose the second option, then links will be blue again on refresh.</span><br/>				<span style="color: red">This does not change your basic browser behavior.				If you click on a link then it will still be added to your history normally.				This is not a substitute for using your browser\'s privacy mode.</span>'},ignoreDuplicates:{type:'boolean',value:true,description:'Do not create expandos for images that appear multiple times in a page.'},displayImageCaptions:{type:'boolean',value:true,description:'Retrieve image captions/attribution information.'}},description:'Opens images inline in your browser with the click of a button. Also has configuration options, check it out!',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\_\?=]*/i),exclude:Array(/https?:\/\/([a-z]+).reddit.com\/ads\/[-\w\.\_\?=]*/i,/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]*\/submit\/?$/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){RESUtils.addCSS(".expando-button.image { vertical-align:top !important; float: left; width: 23px; height: 23px; max-width: 23px; max-height: 23px; display: inline-block; background-image: url('http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png'); margin-right: 6px; cursor: pointer;  padding: 0px; }");RESUtils.addCSS(".expando-button.image.commentImg { float: none; margin-left: 4px; } ");RESUtils.addCSS(".expando-button.image.collapsed { background-position: 0px 0px; } ");RESUtils.addCSS(".expando-button.image.collapsed:hover { background-position: 0px -24px; } ");RESUtils.addCSS(".expando-button.image.expanded { background-position: 0px -48px; } ");RESUtils.addCSS(".expando-button.image.expanded:hover { background-position: 0px -72px; } ");RESUtils.addCSS(".expando-button.image.gallery.collapsed { background-position: 0px -368px; } ");RESUtils.addCSS(".expando-button.image.gallery.collapsed:hover { background-position: 0px -392px; } ");RESUtils.addCSS(".expando-button.image.gallery.expanded { background-position: 0px -416px; } ");RESUtils.addCSS(".expando-button.image.gallery.expanded:hover { background-position: 0px -440px; } ");RESUtils.addCSS(".madeVisible { clear: left; display: block; overflow: hidden; } ");RESUtils.addCSS(".madeVisible a { display: inline-block; overflow: hidden; } ");RESUtils.addCSS(".RESImage { float: left; display: block !important;  } ");RESUtils.addCSS(".RESdupeimg { color: #000000; font-size: 10px;  } ");RESUtils.addCSS(".RESClear { clear: both; margin-bottom: 10px;  } ");RESUtils.addCSS('.RESGalleryControls { }');RESUtils.addCSS('.RESGalleryControls a { cursor: pointer; display: inline-block; background-image: url("http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png"); width: 16px; height: 16px; margin: 5px; }');RESUtils.addCSS('.RESGalleryControls span { position: relative; top: -9px; }');RESUtils.addCSS('.RESGalleryControls .previous { background-position: 0px -352px; }');RESUtils.addCSS('.RESGalleryControls .next { background-position: 16px -352px; }');RESUtils.addCSS('.RESGalleryControls .end { background-position-y: -336px; }');RESUtils.addCSS('.RESGalleryControls .previous:hover { background-position: 0px -320px; }');RESUtils.addCSS('.RESGalleryControls .next:hover { background-position: 16px -320px; }');RESUtils.addCSS('.RESGalleryControls .end:hover { background-position-y: -304px; }');RESUtils.addCSS('.imgTitle { font-size: 13px; padding: 2px; }');RESUtils.addCSS('.imgCredits { font-size: 11px; padding: 2px; }');RESUtils.addCSS('.thing .title.visited { color: #551A8B; }');if(!this.options.displayImageCaptions.value){RESUtils.addCSS('.imgTitle, .imgCaptions { display: none; }')}}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){this.imageList=[];this.imagesRevealed={};this.dupeAnchors=0;this.goneWild='';this.goneWildModes={};if(this.options.markVisited.value){if((typeof(chrome)=='undefined')&&(typeof(self.on)=='undefined')){this.imageTrackFrame=document.createElement('iframe');this.imageTrackFrame.addEventListener('load',function(){setTimeout(modules['showImages'].imageTrackShift,300)},false);this.imageTrackFrame.style.display='none';this.imageTrackFrame.style.width='0px';this.imageTrackFrame.style.height='0px';document.body.appendChild(this.imageTrackFrame)}this.imageTrackStack=[]}for(var a in this.siteModules){this.siteModules[a].go()}this.scanningForImages=false;RESUtils.watchForElement('siteTable',modules['showImages'].findAllImages);RESUtils.watchForElement('selfText',modules['showImages'].findAllImagesInSelfText);this.createImageButtons();this.findAllImages();document.addEventListener('dragstart',function(){return false},false)}},findAllImagesInSelfText:function(a){modules['showImages'].findAllImages(a,true)},createImageButtons:function(){if((location.href.match(/search\?\/?q\=/))||(location.href.match(/about\/reports/))||(location.href.match(/about\/spam/))||(location.href.match(/about\/unmoderated/))||(location.href.match(/modqueue/))||(location.href.toLowerCase().match('dashboard'))){var b=document.body.querySelector('#header-bottom-left');if(b){var c=document.createElement('ul');c.setAttribute('class','tabmenu viewimages');c.setAttribute('style','display: inline-block');b.appendChild(c)}}else{var c=document.body.querySelector('#header-bottom-left ul.tabmenu')}if(c){var d=document.createElement('li');var a=document.createElement('a');var f=document.createTextNode('scanning for images...');this.scanningForImages=true;a.href='javascript:void(0);';a.id='viewImagesButton';a.addEventListener('click',function(e){e.preventDefault();if(!modules['showImages'].scanningForImages){modules['showImages'].showImagesToggle()}},true);a.appendChild(f);d.appendChild(a);c.appendChild(d);this.viewImageButton=a;var g=document.querySelector('.side .md a[href^="/RESGoneWildEnable"]');if(!g&&/gonewild/i.test(location.href)){g=$('<a href="/RESGoneWildEnable">')[0]}if(g){var h={};var k=0;if(!/RESGoneWildEnable-nodefault/i.test(g.pathname)){h['m']=['m','man','male'];h['f']=['f','fem','female'];k=2}var l=/^[A-Za-z0-9_ \-]{1,32}$/;if(g.search){var m=g.search.slice(1).split('&');for(var i=0;i<m.length&&k<8;i++){var n=m[i].split('=');if(n.length!=2)continue;var o=decodeURIComponent(n[0]);if(!l.test(o))continue;var p=n[1].split(',');var q=[];for(var j=0;j<p.length&&q.length<8;j++){var r=decodeURIComponent(p[j]);if(!l.test(r))continue;else q.push(r)}if(q.length>0){if(!(o in h))k++;h[o]=q}}}if(k>0){for(var s in h){this.goneWildModes[s]=new RegExp('[\\[\\{\\<\\(]('+h[s].join('|')+')[\\]\\}\\>\\)]','i')}}}if(!/comments\/[-\w\.\/]/i.test(location.href)){for(var t in this.goneWildModes){var d=document.createElement('li');var a=document.createElement('a');var f=document.createTextNode('['+t+']');a.href='javascript:void(0);';a.addEventListener('click',(function(a){return function(e){e.preventDefault();modules['showImages'].showImagesToggle(a)}})(t),true);a.appendChild(f);d.appendChild(a);c.appendChild(d)}}}},updateImageButtons:function(a){if(typeof(this.viewImageButton)!='undefined'){var b=(this.allImagesVisible?'hide':'view')+' images';if(!RESUtils.currentSubreddit('dashboard'))b+='('+a+')';$(this.viewImageButton).text(b)}},findImageFilter:function(a,b){if(b in this.goneWildModes)var c=this.goneWildModes[b];else b='';var d=(b?c.test(a.text):false);a.NSFW=false;if(this.options.hideNSFW.value){a.NSFW=/nsfw/i.test(a.text)}return(a.href&&(b==''||d)&&!a.NSFW&&typeof(a.site)!='undefined')},findImages:function(a,b){for(var i=0,len=this.imageList.length;i<len;i++){var c=this.imageList[i];this.revealImage(c,b&&(this.findImageFilter(c.imageLink,a)))}},showImagesToggle:function(a,b){if(!a)this.goneWild=a='';else this.goneWild=a;if(this.allImagesVisible&&!b){this.allImagesVisible=false;for(var i=0,len=this.imageList.length;i<len;i++){this.revealImage(this.imageList[i],false)}this.updateImageButtons(this.imageList.length);return false}else{this.allImagesVisible=true;this.updateImageButtons(this.imageList.length);this.findImages(a,true)}},findAllImages:function(b,c){modules['showImages'].scanningForImages=true;if(b==null){b=document.body}var d=/comments\/[-\w\.\/]/i;var e=/user\/[-\w\.\/]/i;modules['showImages'].scanningSelfText=false;var f=[];if(d.test(location.href)||e.test(location.href)){f=b.querySelectorAll('#siteTable a.title, .expando .usertext-body > div.md a, .content .usertext-body > div.md a')}else if(c){f=b.querySelectorAll('.usertext-body > div.md a');modules['showImages'].scanningSelfText=true}else{f=b.querySelectorAll('#siteTable A.title')}if(RESUtils.pageType()=='comments'){(function(){var a=Math.min(this.elements.length-this.elementIndex,15);for(var i=0;i<a;i++,this.elementIndex++){modules['showImages'].checkElementForImage(this.elements[this.elementIndex])}if(this.elementIndex<this.elements.length){setTimeout(arguments.callee.bind(this),1000)}else{modules['showImages'].scanningSelfText=false;modules['showImages'].scanningForImages=false;modules['showImages'].updateImageButtons(modules['showImages'].imageList.length)}}).bind({elements:f,elementIndex:0})()}else{var g=f.length;for(var i=0;i<g;i++){modules['showImages'].checkElementForImage(f[i])}modules['showImages'].scanningSelfText=false;modules['showImages'].scanningForImages=false;modules['showImages'].updateImageButtons(modules['showImages'].imageList.length)}},checkElementForImage:function(a){if(this.options.hideNSFW.value){if(hasClass(a,'title')){a.NSFW=hasClass(a.parentNode.parentNode.parentNode,'over18')}}else{a.NSFW=false}var b=a.href;if((!hasClass(a,'imgScanned')&&(typeof(this.imagesRevealed[b])=='undefined'||!this.options.ignoreDuplicates.value||(RESUtils.currentSubreddit('dashboard')))&&b!=null)||this.scanningSelfText){addClass(a,'imgScanned');this.dupeAnchors++;var c=false;if(c=this.siteModules['default'].detect(a)){a.site='default'}if(!c){for(var d in this.siteModules){if(d=='default')continue;if(this.siteModules[d].detect(a)){a.site=d;c=true;break}}}if(c&&!a.NSFW){this.imagesRevealed[b]=this.dupeAnchors;this.siteModules[a.site].handleLink(a)}}else if(!hasClass(a,'imgScanned')){var e=document.createElement('span');e.setAttribute('class','RESdupeimg');$(e).html(' <a class="noKeyNav" href="#img'+escapeHTML(this.imagesRevealed[b])+'" title="click to scroll to original">[RES ignored duplicate image]</a>');insertAfter(a,e)}},createImageExpando:function(a){if(!a)return false;var b=a.href;if(!b)return false;a.name='img'+this.imagesRevealed[b];var c=document.createElement('a');c.className='toggleImage expando-button collapsed';if(a.type=='IMAGE')c.className+=' image';if(a.type=='GALLERY')c.className+=' image gallery';if(a.type=='TEXT')c.className+=' selftext';$(c).html('&nbsp;');c.addEventListener('click',function(e){e.preventDefault();modules['showImages'].revealImage(e.target,(hasClass(e.target,'collapsed')!=null))},true);var d=null;if(hasClass(a.parentNode,'title')){d=a.parentNode;addClass(c,'linkImg')}else{d=a;addClass(c,'commentImg')}insertAfter(d,c);c.imageLink=a;this.imageList.push(c);if(this.scanningSelfText&&this.options.autoExpandSelfText.value){this.revealImage(c,true)}else if(this.allImagesVisible){this.revealImage(c,this.findImageFilter(c.imageLink,this.goneWild))}if(this.scanningForImages==false){this.updateImageButtons(this.imageList.length)}},revealImageDeferred:function(a){if(hasClass(a.parentNode,'title')){var b=a.parentNode.nextSibling}else{var b=a.nextSibling}this.revealImage(b,true)},revealImage:function(a,b){if((!a)||(!$(a).is(':visible')))return false;var c=a.imageLink;if(typeof(this.siteModules[c.site])=='undefined'){console.log('something went wrong scanning image from site: '+c.site);return}if(this.siteModules[c.site].deferred&&typeof(c.src)=='undefined'){this.siteModules[c.site].deferredHandleLink(c);return}if(a.expandoBox&&hasClass(a.expandoBox,'madeVisible')){if(!b){removeClass(a,'expanded');addClass(a,'collapsed');a.expandoBox.style.display='none'}else{removeClass(a,'collapsed');addClass(a,'expanded');a.expandoBox.style.display='block'}this.handleSidebarHiding()}else if(b){switch(c.type){case'IMAGE':this.generateImageExpando(a);break;case'GALLERY':this.generateGalleryExpando(a);break;case'TEXT':this.generateTextExpando(a);break}}},generateImageExpando:function(a){var b=a.imageLink;var c=document.createElement('div');addClass(c,'madeVisible');if('imageTitle'in b){var d=document.createElement('h3');d.className='imgTitle';$(d).text(b.imageTitle);c.appendChild(d)}var f=document.createElement('a');addClass(f,'madeVisible');f.href=b.href;if(this.options.openInNewWindow.value){f.target='_blank'}var g=(b.type=='IMAGE_SCRAPE')?b.getAttribute('scraped_src'):b.src;$(f).html('<img title="drag to resize" class="RESImage" style="max-width:'+this.options.maxWidth.value+'px;max-height:'+this.options.maxHeight.value+'px;" src="'+g+'" />');var h=f.querySelector('IMG');if('credits'in b){var i=document.createElement('div');i.className='imgCredits';try{$(i).html(RESUtils.sanitizeHTML(b.credits))}catch(e){$(i).text(b.credits)}c.appendChild(i)}c.appendChild(f);if('caption'in b){var j=document.createElement('div');j.className='imgCaptions';$(j).text(b.caption);c.appendChild(j)}if(hasClass(a,'commentImg')){insertAfter(a,c)}else{a.parentNode.appendChild(c)}a.expandoBox=c;removeClass(a,'collapsed');addClass(a,'expanded');this.trackImageLoad(b,h);this.makeImageZoomable(h)},generateGalleryExpando:function(f){var g=f.imageLink;var h=g.galleryStart||0;var i=document.createElement('div');addClass(i,'madeVisible');i.sources=g.src;i.currentImage=h;var j=document.createElement('h3');addClass(j,'imgTitle');j.textContent=g.imageTitle||'';i.appendChild(j);var k=document.createElement('a');addClass(k,'madeVisible');k.href=i.sources[h].href||g.href;if(this.options.openInNewWindow.value){k.target='_blank'}var l=document.createElement('div');l.className='RESGalleryControls';var m=document.createElement("a");m.className='previous noKeyNav';m.addEventListener('click',function(e){var a=e.target.parentElement.parentElement;if(a.currentImage==0){a.currentImage=a.sources.length-1}else{a.currentImage-=1}adjustGalleryDisplay(a)});l.appendChild(m);var n=document.createElement('span');n.className='RESGalleryLabel';var o=(i.sources.length<10)?'0'+i.sources.length:i.sources.length;var p=(h+1<10)?'0'+(h+1):(h+1);n.textContent=p+" of "+o;l.appendChild(n);var q=document.createElement("a");q.className='next noKeyNav';q.addEventListener('click',function(e){var a=e.target.parentElement.parentElement;if(a.currentImage==a.sources.length-1){a.currentImage=0}else{a.currentImage+=1}adjustGalleryDisplay(a)});l.appendChild(q);i.appendChild(l);var r=document.createElement('img');r.src=i.sources[h].src;r.title='drag to resize';addClass(r,'RESImage');r.style.maxWidth=this.options.maxWidth.value+'px';r.style.maxHeight=this.options.maxHeight.value+'px';k.appendChild(r);var s=document.createElement('div');s.className='imgWrapper';var t=document.createElement('h4');t.className='imgCaptions';t.textContent=i.sources[h].title||'';s.appendChild(t);s.appendChild(k);var u=document.createElement('div');u.className='imgCaptions';u.textContent=i.sources[h].caption||'';s.appendChild(u);i.appendChild(s);function adjustGalleryDisplay(a){var b=a.sources[a.currentImage];a.querySelector('img.RESImage').src=b.src;k.href=b.href||g.href;var c=(a.currentImage+1<10)?'0'+(a.currentImage+1):a.currentImage+1;var d=(i.sources.length<10)?'0'+i.sources.length:i.sources.length;a.querySelector('.RESGalleryLabel').textContent=(c+" of "+d);if(a.currentImage==0){m.classList.add('end');q.classList.remove('end')}else if(a.currentImage==a.sources.length-1){m.classList.remove('end');q.classList.add('end')}else{m.classList.remove('end');q.classList.remove('end')}t.textContent=b.title||'';u.textContent=b.caption||''}var v=document.createElement('div');v.className='imgCaptions';v.textContent=g.caption||'';i.appendChild(v);if('credits'in g){var w=document.createElement('div');w.className='imgCredits';try{$(w).html(RESUtils.sanitizeHTML(g.credits||''))}catch(e){$(w).text(g.credits||'')}i.appendChild(w)}if(hasClass(f,'commentImg')){insertAfter(f,i)}else{f.parentNode.appendChild(i)}f.expandoBox=i;removeClass(f,'collapsed');addClass(f,'expanded');this.trackImageLoad(g,r);this.makeImageZoomable(r)},generateTextExpando:function(a){var b=a.imageLink;var c=document.createElement('div');c.className='usertext';var d=document.createElement('div');d.className='madevisible usertext-body';var f=document.createElement('h3');f.className='imgTitle';f.textContent=b.imageTitle||'';d.appendChild(f);var g=document.createElement('div');g.className='md';try{$(g).html(RESUtils.sanitizeHTML(b.src))}catch(error){$(g).text(b.src)}d.appendChild(g);var h=document.createElement('div');h.className='imgCaptions';h.textContent=b.caption||'';d.appendChild(h);if('credits'in b){var i=document.createElement('div');i.className='imgCredits';try{$(i).html(RESUtils.sanitizeHTML(b.credits||''))}catch(e){$(i).text(b.credits||'')}d.appendChild(i)}c.appendChild(d);if(hasClass(a,'commentImg')){insertAfter(a,c)}else{a.parentNode.appendChild(c)}a.expandoBox=d;removeClass(a,'collapsed');addClass(a,'expanded')},trackImageLoad:function(b,c){if(modules['showImages'].options.markVisited.value){var d=$(b).closest('.thing').is('.over18');var f=modules['showImages'].options['sfwHistory'].value;if((typeof(chrome)!='undefined')||(typeof(self.on)!='undefined')){var g=b.historyURL||b.href;if(!d||f!='none')addClass(b,'visited');if(!d||f=='add'){modules['showImages'].imageTrackStack.push(g);if(modules['showImages'].imageTrackStack.length==1)setTimeout(modules['showImages'].imageTrackShift,300)}}else{c.addEventListener('load',function(e){var a=b.historyURL||b.href;if(!d||f!='none')addClass(b,'visited');if(!d||f=='add'){modules['showImages'].imageTrackStack.push(a);if(modules['showImages'].imageTrackStack.length==1)setTimeout(modules['showImages'].imageTrackShift,300)}},false)}}c.addEventListener('load',function(e){modules['showImages'].handleSidebarHiding(e.target)},false)},imageTrackShift:function(){var a=modules['showImages'].imageTrackStack.shift();if(typeof(a)=='undefined'){modules['showImages'].handleSidebarHiding();return}if(typeof(chrome)!='undefined'){if(!chrome.extension.inIncognitoContext){chrome.extension.sendMessage({requestType:'addURLToHistory',url:a})}modules['showImages'].imageTrackShift()}else if(typeof(self.on)!='undefined'){var b={requestType:'addURLToHistory',url:a}self.postMessage(b);modules['showImages'].imageTrackShift()}else if(typeof(modules['showImages'].imageTrackFrame.contentWindow)!='undefined'){modules['showImages'].imageTrackFrame.contentWindow.location.replace(a)}else{modules['showImages'].imageTrackFrame.location.replace(a)}},dragTargetData:{imageWidth:100,diagonal:0,dragging:false},getDragSize:function(e){var a=e.target.getBoundingClientRect();var p=Math.pow;var b=p(p(e.clientX-a.left,2)+p(e.clientY-a.top,2),.5);return Math.round(b)},handleSidebarHiding:function(a){var b=Math.max.apply(Math,$(a||'div.madeVisible img').map(function(){return $(this).position().left+this.offsetWidth}));var c=window.innerWidth-$('.side').width();if(a){var d=Math.max(b,this.furthestRightEdge||0)}else{var d=this.furthestRightEdge=b}if(c-d<15){$('.side').fadeOut();if(a){var e=$(a).closest('div.md');var f=$(e).css('max-width');$(e).data('max-width',f);$(e).css('max-width','100%')}}else{$('.side').fadeIn()}},makeImageZoomable:function(d){if(this.options.imageZoom.value){d.addEventListener('mousedown',function(e){if(e.button==0){if(!d.minWidth)d.minWidth=Math.max(1,Math.min(d.width,100));modules['showImages'].dragTargetData.imageWidth=e.target.width;modules['showImages'].dragTargetData.diagonal=modules['showImages'].getDragSize(e);modules['showImages'].dragTargetData.dragging=false;e.preventDefault()}},true);d.addEventListener('mousemove',function(e){if(modules['showImages'].dragTargetData.diagonal){var a=modules['showImages'].getDragSize(e);var b=modules['showImages'].dragTargetData.diagonal;var c=modules['showImages'].dragTargetData.imageWidth;e.target.style.maxWidth=e.target.style.width=Math.max(e.target.minWidth,a/b*c)+'px';e.target.style.maxHeight='';e.target.style.height='auto';modules['showImages'].handleSidebarHiding(e.target);modules['showImages'].dragTargetData.dragging=true}},false);d.addEventListener('mouseout',function(e){modules['showImages'].dragTargetData.diagonal=0},false);d.addEventListener('mouseup',function(e){if(modules['showImages'].dragTargetData.diagonal){var a=modules['showImages'].getDragSize(e);var b=modules['showImages'].dragTargetData.diagonal;var c=modules['showImages'].dragTargetData.imageWidth;e.target.style.maxWidth=e.target.style.width=Math.max(e.target.minWidth,a/b*c)+'px'}modules['showImages'].handleSidebarHiding();modules['showImages'].dragTargetData.diagonal=0},false);d.addEventListener('click',function(e){modules['showImages'].dragTargetData.diagonal=0;if(modules['showImages'].dragTargetData.dragging){modules['showImages'].dragTargetData.dragging=false;e.preventDefault();return false}},false)}},siteModules:{'default':{acceptRegex:/\.(gif|jpe?g|png)(?:[?&#_].*|$)/i,rejectRegex:/(wikipedia\.org\/wiki|photobucket\.com|gifsound\.com)/i,go:function(){},detect:function(a){var b=a.href;return(this.acceptRegex.test(b)&&!this.rejectRegex.test(b))},handleLink:function(a){var b=a.href;this.handleInfo(a,{type:'IMAGE',src:a.href})},handleInfo:function(a,b){a.type=b.type;a.src=b.src;a.href=b.src;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}modules['showImages'].createImageExpando(a)}},imgur:{APIKey:'fe266bc9466fe69aa1cf0904e7298eda',hashRe:/^https?:\/\/(?:[i.]|[edge.]|[www.])*imgur.com\/(?:r\/[\w]+\/)?([\w]{5,}(?:[&,][\w]{5,})?)(\.[\w]{3,4})?(?:#(\d*))?(?:\?(?:\d*))?$/i,albumHashRe:/^https?:\/\/(?:i\.)?imgur.com\/a\/([\w]+)(\..+)?(?:\/)?(?:#\d*)?$/i,apiPrefix:'http://api.imgur.com/2/',calls:{},go:function(){},detect:function(a){return a.href.toLowerCase().indexOf('imgur.com/')>=0},handleLink:function(c){var d=c.href.split('?')[0];var e=this.hashRe.exec(d);if(!e)var f=this.albumHashRe.exec(d);if(e&&!e[2]){if(e[1].search(/[&,]/)>-1){var g=e[1].split(/[&,]/);modules['showImages'].siteModules['imgur'].handleInfo(c,{album:{images:g.map(function(a){return{image:{title:'',caption:'',hash:a},links:{original:'http://i.imgur.com/'+a+'.jpg'}}})}})}else{modules['showImages'].siteModules['imgur'].handleInfo(c,{image:{links:{original:'http://i.imgur.com/'+e[1]+'.jpg'},image:{}}})}}else if(f&&!f[2]){var h=this.apiPrefix+'album/'+f[1]+'.json';if(h in this.calls){this.handleInfo(c,this.calls[h])}else{GM_xmlhttpRequest({method:'GET',url:h,onload:function(a){try{var b=JSON.parse(a.responseText)}catch(error){var b={}}modules['showImages'].siteModules['imgur'].calls[h]=b;modules['showImages'].siteModules['imgur'].handleInfo(c,b)}})}}},handleInfo:function(a,b){if('image'in b){this.handleSingleImage(a,b)}else if('album'in b){this.handleGallery(a,b)}else{}},handleSingleImage:function(a,b){a.src=b.image.links.original;a.href=b.image.links.original;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}a.type='IMAGE';if(b.image.image.caption)a.caption=b.image.image.caption;modules['showImages'].createImageExpando(a)},handleGallery:function(b,c){var d=b.href.split('#')[0];b.src=c.album.images.map(function(e,i,a){return{title:e.image.title,src:e.links.original,href:d+'#'+e.image.hash,caption:e.image.caption}});if(b.hash){var f=b.hash.slice(1);if(isNaN(f)){for(var i=0;i<b.src.length;i++){if(f==c.album.images[i].image.hash){b.galleryStart=i;break}}}else{b.galleryStart=parseInt(f)}}b.imageTitle=c.album.title;b.caption=c.album.description;b.type='GALLERY';modules['showImages'].createImageExpando(b)}},ehost:{hashRe:/^http:\/\/(?:i\.)?(?:\d+\.)?eho.st\/(\w+)\/?/i,go:function(){},detect:function(a){var b=a.href.toLowerCase();return b.indexOf('eho.st')>=0&&b.substring(-1)!='+'},handleLink:function(a){var b=this.hashRe.exec(a.href);if(b){this.handleInfo(a,{src:'http://i.eho.st/'+b[1]+'.jpg'})}},handleInfo:function(a,b){a.type='IMAGE';a.src=b.src;a.href=b.src;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}modules['showImages'].createImageExpando(a)}},picsarus:{hashRe:/^https?:\/\/(?:[i.]|[edge.]|[www.])*picsarus.com\/(?:r\/[\w]+\/)?([\w]{6,})(\..+)?$/i,go:function(){},detect:function(a){var b=a.href.toLowerCase();return b.indexOf('picsarus.com')>=0&&b.substring(-1)!='+'},handleLink:function(a){var b=this.hashRe.exec(a.href);if(b){this.handleInfo(a,{src:'http://www.picsarus.com/'+b[1]+'.jpg'})}},handleInfo:function(a,b){a.type='IMAGE';a.src=b.src;a.href=b.src;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}modules['showImages'].createImageExpando(a)}},snaggy:{go:function(){},detect:function(a){return a.href.toLowerCase().indexOf('snag.gy/')>=0},handleLink:function(a){var b=a.href;var c=['.jpg','.png','.gif'];if(b.indexOf('i.snag')==-1)b=b.replace('snag.gy','i.snag.gy');if(c.indexOf(b.substr(-4))==-1)b=b+'.jpg';this.handleInfo(a,{src:b})},handleInfo:function(a,b){a.type='IMAGE';a.src=b.src;a.href=b.src;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}modules['showImages'].createImageExpando(a)}},picshd:{deferred:true,hashRe:/^https?:\/\/(?:[i.]|[edge.]|[www.])*picshd.com\/([\w]{5,})(\..+)?$/i,go:function(){},detect:function(a){var b=a.href.toLowerCase();return b.indexOf('picshd.com/')>=0},handleLink:function(a){var b=this.hashRe.exec(a.href);if(b){this.handleInfo(a,'http://i.picshd.com/'+b[1]+'.jpg')}},handleInfo:function(a,b){a.type='IMAGE';a.src=b;a.href=b;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}modules['showImages'].createImageExpando(a)}},minus:{hashRe:/^http:\/\/min.us\/([\w]+)(?:#[\d+])?$/i,calls:{},go:function(){},detect:function(a){var b=a.href.toLowerCase();return b.indexOf('min.us')>=0&&b.indexOf('blog.')==-1},handleLink:function(c){var d=c.href.split('?')[0];var f=d.split('.');var g=(f.length>1?f[f.length-1].toLowerCase():'');if(['jpg','jpeg','png','gif'].indexOf(g)){var h=this.hashRe.exec(d);if(h&&!h[2]){var i=h[1];if(i.substr(0,1)=='m'){var j='http://min.us/api/GetItems/'+i;if(j in this.calls){this.handleInfo(c,this.calls[j])}else{GM_xmlhttpRequest({method:'GET',url:j,onload:function(a){try{var b=JSON.parse(a.responseText)}catch(e){var b={}}modules['showImages'].siteModules['minus'].calls[j]=b;modules['showImages'].siteModules['minus'].handleInfo(c,b)}})}}}}},handleInfo:function(a,b){if('ITEMS_GALLERY'in b){if(b.ITEMS_GALLERY.length>1){a.type='GALLERY';a.src={src:b.ITEMS_GALLERY}}else{a.type='IMAGE';a.href=b.ITEMS_GALLERY[0];if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}a.src=b.ITEMS_GALLERY[0]}modules['showImages'].createImageExpando(a)}}},flickr:{hashRe:/^http:\/\/(?:\w+).?flickr.com\/(?:.*)\/([\d]{10})\/?(?:.*)?$/i,calls:{},go:function(){},detect:function(a){var b=a.href;return this.hashRe.test(b)},handleLink:function(c){var d=c.href;var f=this.hashRe.exec(d);if(f&&!f[2]){var g=f[1];var h='http://api.flickr.com/services/rest/?method=flickr.photos.getSizes&api_key=0414c8799c8baa02c83cf14c219e5b46&photo_id='+g+'&format=json&nojsoncallback=1';if(h in this.calls){this.handleInfo(c,this.calls[h])}else{GM_xmlhttpRequest({method:'GET',url:h,onload:function(a){try{var b=JSON.parse(a.responseText)}catch(e){var b={}}modules['showImages'].siteModules['flickr'].calls[h]=b;modules['showImages'].siteModules['flickr'].handleInfo(c,b)}})}}},handleInfo:function(a,b){if(typeof(b.sizes)=='undefined'){return false}var c=0;var d='';for(i in b.sizes['size']){var e=b.sizes['size'][i];if(e['width']>c){c=e['width'];d=e['source']}}a.type='IMAGE';a.href=d;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}a.src=d;modules['showImages'].createImageExpando(a)}},steam:{go:function(){},detect:function(a){return a.href.toLowerCase().indexOf('cloud.steampowered.com')>=0},handleLink:function(a){this.handleInfo(a,a.href)},handleInfo:function(a,b){a.type='IMAGE';a.src=b;a.href=b;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}modules['showImages'].createImageExpando(a)}},quickmeme:{hashRe:/^http:\/\/(?:(?:www.)?quickmeme.com\/meme|qkme.me|i.qkme.me)\/([\w]+)\/?/i,go:function(){},detect:function(a){var b=a.href.toLowerCase();return b.indexOf('qkme.me')>=0||b.indexOf('quickmeme.com')>=0},handleLink:function(a){var b=this.hashRe.exec(a.href);if(b){this.handleInfo(a,'http://i.qkme.me/'+b[1]+'.jpg')}},handleInfo:function(a,b){a.type='IMAGE';a.src=b;a.href=b;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}modules['showImages'].createImageExpando(a)}},deviantart:{calls:{},matchRe:/^http:\/\/(?:fav.me\/.*|(?:.+\.)?deviantart.com\/(?:art\/.*|[^#]*#\/d.*))$/i,go:function(){},detect:function(a){return this.matchRe.test(a.href)},handleLink:function(c){var d='http://backend.deviantart.com/oembed?url='+encodeURIComponent(c.href);if(d in this.calls){this.handleInfo(c,this.calls[d])}else{GM_xmlhttpRequest({method:'GET',url:d,aggressiveCache:true,onload:function(a){try{var b=JSON.parse(a.responseText)}catch(error){var b={}}modules['showImages'].siteModules['deviantart'].calls[d]=b;modules['showImages'].siteModules['deviantart'].handleInfo(c,b)}})}},handleInfo:function(a,b){if('url'in b){a.imageTitle=b.title;var c=a.href;if(['jpg','jpeg','png','gif'].indexOf(b.url)){a.src=b.url}else{a.src=b.thumbnail_url}if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}a.credits='Art by: <a href="'+b.author_url+'">'+b.author_name+'</a> @ DeviantArt';a.type='IMAGE';modules['showImages'].createImageExpando(a)}}},tumblr:{calls:{},APIKey:'WeJQquHCAasi5EzaN9jMtIZkYzGfESUtEvcYDeSMLICveo3XDq',matchRE:/^https?:\/\/([a-z0-9\-]+\.tumblr\.com)\/post\/(\d+)(?:\/.*)?$/i,go:function(){},detect:function(a){return this.matchRE.test(a.href)},handleLink:function(c){var d=this.matchRE.exec(c.href);if(d){var e='http://api.tumblr.com/v2/blog/'+d[1]+'/posts?api_key='+this.APIKey+'&id='+d[2]+'&filter=raw';if(e in this.calls){this.handleInfo(c,this.calls[e])}else{GM_xmlhttpRequest({method:'GET',url:e,aggressiveCache:true,onload:function(a){try{var b=JSON.parse(a.responseText)}catch(error){var b={}}if('meta'in b&&b.meta.status==200){modules['showImages'].siteModules['tumblr'].calls[e]=b;modules['showImages'].siteModules['tumblr'].handleInfo(c,b)}}})}}},handleInfo:function(a,b){var c=a.href;var d=b.response.posts[0];switch(d.type){case'photo':if(d.photos.length>1){a.type='GALLERY';a.src=d.photos.map(function(e){return{src:e.original_size.url,caption:e.caption}})}else{a.type="IMAGE";a.src=d.photos[0].original_size.url}break;case'text':a.type='TEXT';a.imageTitle=d.title;if(d.format=='markdown'){a.src=modules['commentPreview'].converter.render(d.body)}else if(d.format=='html'){a.src=d.body}break;default:return;break}a.caption=d.caption;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}a.credits='Posted by: <a href="'+b.response.blog.url+'">'+b.response.blog.name+'</a> @ Tumblr';modules['showImages'].createImageExpando(a)}},memecrunch:{hashRe:/^http:\/\/memecrunch.com\/meme\/([0-9A-Z]+)\/([\w\-]+)(\/image\.(png|jpg))?/i,go:function(){},detect:function(a){return a.href.toLowerCase().indexOf('memecrunch.com')>=0},handleLink:function(a){var b=this.hashRe.exec(a.href);if(b&&typeof(b[1])!='undefined'){this.handleInfo(a,'http://memecrunch.com/meme/'+b[1]+'/'+(b[2]||'null')+'/image.png')}},handleInfo:function(a,b){a.type='IMAGE';a.src=b;a.href=b;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}modules['showImages'].createImageExpando(a)}},livememe:{hashRe:/^http:\/\/(?:www.livememe.com|lvme.me)\/([\w]+)\/?/i,go:function(){},detect:function(a){return a.href.toLowerCase().indexOf('livememe.com')>=0},handleLink:function(a){var b=this.hashRe.exec(a.href);if(b){this.handleInfo(a,'http://www.livememe.com/'+b[1]+'.jpg')}},handleInfo:function(a,b){a.type='IMAGE';a.src=b;a.href=b;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}modules['showImages'].createImageExpando(a)}},memefive:{hashRe:/^http:\/\/(?:www.memefive.com)\/meme\/([\w]+)\/?/i,altHashRe:/^http:\/\/(?:www.memefive.com)\/([\w]+)\/?/i,go:function(){},detect:function(a){return a.href.toLowerCase().indexOf('memefive.com')>=0},handleLink:function(a){var b=this.hashRe.exec(a.href);if(!b){b=this.altHashRe.exec(a.href)}if(b){this.handleInfo(a,'http://memefive.com/memes/'+b[1]+'.jpg')}},handleInfo:function(a,b){a.type='IMAGE';a.src=b;a.href=b;if(RESUtils.pageType()=='linklist'){$(a).closest('.thing').find('.thumbnail').attr('href',a.href)}modules['showImages'].createImageExpando(a)}}}};modules['showKarma']={moduleID:'showKarma',moduleName:'Show Comment Karma',category:'Accounts',options:{separator:{type:'text',value:'\u00b7',description:'Separator character between post/comment karma'},useCommas:{type:'boolean',value:false,description:'Use commas for large karma numbers'}},description:'Shows your comment karma next to your link karma.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:[/https?:\/\/([a-z]+).reddit.com\/.*/i],isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},go:function(){if((this.isEnabled())&&(this.isMatchURL())){if(RESUtils.loggedInUser()){RESUtils.loggedInUserInfo(modules['showKarma'].updateKarmaDiv)}}},updateKarmaDiv:function(a){var b=document.querySelector("#header-bottom-right .userkarma");if((typeof(b)!='undefined')&&(b!=null)){var c=b.innerHTML;b.title='';var d=a.data.comment_karma;if(modules['showKarma'].options.useCommas.value){c=RESUtils.addCommas(c);d=RESUtils.addCommas(d)}$(b).html("<a title=\"link karma\" href=\"/user/"+RESUtils.loggedInUser()+"/submitted/\">"+c+"</a> "+modules['showKarma'].options.separator.value+" <a title=\"comment karma\" href=\"/user/"+RESUtils.loggedInUser()+"/comments/\">"+d+"</a>")}}};modules['hideChildComments']={moduleID:'hideChildComments',moduleName:'Hide All Child Comments',category:'Comments',options:{automatic:{type:'boolean',value:false,description:'Automatically hide all but parent comments, or provide a link to hide them all?'}},description:'Allows you to hide all comments except for replies to the OP for easier reading.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:[/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]+\/comments\/[-\w\.]+/i,/https?:\/\/([a-z]+).reddit.com\/comments\/[-\w\.]+/i],isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},go:function(){if((this.isEnabled())&&(this.isMatchURL())){var a=document.createElement('li');this.toggleAllLink=document.createElement('a');this.toggleAllLink.textContent='hide all child comments';this.toggleAllLink.setAttribute('action','hide');this.toggleAllLink.setAttribute('href','javascript:void(0);');this.toggleAllLink.setAttribute('title','Show only replies to original poster.');this.toggleAllLink.addEventListener('click',function(){modules['hideChildComments'].toggleComments(this.getAttribute('action'));if(this.getAttribute('action')=='hide'){this.setAttribute('action','show');this.setAttribute('title','Show all comments.');this.textContent='show all child comments'}else{this.setAttribute('action','hide');this.setAttribute('title','Show only replies to original poster.');this.textContent='hide all child comments'}},true);a.appendChild(this.toggleAllLink);var b=document.querySelector('ul.buttons');if(b){b.appendChild(a);var c=document.querySelectorAll('div.commentarea > div.sitetable > div.thing > div.child > div.listing');for(var i=0,len=c.length;i<len;i++){var a=document.createElement('li');var d=document.createElement('a');d.textContent='hide child comments';d.setAttribute('action','hide');d.setAttribute('href','javascript:void(0);');d.setAttribute('class','toggleChildren');d.addEventListener('click',function(e){modules['hideChildComments'].toggleComments(this.getAttribute('action'),this);if(this.getAttribute('action')=='hide'){this.setAttribute('action','show');this.textContent='show child comments'}else{this.setAttribute('action','hide');this.textContent='hide child comments'}},true);a.appendChild(d);var f=c[i].parentNode.previousSibling;if(typeof(f)!='undefined'){var g=f.querySelector('ul.buttons');if(g)g.appendChild(a)}}if(this.options.automatic.value){RESUtils.click(this.toggleAllLink)}}}},toggleComments:function(a,b){if(b){var c=b.parentNode.parentNode.parentNode.parentNode.nextSibling.firstChild;if(c.tagName=='FORM')c=c.nextSibling;(a=='hide')?c.style.display='none':c.style.display='block'}else{var d=document.querySelectorAll('div.commentarea > div.sitetable > div.thing');for(var i=0,len=d.length;i<len;i++){var c=d[i].querySelector('div.child > div.sitetable');var e=d[i].querySelector('a.toggleChildren');if(e!=null){if(a=='hide'){if(c!=null){c.style.display='none'}e.textContent='show child comments';e.setAttribute('action','show')}else{if(c!=null){c.style.display='block'}e.textContent='hide child comments';e.setAttribute('action','hide')}}}}}};modules['showParent']={moduleID:'showParent',moduleName:'Show Parent on Hover',category:'Comments',options:{},description:'Shows parent comment when hovering over the "parent" link of a comment.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:[/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]+\/comments\/[-\w\.]+/i,/https?:\/\/([a-z]+).reddit.com\/comments\/[-\w\.]+/i],isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},go:function(){if((this.isEnabled())&&(this.isMatchURL())){this.wireUpParentLinks();RESUtils.watchForElement('newComments',modules['showParent'].wireUpParentLinks)}},show:function(a){var b=a.target.getAttribute('href');b=b.replace(location.href,'');var c=b.replace(/\#/,"");var d=parseInt(a.pageY,10)+10,left=parseInt(a.pageX,10)+10;try{var f=createElementWithID('div','parentComment'+c);addClass(f,'comment parentComment');var g='';if((!(modules['styleTweaks'].options.commentBoxes.value))||(!(modules['styleTweaks'].isEnabled()))){(modules['styleTweaks'].options.lightOrDark.value=='dark')?g='border: 1px solid #666666; padding: 4px; background-color: #333333;':g='border: 1px solid #666666; padding: 4px; background-color: #FFFFFF;'}f.setAttribute('style','width:auto;position:absolute; top:'+d+'px; left:'+left+'px; '+g+';');var h=document.querySelector('div.id-t1_'+c);var i=h.innerHTML.replace(/\<ul\s+class[\s\S]+\<\/ul\>/,"").replace(/\<a[^\>]+>\[-\]\<\/a\>/,'');$(f).html(i);modules['showParent'].getTag('body')[0].appendChild(f)}catch(e){}},hide:function(a){var b=a.target.getAttribute('href');b=b.replace(location.href,'');var c=b.replace(/\#/,"");try{var d=modules['showParent'].getId("parentComment"+c);d.parentNode.removeChild(d)}catch(e){}},getId:function(a,b){if(!b)return document.getElementById(a);return b.getElementById(a)},getTag:function(a,b){if(!b)return document.getElementsByTagName(a);return b.getElementsByTagName(a)},wireUpParentLinks:function(b){if(b==null)b=document;var c='.child ul.flat-list > li:nth-child(2) > a';if(b!=document){c='ul.flat-list > li:nth-child(2) > a';var d=b.querySelectorAll(c);for(var i=0,len=d.length;i<len;i++){d[i].addEventListener('mouseover',modules['showParent'].show,false);d[i].addEventListener('mouseout',modules['showParent'].hide,false)}}else{modules['showParent'].parentLinks=b.querySelectorAll(c);modules['showParent'].parentLinksCount=modules['showParent'].parentLinks.length;modules['showParent'].parentLinksi=0;(function(){var a=Math.min((modules['showParent'].parentLinksCount-modules['showParent'].parentLinksi),15);for(var i=0;i<a;i++){modules['showParent'].parentLinks[modules['showParent'].parentLinksi].addEventListener('mouseover',modules['showParent'].show,false);modules['showParent'].parentLinks[modules['showParent'].parentLinksi].addEventListener('mouseout',modules['showParent'].hide,false);modules['showParent'].parentLinksi++}if(modules['showParent'].parentLinksi<modules['showParent'].parentLinksCount){setTimeout(arguments.callee,1000)}})()}}};modules['neverEndingReddit']={moduleID:'neverEndingReddit',moduleName:'Never Ending Reddit',category:'UI',options:{returnToPrevPage:{type:'boolean',value:true,description:'Return to the page you were last on when hitting "back" button?'},autoLoad:{type:'boolean',value:true,description:'Automatically load new page on scroll (if off, you click to load)'},hideDupes:{type:'enum',value:'fade',values:[{name:'Fade',value:'fade'},{name:'Hide',value:'hide'},{name:'Do not hide',value:'none'}],description:'Fade or completely hide duplicate posts from previous pages.'}},description:'Inspired by modules like River of Reddit and Auto Pager - gives you a never ending stream of reddit goodness.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:[/https?:\/\/([a-z]+).reddit.com\/[-\w\.\_\?=]*/i],exclude:[],isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){RESUtils.addCSS('#NERModal { display: none; z-index: 999; position: fixed; top: 0px; left: 0px; right: 0px; bottom: 0px; background-color: #333333; opacity: 0.6; }');RESUtils.addCSS('#NERContent { display: none; position: fixed; top: 40px; z-index: 1000; width: 720px; background-color: #FFFFFF; color: #000000; padding: 10px; font-size: 12px; }');RESUtils.addCSS('#NERModalClose { position: absolute; top: 3px; right: 3px; }');RESUtils.addCSS('#NERFail { width: 95%; height: 30px; font-size: 14px; border: 1px solid #999999; border-radius: 10px 10px 10px 10px; -moz-border-radius: 10px 10px 10px 10px; -webkit-border-radius: 10px 10px 10px 10px; padding: 5px; text-align: center; bgcolor: #f0f3fc; cursor: pointer; }');RESUtils.addCSS('.NERdupe p.title:after { color: #000000; font-size: 10px; content: \' (duplicate from previous page)\'; }');RESUtils.addCSS('.NERPageMarker { text-align: center; color: #7f7f7f; font-size: 14px; margin-top: 6px; margin-bottom: 6px; font-weight: normal; background-color: #f0f3fc; border: 1px solid #c7c7c7; border-radius: 3px 3px 3px 3px; padding: 3px 0px 3px 0px; }');switch(this.options.hideDupes.value){case'fade':RESUtils.addCSS('.NERdupe { opacity: 0.3; }');break;case'hide':RESUtils.addCSS('.NERdupe { display: none; }');break}RESUtils.addCSS('#progressIndicator { width: 95%; height: 30px; font-size: 14px; border: 1px solid #999999; border-radius: 10px 10px 10px 10px; -moz-border-radius: 10px 10px 10px 10px; -webkit-border-radius: 10px 10px 10px 10px; padding: 5px; text-align: center; bgcolor: #f0f3fc; cursor: pointer; } ');RESUtils.addCSS('#NREMailCount { margin-left: 0px; float: left; margin-top: 3px;}');RESUtils.addCSS('#NREPause { margin-left: 2px; width: 16px; height: 16px; float: left; background-image: url("http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png"); cursor: pointer; background-position: 0px -192px; }');RESUtils.addCSS('#NREPause.paused { width: 16px; height: 16px; background-image: url("http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png"); cursor: pointer; background-position: -16px -192px; }')}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){if(RESUtils.pageType()!='linklist'){sessionStorage.NERpageURL=location.href}if(typeof(modules['neverEndingReddit'].dupeHash)=='undefined')modules['neverEndingReddit'].dupeHash={};var a=document.body.querySelectorAll('a.comments');for(var i=a.length-1;i>-1;i--){modules['neverEndingReddit'].dupeHash[a[i].href]=1}this.allLinks=document.body.querySelectorAll('#siteTable div.thing');var b=document.querySelectorAll('#siteTable');this.siteTable=b[0];if(b.length==2){this.siteTable=b[1]}var c=document.body.querySelectorAll('.content .nextprev a');if(c.length>0){var d=c[c.length-1];if(d){this.nextPageURL=d.getAttribute('href');var f=RESUtils.getXYpos(d);this.nextPageScrollY=f.y}this.attachLoaderWidget();if(this.options.returnToPrevPage.value){$('a.title[href^="http://"]').live('click',function(e){if((this.target!='_blank')&&(e.which==1))sessionStorage.lastPageURL=this.href});this.returnToPrevPageCheck()}if(this.options.autoLoad.value){window.addEventListener('scroll',modules['neverEndingReddit'].handleScroll,false)}}var g=document.body.querySelectorAll('.content p.nextprev');for(var i=0,len=g.length;i<len;i++){g[i].style.display='none'}this.navMail=document.body.querySelector('#mail');this.NREFloat=createElementWithID('div','NREFloat');this.NREPause=createElementWithID('div','NREPause');this.NREPause.setAttribute('title','Pause / Restart Never Ending Reddit');this.isPaused=(RESStorage.getItem('RESmodules.neverEndingReddit.isPaused')==true);if(this.isPaused)addClass(this.NREPause,'paused');this.NREPause.addEventListener('click',modules['neverEndingReddit'].togglePause,false);if((modules['betteReddit'].options.pinHeader.value!='userbar')&&(modules['betteReddit'].options.pinHeader.value!='header')){this.NREMail=createElementWithID('a','NREMail');if(modules['betteReddit'].options.pinHeader.value=='sub'){RESUtils.addCSS('#NREFloat { position: fixed; top: 23px; right: 8px; display: none; }')}else if(modules['betteReddit'].options.pinHeader.value=='subanduser'){RESUtils.addCSS('#NREFloat { position: fixed; top: 44px; right: 0px; display: none; }');RESUtils.addCSS('#NREMail { display: none; }');RESUtils.addCSS('#NREMailCount { display: none; }')}else{RESUtils.addCSS('#NREFloat { position: fixed; top: 10px; right: 10px; display: none; }')}RESUtils.addCSS('#NREMail { width: 16px; height: 12px; float: left; margin-top: 4px; }');RESUtils.addCSS('#NREMail.nohavemail { background-image: url(/static/sprite-main.png?v=816b8dcd1f863d0343bb5e0d9e094215); background-position: -16px -521px; }');RESUtils.addCSS('#NREMail.havemail { background-image: url(/static/sprite-main.png?v=816b8dcd1f863d0343bb5e0d9e094215); background-position: 0 -521px; }');this.NREFloat.appendChild(this.NREMail);this.NREMailCount=createElementWithID('a','NREMailCount');this.NREMailCount.display='none';this.NREMailCount.setAttribute('href','/message/unread');this.NREFloat.appendChild(this.NREMailCount);var h=false;if((typeof(this.navMail)!='undefined')&&(this.navMail!=null)){h=hasClass(this.navMail,'havemail')}this.setMailIcon(h)}else{this.NREMail=this.navMail;RESUtils.addCSS('#NREFloat { position: fixed; top: 30px; right: 8px; display: none; }')}this.NREFloat.appendChild(this.NREPause);document.body.appendChild(this.NREFloat)}},pageMarkers:[],pageURLs:[],togglePause:function(){modules['neverEndingReddit'].isPaused=!modules['neverEndingReddit'].isPaused;RESStorage.setItem('RESmodules.neverEndingReddit.isPaused',modules['neverEndingReddit'].isPaused);if(modules['neverEndingReddit'].isPaused){addClass(modules['neverEndingReddit'].NREPause,'paused')}else{removeClass(modules['neverEndingReddit'].NREPause,'paused');modules['neverEndingReddit'].handleScroll()}},returnToPrevPageCheck:function(){this.attachModalWidget();this.currPage=1;if((sessionStorage.NERpageURL)&&(sessionStorage.NERpageURL!=sessionStorage.lastPageURL)){var a=sessionStorage.getItem('NERpage')||1;if(a>1){this.currPage=a;this.loadNewPage(true)}}sessionStorage.lastPageURL=location.href},handleScroll:function(e){if(modules['neverEndingReddit'].scrollTimer)clearTimeout(modules['neverEndingReddit'].scrollTimer);modules['neverEndingReddit'].scrollTimer=setTimeout(modules['neverEndingReddit'].handleScrollAfterTimer,300)},handleScrollAfterTimer:function(e){var a=1;for(var i=0,len=modules['neverEndingReddit'].pageMarkers.length;i<len;i++){var b=RESUtils.getXYpos(modules['neverEndingReddit'].pageMarkers[i]);if(b.y<window.pageYOffset){a=modules['neverEndingReddit'].pageMarkers[i].getAttribute('id').replace('page-','')}else{break}}var c=RESUtils.pageType()+'.'+RESUtils.currentSubreddit();RESStorage.setItem('RESmodules.neverEndingReddit.lastPage.'+c,modules['neverEndingReddit'].pageURLs[a]);if(a!=sessionStorage.NERpage){if(a>1){sessionStorage.NERpageURL=location.href;sessionStorage.NERpage=a;modules['neverEndingReddit'].pastFirstPage=true}else{delete sessionStorage['NERpage']}}if((modules['neverEndingReddit'].fromBackButton!=true)&&(modules['neverEndingReddit'].options.returnToPrevPage.value)){for(var i=0,len=modules['neverEndingReddit'].allLinks.length;i<len;i++){if(RESUtils.elementInViewport(modules['neverEndingReddit'].allLinks[i])){var d=modules['neverEndingReddit'].allLinks[i].getAttribute('class');var f=d.match(/id-t[\d]_[\w]+/);if(f){var g=f[0];var c=RESUtils.pageType()+'.'+RESUtils.currentSubreddit();RESStorage.setItem('RESmodules.neverEndingReddit.lastVisibleIndex.'+c,g);break}}}}if((RESUtils.elementInViewport(modules['neverEndingReddit'].progressIndicator))&&(modules['neverEndingReddit'].fromBackButton!=true)){if(modules['neverEndingReddit'].isPaused!=true){modules['neverEndingReddit'].loadNewPage()}}if($(window).scrollTop()>30){modules['neverEndingReddit'].showFloat(true)}else{modules['neverEndingReddit'].showFloat(false)}},duplicateCheck:function(a){var b=a.querySelectorAll('div.link');for(var i=b.length-1;i>-1;i--){var c=b[i];var d=c.querySelector('a.comments').href;if(modules['neverEndingReddit'].dupeHash[d]){addClass(c,'NERdupe')}else{modules['neverEndingReddit'].dupeHash[d]=1}}return a},setMailIcon:function(a){if(RESUtils.loggedInUser()==null)return false;if(a){modules['neverEndingReddit'].hasNewMail=true;removeClass(this.NREMail,'nohavemail');this.NREMail.setAttribute('href','http://www.reddit.com/message/unread/');this.NREMail.setAttribute('title','new mail!');var b='/static/mail.png';if(modules['styleTweaks'].options.colorBlindFriendly.value){b='http://thumbs.reddit.com/t5_2s10b_5.png'}addClass(this.NREMail,'havemail');modules['betteReddit'].showUnreadCount()}else{modules['neverEndingReddit'].hasNewMail=false;addClass(this.NREMail,'nohavemail');this.NREMail.setAttribute('href','http://www.reddit.com/message/inbox/');this.NREMail.setAttribute('title','no new mail');removeClass(this.NREMail,'havemail');modules['betteReddit'].setUnreadCount(0)}},attachModalWidget:function(){this.modalWidget=createElementWithID('div','NERModal');$(this.modalWidget).html('&nbsp;');this.modalContent=createElementWithID('div','NERContent');$(this.modalContent).html('<div id="NERModalClose" class="RESCloseButton">&times;</div>Never Ending Reddit has detected that you are returning from a page that it loaded. Please give us a moment while we reload that content and return you to where you left off.<br><img src="'+RESConsole.loader+'">');document.body.appendChild(this.modalWidget);document.body.appendChild(this.modalContent);$('#NERModalClose').click(function(){$(modules['neverEndingReddit'].modalWidget).hide();$(modules['neverEndingReddit'].modalContent).hide()})},attachLoaderWidget:function(){this.progressIndicator=document.createElement('p');var a=(this.options.autoLoad.value)?'scroll or ':'';$(this.progressIndicator).html('Never Ending Reddit - '+a+'click to activate, or you can <a id="NERStaticLink" href="'+this.nextPageURL+'">open the URL manually</a>');this.progressIndicator.id='progressIndicator';this.progressIndicator.className='neverEndingReddit';this.progressIndicator.addEventListener('click',function(e){if(e.target.id=='NERStaticLink'){return true}else{e.preventDefault();modules['neverEndingReddit'].loadNewPage()}},false);insertAfter(this.siteTable,this.progressIndicator)},loadNewPage:function(q,r){if(q){this.fromBackButton=true;var s=RESUtils.pageType()+'.'+RESUtils.currentSubreddit();var t=this.nextPageURL;this.nextPageURL=RESStorage.getItem('RESmodules.neverEndingReddit.lastPage.'+s);if((this.nextPageURL=='undefined')||(this.nextPageURL==null)){modules['neverEndingReddit'].fromBackButton=false;this.nextPageURL=t;this.currPage=1;return false}var u=Math.floor((window.innerWidth-720)/2);this.modalWidget.style.display='block';this.modalContent.style.display='block';this.modalContent.style.left=u+'px';this.progressIndicator.parentNode.removeChild(modules['neverEndingReddit'].progressIndicator)}else{this.fromBackButton=false}if(this.isLoading!=true){this.progressIndicator.removeEventListener('click',modules['neverEndingReddit'].loadNewPage,false);$(this.progressIndicator).html('<img src="'+RESConsole.loader+'"> Loading next page...');this.isLoading=true;if(this.nextPageURL.indexOf(location.hostname)==-1){console.log('Next page URL mismatch. Something strange may be afoot.')return false}GM_xmlhttpRequest({method:"GET",url:this.nextPageURL,onload:function(a){if((typeof(modules['neverEndingReddit'].progressIndicator.parentNode)!='undefined')&&(modules['neverEndingReddit'].progressIndicator.parentNode!=null)){modules['neverEndingReddit'].progressIndicator.parentNode.removeChild(modules['neverEndingReddit'].progressIndicator)}var b=a.responseText;var c=document.createElement('div');$(c).html(b.replace(/<script(.|\s)*?\/script>/g,''));var d=c.querySelector('#siteTable');if(d){var e=c.querySelectorAll('#siteTable');if(e.length==2){d=e[1]}d.setAttribute('ID','siteTable-'+modules['neverEndingReddit'].currPage+1);modules['neverEndingReddit'].duplicateCheck(d);var f=c.querySelector('#mail');if((typeof(f)!='undefined')&&(f!=null)&&(hasClass(f,'havemail'))){modules['neverEndingReddit'].setMailIcon(true)}else{modules['neverEndingReddit'].setMailIcon(false)}var g=c.querySelectorAll('.content .nextprev a');if((g)&&(g.length)){if(isNaN(modules['neverEndingReddit'].currPage))modules['neverEndingReddit'].currPage=1;if(!q)modules['neverEndingReddit'].currPage++;if((!(modules['neverEndingReddit'].fromBackButton))&&(modules['neverEndingReddit'].options.returnToPrevPage.value)){modules['neverEndingReddit'].pageURLs[modules['neverEndingReddit'].currPage]=modules['neverEndingReddit'].nextPageURL;var h=RESUtils.pageType()+'.'+RESUtils.currentSubreddit();RESStorage.setItem('RESmodules.neverEndingReddit.lastPage.'+h,modules['neverEndingReddit'].nextPageURL)}var i=g[g.length-1];var j=createElementWithID('div','page-'+modules['neverEndingReddit'].currPage);addClass(j,'NERPageMarker');$(j).text('Page '+modules['neverEndingReddit'].currPage);modules['neverEndingReddit'].siteTable.appendChild(j);modules['neverEndingReddit'].pageMarkers.push(j);modules['neverEndingReddit'].siteTable.appendChild(d);modules['neverEndingReddit'].isLoading=false;if(i){if(i.getAttribute('rel').indexOf('prev')!=-1){modules['neverEndingReddit'].progressIndicator.style.display='none';var k=createElementWithID('div','endOfReddit');$(k).text('You\'ve reached the last page available.  There are no more pages to load.');modules['neverEndingReddit'].siteTable.appendChild(k);window.removeEventListener('scroll',modules['neverEndingReddit'].handleScroll,false)}else{modules['neverEndingReddit'].nextPageURL=i.getAttribute('href');modules['neverEndingReddit'].attachLoaderWidget()}}modules['neverEndingReddit'].allLinks=document.body.querySelectorAll('#siteTable div.thing');if((q)&&(modules['neverEndingReddit'].options.returnToPrevPage.value)){modules['neverEndingReddit'].modalWidget.style.display='none';modules['neverEndingReddit'].modalContent.style.display='none';var h=RESUtils.pageType()+'.'+RESUtils.currentSubreddit();var l=RESStorage.getItem('RESmodules.neverEndingReddit.lastVisibleIndex.'+h);var m=document.body.querySelector('.'+l);if(!m){var m=d.querySelector('#siteTable div.thing')}var n=RESUtils.getXYpos(m);RESUtils.scrollTo(0,n.y);modules['neverEndingReddit'].fromBackButton=false}}else{var o=c.querySelector('#noresults');var p=(o)?true:false;modules['neverEndingReddit'].NERFail(p)}}},onerror:function(a){modules['neverEndingReddit'].NERFail()}})}else{}},NERFail:function(a){modules['neverEndingReddit'].isLoading=false;var b=createElementWithID('div','NERFail');if(a){$(b).html('Reddit has responded "there doesn\'t seem to be anything here." - this sometimes happens after several pages as votes shuffle posts up and down. You\'ll have to <a href="'+location.href.split('#')[0]+'">start from the beginning.</a>  If you like, you can try loading <a target="_blank" href="'+modules['neverEndingReddit'].nextPageURL+'">the same URL that RES tried to load.</a> If you are interested, there is a <a target="_blank" href="http://www.reddit.com/r/Enhancement/comments/s72xt/never_ending_reddit_and_reddit_barfing_explained/">technical explanation here</a>.');b.setAttribute('style','cursor: auto !important;')}else{$(b).text('It appears Reddit is under heavy load or has barfed for some other reason, so Never Ending Reddit couldn\'t load the next page. Click here to try to load the page again.');b.addEventListener('click',function(e){modules['neverEndingReddit'].attachLoaderWidget();modules['neverEndingReddit'].loadNewPage(false,true);e.target.parentNode.removeChild(e.target);e.target.textContent='Loading... or trying, anyway...'},false)}modules['neverEndingReddit'].siteTable.appendChild(b);modules['neverEndingReddit'].modalWidget.style.display='none';modules['neverEndingReddit'].modalContent.style.display='none'},showFloat:function(a){if(a){this.NREFloat.style.display='block'}else{this.NREFloat.style.display='none'}}};modules['saveComments']={moduleID:'saveComments',moduleName:'Save Comments',category:'Comments',options:{},description:'Save Comments allows you to save comments, since reddit doesn\'t!',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]*/i),exclude:Array(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]*\/submit\/?/i,/https?:\/\/([a-z]+).reddit.com\/submit\/?/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},go:function(){if((this.isEnabled())&&(this.isMatchURL())){var a=location.href;var b=new RegExp(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]*comments\/[-\w\.\/]*/i);var c=new RegExp(/https?:\/\/([a-z]+).reddit.com\/user\/([\w]+)\/saved\/?/i);if(b.test(a)){this.loadSavedComments();this.addSaveLinks()}else if(c.test(a)){this.loadSavedComments();this.addSavedCommentsTab();this.drawSavedComments();if(location.hash=='#comments'){this.showSavedTab('comments')}}else{this.addSavedCommentsTab()}RESUtils.watchForElement('newComments',modules['saveComments'].addSaveLinks)}},addSaveLinks:function(d){if(!d)var d=document.body;modules['saveComments'].allComments=d.querySelectorAll('div.commentarea > div.sitetable > div.thing div.entry div.noncollapsed');modules['saveComments'].allCommentsCount=modules['saveComments'].allComments.length;modules['saveComments'].allCommentsi=0;(function(){var a=Math.min((modules['saveComments'].allCommentsCount-modules['saveComments'].allCommentsi),15);for(var i=0;i<a;i++){var b=modules['saveComments'].allCommentsi;var c=modules['saveComments'].allComments[b];modules['saveComments'].addSaveLinkToComment(c);modules['saveComments'].allCommentsi++}if(modules['saveComments'].allCommentsi<modules['saveComments'].allCommentsCount){setTimeout(arguments.callee,1000)}})()},addSaveLinkToComment:function(a){var b=a.querySelector('ul.flat-list');var c=b.querySelector('li.first a.bylink');if(c!=null){if(RESUtils.loggedInUser()){if(c.parentNode.nextSibling!=null){if(typeof(c.parentNode.nextSibling.firstChild.getAttribute)!='undefined'){var d=c.parentNode.nextSibling.firstChild.getAttribute('href')}else{var d=null}}else{var d=null}}else{var d=null}var f=((d==null)||(d.indexOf('#')==-1));var g=a.querySelector('a.author');if(g==null){var h='[deleted]'}else{var h=g.text}var i=c.getAttribute('href');var j=i.split('/');var k=j[j.length-1];var l=document.createElement('li');if((typeof(this.storedComments)!='undefined')&&(typeof(this.storedComments[k])!='undefined')){$(l).html('<a href="/saved#comments">saved</a>')}else{$(l).html('<a href="javascript:void(0);" class="saveComments">save</a>');l.setAttribute('saveID',k);l.setAttribute('saveLink',i);l.setAttribute('saveUser',h);l.addEventListener('click',function(e){e.preventDefault();modules['saveComments'].saveComment(this,this.getAttribute('saveID'),this.getAttribute('saveLink'),this.getAttribute('saveUser'))},true)}var m=b.lastChild;if(f)m=m.previousSibling;b.insertBefore(l,m)}},loadSavedComments:function(){var a=RESStorage.getItem('RESmodules.saveComments.savedComments');if(a==null){this.storedComments={}}else{this.storedComments=safeJSON.parse(a,'RESmodules.saveComments.savedComments');if(a.slice(0,1)=='['){var b={};for(var i in this.storedComments){var c=this.storedComments[i].href.split('/');var d=c[c.length-1];b[d]=this.storedComments[i]}this.storedComments=b;RESStorage.setItem('RESmodules.saveComments.savedComments',JSON.stringify(b))}}},saveComment:function(b,c,d,f,g){this.loadSavedComments();if(typeof(this.storedComments[c])!='undefined'){alert('comment already saved!')}else{if(modules['keyboardNav'].isEnabled()){modules['keyboardNav'].keyUnfocus(modules['keyboardNav'].keyboardLinks[modules['keyboardNav'].activeIndex])}var g=b.parentNode.parentNode.querySelector('div.usertext-body > div.md');if(g!=null){commentHTML=g.innerHTML;var h={href:d,username:f,comment:commentHTML,timeSaved:Date()};this.storedComments[c]=h;var i=document.createElement('li');$(i).html('<a href="javascript:void(0);">unsave</a>');i.setAttribute('unsaveID',c);i.setAttribute('unsaveLink',d);i.setAttribute('class','saveComments');i.addEventListener('click',function(e){var a=this.getAttribute('unsaveID');modules['saveComments'].unsaveComment(a,this)},false);b.parentNode.replaceChild(i,b)}if(modules['keyboardNav'].isEnabled()){modules['keyboardNav'].keyFocus(modules['keyboardNav'].keyboardLinks[modules['keyboardNav'].activeIndex])}if(RESUtils.proEnabled()){if(typeof(this.storedComments.RESPro_add)=='undefined'){this.storedComments.RESPro_add={}}if(typeof(this.storedComments.RESPro_delete)=='undefined'){this.storedComments.RESPro_delete={}}this.storedComments.RESPro_add[c]=true;if(typeof(this.storedComments.RESPro_delete[c])!='undefined')delete this.storedComments.RESPro_delete[c]}RESStorage.setItem('RESmodules.saveComments.savedComments',JSON.stringify(this.storedComments));if(RESUtils.proEnabled()){modules['RESPro'].authenticate(function(){modules['RESPro'].saveModuleData('saveComments')})}}},addSavedCommentsTab:function(){var a=document.body.querySelector('#header-bottom-left ul.tabmenu');if(a){var b=new RegExp(/https?:\/\/([a-z]+).reddit.com\/user\/[\w]+\/saved\/?/i);var c=a.querySelectorAll('li');for(var i=0,len=c.length;i<len;i++){var d=c[i].querySelector('a');if((hasClass(c[i],'selected'))&&(b.test(d.href))){c[i].addEventListener('click',function(e){e.preventDefault();modules['saveComments'].showSavedTab('links')},true)}var f=RESUtils.loggedInUser()||'';if(b.test(d.href)){this.savedLinksTab=c[i];d.textContent='saved links'}}this.savedCommentsTab=document.createElement('li');$(this.savedCommentsTab).html('<a id="savedCommentsTab" href="javascript:void(0);">saved comments</a>');if(b.test(location.href)){this.savedCommentsTab.addEventListener('click',function(e){e.preventDefault();modules['saveComments'].showSavedTab('comments')},true)}else{this.savedCommentsTab.addEventListener('click',function(e){e.preventDefault();location.href=location.protocol+'//www.reddit.com/saved/#comments'},true)}if(this.savedLinksTab!=null){insertAfter(this.savedLinksTab,this.savedCommentsTab)}}},showSavedTab:function(a){switch(a){case'links':location.hash='links';this.savedLinksContent.style.display='block';this.savedCommentsContent.style.display='none';addClass(this.savedLinksTab,'selected');removeClass(this.savedCommentsTab,'selected');break;case'comments':location.hash='comments';this.savedLinksContent.style.display='none';this.savedCommentsContent.style.display='block';removeClass(this.savedLinksTab,'selected');addClass(this.savedCommentsTab,'selected');break}},drawSavedComments:function(){RESUtils.addCSS('.savedComment { padding: 5px; font-size: 12px; margin-bottom: 20px; margin-left: 40px; margin-right: 10px; border: 1px solid #CCCCCC; border-radius: 10px 10px 10px 10px; -moz-border-radius: 10px 10px 10px 10px; -webkit-border-radius: 10px 10px 10px 10px; width: auto; } ');RESUtils.addCSS('.savedCommentHeader { margin-bottom: 8px; }');RESUtils.addCSS('.savedCommentBody { margin-bottom: 8px; }');RESUtils.addCSS('#savedLinksList { margin-top: 10px; }');this.savedLinksContent=document.body.querySelector('BODY > div.content');this.savedCommentsContent=createElementWithID('div','savedLinksList');this.savedCommentsContent.style.display='none';this.savedCommentsContent.setAttribute('class','sitetable linklisting');for(var i in this.storedComments){if((i!='RESPro_add')&&(i!='RESPro_delete')){var a=document.createElement('div');a.setAttribute('class','clearleft');var b=document.createElement('div');addClass(b,'savedComment');addClass(b,'thing entry');var c='<div class="savedCommentHeader">Comment by user: '+escapeHTML(this.storedComments[i].username)+' saved on '+escapeHTML(this.storedComments[i].timeSaved)+'</div>';c+='<div class="savedCommentBody">'+this.storedComments[i].comment.replace(/<script(.|\s)*?\/script>/g,'')+'</div>';c+='<div class="savedCommentFooter"><ul class="flat-list buttons"><li><a class="unsaveComment" href="javascript:void(0);">unsave</a></li><li><a href="'+escapeHTML(this.storedComments[i].href)+'">view original</a></li></ul></div>'$(b).html(c);var d=b.querySelector('.unsaveComment');d.setAttribute('unsaveID',i);d.setAttribute('unsaveLink',this.storedComments[i].href);d.addEventListener('click',function(e){e.preventDefault();modules['saveComments'].unsaveComment(this.getAttribute('unsaveID'))},true);this.savedCommentsContent.appendChild(b);this.savedCommentsContent.appendChild(a)}}if(this.storedComments.length==0){$(this.savedCommentsContent).html('<li>You have not yet saved any comments.</li>')}insertAfter(this.savedLinksContent,this.savedCommentsContent)},unsaveComment:function(a,b){delete this.storedComments[a];if(RESUtils.proEnabled()){if(typeof(this.storedComments.RESPro_add)=='undefined'){this.storedComments.RESPro_add={}}if(typeof(this.storedComments.RESPro_delete)=='undefined'){this.storedComments.RESPro_delete={}}this.storedComments.RESPro_delete[a]=true;if(typeof(this.storedComments.RESPro_add[a])!='undefined')delete this.storedComments.RESPro_add[a]}RESStorage.setItem('RESmodules.saveComments.savedComments',JSON.stringify(this.storedComments));if(RESUtils.proEnabled()){modules['RESPro'].authenticate(function(){modules['RESPro'].saveModuleData('saveComments')})}if(typeof(this.savedCommentsContent)!='undefined'){this.savedCommentsContent.parentNode.removeChild(this.savedCommentsContent);this.drawSavedComments();this.showSavedTab('comments')}else{var c=b.parentNode.parentNode;b.parentNode.removeChild(b);this.addSaveLinkToComment(c)}}};modules['userHighlight']={moduleID:'userHighlight',moduleName:'User Highlighter',category:'Users',description:'Highlights certain users in comment threads: OP, Admin, Friends, Mod - contributed by MrDerk',options:{highlightOP:{type:'boolean',value:true,description:'Highlight OP\'s comments'},OPColor:{type:'text',value:'#0055DF',description:'Color to use to highlight OP. Defaults to original text color'},OPColorHover:{type:'text',value:'#4E7EAB',description:'Color used to highlight OP on hover.'},highlightAdmin:{type:'boolean',value:true,description:'Highlight Admin\'s comments'},adminColor:{type:'text',value:'#FF0011',description:'Color to use to highlight Admins. Defaults to original text color'},adminColorHover:{type:'text',value:'#B3000C',description:'Color used to highlight Admins on hover.'},highlightFriend:{type:'boolean',value:true,description:'Highlight Friends\' comments'},friendColor:{type:'text',value:'#FF4500',description:'Color to use to highlight Friends. Defaults to original text color'},friendColorHover:{type:'text',value:'#B33000',description:'Color used to highlight Friends on hover.'},highlightMod:{type:'boolean',value:true,description:'Highlight Mod\'s comments'},modColor:{type:'text',value:'#228822',description:'Color to use to highlight Mods. Defaults to original text color'},modColorHover:{type:'text',value:'#134913',description:'Color used to highlight Mods on hover. Defaults to gray.'},fontColor:{type:'text',value:'white',description:'Color for highlighted text.'}},isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[\?]*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},go:function(){if((this.isEnabled())&&(this.isMatchURL())){if(this.options.highlightOP.value){var a='submitter';var b=this.options.OPColor.value;var c=this.options.OPColorHover.value;this.doHighlight(a,b,c)}if(this.options.highlightFriend.value){var a='friend';var b=this.options.friendColor.value;var c=this.options.friendColorHover.value;this.doHighlight(a,b,c)}if(this.options.highlightMod.value){var a='moderator';var b=this.options.modColor.value;var c=this.options.modColorHover.value;this.doHighlight(a,b,c)}if(this.options.highlightAdmin.value){var a='admin';var b=this.options.adminColor.value;var c=this.options.adminColorHover.value;this.doHighlight(a,b,c)}}},doHighlight:function(a,b,c){var d=document.querySelector('.noncollapsed .'+a);if(d===null){d=document.querySelector('.'+a)}if(d!=null){if(b==='default'){b=this.getStyle(d,'color')}if(c==='default'){c="#AAA"}if(typeof(b)!="undefined"&&b!='rgb(255, 255, 255)'){RESUtils.addCSS("				.author."+a+" { 					color: "+this.options.fontColor.value+" !important; 					font-weight: bold; 					padding: 0 2px 0 2px; 					border-radius: 3px; 					-moz-border-radius: 3px; 					-webkit-border-radius: 3px; 					background-color:"+b+" !important} 				.collapsed .author."+a+" { 					color: white !important; 					background-color: #AAA !important}				.author."+a+":hover {					background-color: "+c+" !important; 					text-decoration: none !important}")}}},getStyle:function(c,d){var e="";if(document.defaultView&&document.defaultView.getComputedStyle){e=document.defaultView.getComputedStyle(c,"").getPropertyValue(d)}else if(c.currentStyle){d=d.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()});e=c.currentStyle[d]}return e}};modules['styleTweaks']={moduleID:'styleTweaks',moduleName:'Style Tweaks',category:'UI',description:'Provides a number of style tweaks to the Reddit interface',options:{navTop:{type:'boolean',value:true,description:'Moves the username navbar to the top (great on netbooks!)'},commentBoxes:{type:'boolean',value:true,description:'Highlights comment boxes for easier reading / placefinding in large threads.'},commentRounded:{type:'boolean',value:true,description:'Round corners of comment boxes'},commentHoverBorder:{type:'boolean',value:false,description:'Highlight comment box hierarchy on hover (turn off for faster performance)'},commentIndent:{type:'text',value:10,description:'Indent comments by [x] pixels (only enter the number, no \'px\')'},continuity:{type:'boolean',value:false,description:'Show comment continuity lines'},lightSwitch:{type:'boolean',value:true,description:'Enable lightswitch (toggle between light / dark reddit)'},lightOrDark:{type:'enum',values:[{name:'Light',value:'light'},{name:'Dark',value:'dark'}],value:'light',description:'Light, or dark?'},visitedStyle:{type:'boolean',value:false,description:'Reddit makes it so no links on comment pages appear as "visited" - including user profiles. This option undoes that.'},showExpandos:{type:'boolean',value:true,description:'Bring back video and text expando buttons for users with compressed link display'},colorBlindFriendly:{type:'boolean',value:false,description:'Use colorblind friendly styles when possible'},scrollSubredditDropdown:{type:'boolean',value:true,description:'Scroll the standard subreddit dropdown (useful for pinned header and disabled Subreddit Manager)'}},isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){if(this.options.visitedStyle.value){RESUtils.addCSS(".comment a:visited { color:#551a8b }")}else{RESUtils.addCSS(".comment .md p > a:visited { color:#551a8b }")}if(this.options.showExpandos.value){RESUtils.addCSS('.compressed .expando-button { display: block !important; }')}var a=new RegExp(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]*comments\/[-\w\.\/]*/i);if((this.options.commentBoxes.value)&&(a.test(location.href))){this.commentBoxes()}this.isDark=false;if(this.options.lightOrDark.value=='dark'){this.isDark=true;this.redditDark()}}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){if(this.isDark){addClass(document.body,'res-nightmode')}if(typeof(this.options.commentBoxHover)!='undefined'){delete this.options.commentBoxHover;RESStorage.setItem('RESoptions.styleTweaks',JSON.stringify(modules['styleTweaks'].options))}if(this.options.navTop.value){this.navTop()}if(this.options.lightSwitch.value){this.lightSwitch()}if(this.options.colorBlindFriendly.value){var a=document.body.querySelector('#mail');if((a)&&(hasClass(a,'havemail'))){a.setAttribute('style','background-image: url(http://thumbs.reddit.com/t5_2s10b_5.png); background-position: 0px 0px;')}}if(this.options.scrollSubredditDropdown.value){var b=Math.floor(window.innerHeight*0.95);if($('.drop-choices.srdrop').height()>b){RESUtils.addCSS('.drop-choices.srdrop { 						overflow-y:scroll; 						height:'+b+'px; 					}')}}if(this.options.showExpandos.value){RESUtils.addCSS('.compressed .expando-button { display: block !important; }');var c=document.body.querySelectorAll('.entry > p.title > a.title');var d=/twitter.com\/(?:#!\/)?([\w]+)\/(status|statuses)\/([\d]+)/i;for(var i=0,len=c.length;i<len;i++){var e=c[i].getAttribute('href');e=e.replace('/#!','');if(d.test(e)){var f=document.createElement('div');f.setAttribute('class','expando-button collapsed selftext twitter');f.addEventListener('click',modules['styleTweaks'].toggleTweetExpando,false);insertAfter(c[i].parentNode,f)}}}this.userbarHider();this.subredditStyles()}},toggleTweetExpando:function(e){var c=e.target.nextSibling.nextSibling.nextSibling;if(hasClass(e.target,'collapsed')){$(e.target).removeClass('collapsed').addClass('expanded');console.log(c);if(hasClass(c,'twitterLoaded')){c.style.display='block';return}var d=e.target.previousSibling.firstChild.getAttribute('href');d=d.replace('/#!','');var f=d.match(/twitter.com\/[^\/]+\/(?:status|statuses)\/([\d]+)/i);if(f!=null){var g='http://api.twitter.com/1/statuses/show/'+f[1]+'.json';if(typeof(chrome)!='undefined'){var h={requestType:'loadTweet',url:g};chrome.extension.sendMessage(h,function(a){var b=a;$(c).html('<form class="usertext"><div class="usertext-body"><div class="md"><div><img style="display: block;" src="'+escapeHTML(b.user.profile_image_url)+'"></div>'+escapeHTML(b.user.screen_name)+': '+escapeHTML(b.text)+'</div></div></form>');c.style.display='block';addClass(c,'twitterLoaded')})}else if(typeof(safari)!='undefined'){modules['styleTweaks'].tweetExpando=c;var h={requestType:'loadTweet',url:g}safari.self.tab.dispatchMessage("loadTweet",h)}else if(typeof(opera)!='undefined'){modules['styleTweaks'].tweetExpando=c;var h={requestType:'loadTweet',url:g}opera.extension.postMessage(JSON.stringify(h))}else if(typeof(self.on)=='function'){modules['styleTweaks'].tweetExpando=c;var h={requestType:'loadTweet',url:g}self.postMessage(h)}else{GM_xmlhttpRequest({method:"GET",url:g,target:c,onload:function(a){var b=JSON.parse(a.responseText);$(c).html('<form class="usertext"><div class="usertext-body"><div class="md"><div><img style="display: block;" src="'+escapeHTML(b.user.profile_image_url)+'"></div>'+escapeHTML(b.user.screen_name)+': '+escapeHTML(b.text)+'</div></div></form>');c.style.display='block'}})}}}else{$(e.target).removeClass('expanded').addClass('collapsed');c.style.display='none'}},navTop:function(){RESUtils.addCSS('#header-bottom-right { top: 19px; border-radius: 0px 0px 0px 3px; -moz-border-radius: 0px 0px 0px 3px; -webkit-border-radius: 0px 0px 0px 3px; bottom: auto;  }');$('#header-bottom-right').addClass('res-navTop')},userbarHider:function(){RESUtils.addCSS("#userbarToggle { min-height: 22px; position: absolute; top: 0px; left: -5px; width: 16px; padding-right: 3px; height: 100%; font-size: 15px; border-radius: 4px 0px 0px 4px; color: #a1bcd6; display: inline-block; background-color: #dfecf9; border-right: 1px solid #cee3f8; cursor: pointer; text-align: right; line-height: 24px; }");RESUtils.addCSS("#userbarToggle.userbarShow { min-height: 26px; }");RESUtils.addCSS("#header-bottom-right .user { margin-left: 16px; }");RESUtils.addCSS("#userbarToggle.userbarShow { left: -12px; }");RESUtils.addCSS(".res-navTop #userbarToggle.userbarShow { top:0 }");this.userbar=document.getElementById('header-bottom-right');if(this.userbar){this.userbarToggle=createElementWithID('div','userbarToggle');$(this.userbarToggle).html('&raquo;');this.userbarToggle.setAttribute('title','Toggle Userbar');addClass(this.userbarToggle,'userbarHide');this.userbarToggle.addEventListener('click',function(e){modules['styleTweaks'].toggleUserBar()},false);this.userbar.insertBefore(this.userbarToggle,this.userbar.firstChild);if(RESStorage.getItem('RESmodules.styleTweaks.userbarState')=='hidden'){this.toggleUserBar()}}},toggleUserBar:function(){var a=this.userbarToggle.nextSibling;if(hasClass(this.userbarToggle,'userbarHide')){removeClass(this.userbarToggle,'userbarHide');addClass(this.userbarToggle,'userbarShow');$(this.userbarToggle).html('&laquo;');RESStorage.setItem('RESmodules.styleTweaks.userbarState','hidden');modules['accountSwitcher'].closeAccountMenu();while((typeof(a)!='undefined')&&(a!=null)){a.style.display='none';a=a.nextSibling}}else{removeClass(this.userbarToggle,'userbarShow');addClass(this.userbarToggle,'userbarHide');$(this.userbarToggle).html('&raquo;');RESStorage.setItem('RESmodules.styleTweaks.userbarState','visible');while((typeof(a)!='undefined')&&(a!=null)){if((a.className.match(/mail/))||(a.id=='openRESPrefs')){a.style.display='inline-block'}else{a.style.display='inline'}a=a.nextSibling}}},commentBoxes:function(){RESUtils.addCSS(".parentComment { background-color:#ffffff !important; } ");RESUtils.addCSS(".comment{");if(this.options.commentRounded.value){RESUtils.addCSS("	-moz-border-radius:3px !important;"+" 	 -webkit-border-radius:3px !important;"+" 	 border-radius:3px !important;")}RESUtils.addCSS("	margin-left:"+this.options.commentIndent.value+"px !important;"+"	margin-right:8px!important;"+"	margin-top:0px!important;"+"	margin-bottom:8px!important;"+"	border:1px solid #e6e6e6 !important;"+"	padding-left:5px!important;"+"	padding-top:5px!important;"+"	padding-right:8px!important;"+"	padding-bottom:0px!important;"+"	overflow: hidden !important;"+"}");if(this.options.continuity.value){RESUtils.addCSS('.comment div.child { border-left: 1px dotted #555555 !important; } ')}else{RESUtils.addCSS('.comment div.child { border-left: none !important; } ')}RESUtils.addCSS(".comment .comment{"+"	margin-right:0px!important;"+"	background-color:#F7F7F8 !important;"+"}"+".comment .comment .comment{"+"	background-color:#ffffff !important;"+"}"+".comment .comment .comment .comment{"+"	background-color:#F7F7F8 !important;"+"}"+".comment .comment .comment .comment .comment{"+"	background-color:#ffffff !important;"+"}"+".comment .comment .comment .comment .comment .comment{"+"	background-color:#F7F7F8 !important;"+"}"+".comment .comment .comment .comment .comment .comment .comment{"+"	background-color:#ffffff !important;"+"}"+".comment .comment .comment .comment .comment .comment .comment .comment{"+"	background-color:#F7F7F8 !important;"+"}"+".comment .comment .comment .comment .comment .comment .comment .comment .comment{"+"	background-color:#ffffff !important;"+"}"+".comment .comment .comment .comment .comment .comment .comment .comment .comment .comment{"+"	background-color:#F7F7F8 !important;"+"}"+"body > .content {"+" padding-right:0px; !important;"+"}");if(this.options.commentHoverBorder.value){RESUtils.addCSS(" .comment:hover {border: 1px solid #99AAEE !important; }")}},lightSwitch:function(){RESUtils.addCSS(".lightOn { background-position: 0px -96px; } ");RESUtils.addCSS(".lightOff { background-position: 0px -108px; } ");RESUtils.addCSS('#lightSwitchToggle { float: right; margin-right: 10px; margin-top: 10px; line-height: 10px; }');var a=document.createDocumentFragment();this.lightSwitch=document.createElement('li');this.lightSwitch.setAttribute('title',"Toggle night and day");this.lightSwitch.addEventListener('click',function(e){e.preventDefault();if(modules['styleTweaks'].isDark==true){RESUtils.setOption('styleTweaks','lightOrDark','light');removeClass(modules['styleTweaks'].lightSwitchToggle,'enabled');RESUtils.notification('Dark style will be removed on next page load.')}else{RESUtils.setOption('styleTweaks','lightOrDark','dark');addClass(modules['styleTweaks'].lightSwitchToggle,'enabled');RESUtils.notification('Dark style will be applied on next page load.')}},true);this.lightSwitch.textContent='night mode';this.lightSwitchToggle=createElementWithID('div','lightSwitchToggle','toggleButton');$(this.lightSwitchToggle).html('<span class="toggleOn">on</span><span class="toggleOff">off</span>');this.lightSwitch.appendChild(this.lightSwitchToggle);(this.options.lightOrDark.value=='dark')?addClass(this.lightSwitchToggle,'enabled'):removeClass(this.lightSwitchToggle,'enabled');a.appendChild(this.lightSwitch);$('#RESDropdownOptions').append(this.lightSwitch)},subredditStyles:function(){this.ignoredSubReddits=[];var a=RESStorage.getItem('RESmodules.styleTweaks.ignoredSubredditStyles');if(a){this.ignoredSubReddits=safeJSON.parse(a,'RESmodules.styleTweaks.ignoredSubredditStyles')}this.head=document.getElementsByTagName("head")[0];var b=document.querySelector('.titlebox h1');var c=document.createElement('div');c.setAttribute('style','display: block !important; position: relative !important; left: 0px !important; top: 0px !important; height: auto !important; width: auto !important; visibility: visible !important;');var d=document.createElement('label');addClass(c,'styleToggle');this.styleToggleCheckbox=document.createElement('input');this.styleToggleCheckbox.setAttribute('type','checkbox');this.styleToggleCheckbox.setAttribute('name','subRedditStyleCheckbox');this.styleToggleCheckbox.setAttribute('name','subRedditStyleCheckbox');this.styleToggleCheckbox.setAttribute('style','display: inline-block !important; height: auto !important; width: auto !important; visibility: visible !important;');if(RESUtils.currentSubreddit()){this.curSubReddit=RESUtils.currentSubreddit().toLowerCase()}if((this.curSubReddit!=null)&&(b!=null)){var f=this.ignoredSubReddits.indexOf(this.curSubReddit);if(f==-1){this.styleToggleCheckbox.checked=true}else{this.toggleSubredditStyle(false)}this.styleToggleCheckbox.addEventListener('change',function(e){modules['styleTweaks'].toggleSubredditStyle(this.checked)},false);c.appendChild(this.styleToggleCheckbox);insertAfter(b,c)}d.setAttribute('for','subRedditStyleCheckbox');d.setAttribute('style','display: inline-block !important; margin-left: 5px !important; visibility: visible !important; width: auto !important; height: auto !important;');d.textContent='Use subreddit style ';c.appendChild(d)},toggleSubredditStyle:function(a,b){var c=(b)?b.toLowerCase():this.curSubReddit;if(a){var d=this.ignoredSubReddits.indexOf(c);if(d!=-1)this.ignoredSubReddits.splice(d,1);var e=document.createElement('link');e.setAttribute('title','applied_subreddit_stylesheet');e.setAttribute('rel','stylesheet');e.setAttribute('href','http://www.reddit.com/r/'+c+'/stylesheet.css');if(!b||(b==this.curSubReddit))this.head.appendChild(e)}else{var d=this.ignoredSubReddits.indexOf(c);if(d==-1)this.ignoredSubReddits[this.ignoredSubReddits.length]=c;var e=this.head.querySelector('link[title=applied_subreddit_stylesheet]');if(!e)e=this.head.querySelector('style[title=applied_subreddit_stylesheet]');if((e)&&(!b||(b==this.curSubReddit))){e.parentNode.removeChild(e)}}RESStorage.setItem('RESmodules.styleTweaks.ignoredSubredditStyles',JSON.stringify(this.ignoredSubReddits))},redditDark:function(a){if(a){this.isDark=false;if(typeof(this.darkStyle)!='undefined'){this.darkStyle.parentNode.removeChild(this.darkStyle);removeClass(document.body,'res-nightmode')}}else{this.isDark=true;var b=".organic-listing .tabmenu, #header-bottom-left { background-color: #666 !important; }";b+="html, body, body > .content {background-color:#222 !important;}";b+=" body {background-image:none !important}";b+=" .comment .md p a[href='/spoiler'] {background-color: #000 !important;color: #000 !important;}";b+=" .comment .md p a[href='/spoiler']:hover, .comment .md p a[href='/spoiler']:active {color: #FFF !important;}";b+=" .titlebox blockquote,  .sidecontentbox .content {background-color: #111;}";b+=" .flair {background-color:#bbb!important;color:black!important;}";b+=" .RESUserTagImage,  button.arrow.prev,  button.arrow.next {opacity:0.5;}";b+=" #RESConsole {background-color:#ddd;}";b+=" #RESMenu li.active {background-color:#7f7f7f !important;}";b+=" #RESConsoleContent,  #RESMenu li {background-color:#eee;}";b+=" #RESConsoleTopBar #RESLogo,  #progressIndicator {opacity:0.4;}";b+=" .tabmenu li a,  .login-form,  .login-form input[name*='passwd'],  .login-form-side .submit {background-color:#bbb;}";b+=" .login-form-side input {width:auto!important;}";b+=" form.login-form.login-form-side {background-color: #888;color: #eee;}";b+=" #RESConsoleTopBar,  .moduleHeader,  .allOptionsContainer,  .optionContainer {background-color: #ccc;color:black !important;}";b+=" #siteTable sitetable{background-color:#222 !important;}";b+=" #commentNavButtons * {color:white !important;}";b+=" .usertable .btn {border-color:#aa9 !important;color:#aa9 !important;}";b+=" .usertable tr .user .userkarma {color:#aa9 !important;}";b+=" .thing.spam {background-color:salmon !important;}";b+=" .wikipage h1 {color:#ddd !important;}";b+=" .titlebox .usertext-body .md h3, #userTaggerTable th, #newCommentsTable th {color:#000;}";b+=" .new-comment .usertext-body .md {border:0.1em #aaa dashed;}";b+=" .sitetable .moderator {background-color:#282!important;}";b+=" .sitetable .admin {background-color:#F01!important;}";b+=" .message ul {color:#abcabc !important;}";b+=" .side .spacer > #search input {background-color:#444 !important;}";b+=" input[type=\"text\"] {background-color:#aaa !important;}";b+=" .share-button .option {color: #8AD !important;}";b+="body > .content > .spacer > .sitetable:before, body > .content > .sharelink ~ .sitetable:before,  .side .age,  .trophy-info * {color: #ddd !important;}";b+=" .livePreview blockquote {border-left: 2px solid white !important};";b+=" #RESDashboardComponent,  RESDashboardComponentHeader {background-color: #ddd !important;}";b+=" #RESDashboardAddComponent,  .RESDashboardComponentHeader {background-color: #bbb !important;}";b+=" .addNewWidget, .editWidget, .RESDashboardComponent a.widgetPath,  #authorInfoToolTip a.option,  .updateTime {color: white !important;}";b+=" .entry .score {color:#dde !important;}";b+=" .entry p.tagline:first-of-type,  .entry time {color:#dd8;}"css+="  code {color:#6c0 !important;}"css+=" .entry .domain a {color:cyan !important;}"css+=" .traffic-table tr.odd {color: #222 !important;}"css+=" .side,  .flairselector,  .linefield {background-color: #222;}"css+=" .big-mod-buttons .pretty-button {color:black !important;}"css+=" .voteWeight { background-color: #222 !important; color: white !important;}"css+=" form.flairtoggle,  .trophy-area .content,  .side .spacer h1,  .NERPageMarker,  .side .spacer {background-color:#222 !important;color:#ddd !important;}";b+=" .sitetable .thing {border-color:transparent !important;}"css+=" .message.message-reply.recipient > .entry .head, .message.message-parent.recipient > .entry .head {color:inherit !important;}"css+=" #header {background-color:#666660 !important;}";b+="body { background-color: #222 !important; } .infobar { background-color:#222 !important; color:black !important; }";b+='.toggle .option { color:#FFF!important; }';b+="#subscribe a, .share .option, h2, .tagline a, .content a, .footer a, .wired a, .side a, .subredditbox li a { color:#8AD !important; }";b+=".rank .star { color:orangered !important; } .content { color:#CCC !important; } .thing .title.loggedin, .link .title { color:#DFDFDF !important; }";b+=".arrow { height:14px !important; margin-top:0 !important; width:15px !important; }";b+=".arrow.up { background:url(http://thumbs.reddit.com/t5_2qlyl_0.png?v=zs9q49wxah08x4kpv2tu5x4nbda7kmcpgkbj) -15px 0 no-repeat !important; }";b+=".arrow.down { background:url(http://thumbs.reddit.com/t5_2qlyl_0.png?v=10999ad3mtco31oaf6rrggme3t9jdztmxtg6) -15px -14px no-repeat !important; }";b+=".arrow.up:hover { background:url(http://thumbs.reddit.com/t5_2qlyl_0.png?v=9oeida688vtqjpb4k0uy93oongrzuv5j7vcj) -30px 0 no-repeat !important; }";b+=".arrow.down:hover { background:url(http://thumbs.reddit.com/t5_2qlyl_0.png?v=cmsw4qrin2rivequ0x1wnmn8ltd7ke328yqs) -30px -14px no-repeat !important; }";b+=".arrow.upmod { background:url(http://thumbs.reddit.com/t5_2qlyl_0.png?v=8oarqkcswl255wrw3q1kyd74xrty50a7wr3z) 0 0 no-repeat !important; }";b+=".arrow.downmod { background:url(http://thumbs.reddit.com/t5_2qlyl_0.png?v=90eauq018nf41z3vr0u249gv2q6651xyzrkh) 0 -14px no-repeat !important; }";b+=".link .score.likes, .linkcompressed .score.likes { color:orangered !important; }";b+=".link .score.dislikes, .linkcompressed .score.dislikes { color:#8AD !important; }";b+=".linkcompressed .entry .buttons li a, .link .usertext .md, .thing .compressed, organic-listing .link, .organic-listing .link.promotedlink, .link.promotedlink.promoted { background:none !important; }";b+=".message.new > .entry {background-color:#444444; border:1px solid #E9E9E9; padding:6px; } ";b+=".subredditbox li a:before { content:\"#\" !important; } .subredditbox li { font-weight:bold !important; text-transform:lowercase !important; }";b+=".dropdown.lightdrop .drop-choices { background-color:#333 !important; }";b+=".dropdown.lightdrop a.choice:hover { background-color:#111 !important; } .midcol {margin-right:7px !important;}  .side {color:#fff; margin-left:10px !important; }";b+=".side h4, .side h3 { color:#ddd !important; } .side h5 { color:#aaa !important; margin-top:5px !important; } .side p { margin-top:5px !important; }";b+=".sidebox, .subredditbox, .subreddit-info, .raisedbox, .login-form-side { background-color:#393939 !important; border:2px solid #151515 !important; color:#aaa !important; border-radius:8px !important; -moz-border-radius:8px !important; -webkit-border-radius:8px !important; }";b+=".login-form-side { background:#e8690a !important; border-bottom:0 !important; border-color:#e8690a !important; padding-bottom:1px !important; position:relative !important; }";b+=".login-form-side input { width:125px !important; } .login-form-side label { color:#111 !important; } .login-form-side a { color:#FFFFFF !important; font-size:11px !important; }";b+=".login-form-side .error { color:#660000 !important; } .subreddit-info .label { color:#aaa !important; } .subreddit-info { padding:10px !important; }";b+=".subreddit-info .spacer a { background-color:#222; border:none !important; margin-right:3px !important; }";b+=".subredditbox ul { padding:10px 0px 10px 3px !important; width:140px !important; } .subredditbox ul a:hover { text-decoration:underline !important; } .morelink { background:none !important; border:0 !important; border-radius-bottomleft:6px !important; -moz-border-radius-bottomleft:6px !important; -webkit-border-radius-bottomleft:6px !important; -moz-border-radius-topright:6px !important; -webkit-border-radius-bottom-left-radius:6px !important; -webkit-border-radius-top-right-radius:6px !important; }";b+=".morelink.blah:hover { background:none !important; color:#369 !important; } .morelink.blah { background:none !important; border:0 !important; color:#369 !important; }";b+=".morelink:hover { border:0 !important; color:white !important; } .sidebox { padding-left:60px !important; }";b+=".sidebox.submit { background:#393939 url(http://thumbs.reddit.com/t5_2qlyl_2.png?v=0s1s9iul2umpm0bx46cioc7yjwbkprt7r2qr) no-repeat 6px 50% !important; }";b+=".sidebox .spacer, .linkinfo {background-color:#393939 !important; } .nub {background-color: transparent !important;}";b+=".sidebox.create { background:#393939 url(http://thumbs.reddit.com/t5_2qlyl_1.png?v=gl82ywfldj630zod4iaq56cidjud4n79wqw8) no-repeat 6px 50% !important; }";b+=".sidebox .subtitle { color:#aaa !important; } h1 { border-bottom:1px solid #444 !important; }";b+="button.btn { background:none !important; border:2px solid black !important; color:black !important; position:relative !important; width:auto !important; }";b+=".commentreply .buttons button { margin-left:0 !important; margin-top:5px !important; } .commentreply .textarea { color:black !important; }";b+=".menuarea { margin-right:315px !important; } .permamessage { background-image:url(http://thumbs.reddit.com/t5_2qlyl_3.png?v=uza2aq80cb2x2e90ojhdqooj1wazax4jjzfc) !important; border-color:#369 !important; }";b+=".commentbody.border { background-color:#369 !important; } .commentreply .help tr { background:none !important; } .commentreply table.help { margin:2px !important; }";b+="#newlink th { padding-top:5px !important; vertical-align:top !important; } .pretty-form.long-text input[type=\"text\"], .pretty-form.long-text textarea, .pretty-form.long-text input[type=\"password\"], .commentreply textarea { background-color:#333 !important; border:2px solid black !important; color:#CCC !important; padding:4px !important; }";b+="input#title { height:5em !important; } .spam, .reported { background:none !important; border:2px dotted !important; padding:4px !important; }";b+=".spam { border-color:orangered !important; } .reported { border-color:goldenrod !important; } .organic-listing .linkcompressed { background:none !important; }";b+=".organic-listing .nextprev img { opacity:.7 !important; } .organic-listing .nextprev img:hover { opacity:.85 !important; }";b+="#search input[type=\"text\"] { background-color:#222 !important; color:gray !important; } #search input[type=\"text\"]:focus { color:white !important; }";b+="#sr-header-area, #sr-more-link { background:#c2d2e2 !important; } ";b+="#header-bottom-left .tabmenu .selected a { border-bottom:none !important; padding-bottom:0 !important; } #ad-frame { opacity:.8 !important; }";b+=".comment.unread { background-color:#4A473B !important; } .raisedbox .flat-list a { background-color:#222 !important; -moz-border-radius:2px !important; -webkit-border-radius:2px !important; }";b+=".raisedbox .flat-list a:hover { background-color:#336699 !important; color:white !important; } .instructions { background:white !important; padding:10px !important; }";b+=".instructions .preftable th, .instructions .pretty-form  { color:black !important; } #feedback { padding:10px !important; } span[class=\"hover pagename redditname\"] a {font-size: 1.7em !important;}";b+=".thing .title.loggedin:visited, .link .title:visited  {color: #666666 !important;} legend {background-color: black !important;}";b+="a.author.moderator, a.moderator, a.author.friend, a.friend, a.author.admin, a.admin {color:#fff !important; }";b+="table[class=\"markhelp md\"] tr td { background-color: #555 !important; }";b+="div.infobar { color: #ccc !important; }  table[class=\"markhelp md\"] tr[style=\"background-color: rgb(255, 255, 153); text-align: center;\"] td { background-color: #36c !important; }";b+="form[class=\"usertext border\"] div.usertext-body { background-color: transparent !important;  border-width: 2px !important; border-style: solid !important; border-color: #999 !important; }";b+="form[class=\"usertext border\"] div.usertext-body div.md { background-color: transparent !important; } form#form-t1_c0b71p54yc div {color: black !important;}";b+="a[rel=\"tag\"], a.dsq-help {color: #8AD !important; }  div[class=\"post-body entry-content\"], div.dsq-auth-header { color: #ccc !important; }";b+="div#siteTable div[onclick=\"click_thing(this)\"] {background-color: #222 !important;} .md p {color: #ddd !important; } .mail .havemail img, .mail .nohavemail img {   visibility: hidden; }";b+=".havemail {   background: url('http://i.imgur.com/2Anoz.gif') bottom left no-repeat; }  .mail .nohavemail {   background: url('http://imgur.com/6WV6Il.gif') bottom left no-repeat; }";b+="#header-bottom-right { background-color: #BBBBBB !important; }";b+='.expando-button.image {background: none !important; background-image: url(http://a.thumbs.redditmedia.com/JTs29zfSOzSMYO0B.png) !important;}';b+='.expando-button.image.collapsed {background-position: 0px 0px !important;}';b+='.expando-button.image.collapsed:hover {background-position: 0px -24px !important;}';b+='.expando-button.image.expanded, .eb-se { margin-bottom:5px; background-position: 0px -48px !important;}';b+='.expando-button.image.expanded:hover, .eb-seh {background-position: 0px -72px !important;}';b+='.expando-button.image.gallery.collapsed {background-position: 0px -288px !important;}';b+='.expando-button.image.gallery.collapsed:hover {background-position: 0px -312px !important;}';b+='.expando-button.image.gallery.expanded  { margin-bottom:5px; background-position: 0px -336px !important;}';b+='.expando-button.image.gallery.expanded:hover {background-position: 0px -360px !important;}';b+='.expando-button.selftext {background: none !important; background-image: url(http://a.thumbs.redditmedia.com/JTs29zfSOzSMYO0B.png) !important;}';b+='.expando-button.selftext.collapsed {background-position: 0px -96px !important;}';b+='.expando-button.selftext.collapsed:hover {background-position: 0px -120px !important;}';b+='.expando-button.selftext.expanded, .eb-se { margin-bottom:5px; background-position: 0px -144px !important;}';b+='.expando-button.selftext.expanded:hover, .eb-seh {background-position: 0px -168px !important;}';b+='.expando-button.video {background: none !important; background-image: url(http://a.thumbs.redditmedia.com/JTs29zfSOzSMYO0B.png) !important;}';b+='.expando-button.video.collapsed {background-position: 0px -192px !important;}';b+='.expando-button.video.collapsed:hover {background-position: 0px -216px !important;}';b+='.expando-button.video.expanded, .eb-se { margin-bottom:5px; background-position: 0px -240px !important;}';b+='.expando-button.video.expanded:hover, .eb-seh {background-position: 0px -264px !important;}';b+='.expando-button {  background-color:transparent!important; }';b+='.RESdupeimg { color: #eeeeee; font-size: 10px;  }';b+='.keyHighlight, .keyHighlight div.md { background-color: #666666 !important; } .keyHighlight .title.loggedin:visited, .keyHighlight .title:visited { color: #dfdfdf !important; } .nub {background: none !important;}';b+='.side .titlebox { padding-left:5px!important;}';b+='.user .userkarma { color:#444!important; }';b+='.drop-choices { background-color:#C2D2E2!important; }';b+='.drop-choices a { color:black!important; }';b+='.subreddit .usertext .md { background-color:#222!important; color:#CCC!important; }';b+='.formtabs-content { border-top: 6px solid #111!important; }';b+='form#newlink.submit ul.tabmenu>li.selected a { background-color:#111!important; color:#88AADD!important; }';b+='a.link-button, a.text-button { color:#444!important; }';b+='form#newlink.submit button.btn { background-color:#111!important; color:#88AADD!important; }';b+='#sr-autocomplete-area { z-index:1!important; }';b+='form#newlink.submit textarea, form#newlink.submit input#url, form#newlink.submit input#sr-autocomplete { background-color:#666!important; color:#CCC!important; }';b+='.create-reddit { border:none!important; }';b+='.create-reddit span.title { background-color:#111!important; color:#88AADD!important; }';b+='.linefield .linefield-content { border-color: #111!important; }';b+='.create-reddit input#title, .create-reddit input#name.text, .create-reddit input#domain.text { height:1.2em!important; background-color:#666!important; color:#CCC!important; }';b+='.linefield .delete-field { background-color:transparent!important; }';b+='.instructions { background-color:transparent!important; }';b+='.instructions .preftable th { color:#CCC!important; }';b+='.icon-menu a, FORM.leavemoderator-button { background-color:#222!important; }';b+='.leavemoderator, FORM.leavecontributor-button { background-color:#222!important; }';b+='#pref-delete .delete-field { background-color:transparent!important; }';b+='.NERdupe p.title:after { color: #dddddd !important; }';b+='.savedComment { color: #dddddd !important; }';if(this.options.commentBoxes.value){b+=".comment{"+"	background-color:#444444 !important;"+"}"+".comment .comment{"+"	background-color:#111111 !important;"+"}"+".comment .comment .comment{"+"	background-color:#444444 !important;"+"}"+".comment .comment .comment .comment{"+"	background-color:#111111 !important;"+"}"+".comment .comment .comment .comment .comment{"+"	background-color:#444444 !important;"+"}"+".comment .comment .comment .comment .comment .comment{"+"	background-color:#111111 !important;"+"}"+".comment .comment .comment .comment .comment .comment .comment{"+"	background-color:#444444 !important;"+"}"+".comment .comment .comment .comment .comment .comment .comment .comment{"+"	background-color:#111111 !important;"+"}"+".comment .comment .comment .comment .comment .comment .comment .comment .comment{"+"	background-color:#444444 !important;"+"}"+".comment .comment .comment .comment .comment .comment .comment .comment .comment .comment{"+"	background-color:#111111 !important;"+"}";b+='.thing { margin-bottom: 10px; border: 1px solid #666666 !important; } '}b+='.organic-listing .link { background-color: #333333 !important; } .sidecontentbox { background-color: #111111; }';if(this.options.continuity.value){b+='.comment div.child { border-left: 1px dotted #555555 !important; } '}else{b+='.comment div.child { border-left: none !important; } '}b+='.roundfield {background-color: #111111 !important;}';b+='#authorInfoToolTip { background-color: #666666 !important; color: #cccccc !important; border-color: #888888 !important; } #authorInfoToolTip a { color: #88AADD !important; } ';b+='.new-comment .usertext-body { background-color: #334455 !important; border: none !important; margin:-1px 0; }';b+='.usertext-edit textarea { background-color: #666666 !important; color: #CCCCCC !important; } ';b+='.RESDialogSmall { background-color: #666666 !important; color: #CCCCCC !important; } ';b+='.RESDialogSmall h3 { background-color: #222222 !important; color: #CCCCCC !important; } ';b+='ul.token-input-list-facebook { background-color: #aaa; }';RESUtils.addCSS(b)}}};modules['accountSwitcher']={moduleID:'accountSwitcher',moduleName:'Account Switcher',category:'Accounts',options:{accounts:{type:'table',addRowText:'+add account',fields:[{name:'username',type:'text'},{name:'password',type:'password'}],value:[],description:'Set your usernames and passwords below. They are only stored in RES preferences.'},keepLoggedIn:{type:'boolean',value:false,description:'Keep me logged in when I restart my browser.'},showCurrentUserName:{type:'boolean',value:false,description:'Show my current user name in the Account Switcher.'},dropDownStyle:{type:'enum',values:[{name:'snoo (alien)',value:'alien'},{name:'simple arrow',value:'arrow'}],value:'alien',description:'Use the "snoo" icon, or older style dropdown?'}},description:'Store username/password pairs and switch accounts instantly while browsing Reddit!',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){RESUtils.addCSS('#header-bottom-right { height: auto; padding: 4px 4px 7px }')RESUtils.addCSS('#RESAccountSwitcherDropdown { min-width: 110px; width: auto; display: none; position: absolute; z-index: 999; }');RESUtils.addCSS('#RESAccountSwitcherDropdown li.accountName { height: auto; line-height: 20px; padding-top: 2px; padding-bottom: 2px; }');if(this.options.dropDownStyle.value=='alien'){RESUtils.addCSS('#RESAccountSwitcherIcon { cursor: pointer; margin-left: 3px; display: inline-block; width: 12px; vertical-align: middle; height: 16px; background-repeat: no-repeat; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAPCAYAAAAyPTUwAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkQ3NTExRkExOEYzNTExRTFBNjgzQzhEOUY2QzU2MUNFIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkQ3NTExRkEyOEYzNTExRTFBNjgzQzhEOUY2QzU2MUNFIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RDc1MTFGOUY4RjM1MTFFMUE2ODNDOEQ5RjZDNTYxQ0UiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RDc1MTFGQTA4RjM1MTFFMUE2ODNDOEQ5RjZDNTYxQ0UiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6W3fJJAAAB4ElEQVR42mJgwA4YgdgSiJUUFRXDW1tbL7Kzswsw4VDMBcRXgfgeMzPzJx4eHn4gG0MtSICPjY3NF0jLoCtglJWV1eDm5rZmZWX9k5ZbWGFmYqwhwM3B8Pn7T4bzl6/enzNlQsfrV68+srKxPWHMz89/ZmJiIunn58fA9+YKAwMHHwODlA4Dw4fHDAzPbzD8VLRhWLNuPcOzp0//MEhJSaU/f/HyPxhkyf//3xsEYa+s/f8/nOn//19f/n/98fO/jo5ONwMfH5/S27dvwfL/nt/5//8rhP3/z7f//55cgzD//PkPdK4F2N3x8fFLv3///v/d56//l69a83///v3/V65e8//+k+f///79+7+4uPgAUB0zIywUgNZEZmVlzRMTE2P78OEDA9DTDN++ffs3c+bMglOnTk0HqvkDC5p/L168+P7582cmaWlpBhUVFQZ5eXkGoPUMDx8+BMn/QQ5C1vb29r+HDx/+jwwuXLjwv7e39z8wWHkYkAOdk5OT4cePHygx9OXLF7BzgPpQo05NTS2mp6fnO7LJc+bM+a2np1eKNUFISEg0gEIFHIz//v3X1dWdDU1UYMAMYzg7O8eUlpYmXLly5dtfFm6h40cO3DU2NhYBphOea9euHQOpAQgwAKMW+Z5mJFvIAAAAAElFTkSuQmCC); }');RESUtils.addCSS('#RESAccountSwitcherIconOverlay { cursor: pointer; position: absolute; display: none; width: 11px; height: 22px; background-position: 2px 3px; padding-left: 2px; padding-right: 2px; padding-top: 3px; border: 1px solid #336699; border-bottom: 1px solid #5f99cf; background-color: #5f99cf; border-radius: 3px 3px 0px 0px; z-index: 100; background-repeat: no-repeat; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAPCAYAAAAyPTUwAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkQ3NTExRkExOEYzNTExRTFBNjgzQzhEOUY2QzU2MUNFIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkQ3NTExRkEyOEYzNTExRTFBNjgzQzhEOUY2QzU2MUNFIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RDc1MTFGOUY4RjM1MTFFMUE2ODNDOEQ5RjZDNTYxQ0UiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RDc1MTFGQTA4RjM1MTFFMUE2ODNDOEQ5RjZDNTYxQ0UiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6W3fJJAAAB4ElEQVR42mJgwA4YgdgSiJUUFRXDW1tbL7Kzswsw4VDMBcRXgfgeMzPzJx4eHn4gG0MtSICPjY3NF0jLoCtglJWV1eDm5rZmZWX9k5ZbWGFmYqwhwM3B8Pn7T4bzl6/enzNlQsfrV68+srKxPWHMz89/ZmJiIunn58fA9+YKAwMHHwODlA4Dw4fHDAzPbzD8VLRhWLNuPcOzp0//MEhJSaU/f/HyPxhkyf//3xsEYa+s/f8/nOn//19f/n/98fO/jo5ONwMfH5/S27dvwfL/nt/5//8rhP3/z7f//55cgzD//PkPdK4F2N3x8fFLv3///v/d56//l69a83///v3/V65e8//+k+f///79+7+4uPgAUB0zIywUgNZEZmVlzRMTE2P78OEDA9DTDN++ffs3c+bMglOnTk0HqvkDC5p/L168+P7582cmaWlpBhUVFQZ5eXkGoPUMDx8+BMn/QQ5C1vb29r+HDx/+jwwuXLjwv7e39z8wWHkYkAOdk5OT4cePHygx9OXLF7BzgPpQo05NTS2mp6fnO7LJc+bM+a2np1eKNUFISEg0gEIFHIz//v3X1dWdDU1UYMAMYzg7O8eUlpYmXLly5dtfFm6h40cO3DU2NhYBphOea9euHQOpAQgwAKMW+Z5mJFvIAAAAAElFTkSuQmCC); }')}else{RESUtils.addCSS('#RESAccountSwitcherIcon { display: inline-block; vertical-align: middle; margin-left: 3px; }');RESUtils.addCSS('#RESAccountSwitcherIcon .downArrow { cursor: pointer; margin-top: 2px; display: block; width: 16px; height: 10px; background-image: url("http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png"); background-position: 0px -106px; }');RESUtils.addCSS('#RESAccountSwitcherIconOverlay { cursor: pointer; position: absolute; display: none; width: 20px; height: 22px; z-index: 100; border: 1px solid #336699; border-bottom: 1px solid #5f99cf; background-color: #5f99cf; border-radius: 3px 3px 0px 0px; }');RESUtils.addCSS('#RESAccountSwitcherIconOverlay .downArrow { margin-top: 6px; margin-left: 3px; display: inline-block; width: 18px; height: 10px; background-image: url("http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png"); background-position: 0px -96px; }')}}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){this.userLink=document.querySelector('#header-bottom-right > span.user > a');if(this.userLink){this.userLink.style.marginRight='2px';this.loggedInUser=RESUtils.loggedInUser();if(this.options.dropDownStyle.value=='alien'){this.downArrowOverlay=$('<span id="RESAccountSwitcherIconOverlay"></span>');this.downArrow=$('<span id="RESAccountSwitcherIcon"></span>')}else{this.downArrowOverlay=$('<span id="RESAccountSwitcherIconOverlay"><span class="downArrow"></span></span>');this.downArrow=$('<span id="RESAccountSwitcherIcon"><span class="downArrow"></span></span>')}$(this.downArrowOverlay).click(function(){modules['accountSwitcher'].toggleAccountMenu(false);modules['accountSwitcher'].manageAccounts()})$(document.body).append(this.downArrowOverlay);$(this.downArrow).click(function(){modules['accountSwitcher'].toggleAccountMenu(true)});$(this.downArrowOverlay).mouseleave(function(){modules['accountSwitcher'].dropdownTimer=setTimeout(function(){modules['accountSwitcher'].toggleAccountMenu(false)},1000)});$(this.userLink).after(this.downArrow);this.accountMenu=$('<ul id="RESAccountSwitcherDropdown" class="RESDropdownList"></ul>')$(this.accountMenu).mouseenter(function(){clearTimeout(modules['accountSwitcher'].dropdownTimer)});$(this.accountMenu).mouseleave(function(){modules['accountSwitcher'].toggleAccountMenu(false)});var a=this.options.accounts.value;if(a!=null){var b=0;for(var i=0,len=a.length;i<len;i++){var c=a[i];if(c[0]!=this.loggedInUser||this.options.showCurrentUserName.value){b++;var d=document.createElement('LI');addClass(d,'accountName');if(c[0]==this.loggedInUser){addClass(d,'active')}d.setAttribute('data-username',c[0]);$(d).text(c[0]);d.style.cursor='pointer';d.addEventListener('click',function(e){e.preventDefault();modules['accountSwitcher'].switchTo(e.target.getAttribute('data-username'))},true);$(this.accountMenu).append(d)}}var d=document.createElement('LI');addClass(d,'accountName');d.textContent='+ add account';d.style.cursor='pointer';d.addEventListener('click',function(e){e.preventDefault();modules['accountSwitcher'].toggleAccountMenu(false);modules['accountSwitcher'].manageAccounts()},true);$(this.accountMenu).append(d)}$(document.body).append(this.accountMenu)}}},toggleAccountMenu:function(a){if((a)||(!$(modules['accountSwitcher'].accountMenu).is(':visible'))){var b=18;if($('#RESAccountSwitcherDropdown').css('position')!='fixed'){var c=$(modules['accountSwitcher'].userLink).offset().left;var d=$(modules['accountSwitcher'].userLink).offset().top}else{var c=$('#header-bottom-right').position().left+$(modules['accountSwitcher'].userLink).position().left;var d=$(modules['accountSwitcher'].userLink).position().top;if(modules['betteReddit'].options.pinHeader.value=='subanduser'){b+=$('#sr-header-area').height()}else if(modules['betteReddit'].options.pinHeader.value=='header'){b+=$('#sr-header-area').height()}}$(modules['accountSwitcher'].accountMenu).css({top:(d+b)+'px',left:(c)+'px'});$(modules['accountSwitcher'].accountMenu).show();var c=$(modules['accountSwitcher'].downArrow).offset().left;var d=$(modules['accountSwitcher'].downArrow).offset().top;$(modules['accountSwitcher'].downArrowOverlay).css({top:(d-4)+'px',left:(c-3)+'px'});$(modules['accountSwitcher'].downArrowOverlay).show()}else{$(modules['accountSwitcher'].accountMenu).hide();$(modules['accountSwitcher'].downArrowOverlay).hide()}},closeAccountMenu:function(){$(this.accountMenu).hide()},switchTo:function(f){var g=this.options.accounts.value;var h='';var j='';if(this.options.keepLoggedIn.value){j='&rem=on'}for(var i=0,len=g.length;i<len;i++){var k=g[i];if(k[0]==f){h=k[1]}}var l='https://ssl.reddit.com/api/login';if(typeof(opera)!='undefined'){l='http://'+location.hostname+'/api/login'}else if((typeof(chrome)!='undefined')&&(chrome.extension.inIncognitoContext)){l='http://'+location.hostname+'/api/login'}else if(typeof(safari)!='undefined'){l='http://'+location.hostname+'/api/login'}GM_xmlhttpRequest({method:"POST",url:l,data:'user='+RESUtils.urlencode(f)+'&passwd='+RESUtils.urlencode(h)+j,headers:{"Content-Type":"application/x-www-form-urlencoded"},onload:function(a){var b=false;try{var c=JSON.parse(a.responseText)}catch(d){var c={};b=true}var d=/WRONG_PASSWORD/;var e=/RATELIMIT/;if(b){RESUtils.notification('There was an error switching accounts. Reddit may be under heavy load. Please try again in a few moments.')}else if(d.test(a.responseText)){alert('Incorrect login and/or password. Please check your configuration.')}else if(e.test(a.responseText)){alert('RATE LIMIT: The Reddit API is seeing too many hits from you too fast, perhaps you keep submitting a wrong password, etc?  Try again in a few minutes.')}else{location.reload()}}})},manageAccounts:function(){RESConsole.open();RESConsole.menuClick(document.getElementById('Menu-Accounts'));RESConsole.drawConfigOptions('accountSwitcher')}};modules['filteReddit']={moduleID:'filteReddit',moduleName:'filteReddit',category:'Filters',options:{NSFWfilter:{type:'boolean',value:false,description:'Filters all links labelled NSFW'},NSFWQuickToggle:{type:'boolean',value:true,description:'Add a quick NSFW on/off toggle to the gear menu'},keywords:{type:'table',addRowText:'+add filter',fields:[{name:'keyword',type:'text'},{name:'applyTo',type:'enum',values:[{name:'Everywhere',value:'everywhere'},{name:'Everywhere but:',value:'exclude'},{name:'Only on:',value:'include'}],value:'everywhere',description:'Apply filter to:'},{name:'reddits',type:'list',source:'/api/search_reddit_names.json?app=res',hintText:'type a subreddit name',onResult:function(a){var b=a.names;var c=[];for(var i=0,len=b.length;i<len;i++){c.push({id:b[i],name:b[i]})}return c}}],value:[],description:'Type in title keywords you want to ignore if they show up in a title'},subreddits:{type:'table',addRowText:'+add filter',fields:[{name:'subreddit',type:'text'}],value:[],description:'Type in a subreddit you want to ignore (only applies to /r/all or /domain/* urls)'},domains:{type:'table',addRowText:'+add filter',fields:[{name:'domain',type:'text'},{name:'applyTo',type:'enum',values:[{name:'Everywhere',value:'everywhere'},{name:'Everywhere but:',value:'exclude'},{name:'Only on:',value:'include'}],value:'everywhere',description:'Apply filter to:'},{name:'reddits',type:'list',source:'/api/search_reddit_names.json?app=res',hintText:'type a subreddit name',onResult:function(a){var b=a.names;var c=[];for(var i=0,len=b.length;i<len;i++){c.push({id:b[i],name:b[i]})}return c}}],value:[],description:'Type in domain keywords you want to ignore. Note that \"reddit\" would ignore \"reddit.com\" and \"fooredditbar.com\"'},flair:{type:'table',addRowText:'+add filter',fields:[{name:'keyword',type:'text'},{name:'applyTo',type:'enum',values:[{name:'Everywhere',value:'everywhere'},{name:'Everywhere but:',value:'exclude'},{name:'Only on:',value:'include'}],value:'everywhere',description:'Apply filter to:'},{name:'reddits',type:'list',source:'/api/search_reddit_names.json?app=res',hintText:'type a subreddit name',onResult:function(a){var b=a.names;var c=[];for(var i=0,len=b.length;i<len;i++){c.push({id:b[i],name:b[i]})}return c}}],value:[],description:'Type in keywords you want to ignore if they are contained in link flair'}},description:'Filter out NSFW content, or links by keyword, domain (use User Tagger to ignore by user) or subreddit (for /r/all or /domain/*).',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/?(?:\??[\w]+=[\w]+&?)*/i,/https?:\/\/([a-z]+).reddit.com\/r\/[\w]+\/?(?:\??[\w]+=[\w]+&?)*$/i),exclude:Array(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]+\/comments\/[-\w\.]+/i,/https?:\/\/([a-z]+).reddit.com\/saved\/?/i,/https?:\/\/([a-z]+).reddit.com\/comments\/[-\w\.]+/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if(this.isEnabled()){RESUtils.addCSS('#nsfwSwitchToggle { float: right; margin-right: 10px; margin-top: 10px; line-height: 10px; }');RESUtils.addCSS('.RESFilterToggle { margin-right: 5px; color: white; background-image: url(/static/bg-button-add.png); cursor: pointer; text-align: center; width: 68px; font-weight: bold; font-size: 10px; border: 1px solid #444444; padding: 1px 6px; border-radius: 3px 3px 3px 3px;  }');RESUtils.addCSS('.RESFilterToggle.remove { background-image: url(/static/bg-button-remove.png) }');RESUtils.addCSS('.RESFiltered { display: none !important; }');if(this.options.NSFWfilter.value){RESUtils.addCSS('.over18 { display: none !important; }')}}},go:function(){if((this.isEnabled())&&(this.options.NSFWQuickToggle.value)){var a=document.createDocumentFragment();this.nsfwSwitch=document.createElement('li');this.nsfwSwitch.setAttribute('title',"Toggle NSFW Filter");this.nsfwSwitch.addEventListener('click',function(e){e.preventDefault();if(modules['filteReddit'].options.NSFWfilter.value==true){modules['filteReddit'].filterNSFW(false);RESUtils.setOption('filteReddit','NSFWfilter',false);removeClass(modules['filteReddit'].nsfwSwitchToggle,'enabled')}else{modules['filteReddit'].filterNSFW(true);RESUtils.setOption('filteReddit','NSFWfilter',true);addClass(modules['filteReddit'].nsfwSwitchToggle,'enabled')}},true);this.nsfwSwitch.textContent='nsfw filter';this.nsfwSwitchToggle=createElementWithID('div','nsfwSwitchToggle','toggleButton');$(this.nsfwSwitchToggle).html('<span class="toggleOn">on</span><span class="toggleOff">off</span>');this.nsfwSwitch.appendChild(this.nsfwSwitchToggle);(this.options.NSFWfilter.value)?addClass(this.nsfwSwitchToggle,'enabled'):removeClass(this.nsfwSwitchToggle,'enabled');a.appendChild(this.nsfwSwitch);$('#RESDropdownOptions').append(this.nsfwSwitch)}if((this.isEnabled())&&(this.isMatchURL())){this.scanEntries();RESUtils.watchForElement('siteTable',modules['filteReddit'].scanEntries)}},scanEntries:function(a){if(a==null){var b=document.querySelectorAll('#siteTable div.thing.link')}else{var b=a.querySelectorAll('div.thing.link')}var c=(RESUtils.currentSubreddit('all'))||(RESUtils.currentDomain());for(var i=0,len=b.length;i<len;i++){var d=b[i].querySelector('.entry a.title').innerHTML;var e=b[i].querySelector('.entry span.domain > a').innerHTML.toLowerCase();var f=b[i].querySelector('.entry a.subreddit');var g=b[i].querySelector('.entry span.linkflairlabel');if(f!=null){var h=f.innerHTML}else{var h=false}var j=false;var k=(RESUtils.currentSubreddit())?RESUtils.currentSubreddit().toLowerCase():null;j=modules['filteReddit'].filterTitle(d,h||RESUtils.currentSubreddit());if(!j)j=modules['filteReddit'].filterDomain(e,h||k);if((!j)&&(c)&&(h)){j=modules['filteReddit'].filterSubreddit(h)}if((!j)&&(g)){j=modules['filteReddit'].filterFlair(g.textContent,h||RESUtils.currentSubreddit())}if(j){addClass(b[i],'RESFiltered')}}},filterNSFW:function(a){if(a==true){$('.over18').hide();if($('#nsfwstyle').length==0){$('body').append('<style id="nsfwstyle" />')}$('#nsfwstyle').html('.over18 { display: none; }')}else{$('.over18').show();if($('#nsfwstyle').length==0){$('body').append('<style id="nsfwstyle" />')}$('#nsfwstyle').html('.over18 { display: block; }')}},filterTitle:function(a,b){var b=(b)?b.toLowerCase():null;return this.arrayContainsSubstring(this.options.keywords.value,a.toLowerCase(),b)},filterDomain:function(a,b){var b=(b)?b.toLowerCase():null;var a=(a)?a.toLowerCase():null;return this.arrayContainsSubstring(this.options.domains.value,a,b)},filterSubreddit:function(a){return this.arrayContainsSubstring(this.options.subreddits.value,a.toLowerCase(),null,true)},filterFlair:function(a,b){var b=(b)?b.toLowerCase():null;return this.arrayContainsSubstring(this.options.flair.value,a.toLowerCase(),b)},unescapeHTML:function(a){var b=document.createElement("div");$(b).html(a);var c=b.childNodes[0].nodeValue;b.removeChild(b.firstChild);delete b;return c},arrayContainsSubstring:function(a,b,c,d){b=this.unescapeHTML(b);var i=a.length;while(i--){if((typeof(a[i])!='object')||(a[i].length<3)){if(a[i].length==1)a[i]=a[i][0];a[i]=[a[i],'everywhere','']}var e=a[i][0];var f=a[i][1];var g=a[i][2].toLowerCase().split(',');var h=false;switch(f){case'exclude':if(g.indexOf(c)!=-1){h=true}break;case'include':if(g.indexOf(c)==-1){h=true}break}if((!h)&&(d)&&(a[i]!=null)&&(b.toLowerCase()==e.toLowerCase()))return true;if((!h)&&(!d)&&(a[i]!=null)&&(b.indexOf(e.toString().toLowerCase())!=-1)){return true}}return false},toggleFilter:function(e){var a=e.target.getAttribute('subreddit').toLowerCase();var b=modules['filteReddit'].options.subreddits.value||[];var c=false;for(var i=0,len=b.length;i<len;i++){if((b[i])&&(b[i][0].toLowerCase()==a)){c=true;b.splice(i,1);e.target.setAttribute('title','Filter this subreddit from /r/all and /domain/*');e.target.textContent='+filter';removeClass(e.target,'remove');break}}if(!c){var d=[a,'everywhere',''];b.push(d);e.target.setAttribute('title','Stop filtering this subreddit from /r/all and /domain/*');e.target.textContent='-filter';addClass(e.target,'remove')}modules['filteReddit'].options.subreddits.value=b;RESStorage.setItem('RESoptions.filteReddit',JSON.stringify(modules['filteReddit'].options))}};modules['newCommentCount']={moduleID:'newCommentCount',moduleName:'New Comment Count',category:'Comments',options:{cleanComments:{type:'text',value:7,description:'Clean out cached comment counts of pages you haven\'t visited in [x] days - enter a number here only!'},subscriptionLength:{type:'text',value:2,description:'Automatically remove thread subscriptions in [x] days - enter a number here only!'}},description:'Shows how many new comments there are since your last visit.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/.*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){RESUtils.addCSS('.newComments { display: inline; color: orangered; }');RESUtils.addCSS('.RESSubscriptionButton { display: inline-block; margin-left: 15px; padding: 1px 0px 1px 0px; text-align: center; width: 78px; font-weight: bold; cursor: pointer; color: #336699; border: 1px solid #b6b6b6; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px;  }');RESUtils.addCSS('td .RESSubscriptionButton { margin-left: 0; margin-right: 15px; } ');RESUtils.addCSS('.RESSubscriptionButton.unsubscribe { color: orangered; }');RESUtils.addCSS('.RESSubscriptionButton:hover { background-color: #f0f3fc; }')}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){var a=RESStorage.getItem('RESmodules.newCommentCount.counts');if(a==null)a='{}';this.commentCounts=safeJSON.parse(a,'RESmodules.newCommentCount.counts');if(RESUtils.pageType()=='comments'){this.updateCommentCount();RESUtils.watchForElement('newComments',modules['newCommentCount'].updateCommentCountFromMyComment);this.addSubscribeLink()}else if(RESUtils.currentSubreddit('dashboard')){modules['dashboard'].addTab('newCommentsContents','My Subscriptions');var b=$('<div class="show">Show:</div>')var c=$('<select id="subscriptionFilter"><option>subscribed threads</option><option>all threads</option></select>')$(b).append(c);$('#newCommentsContents').append(b);$('#subscriptionFilter').change(function(){modules['newCommentCount'].drawSubscriptionsTable()});var d=$('<table id="newCommentsTable" />');$(d).append('<thead><tr><th sort="" class="active">Thread title</th><th sort="subreddit">Subreddit</th><th sort="updateTime">Last Visited</th><th sort="subscriptionDate">Subscription Expires</th><th class="actions">Actions</th></tr></thead><tbody></tbody>');$('#newCommentsContents').append(d);$('#newCommentsTable thead th').click(function(e){e.preventDefault();if($(this).hasClass('actions')){return false}if($(this).hasClass('active')){$(this).toggleClass('descending')}$(this).addClass('active');$(this).siblings().removeClass('active').find('SPAN').remove();$(this).find('.sortAsc, .sortDesc').remove();($(e.target).hasClass('descending'))?$(this).append('<span class="sortDesc" />'):$(this).append('<span class="sortAsc" />');modules['newCommentCount'].drawSubscriptionsTable($(e.target).attr('sort'),$(e.target).hasClass('descending'))});this.drawSubscriptionsTable();RESUtils.watchForElement('siteTable',modules['newCommentCount'].processCommentCounts)}else{this.processCommentCounts();RESUtils.watchForElement('siteTable',modules['newCommentCount'].processCommentCounts)}this.checkSubscriptions()}},drawSubscriptionsTable:function(c,d){var e=$('#subscriptionFilter').val();this.currentSortMethod=c||this.currentSortMethod;this.descending=(d==null)?this.descending:d==true;var f=[];for(var i in this.commentCounts){this.commentCounts[i].id=i;var g=this.commentCounts[i].url.match(RESUtils.matchRE);if(g){this.commentCounts[i].subreddit=g[1].toLowerCase();f.push(this.commentCounts[i])}}$('#newCommentsTable tbody').html('');switch(this.currentSortMethod){case'subscriptionDate':f.sort(function(a,b){return(a.subscriptionDate>b.subscriptionDate)?1:(b.subscriptionDate>a.subscriptionDate)?-1:0});if(this.descending)f.reverse();break;case'updateTime':f.sort(function(a,b){return(a.updateTime>b.updateTime)?1:(b.updateTime>a.updateTime)?-1:0});if(this.descending)f.reverse();break;case'subreddit':f.sort(function(a,b){return(a.subreddit>b.subreddit)?1:(b.subreddit>a.subreddit)?-1:0});if(this.descending)f.reverse();break;default:f.sort(function(a,b){return(a.title>b.title)?1:(b.title>a.title)?-1:0});if(this.descending)f.reverse();break}var h=0;for(var i in f){if((e=='all threads')||((e=='subscribed threads')&&(typeof(f[i].subscriptionDate)!='undefined'))){var j=f[i].title;var k=f[i].url;var l=new Date(f[i].updateTime);var m=(typeof(f[i].subscriptionDate)!='undefined')?new Date(f[i].subscriptionDate+(86400000*this.options.subscriptionLength.value)):0;if(m>0){var n=RESUtils.niceDateTime(m);var o='<span class="RESSubscriptionButton renew" title="renew subscription to this thread" data-threadid="'+f[i].id+'">renew</span>';var p='<span class="RESSubscriptionButton unsubscribe" title="unsubscribe from this thread" data-threadid="'+f[i].id+'">unsubscribe</span>';var q=o+p}else{var n='n/a';var q='<span class="RESSubscriptionButton subscribe" title="subscribe to this thread" data-threadid="'+f[i].id+'">subscribe</span>'}var r='<a href="/r/'+f[i].subreddit+'">/r/'+f[i].subreddit+'</a>';var s=$('<tr><td><a href="'+k+'">'+j+'</a></td><td>'+r+'</td><td>'+RESUtils.niceDateTime(l)+'</td><td>'+n+'</td><td>'+q+'</td></tr>');$(s).find('.renew').click(modules['newCommentCount'].renewSubscriptionButton);$(s).find('.unsubscribe').click(modules['newCommentCount'].unsubscribeButton);$(s).find('.subscribe').click(modules['newCommentCount'].subscribeButton);$('#newCommentsTable tbody').append(s);h++}}if(h==0){if(e=='subscribed threads'){$('#newCommentsTable tbody').append('<td colspan="5">You are currently not subscribed to any threads. To subscribe to a thread, click the "subscribe" button found near the top of the comments page.</td>')}else{$('#newCommentsTable tbody').append('<td colspan="5">No threads found</td>')}}},renewSubscriptionButton:function(e){var a=$(e.target).attr('data-threadid');modules['newCommentCount'].renewSubscription(a);RESUtils.notification('Your subscription has been renewed - it will expire in '+modules['newCommentCount'].options.subscriptionLength.value+' days.')},renewSubscription:function(a){var b=new Date();modules['newCommentCount'].commentCounts[a].subscriptionDate=b.getTime();RESStorage.setItem('RESmodules.newCommentCount.counts',JSON.stringify(modules['newCommentCount'].commentCounts));this.drawSubscriptionsTable()},unsubscribeButton:function(e){var a=window.confirm('Are you sure you want to unsubscribe?');if(a){var b=$(e.target).attr('data-threadid');modules['newCommentCount'].unsubscribe(b)}},unsubscribe:function(a){delete modules['newCommentCount'].commentCounts[a].subscriptionDate;RESStorage.setItem('RESmodules.newCommentCount.counts',JSON.stringify(modules['newCommentCount'].commentCounts));this.drawSubscriptionsTable()},subscribeButton:function(e){var a=$(e.target).attr('data-threadid');modules['newCommentCount'].subscribe(a)},subscribe:function(a){var b=new Date();modules['newCommentCount'].commentCounts[a].subscriptionDate=b.getTime();RESStorage.setItem('RESmodules.newCommentCount.counts',JSON.stringify(modules['newCommentCount'].commentCounts));this.drawSubscriptionsTable()},processCommentCounts:function(a){var a=a||document.body;var b=RESStorage.getItem('RESmodules.newCommentCount.lastClean');var c=new Date();if(b==null){b=c.getTime();RESStorage.setItem('RESmodules.newCommentCount.lastClean',c.getTime())}if((c.getTime()-b)>21600000){modules['newCommentCount'].cleanCache()}var d=/\/r\/[\w]+\/comments\/([\w]+)\//i;var e=a.querySelectorAll('.sitetable.linklisting div.thing.link a.comments');for(var i=0,len=e.length;i<len;i++){var f=e[i].getAttribute('href');var g=e[i].innerHTML;var h=g.split(' ');g=h[0];var j=d.exec(f);if(j){var k=j[1];if((typeof(modules['newCommentCount'].commentCounts[k])!='undefined')&&(modules['newCommentCount'].commentCounts[k]!=null)){var l=g-modules['newCommentCount'].commentCounts[k].count;if(l>0){var m=$('<span class="newComments">&nbsp;('+l+' new)</span>');$(e[i]).append(m)}}}}},updateCommentCountFromMyComment:function(){modules['newCommentCount'].updateCommentCount(true)},updateCommentCount:function(a){var b=modules['newCommentCount'];var c=/\/r\/[\w]+\/comments\/([\w]+)\//i;var d=c.exec(location.href);if(d){if(!b.currentCommentCount){b.currentCommentID=d[1];var e=document.querySelector('#siteTable a.comments');if(e){var f=e.innerHTML.split(' ');b.currentCommentCount=f[0];if((typeof(b.commentCounts[b.currentCommentID])!='undefined')&&(b.commentCounts[b.currentCommentID]!=null)){var g=b.commentCounts[b.currentCommentID].count;var h=b.currentCommentCount-g;var i=$('<span class="newComments">&nbsp;('+h+' new)</span>');if(h>0)$(e).append(i)}if(isNaN(b.currentCommentCount))b.currentCommentCount=0;if(a)b.currentCommentCount++}}else{b.currentCommentCount++}}var j=new Date();if(typeof(b.commentCounts)=='undefined'){b.commentCounts={}}if(typeof(b.commentCounts[b.currentCommentID])=='undefined'){b.commentCounts[b.currentCommentID]={}}b.commentCounts[b.currentCommentID].count=b.currentCommentCount;b.commentCounts[b.currentCommentID].url=location.href.replace(location.hash,'');b.commentCounts[b.currentCommentID].title=document.title;b.commentCounts[b.currentCommentID].updateTime=j.getTime();window.setTimeout(function(){RESStorage.setItem('RESmodules.newCommentCount.counts',JSON.stringify(modules['newCommentCount'].commentCounts))},100)},cleanCache:function(){var a=new Date();for(var i in this.commentCounts){if((this.commentCounts[i]!=null)&&((a.getTime()-this.commentCounts[i].updateTime)>(86400000*this.options.cleanComments.value))){delete this.commentCounts[i]}else if(this.commentCounts[i]==null){delete this.commentCounts[i]}}RESStorage.setItem('RESmodules.newCommentCount.counts',JSON.stringify(this.commentCounts));RESStorage.setItem('RESmodules.newCommentCount.lastClean',a.getTime())},addSubscribeLink:function(){var a=document.body.querySelector('.commentarea .panestack-title');if(a){this.commentSubToggle=createElementWithID('span','REScommentSubToggle','RESSubscriptionButton');this.commentSubToggle.addEventListener('click',modules['newCommentCount'].toggleSubscription,false);a.appendChild(this.commentSubToggle);if(typeof(this.commentCounts[this.currentCommentID].subscriptionDate)!='undefined'){this.commentSubToggle.textContent='unsubscribe';this.commentSubToggle.setAttribute('title','unsubscribe from thread');addClass(this.commentSubToggle,'unsubscribe')}else{this.commentSubToggle.textContent='subscribe';this.commentSubToggle.setAttribute('title','subscribe to this thread to be notified when new comments are posted');removeClass(this.commentSubToggle,'unsubscribe')}}},toggleSubscription:function(){var a=modules['newCommentCount'].currentCommentID;if(typeof(modules['newCommentCount'].commentCounts[a].subscriptionDate)!='undefined'){modules['newCommentCount'].unsubscribeFromThread(a)}else{modules['newCommentCount'].subscribeToThread(a)}},getLatestCommentCounts:function(){var a=RESStorage.getItem('RESmodules.newCommentCount.counts');if(a==null){a='{}'}modules['newCommentCount'].commentCounts=safeJSON.parse(a,'RESmodules.newCommentCount.counts')},subscribeToThread:function(a){modules['newCommentCount'].getLatestCommentCounts();modules['newCommentCount'].commentSubToggle.textContent='unsubscribe';modules['newCommentCount'].commentSubToggle.setAttribute('title','unsubscribe from thread');addClass(modules['newCommentCount'].commentSubToggle,'unsubscribe');a=a||modules['newCommentCount'].currentCommentID;var b=new Date();modules['newCommentCount'].commentCounts[a].subscriptionDate=b.getTime();RESStorage.setItem('RESmodules.newCommentCount.counts',JSON.stringify(modules['newCommentCount'].commentCounts));RESUtils.notification({header:'Subscription Notification',message:'You are now subscribed to this thread for '+modules['newCommentCount'].options.subscriptionLength.value+' days. You will be notified if new comments are posted since your last visit.'},3000)},unsubscribeFromThread:function(a){modules['newCommentCount'].getLatestCommentCounts();modules['newCommentCount'].commentSubToggle.textContent='subscribe';modules['newCommentCount'].commentSubToggle.setAttribute('title','subscribe to this thread and be notified when new comments are posted');removeClass(modules['newCommentCount'].commentSubToggle,'unsubscribe');a=a||modules['newCommentCount'].currentCommentID;var b=new Date();delete modules['newCommentCount'].commentCounts[a].subscriptionDate;RESStorage.setItem('RESmodules.newCommentCount.counts',JSON.stringify(modules['newCommentCount'].commentCounts));RESUtils.notification({header:'Subscription Notification',message:'You are now unsubscribed from this thread.'},3000)},checkSubscriptions:function(){if(this.commentCounts){var a=[];for(var i in this.commentCounts){var b=this.commentCounts[i];if((b)&&(typeof(b.subscriptionDate)!='undefined')){var c=parseInt(b.lastCheck)||0;var d=parseInt(b.subscriptionDate);var e=new Date();if((e.getTime()-d)>(this.options.subscriptionLength.value*86400000)){delete this.commentCounts[i].subscriptionDate}if((e.getTime()-c)>300000){b.lastCheck=e.getTime();this.commentCounts[i]=b;a.push('t3_'+i)}RESStorage.setItem('RESmodules.newCommentCount.count',JSON.stringify(this.commentCounts))}}if(a.length>0){this.checkThreads(a)}}},checkThreads:function(f){GM_xmlhttpRequest({method:"GET",url:location.protocol+'//'+location.hostname+'/by_id/'+f.join(',')+'.json?app=res',onload:function(a){var b=new Date();var c=JSON.parse(a.responseText);if(typeof(c.data)!='undefined'){for(var i=0,len=c.data.children.length;i<len;i++){var d=c.data.children[i].data.id;var e=modules['newCommentCount'].commentCounts[d];if(e.count<c.data.children[i].data.num_comments){modules['newCommentCount'].commentCounts[d].count=c.data.children[i].data.num_comments;RESUtils.notification({header:'Subscription Notification',message:'<p>New comments posted to thread:</p> <a href="'+e.url+'">'+e.title+'</a> <p><a class="RESNotificationButtonBlue" href="'+e.url+'">view the submission</a></p><div class="clear"></div>'},10000)}}RESStorage.setItem('RESmodules.newCommentCount.counts',JSON.stringify(modules['newCommentCount'].commentCounts))}}})}};modules['spamButton']={moduleID:'spamButton',moduleName:'Spam Button',category:'Filters',options:{},description:'Adds a Spam button to posts for easy reporting.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[\?]*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},go:function(){if((this.isEnabled())&&(this.isMatchURL())){var a=RESStorage.getItem('RESmodules.spamButton.reset');if(!a){RESStorage.setItem('RESmodules.spamButton.reset','true');RESConsole.enableModule('spamButton',false)}if(RESUtils.loggedInUser()!=RESUtils.currentUserProfile()){RESUtils.watchForElement('siteTable',modules['spamButton'].addSpamButtons);this.addSpamButtons()}}},addSpamButtons:function(b){if(b==null)b=document;if((RESUtils.pageType()=='linklist')||(RESUtils.pageType()=='comments')||(RESUtils.pageType()=='profile')){var c=b.querySelectorAll('#siteTable ul.flat-list.buttons');for(var i=0,len=c.length;i<len;i++){var d=c[i].childNodes[0].childNodes[0].href;var e=document.createElement('li');c[i].lastChild.parentNode.insertBefore(e,c[i].lastChild);var a=document.createElement('a');a.setAttribute('class','option');a.setAttribute('title','Report this user as a spammer');a.addEventListener('click',modules['spamButton'].reportPost,false);a.setAttribute('href','javascript:void(0)');a.textContent='rts';a.title="reportthespammers"spam.appendChild(a)}}},reportPost:function(e){var a=e.target;var b=a.parentNode.parentNode.parentNode;var c=b.querySelector('.author');var d=c.href;var f=c.innerHTML;a.setAttribute('href','http://www.reddit.com/r/reportthespammers/submit?url='+d+'&title=overview for '+f);a.setAttribute('target','_blank')}};modules['commentNavigator']={moduleID:'commentNavigator',moduleName:'Comment Navigator',category:'Comments',description:'Provides a comment navigation tool to easily find comments by OP, mod, etc.',options:{showByDefault:{type:'boolean',value:false,description:'Display Comment Navigator by default'}},isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]+\/comments\/[-\w\.]+/i,/https?:\/\/([a-z]+).reddit.com\/comments\/[-\w\.]+/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){RESUtils.addCSS('#REScommentNavBox { position: fixed; z-index: 999; right: 10px; top: 46px; width: 265px; border: 1px solid gray; background-color: #ffffff; opacity: 0.3; padding: 3px; user-select: none; -webkit-user-select: none; -moz-user-select: none; -webkit-transition:opacity 0.5s ease-in; -moz-transition:opacity 0.5s ease-in; -o-transition:opacity 0.5s ease-in; -ms-transition:opacity 0.5s ease-in; -transition:opacity 0.5s ease-in; }');RESUtils.addCSS('#REScommentNavBox:hover { opacity: 1 }');RESUtils.addCSS('#REScommentNavToggle { float: left; display: inline; margin-left: 0px; width: 100%; }');RESUtils.addCSS('.commentarea .menuarea { margin-right: 0px; }');RESUtils.addCSS('.menuarea > .spacer { margin-right: 0px; }');RESUtils.addCSS('#commentNavButtons { margin: auto; }');RESUtils.addCSS('#commentNavUp { margin: auto; cursor: pointer; background-image: url("http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png"); width: 32px; height: 20px; background-position: 0px -224px; }');RESUtils.addCSS('#commentNavDown { margin: auto; cursor: pointer; background-image: url("http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png"); width: 32px; height: 20px; background-position: 0px -244px; }');RESUtils.addCSS('#commentNavUp.noNav { background-position: 0px -264px; }');RESUtils.addCSS('#commentNavDown.noNav { background-position: 0px -284px; }');RESUtils.addCSS('#commentNavButtons { display: none; margin-left: 12px; text-align: center; user-select: none; -webkit-user-select: none; -moz-user-select: none; }');RESUtils.addCSS('.commentNavSortType { cursor: pointer; font-weight: bold; float: left; margin-left: 6px; }');RESUtils.addCSS('#commentNavPostCount { color: #1278d3; }');RESUtils.addCSS('.noNav #commentNavPostCount { color: #dddddd; }');RESUtils.addCSS('.commentNavSortTypeDisabled { color: #dddddd; }');RESUtils.addCSS('.commentNavSortType:hover { text-decoration: underline; }');RESUtils.addCSS('#REScommentNavToggle span { float: left; margin-left: 6px; }');RESUtils.addCSS('.menuarea > .spacer { float: left; }')}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){this.commentNavBox=createElementWithID('div','REScommentNavBox');addClass(this.commentNavBox,'RESDialogSmall');var a=document.body.querySelector('.commentarea .menuarea');if(a){this.commentNavToggle=createElementWithID('div','REScommentNavToggle');$(this.commentNavToggle).html('<span>navigate by:</span>');var b=['submitter','moderator','friend','admin','IAmA','images','popular','new'];for(var i=0,len=b.length;i<len;i++){var c=b[i];var d=createElementWithID('div','navigateBy'+c);switch(c){case'submitter':d.setAttribute('title','Navigate comments made by the post submitter');break;case'moderator':d.setAttribute('title','Navigate comments made by moderators');break;case'friend':d.setAttribute('title','Navigate comments made by users on your friends list');break;case'admin':d.setAttribute('title','Navigate comments made by reddit admins');break;case'IAmA':d.setAttribute('title','Navigate through questions that have been answered by the submitter (most useful in /r/IAmA)');break;case'images':d.setAttribute('title','Navigate through comments with images');break;case'popular':d.setAttribute('title','Navigate through comments in order of highest vote total');break;case'new':d.setAttribute('title','Navigate through new comments (Reddit Gold users only)');break;default:break}d.setAttribute('index',i+1);addClass(d,'commentNavSortType');d.textContent=c;if(c=='new'){var f=document.body.querySelector('.gold-accent.comment-visits-box');if(f){d.setAttribute('style','color: #9A7D2E;')}else{addClass(d,'commentNavSortTypeDisabled')}}if((c!='new')||(f)){d.addEventListener('click',function(e){modules['commentNavigator'].showNavigator(e.target.getAttribute('index'))},false)}this.commentNavToggle.appendChild(d);if(i<len-1){var g=document.createElement('span');g.textContent='|';this.commentNavToggle.appendChild(g)}}a.appendChild(this.commentNavToggle,a.firstChild);if(!(this.options.showByDefault.value)){this.commentNavBox.style.display='none'}var h=' 										<h3>Navigate by: 						<select id="commentNavBy"> 							<option name=""></option> 							<option name="submitter">submitter</option> 							<option name="moderator">moderator</option> 							<option name="friend">friend</option> 							<option name="admin">admin</option> 							<option name="IAmA">IAmA</option> 							<option name="images">images</option> 							<option name="popular">popular</option> 							<option name="new">new</option> 						</select> 					</h3>					<div id="commentNavCloseButton" class="RESCloseButton">&times;</div> 					<div class="RESDialogContents"> 						<div id="commentNavButtons"> 							<div id="commentNavUp"></div> <div id="commentNavPostCount"></div> <div id="commentNavDown"></div> 						</div> 					</div> 				';$(this.commentNavBox).html(h);this.posts=[];this.nav=[];this.navSelect=this.commentNavBox.querySelector('#commentNavBy');this.commentNavPostCount=this.commentNavBox.querySelector('#commentNavPostCount');this.commentNavButtons=this.commentNavBox.querySelector('#commentNavButtons');this.commentNavCloseButton=this.commentNavBox.querySelector('#commentNavCloseButton');this.commentNavCloseButton.addEventListener('click',function(e){modules['commentNavigator'].commentNavBox.style.display='none'},false);this.commentNavUp=this.commentNavBox.querySelector('#commentNavUp');this.commentNavUp.addEventListener('click',modules['commentNavigator'].moveUp,false);this.commentNavDown=this.commentNavBox.querySelector('#commentNavDown');this.commentNavDown.addEventListener('click',modules['commentNavigator'].moveDown,false);this.navSelect.addEventListener('change',modules['commentNavigator'].changeCategory,false);document.body.appendChild(this.commentNavBox)}}},changeCategory:function(){var a=modules['commentNavigator'].navSelect.selectedIndex;modules['commentNavigator'].currentCategory=modules['commentNavigator'].navSelect.options[a].value;if(modules['commentNavigator'].currentCategory!=''){modules['commentNavigator'].getPostsByCategory(modules['commentNavigator'].currentCategory);modules['commentNavigator'].commentNavButtons.style.display='block'}else{modules['commentNavigator'].commentNavButtons.style.display='none'}},showNavigator:function(a){modules['commentNavigator'].commentNavBox.style.display='block';this.navSelect.selectedIndex=a;modules['commentNavigator'].changeCategory()},getPostsByCategory:function(){var c=modules['commentNavigator'].currentCategory;if((typeof(c)!='undefined')&&(c!='')){if(typeof(this.posts[c])=='undefined'){switch(c){case'submitter':case'moderator':case'friend':case'admin':this.posts[c]=document.querySelectorAll('.noncollapsed a.author.'+c);break;case'IAmA':var d=document.querySelectorAll('.noncollapsed a.author.submitter');this.posts[c]=[];for(var i=0,len=d.length;i<len;i++){var e=d[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;if(e.parentNode.nodeName=='BODY'){this.posts[c].push(d[i].parentNode.parentNode)}else{this.posts[c].push(e)}}break;case'images':var f=document.querySelectorAll('.toggleImage');this.posts[c]=f;break;case'popular':var g=document.querySelectorAll('.noncollapsed');var h=[];for(var i=0,len=g.length;i<len;i++){var j=g[i].querySelector('.unvoted');if(j){var k=j.innerHTML.split(' ');var l=k[0]}else{var l=0}h[i]={comment:g[i],score:l}}h.sort(function(a,b){return parseInt(b.score)-parseInt(a.score)});this.posts[c]=[];for(var i=0,len=h.length;i<len;i++){this.posts[c][i]=h[i].comment}break;case'new':this.posts[c]=document.querySelectorAll('.new-comment');break}this.nav[c]=0}if(this.posts[c].length){modules['commentNavigator'].scrollToNavElement();removeClass(modules['commentNavigator'].commentNavUp,'noNav');removeClass(modules['commentNavigator'].commentNavDown,'noNav');removeClass(modules['commentNavigator'].commentNavButtons,'noNav')}else{modules['commentNavigator'].commentNavPostCount.textContent='none';addClass(modules['commentNavigator'].commentNavUp,'noNav');addClass(modules['commentNavigator'].commentNavDown,'noNav');addClass(modules['commentNavigator'].commentNavButtons,'noNav')}}},moveUp:function(){var a=modules['commentNavigator'].currentCategory;if(modules['commentNavigator'].posts[a].length){if(modules['commentNavigator'].nav[a]>0){modules['commentNavigator'].nav[a]--}else{modules['commentNavigator'].nav[a]=modules['commentNavigator'].posts[a].length-1}modules['commentNavigator'].scrollToNavElement()}},moveDown:function(){var a=modules['commentNavigator'].currentCategory;if(modules['commentNavigator'].posts[a].length){if(modules['commentNavigator'].nav[a]<modules['commentNavigator'].posts[a].length-1){modules['commentNavigator'].nav[a]++}else{modules['commentNavigator'].nav[a]=0}modules['commentNavigator'].scrollToNavElement()}},scrollToNavElement:function(){var a=modules['commentNavigator'].currentCategory;$(modules['commentNavigator'].commentNavPostCount).text(modules['commentNavigator'].nav[a]+1+'/'+modules['commentNavigator'].posts[a].length);var b=RESUtils.getXYpos(modules['commentNavigator'].posts[a][modules['commentNavigator'].nav[a]]);RESUtils.scrollTo(0,b.y)}};modules['subredditManager']={moduleID:'subredditManager',moduleName:'Subreddit Manager',category:'UI',options:{subredditShortcut:{type:'boolean',value:true,description:'Add +shortcut button in subreddit sidebar for easy addition of shortcuts.'},linkDashboard:{type:'boolean',value:true,description:'Show "DASHBOARD" link in subreddit manager'},linkAll:{type:'boolean',value:true,description:'Show "ALL" link in subreddit manager'},linkFront:{type:'boolean',value:true,description:'show "FRONT" link in subreddit manager'},linkRandom:{type:'boolean',value:true,description:'Show "RANDOM" link in subreddit manager'},linkRandNSFW:{type:'boolean',value:false,description:'Show "RANDNSFW" link in subreddit manager'},linkFriends:{type:'boolean',value:true,description:'Show "FRIENDS" link in subreddit manager'},linkMod:{type:'boolean',value:true,description:'Show "MOD" link in subreddit manager'},linkModqueue:{type:'boolean',value:true,description:'Show "MODQUEUE" link in subreddit manager'}},description:'Allows you to customize the top bar with your own subreddit shortcuts, including dropdown menus of multi-reddits and more.',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/.*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){RESUtils.addCSS('.srOver { outline: 1px dashed black; }');RESUtils.addCSS('body { overflow-x: hidden; }');RESUtils.addCSS('#sr-header-area a { font-size: 100% !important; }');RESUtils.addCSS('#srList { position: absolute; top: 18px; left: 0px; z-index: 9999; display: none; border: 1px solid black; background-color: #FAFAFA; max-height: 92%; width: auto; overflow-y: auto; }');RESUtils.addCSS('#srList tr { border-bottom: 1px solid gray; }');RESUtils.addCSS('#srList thead td { cursor: pointer; }');RESUtils.addCSS('#srList td { padding-left: 8px; padding-right: 8px; padding-top: 3px; padding-bottom: 3px; }');RESUtils.addCSS('#srList td.RESvisited, #srList td.RESshortcut { text-transform: none; }');RESUtils.addCSS('#srList td.RESshortcut {cursor: pointer;}');RESUtils.addCSS('#srList td a { width: 100%; display: block; }');RESUtils.addCSS('#srList tr:hover { background-color: #eeeeff; }');RESUtils.addCSS('#srLeftContainer, #RESStaticShortcuts, #RESShortcuts, #srDropdown { display: inline; float: left; position: relative; z-index: 5; }');RESUtils.addCSS('#editShortcutDialog { display: none; z-index: 999; position: absolute; top: 25px; left: 5px; width: 230px; padding: 10px; background-color: #f0f3fc; border: 1px solid #c7c7c7; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; font-size: 12px; color: #000000; }');RESUtils.addCSS('#editShortcutDialog h3 { display: inline-block; float: left; font-size: 13px; margin-top: 6px; }');RESUtils.addCSS('#editShortcutClose { float: right; margin-top: 2px; margin-right: 0px; }');RESUtils.addCSS('#editShortcutDialog label { clear: both; float: left; width: 100px; margin-top: 12px; }');RESUtils.addCSS('#editShortcutDialog input { float: left; width: 126px; margin-top: 10px; }');RESUtils.addCSS('#editShortcutDialog input[type=button] { float: right; width: 45px; margin-left: 10px; cursor: pointer; padding-top: 3px; padding-bottom: 3px; padding-left: 5px; padding-right: 5px; font-size: 12px; color: #ffffff; border: 1px solid #636363; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; background-color: #5cc410; }');if((typeof(chrome)!='undefined')||(typeof(safari)!='undefined')){RESUtils.addCSS('#srLeftContainer { margin-right: 14px; }')}else{RESUtils.addCSS('#srLeftContainer { margin-right: 6px; }')}RESUtils.addCSS('#srLeftContainer { z-index: 4; padding-left: 4px; }');RESUtils.addCSS('#RESShortcutsViewport { width: auto; max-height: 20px; overflow: hidden; } ');RESUtils.addCSS('#RESShortcuts { z-index: 6; white-space: nowrap; overflow-x: hidden; padding-left: 2px; }');RESUtils.addCSS('#RESSubredditGroupDropdown { display: none; position: absolute; z-index: 99999; padding: 3px; background-color: #F0F0F0; border-left: 1px solid black; border-right: 1px solid black; border-bottom: 1px solid black; }');RESUtils.addCSS('#RESSubredditGroupDropdown li { padding-left: 3px; padding-right: 3px; margin-bottom: 2px; }');RESUtils.addCSS('#RESSubredditGroupDropdown li:hover { background-color: #F0F0FC; }');RESUtils.addCSS('#RESShortcutsEditContainer { width: 52px; position: absolute; right: 0px; top: 0px; z-index: 999; background-color: #f0f0f0; height: 16px; user-select: none; -webkit-user-select: none; -moz-user-select: none; }');RESUtils.addCSS('#RESShortcutsRight { right: 0px; }');RESUtils.addCSS('#RESShortcutsAdd { right: 15px; }');RESUtils.addCSS('#RESShortcutsLeft { right: 31px; }');RESUtils.addCSS('#RESShortcutsRight, #RESShortcutsLeft, #RESShortcutsAdd, #RESShortcutsTrash {  width: 16px; cursor: pointer; background: #F0F0F0; font-size: 20px; color: #369; height: 18px; line-height: 15px; position: absolute; top: 0px; z-index: 999; background-color: #f0f0f0; user-select: none; -webkit-user-select: none; -moz-user-select: none;  } ');RESUtils.addCSS('#RESShortcutsTrash { display: none; font-size: 17px; width: 16px; cursor: pointer; right: 15px; height: 16px; position: absolute; top: 0px; z-index: 1000; user-select: none; -webkit-user-select: none; -moz-user-select: none; }');RESUtils.addCSS('.srSep { margin-left: 6px; }');RESUtils.addCSS('.RESshortcutside { margin-right: 5px; margin-top: 2px; color: white; background-image: url(/static/bg-button-add.png); cursor: pointer; text-align: center; width: 68px; font-weight: bold; font-size: 10px; border: 1px solid #444444; padding: 1px 6px; border-radius: 3px 3px 3px 3px; }');RESUtils.addCSS('.RESshortcutside.remove { background-image: url(/static/bg-button-remove.png) }');RESUtils.addCSS('.RESshortcutside:hover { background-color: #f0f0ff; }');RESUtils.addCSS('h1.redditname { overflow: auto; }');RESUtils.addCSS('.sortAsc, .sortDesc { float: right; background-image: url("http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png"); width: 12px; height: 12px; background-repeat: no-repeat; }');RESUtils.addCSS('.sortAsc { background-position: 0px -149px; }');RESUtils.addCSS('.sortDesc { background-position: -12px -149px; }');RESUtils.addCSS('#RESShortcutsAddFormContainer { display: none; position: absolute; width: 290px; padding: 2px; right: 0px; top: 21px; z-index: 10000; background-color: #f0f3fc; border: 1px solid #c7c7c7; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; font-size: 12px; color: #000000; }');RESUtils.addCSS('#RESShortcutsAddFormContainer  a { font-weight: bold; }');RESUtils.addCSS('#newShortcut { width: 130px; }');RESUtils.addCSS('#displayName { width: 130px; }');RESUtils.addCSS('#shortCutsAddForm { padding: 5px; }');RESUtils.addCSS('#shortCutsAddForm div { font-size: 10px; margin-bottom: 10px; }');RESUtils.addCSS('#shortCutsAddForm label { display: inline-block; width: 100px; }');RESUtils.addCSS('#shortCutsAddForm input[type=text] { width: 170px; margin-bottom: 6px; }');RESUtils.addCSS('#addSubreddit { float: right; cursor: pointer; padding-top: 3px; padding-bottom: 3px; padding-left: 5px; padding-right: 5px; font-size: 12px; color: #ffffff; border: 1px solid #636363; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; background-color: #5cc410; }');RESUtils.addCSS('.RESShortcutsCurrentSub { color:orangered!important; font-weight:bold; }');RESUtils.addCSS('.RESShortcutsCurrentSub:visited { color:orangered!important; font-weight:bold; }');RESUtils.addCSS('#srLeftContainer, #RESShortcutsViewport, #RESShortcutsEditContainer{max-height:18px;}');if(typeof(opera)!='undefined'){RESUtils.addCSS('#sr-header-area { display: block !important; }')}}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){this.manageSubreddits();if(RESUtils.currentSubreddit()!=null){this.setLastViewtime()}}},manageSubreddits:function(){this.redrawSubredditBar();if((RESUtils.currentSubreddit())&&(this.options.subredditShortcut.value==true)){var a=document.querySelectorAll('.fancy-toggle-button');for(var h=0,len=a.length;h<len;h++){var b=a[h];if((RESUtils.currentSubreddit().indexOf('+')==-1)&&(RESUtils.currentSubreddit()!='mod')){var c=RESUtils.currentSubreddit();var d=false}else if($(b).parent().hasClass('subButtons')){var d=true;var c=$(b).parent().parent().find('a.title').text()}else{var d=true;var c=$(b).next().text()}if(!($('#subButtons-'+c).length>0)){var e=$('<div id="subButtons-'+c+'" class="subButtons" style="margin: 0 !important;"></div>');$(b).wrap(e);if(d){var f=$(b).parent();$(f).appendTo($(f).parent())}}b.addEventListener('click',function(){RESStorage.setItem('RESmodules.subredditManager.subreddits.lastCheck.'+RESUtils.loggedInUser(),0)},false);var g=document.createElement('span');g.setAttribute('style','display: inline-block !important;');g.setAttribute('class','RESshortcut RESshortcutside');g.setAttribute('subreddit',c);var j=-1;for(var i=0,sublen=modules['subredditManager'].mySubredditShortcuts.length;i<sublen;i++){if(modules['subredditManager'].mySubredditShortcuts[i].subreddit.toLowerCase()==c.toLowerCase()){j=i;break}}if(j!=-1){g.textContent='-shortcut';g.setAttribute('title','Remove this subreddit from your shortcut bar');addClass(g,'remove')}else{g.textContent='+shortcut';g.setAttribute('title','Add this subreddit to your shortcut bar')}g.addEventListener('click',modules['subredditManager'].toggleSubredditShortcut,false);$('#subButtons-'+c).append(g);var k=$('#subButtons-'+c).next();if($(k).hasClass('title')&&(!$('#subButtons-'+c).hasClass('swapped'))){$('#subButtons-'+c).before($(k));$('#subButtons-'+c).addClass('swapped')}}}if(location.href.match(/https?:\/\/www.reddit.com\/reddits\/?(\?[\w=&]+)*/)){this.browsingReddits()}},browsingReddits:function(){var a=document.body.querySelectorAll('p.titlerow > a');if(a){for(var i=0,len=a.length;i<len;i++){if(typeof(a[i])=='undefined')break;var b=a[i].getAttribute('href').match(/https?:\/\/(?:[a-z]+).reddit.com\/r\/([\w]+).*/i);if(b!=null){var c=document.createElement('span');c.setAttribute('style','display: inline-block; margin-right: 0');c.setAttribute('class','RESshortcut RESshortcutside');c.setAttribute('subreddit',b[1]);var d=-1;for(var j=0,len=modules['subredditManager'].mySubredditShortcuts.length;j<len;j++){if(modules['subredditManager'].mySubredditShortcuts[j].subreddit==RESUtils.currentSubreddit()){d=j;break}}if(d!=-1){c.textContent='-shortcut';c.setAttribute('title','Remove this subreddit from your shortcut bar')}else{c.textContent='+shortcut';c.setAttribute('title','Add this subreddit to your shortcut bar')}c.addEventListener('click',modules['subredditManager'].toggleSubredditShortcut,false);a[i].parentNode.parentNode.previousSibling.appendChild(c)}else{}}}},redrawShortcuts:function(){this.shortCutsContainer.textContent='';var b=RESStorage.getItem('RESmodules.subredditManager.subredditShortcuts.'+RESUtils.loggedInUser());if(b==null){b=RESStorage.getItem('RESmodules.betteReddit.subredditShortcuts.'+RESUtils.loggedInUser());if(b!=null){var c=JSON.parse(RESStorage.getItem('RESoptions.betteReddit'));delete c.manageSubreddits;delete c.linkDashboard;delete c.linkAll;delete c.linkFriends;delete c.linkMod;delete c.linkRandom;delete c.linkHome;RESStorage.setItem('RESoptions.betteReddit',JSON.stringify(c));RESStorage.setItem('RESmodules.subredditManager.subredditShortcuts.'+RESUtils.loggedInUser(),b);RESStorage.removeItem('RESmodules.betteReddit.subredditShortcuts.'+RESUtils.loggedInUser());RESUtils.notification({header:'RES Notification',message:'Subreddit Manager is now a separate module (removed from betteReddit) to avoid confusion. If you dislike this feature, you may disable the module in the RES console'})}}if((b!=null)&&(b!='')&&(b!=[])){this.mySubredditShortcuts=safeJSON.parse(b,'RESmodules.subredditManager.subredditShortcuts.'+RESUtils.loggedInUser())for(var i=0,len=this.mySubredditShortcuts.length;i<len;i++){if(typeof(this.mySubredditShortcuts[i])=='string'){this.mySubredditShortcuts[i]={subreddit:this.mySubredditShortcuts[i],displayName:this.mySubredditShortcuts[i]}}var d=document.createElement('a');d.setAttribute('draggable','true');d.setAttribute('orderIndex',i);d.setAttribute('data-subreddit',this.mySubredditShortcuts[i].subreddit);addClass(d,'subbarlink');if((RESUtils.currentSubreddit()!=null)&&(RESUtils.currentSubreddit().toLowerCase()==this.mySubredditShortcuts[i].subreddit.toLowerCase())){addClass(d,'RESShortcutsCurrentSub')}d.setAttribute('href','/r/'+this.mySubredditShortcuts[i].subreddit);d.textContent=this.mySubredditShortcuts[i].displayName;d.addEventListener('click',function(e){if(e.button!=0||e.ctrlKey||e.metaKey||e.altKey){return true}else{e.preventDefault();modules['subredditManager'].clickedShortcut=e.target.getAttribute('href');if(typeof(modules['subredditManager'].clickTimer)=='undefined'){modules['subredditManager'].clickTimer=setTimeout(modules['subredditManager'].followSubredditShortcut,300)}}},false);d.addEventListener('dblclick',function(e){e.preventDefault();clearTimeout(modules['subredditManager'].clickTimer);delete modules['subredditManager'].clickTimer;modules['subredditManager'].editSubredditShortcut(e.target)},false);d.addEventListener('mouseover',function(e){clearTimeout(modules['subredditManager'].hideSubredditGroupDropdownTimer);if((typeof(e.target.getAttribute)!='undefined')&&(e.target.getAttribute('href').indexOf('+')!=-1)){var a=e.target.getAttribute('href').replace('/r/','').split('+');modules['subredditManager'].showSubredditGroupDropdown(a,e.target)}},false);d.addEventListener('mouseout',function(e){modules['subredditManager'].hideSubredditGroupDropdownTimer=setTimeout(function(){modules['subredditManager'].hideSubredditGroupDropdown()},500)},false);d.addEventListener('dragstart',modules['subredditManager'].subredditDragStart,false);d.addEventListener('dragenter',modules['subredditManager'].subredditDragEnter,false)d.addEventListener('dragover',modules['subredditManager'].subredditDragOver,false);d.addEventListener('dragleave',modules['subredditManager'].subredditDragLeave,false);d.addEventListener('drop',modules['subredditManager'].subredditDrop,false);d.addEventListener('dragend',modules['subredditManager'].subredditDragEnd,false);this.shortCutsContainer.appendChild(d);if(i<len-1){var f=document.createElement('span');f.setAttribute('class','separator');f.textContent='-';this.shortCutsContainer.appendChild(f)}}if(this.mySubredditShortcuts.length==0){this.shortCutsContainer.style.textTransform='none';this.shortCutsContainer.textContent='add shortcuts from the my subreddits menu at left or click the button by the subreddit name, drag and drop to sort'}else{this.shortCutsContainer.style.textTransform=''}}else{this.shortCutsContainer.style.textTransform='none';this.shortCutsContainer.textContent='add shortcuts from the my subreddits menu at left or click the button by the subreddit name, drag and drop to sort';this.mySubredditShortcuts=[]}},showSubredditGroupDropdown:function(a,b){if(typeof(this.subredditGroupDropdown)=='undefined'){this.subredditGroupDropdown=createElementWithID('div','RESSubredditGroupDropdown');this.subredditGroupDropdownUL=document.createElement('ul');this.subredditGroupDropdown.appendChild(this.subredditGroupDropdownUL);document.body.appendChild(this.subredditGroupDropdown);this.subredditGroupDropdown.addEventListener('mouseout',function(e){modules['subredditManager'].hideSubredditGroupDropdownTimer=setTimeout(function(){modules['subredditManager'].hideSubredditGroupDropdown()},500)},false);this.subredditGroupDropdown.addEventListener('mouseover',function(e){clearTimeout(modules['subredditManager'].hideSubredditGroupDropdownTimer)},false)}this.groupDropdownVisible=true;if(a){$(this.subredditGroupDropdownUL).html('');for(var i=0,len=a.length;i<len;i++){var c=$('<li><a href="/r/'+a[i]+'">'+a[i]+'</a></li>');$(this.subredditGroupDropdownUL).append(c)}var d=RESUtils.getXYpos(b);this.subredditGroupDropdown.style.top=(d.y+16)+'px';this.subredditGroupDropdown.style.left=d.x+'px';this.subredditGroupDropdown.style.display='block'}},hideSubredditGroupDropdown:function(){delete modules['subredditManager'].hideSubredditGroupDropdownTimer;if(this.subredditGroupDropdown)this.subredditGroupDropdown.style.display='none'},editSubredditShortcut:function(g){var h=g.getAttribute('href').slice(3);var j;for(var i=0,len=modules['subredditManager'].mySubredditShortcuts.length;i<len;i++){if(modules['subredditManager'].mySubredditShortcuts[i].subreddit==h){j=i;break}}if(typeof(this.editShortcutDialog)=='undefined'){this.editShortcutDialog=createElementWithID('div','editShortcutDialog');document.body.appendChild(this.editShortcutDialog)}var k='<form name="editSubredditShortcut"><h3>Edit Shortcut</h3><div id="editShortcutClose" class="RESCloseButton">&times;</div><label for="subreddit">Subreddit:</label> <input type="text" name="subreddit" value="'+h+'" id="shortcut-subreddit"><br>'thisForm+='<label for="displayName">Display Name:</label><input type="text" name="displayName" value="'+g.textContent+'" id="shortcut-displayname">';k+='<input type="hidden" name="idx" value="'+j+'"><input type="button" name="shortcut-save" value="save" id="shortcut-save"></form>';$(this.editShortcutDialog).html(k);this.subredditInput=this.editShortcutDialog.querySelector('input[name=subreddit]');this.displayNameInput=this.editShortcutDialog.querySelector('input[name=displayName]');this.subredditForm=this.editShortcutDialog.querySelector('FORM');this.subredditForm.addEventListener('submit',function(e){e.preventDefault()},false);this.saveButton=this.editShortcutDialog.querySelector('input[name=shortcut-save]');this.saveButton.addEventListener('click',function(e){var a=modules['subredditManager'].editShortcutDialog.querySelector('input[name=idx]').value;var b=modules['subredditManager'].editShortcutDialog.querySelector('input[name=subreddit]').value;var c=modules['subredditManager'].editShortcutDialog.querySelector('input[name=displayName]').value;if((b=='')||(c=='')){b=modules['subredditManager'].mySubredditShortcuts[a].subreddit;modules['subredditManager'].removeSubredditShortcut(b)}else{if(RESUtils.proEnabled()){var d=modules['subredditManager'].mySubredditShortcuts[a].subreddit;if(typeof(modules['subredditManager'].RESPro)=='undefined'){if(RESStorage.getItem('RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser())!=null){var f=safeJSON.parse(RESStorage.getItem('RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser()),'RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser())}else{var f={add:{},del:{}}}modules['subredditManager'].RESPro=f}if(typeof(modules['subredditManager'].RESPro.add)=='undefined'){modules['subredditManager'].RESPro.add={}}if(typeof(modules['subredditManager'].RESPro.del)=='undefined'){modules['subredditManager'].RESPro.del={}}modules['subredditManager'].RESPro.add[b]=true;modules['subredditManager'].RESPro.del[d]=true;if(typeof(modules['subredditManager'].RESPro.add[d])!='undefined')delete modules['subredditManager'].RESPro.add[d];if(typeof(modules['subredditManager'].RESPro.del[b])!='undefined')delete modules['subredditManager'].RESPro.del[b];RESStorage.setItem('RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser(),JSON.stringify(modules['subredditManager'].RESPro))}modules['subredditManager'].mySubredditShortcuts[a]={subreddit:b,displayName:c}RESStorage.setItem('RESmodules.subredditManager.subredditShortcuts.'+RESUtils.loggedInUser(),JSON.stringify(modules['subredditManager'].mySubredditShortcuts));if(RESUtils.proEnabled()){modules['RESPro'].saveModuleData('subredditManager')}}modules['subredditManager'].editShortcutDialog.style.display='none';modules['subredditManager'].redrawShortcuts();modules['subredditManager'].populateSubredditDropdown()},false);this.subredditInput.addEventListener('keyup',function(e){if(e.keyCode==27){modules['subredditManager'].editShortcutDialog.style.display='none';modules['subredditManager'].editShortcutDialog.blur()}else if(e.keyCode==13){RESUtils.click(modules['subredditManager'].saveButton)}},false);this.displayNameInput.addEventListener('keyup',function(e){if(e.keyCode==27){modules['subredditManager'].editShortcutDialog.style.display='none';modules['subredditManager'].editShortcutDialog.blur()}else if(e.keyCode==13){RESUtils.click(modules['subredditManager'].saveButton)}},false);var l=this.editShortcutDialog.querySelector('#editShortcutClose');l.addEventListener('click',function(e){modules['subredditManager'].editShortcutDialog.style.display='none'},false);this.editShortcutDialog.style.display='block';var m=Math.min(RESUtils.mouseX,window.innerWidth-300);this.editShortcutDialog.style.left=m+'px';setTimeout(function(){modules['subredditManager'].subredditInput.focus()},200)},followSubredditShortcut:function(){if(typeof(self.on)=='function'){location.href=location.protocol+'//'+location.hostname+modules['subredditManager'].clickedShortcut}else{location.href=modules['subredditManager'].clickedShortcut}},subredditDragStart:function(e){clearTimeout(modules['subredditManager'].clickTimer);this.style.opacity='0.4';modules['subredditManager'].shortCutsTrash.style.display='block';modules['subredditManager'].dragSrcEl=this;e.dataTransfer.effectAllowed='move';modules['subredditManager'].srDataTransfer=this.getAttribute('orderIndex')+','+this.getAttribute('data-subreddit')},subredditDragEnter:function(e){addClass(this,'srOver');return false},subredditDragOver:function(e){if(e.preventDefault){e.preventDefault()}e.dataTransfer.dropEffect='move';return false},subredditDragLeave:function(e){removeClass(this,'srOver');return false},subredditDrop:function(e){if(e.stopPropagation){e.stopPropagation()}e.preventDefault();modules['subredditManager'].shortCutsTrash.style.display='none';if(modules['subredditManager'].dragSrcEl!=this){if(e.target.getAttribute('id')!='RESShortcutsTrash'){var a=modules['subredditManager'].srDataTransfer.split(',');var b=parseInt(a[0]);var c=modules['subredditManager'].mySubredditShortcuts[b];var d=parseInt(this.getAttribute('orderIndex'));var f=modules['subredditManager'].mySubredditShortcuts[d];var g=[];var h=0;for(var i=0,len=modules['subredditManager'].mySubredditShortcuts.length;i<len;i++){if((i!=b)&&(i!=d)){g[h]=modules['subredditManager'].mySubredditShortcuts[i];h++}else if(i==d){if(d>b){g[h]=f;h++;g[h]=c;h++}else{g[h]=c;h++;g[h]=f;h++}}}modules['subredditManager'].mySubredditShortcuts=g;RESStorage.setItem('RESmodules.subredditManager.subredditShortcuts.'+RESUtils.loggedInUser(),JSON.stringify(modules['subredditManager'].mySubredditShortcuts));modules['subredditManager'].redrawShortcuts();removeClass(this,'srOver')}else{var a=modules['subredditManager'].srDataTransfer.split(',');var b=parseInt(a[0]);var c=a[1];modules['subredditManager'].removeSubredditShortcut(c)}}return false},subredditDragEnd:function(e){modules['subredditManager'].shortCutsTrash.style.display='none';this.style.opacity='1';return false},redrawSubredditBar:function(){this.headerContents=document.querySelector('#sr-header-area');if(this.headerContents){$(this.headerContents).html('');this.srLeftContainer=createElementWithID('div','srLeftContainer');this.srLeftContainer.setAttribute('class','sr-bar');this.srDropdown=createElementWithID('div','srDropdown');this.srDropdownContainer=createElementWithID('div','srDropdownContainer');$(this.srDropdownContainer).html('<a href="javascript:void(0)">My Subreddits</a>');this.srDropdownContainer.addEventListener('click',modules['subredditManager'].toggleSubredditDropdown,false);this.srDropdown.appendChild(this.srDropdownContainer);this.srList=createElementWithID('table','srList');document.body.appendChild(this.srList);this.srLeftContainer.appendChild(this.srDropdown);var c=document.createElement('span');c.setAttribute('class','srSep');c.textContent='|';this.srLeftContainer.appendChild(c);this.staticShortCutsContainer=document.createElement('div');this.staticShortCutsContainer.setAttribute('id','RESStaticShortcuts');$(this.staticShortCutsContainer).html('');var d={};var f=(RESUtils.currentSubreddit())?RESUtils.currentSubreddit().toLowerCase():'home';d[f]='RESShortcutsCurrentSub';var g='';if(this.options.linkDashboard.value)g+='<span class="separator">-</span><a id="RESDashboardLink" class="subbarlink '+d['dashboard']+'" href="/r/Dashboard/">DASHBOARD</a>';if(this.options.linkFront.value)g+='<span class="separator">-</span><a class="subbarlink '+d['home']+'" href="/">FRONT</a>';if(this.options.linkAll.value)g+='<span class="separator">-</span><a class="subbarlink '+d['all']+'" href="/r/all/">ALL</a>';if(this.options.linkRandom.value)g+='<span class="separator">-</span><a class="subbarlink" href="/r/random/">RANDOM</a>';if(this.options.linkRandNSFW.value)g+='<span class="separator">-</span><a class="subbarlink" href="/r/randnsfw/">RANDNSFW</a>';if(RESUtils.loggedInUser()!=null){if(this.options.linkFriends.value)g+='<span class="separator">-</span><a class="subbarlink '+d['friends']+'" href="/r/friends/">FRIENDS</a>';var h=document.getElementById('modmail');if(h){if(this.options.linkMod.value)g+='<span class="separator">-</span><a class=" '+d['mod']+'" href="/r/mod/">MOD</a>';if(this.options.linkModqueue.value)g+='<span class="separator">-</span><a class="subbarlink" href="/r/mod/about/modqueue">MODQUEUE</a>'}}$(this.staticShortCutsContainer).append(g);this.srLeftContainer.appendChild(this.staticShortCutsContainer);this.srLeftContainer.appendChild(c);this.headerContents.appendChild(this.srLeftContainer);this.shortCutsViewport=document.createElement('div');this.shortCutsViewport.setAttribute('id','RESShortcutsViewport');this.headerContents.appendChild(this.shortCutsViewport);this.shortCutsContainer=document.createElement('div');this.shortCutsContainer.setAttribute('id','RESShortcuts');this.shortCutsContainer.setAttribute('class','sr-bar');this.shortCutsViewport.appendChild(this.shortCutsContainer);this.shortCutsEditContainer=document.createElement('div');this.shortCutsEditContainer.setAttribute('id','RESShortcutsEditContainer');this.headerContents.appendChild(this.shortCutsEditContainer);this.shortCutsRight=document.createElement('div');this.shortCutsRight.setAttribute('id','RESShortcutsRight');this.shortCutsRight.textContent='>';this.shortCutsRight.addEventListener('click',function(e){modules['subredditManager'].containerWidth=modules['subredditManager'].shortCutsContainer.offsetWidth;var a=modules['subredditManager'].shortCutsContainer.firstChild.style.marginLeft;a=parseInt(a.replace('px',''));if(isNaN(a))a=0;var b=$('#RESShortcutsViewport').width()-80;if(modules['subredditManager'].containerWidth>(b)){a-=b;modules['subredditManager'].shortCutsContainer.firstChild.style.marginLeft=a+'px'}else{}},false);this.shortCutsEditContainer.appendChild(this.shortCutsRight);this.shortCutsAdd=document.createElement('div');this.shortCutsAdd.setAttribute('id','RESShortcutsAdd');this.shortCutsAdd.textContent='+';this.shortCutsAdd.title='add shortcut';this.shortCutsAddFormContainer=document.createElement('div');this.shortCutsAddFormContainer.setAttribute('id','RESShortcutsAddFormContainer');this.shortCutsAddFormContainer.style.display='none';var i=' 				<form id="shortCutsAddForm"> 					<div>Add shortcut or multi-reddit (i.e. foo+bar+baz):</div> 					<label for="newShortcut">Subreddit:</label> <input type="text" id="newShortcut"><br> 					<label for="displayName">Display Name:</label> <input type="text" id="displayName"><br> 					<input type="submit" name="submit" value="add" id="addSubreddit"> 					<div style="clear: both; float: right; margin-top: 5px;"><a style="font-size: 9px;" href="/reddits">Edit frontpage subscriptions</a></div> 				</form> 			';$(this.shortCutsAddFormContainer).html(i);this.shortCutsAddFormField=this.shortCutsAddFormContainer.querySelector('#newShortcut');this.shortCutsAddFormFieldDisplayName=this.shortCutsAddFormContainer.querySelector('#displayName');modules['subredditManager'].shortCutsAddFormField.addEventListener('keyup',function(e){if(e.keyCode==27){modules['subredditManager'].shortCutsAddFormContainer.style.display='none';modules['subredditManager'].shortCutsAddFormField.blur()}},false);modules['subredditManager'].shortCutsAddFormFieldDisplayName.addEventListener('keyup',function(e){if(e.keyCode==27){modules['subredditManager'].shortCutsAddFormContainer.style.display='none';modules['subredditManager'].shortCutsAddFormFieldDisplayName.blur()}},false);this.shortCutsAddForm=this.shortCutsAddFormContainer.querySelector('#shortCutsAddForm');this.shortCutsAddForm.addEventListener('submit',function(e){e.preventDefault();var a=modules['subredditManager'].shortCutsAddFormField.value;var b=modules['subredditManager'].shortCutsAddFormFieldDisplayName.value;if(b=='')b=a;a=a.replace('/r/','').replace('r/','');modules['subredditManager'].shortCutsAddFormField.value='';modules['subredditManager'].shortCutsAddFormFieldDisplayName.value='';modules['subredditManager'].shortCutsAddFormContainer.style.display='none';if(a){modules['subredditManager'].addSubredditShortcut(a,b)}},false);this.shortCutsAdd.addEventListener('click',function(e){if(modules['subredditManager'].shortCutsAddFormContainer.style.display=='none'){modules['subredditManager'].shortCutsAddFormContainer.style.display='block';modules['subredditManager'].shortCutsAddFormField.focus()}else{modules['subredditManager'].shortCutsAddFormContainer.style.display='none';modules['subredditManager'].shortCutsAddFormField.blur()}},false);this.shortCutsEditContainer.appendChild(this.shortCutsAdd);document.body.appendChild(this.shortCutsAddFormContainer);this.shortCutsTrash=document.createElement('div');this.shortCutsTrash.setAttribute('id','RESShortcutsTrash');this.shortCutsTrash.textContent='X';this.shortCutsTrash.addEventListener('dragenter',modules['subredditManager'].subredditDragEnter,false)this.shortCutsTrash.addEventListener('dragleave',modules['subredditManager'].subredditDragLeave,false);this.shortCutsTrash.addEventListener('dragover',modules['subredditManager'].subredditDragOver,false);this.shortCutsTrash.addEventListener('drop',modules['subredditManager'].subredditDrop,false);this.shortCutsEditContainer.appendChild(this.shortCutsTrash);this.shortCutsLeft=document.createElement('div');this.shortCutsLeft.setAttribute('id','RESShortcutsLeft');this.shortCutsLeft.textContent='<';this.shortCutsLeft.addEventListener('click',function(e){var a=modules['subredditManager'].shortCutsContainer.firstChild.style.marginLeft;a=parseInt(a.replace('px',''));var b=$('#RESShortcutsViewport').width()-80;if(isNaN(a))a=0;a+=b;if(a<=0){modules['subredditManager'].shortCutsContainer.firstChild.style.marginLeft=a+'px'}},false);this.shortCutsEditContainer.appendChild(this.shortCutsLeft);this.redrawShortcuts()}},toggleSubredditDropdown:function(){if(modules['subredditManager'].srList.style.display=='block'){modules['subredditManager'].srList.style.display='none'}else{if(RESUtils.loggedInUser()){$(modules['subredditManager'].srList).html('<tr><td width="360">Loading subreddits (may take a moment)...<div id="subredditPagesLoaded"></div></td></tr>');modules['subredditManager'].subredditPagesLoaded=modules['subredditManager'].srList.querySelector('#subredditPagesLoaded');modules['subredditManager'].srList.style.display='block';modules['subredditManager'].getSubreddits()}else{$(modules['subredditManager'].srList).html('<tr><td width="360">You must be logged in to load your own list of subreddits. <a style="display: inline; float: left;" href="/reddits">browse them all</a></td></tr>');modules['subredditManager'].srList.style.display='block'}}},mySubreddits:[],mySubredditShortcuts:[],getSubredditJSON:function(l){var m=location.protocol+'//'+location.hostname+'/reddits/mine/.json?app=res';if(l)m+='&after='+l;GM_xmlhttpRequest({method:"GET",url:m,onload:function(e){var f=JSON.parse(e.responseText);if((typeof(f.data)!='undefined')&&(typeof(f.data.children)!='undefined')){if(modules['subredditManager'].subredditPagesLoaded.innerHTML==''){modules['subredditManager'].subredditPagesLoaded.textContent='Pages loaded: 1'}else{var g=modules['subredditManager'].subredditPagesLoaded.innerHTML.match(/:\ ([\d]+)/);modules['subredditManager'].subredditPagesLoaded.textContent='Pages loaded: '+(parseInt(g[1])+1)}var h=new Date();RESStorage.setItem('RESmodules.subredditManager.subreddits.lastCheck.'+RESUtils.loggedInUser(),h.getTime());var j=f.data.children;for(var i=0,len=j.length;i<len;i++){var k={display_name:j[i].data.display_name,url:j[i].data.url,over18:j[i].data.over18,id:j[i].data.id,created:j[i].data.created,description:j[i].data.description}modules['subredditManager'].mySubreddits.push(k)}if(f.data.after!=null){modules['subredditManager'].getSubredditJSON(f.data.after)}else{modules['subredditManager'].mySubreddits.sort(function(a,b){var c=a.display_name.toLowerCase();var d=b.display_name.toLowerCase();if(c>d)return 1;if(c==d)return 0;return-1});RESStorage.setItem('RESmodules.subredditManager.subreddits.'+RESUtils.loggedInUser(),JSON.stringify(modules['subredditManager'].mySubreddits));this.gettingSubreddits=false;modules['subredditManager'].populateSubredditDropdown()}}else{modules['subredditManager'].populateSubredditDropdown(null,true)}}})},getSubreddits:function(){modules['subredditManager'].mySubreddits=[];var a=parseInt(RESStorage.getItem('RESmodules.subredditManager.subreddits.lastCheck.'+RESUtils.loggedInUser()))||0;var b=new Date();var c=RESStorage.getItem('RESmodules.subredditManager.subreddits.'+RESUtils.loggedInUser());if(((b.getTime()-a)>86400000)||(c==null)||(c=='')||(c.length==0)){if(!this.gettingSubreddits){this.gettingSubreddits=true;this.getSubredditJSON()}}else{modules['subredditManager'].mySubreddits=safeJSON.parse(c,'RESmodules.subredditManager.subreddits.'+RESUtils.loggedInUser());this.populateSubredditDropdown()}},populateSubredditDropdown:function(f,g){modules['subredditManager'].sortBy=f||'subreddit';$(modules['subredditManager'].srList).html('');var h=document.createElement('thead');var k=document.createElement('tr');modules['subredditManager'].srHeader=document.createElement('td');modules['subredditManager'].srHeader.addEventListener('click',function(){if(modules['subredditManager'].sortBy=='subreddit'){modules['subredditManager'].populateSubredditDropdown('subredditDesc')}else{modules['subredditManager'].populateSubredditDropdown('subreddit')}},false);modules['subredditManager'].srHeader.textContent='subreddit';modules['subredditManager'].srHeader.setAttribute('width','200');modules['subredditManager'].lvHeader=document.createElement('td');modules['subredditManager'].lvHeader.addEventListener('click',function(){if(modules['subredditManager'].sortBy=='lastVisited'){modules['subredditManager'].populateSubredditDropdown('lastVisitedAsc')}else{modules['subredditManager'].populateSubredditDropdown('lastVisited')}},false);modules['subredditManager'].lvHeader.textContent='Last Visited';modules['subredditManager'].lvHeader.setAttribute('width','120');var l=document.createElement('td');$(l).html('<a style="float: right;" href="/reddits">View all &raquo;</a>');k.appendChild(modules['subredditManager'].srHeader);k.appendChild(modules['subredditManager'].lvHeader);k.appendChild(l);h.appendChild(k);modules['subredditManager'].srList.appendChild(h);var m=document.createElement('tbody');if(!(g)){var n=modules['subredditManager'].mySubreddits.length;if(typeof(this.subredditsLastViewed)=='undefined'){var o=RESStorage.getItem('RESmodules.subredditManager.subredditsLastViewed.'+RESUtils.loggedInUser());if(o){this.subredditsLastViewed=safeJSON.parse(o,'RESmodules.subredditManager.subredditsLastViewed.'+RESUtils.loggedInUser())}else{this.subredditsLastViewed={}}}var p=modules['subredditManager'].mySubreddits;if(f=='lastVisited'){$(modules['subredditManager'].lvHeader).html('Last Visited <div class="sortAsc"></div>');modules['subredditManager'].srHeader.textContent='subreddit';p.sort(function(a,b){var c=a.display_name.toLowerCase();var d=b.display_name.toLowerCase();(typeof(modules['subredditManager'].subredditsLastViewed[c])=='undefined')?alv=0:alv=parseInt(modules['subredditManager'].subredditsLastViewed[c].last_visited);(typeof(modules['subredditManager'].subredditsLastViewed[d])=='undefined')?blv=0:blv=parseInt(modules['subredditManager'].subredditsLastViewed[d].last_visited);if(alv<blv)return 1;if(alv==blv){if(c>d)return 1;return-1}return-1})}else if(f=='lastVisitedAsc'){$(modules['subredditManager'].lvHeader).html('Last Visited <div class="sortDesc"></div>');modules['subredditManager'].srHeader.textContent='subreddit';p.sort(function(a,b){var c=a.display_name.toLowerCase();var d=b.display_name.toLowerCase();(typeof(modules['subredditManager'].subredditsLastViewed[c])=='undefined')?alv=0:alv=parseInt(modules['subredditManager'].subredditsLastViewed[c].last_visited);(typeof(modules['subredditManager'].subredditsLastViewed[d])=='undefined')?blv=0:blv=parseInt(modules['subredditManager'].subredditsLastViewed[d].last_visited);if(alv>blv)return 1;if(alv==blv){if(c>d)return 1;return-1}return-1})}else if(f=='subredditDesc'){modules['subredditManager'].lvHeader.textContent='Last Visited';$(modules['subredditManager'].srHeader).html('subreddit <div class="sortDesc"></div>');p.sort(function(a,b){var c=a.display_name.toLowerCase();var d=b.display_name.toLowerCase();if(c<d)return 1;if(c==d)return 0;return-1})}else{modules['subredditManager'].lvHeader.textContent='Last Visited';$(modules['subredditManager'].srHeader).html('subreddit <div class="sortAsc"></div>');p.sort(function(a,b){var c=a.display_name.toLowerCase();var d=b.display_name.toLowerCase();if(c>d)return 1;if(c==d)return 0;return-1})}for(var i=0;i<n;i++){var q='Never';var r=p[i].display_name.toLowerCase();if(typeof(this.subredditsLastViewed[r])!='undefined'){var s=parseInt(this.subredditsLastViewed[r].last_visited);var t=new Date(s);q=RESUtils.niceDate(t)}var k=document.createElement('tr');var u=document.createElement('td');$(u).html('<a href="'+escapeHTML(modules['subredditManager'].mySubreddits[i].url)+'">'+escapeHTML(modules['subredditManager'].mySubreddits[i].display_name)+'</a>');k.appendChild(u);var v=document.createElement('td');v.textContent=q;v.setAttribute('class','RESvisited');k.appendChild(v);var w=document.createElement('td');w.setAttribute('class','RESshortcut');w.setAttribute('subreddit',modules['subredditManager'].mySubreddits[i].display_name);var x=-1;for(var j=0,len=modules['subredditManager'].mySubredditShortcuts.length;j<len;j++){if(modules['subredditManager'].mySubredditShortcuts[j].subreddit==modules['subredditManager'].mySubreddits[i].display_name){x=j;break}}if(x!=-1){w.addEventListener('click',function(e){if(e.stopPropagation){e.stopPropagation()}var a=e.target.getAttribute('subreddit');modules['subredditManager'].removeSubredditShortcut(a)},false);w.textContent='-shortcut'}else{w.addEventListener('click',function(e){if(e.stopPropagation){e.stopPropagation()}var a=e.target.getAttribute('subreddit');modules['subredditManager'].addSubredditShortcut(a)},false);w.textContent='+shortcut'}k.appendChild(w);m.appendChild(k)}}else{var k=document.createElement('tr');var y=document.createElement('td');y.textContent='There was an error getting your subreddits. You may have third party cookies disabled by your browser. For this function to work, you\'ll need to add an exception for cookies from reddit.com';y.setAttribute('colspan','3');k.appendChild(y);m.appendChild(k)}modules['subredditManager'].srList.appendChild(m)},toggleSubredditShortcut:function(e){if(e.stopPropagation){e.stopPropagation()}var a=-1;for(var i=0,len=modules['subredditManager'].mySubredditShortcuts.length;i<len;i++){if(modules['subredditManager'].mySubredditShortcuts[i].subreddit.toLowerCase()==e.target.getAttribute('subreddit').toLowerCase()){a=i;break}}if(a!=-1){modules['subredditManager'].removeSubredditShortcut(e.target.getAttribute('subreddit'));e.target.setAttribute('title','Add this subreddit to your shortcut bar');e.target.textContent='+shortcut';removeClass(e.target,'remove')}else{modules['subredditManager'].addSubredditShortcut(e.target.getAttribute('subreddit'));e.target.setAttribute('title','Remove this subreddit from your shortcut bar');e.target.textContent='-shortcut';addClass(e.target,'remove')}modules['subredditManager'].redrawShortcuts()},getLatestShortcuts:function(){var a=RESStorage.getItem('RESmodules.subredditManager.subredditShortcuts.'+RESUtils.loggedInUser());if(!a){a='[]'}modules['subredditManager'].mySubredditShortcuts=safeJSON.parse(a,'RESmodules.subredditManager.subredditShortcuts.'+RESUtils.loggedInUser())},addSubredditShortcut:function(a,b){this.getLatestShortcuts();var c=-1;for(var i=0,len=modules['subredditManager'].mySubredditShortcuts.length;i<len;i++){if(modules['subredditManager'].mySubredditShortcuts[i].subreddit.toLowerCase()==a.toLowerCase()){c=i;break}}if(c!=-1){alert('Whoops, you already have a shortcut for that subreddit')}else{b=b||a;subredditObj={subreddit:a,displayName:b}modules['subredditManager'].mySubredditShortcuts.push(subredditObj);if(RESUtils.proEnabled()){if(typeof(modules['subredditManager'].RESPro)=='undefined'){if(RESStorage.getItem('RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser())!=null){var d=safeJSON.parse(RESStorage.getItem('RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser()),'RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser())}else{var d={add:{},del:{}}}modules['subredditManager'].RESPro=d}if(typeof(modules['subredditManager'].RESPro.add)=='undefined'){modules['subredditManager'].RESPro.add={}}if(typeof(modules['subredditManager'].RESPro.del)=='undefined'){modules['subredditManager'].RESPro.del={}}modules['subredditManager'].RESPro.add[a]=true;if(typeof(modules['subredditManager'].RESPro.del[a])!='undefined')delete modules['subredditManager'].RESPro.del[a];RESStorage.setItem('RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser(),JSON.stringify(modules['subredditManager'].RESPro))}RESStorage.setItem('RESmodules.subredditManager.subredditShortcuts.'+RESUtils.loggedInUser(),JSON.stringify(modules['subredditManager'].mySubredditShortcuts));modules['subredditManager'].redrawShortcuts();modules['subredditManager'].populateSubredditDropdown();if(RESUtils.proEnabled()){modules['RESPro'].saveModuleData('subredditManager')}RESUtils.notification({header:'Subreddit Manager Notification',message:'Subreddit shortcut added. You can edit by double clicking, or trash by dragging to the trash can.'})}},removeSubredditShortcut:function(a){this.getLatestShortcuts();var b=-1;for(var i=0,len=modules['subredditManager'].mySubredditShortcuts.length;i<len;i++){if(modules['subredditManager'].mySubredditShortcuts[i].subreddit.toLowerCase()==a.toLowerCase()){b=i;break}}if(b!=-1){modules['subredditManager'].mySubredditShortcuts.splice(b,1);if(RESUtils.proEnabled()){if(typeof(modules['subredditManager'].RESPro)=='undefined'){if(RESStorage.getItem('RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser())!=null){var c=safeJSON.parse(RESStorage.getItem('RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser()),'RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser())}else{var c={add:{},del:{}}}modules['subredditManager'].RESPro=c}if(typeof(modules['subredditManager'].RESPro.add)=='undefined'){modules['subredditManager'].RESPro.add={}}if(typeof(modules['subredditManager'].RESPro.del)=='undefined'){modules['subredditManager'].RESPro.del={}}modules['subredditManager'].RESPro.del[a]=true;if(typeof(modules['subredditManager'].RESPro.add[a])!='undefined')delete modules['subredditManager'].RESPro.add[a];RESStorage.setItem('RESmodules.subredditManager.subredditShortcuts.RESPro.'+RESUtils.loggedInUser(),JSON.stringify(modules['subredditManager'].RESPro))}RESStorage.setItem('RESmodules.subredditManager.subredditShortcuts.'+RESUtils.loggedInUser(),JSON.stringify(modules['subredditManager'].mySubredditShortcuts));modules['subredditManager'].redrawShortcuts();modules['subredditManager'].populateSubredditDropdown();if(RESUtils.proEnabled()){modules['RESPro'].saveModuleData('subredditManager')}}},setLastViewtime:function(){var a=RESStorage.getItem('RESmodules.subredditManager.subredditsLastViewed.'+RESUtils.loggedInUser());if(a==null){this.subredditsLastViewed={}}else{this.subredditsLastViewed=safeJSON.parse(a,'RESmodules.subredditManager.subredditsLastViewed.'+RESUtils.loggedInUser())}var b=new Date();var c=RESUtils.currentSubreddit().toLowerCase();this.subredditsLastViewed[c]={last_visited:b.getTime()}RESStorage.setItem('RESmodules.subredditManager.subredditsLastViewed.'+RESUtils.loggedInUser(),JSON.stringify(this.subredditsLastViewed))}};modules['RESTips']={moduleID:'RESTips',moduleName:'RES Tips and Tricks',category:'UI',options:{dailyTip:{type:'boolean',value:true,description:'Show a random tip once every 24 hours.'}},description:'Adds tips/tricks help to RES console',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[\?]*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},go:function(){if((this.isEnabled())&&(this.isMatchURL())){this.menuItem=createElementWithID('li','RESTipsMenuItem');this.menuItem.textContent='RES Tips and Tricks';this.menuItem.addEventListener('click',function(e){modules['RESTips'].randomTip()},false);$('#RESDropdownOptions').append(this.menuItem);if(this.options.dailyTip.value){this.dailyTip()}}},dailyTip:function(){var a=parseInt(RESStorage.getItem('RESLastToolTip'))||0;var b=new Date();if((b.getTime()-a)>86400000){RESStorage.setItem('RESLastToolTip',b.getTime());if(a==0){this.showTip(0)}else{setTimeout(function(){modules['RESTips'].randomTip()},500)}}},randomTip:function(){this.currTip=Math.floor(Math.random()*this.tips.length);this.showTip(this.currTip)},disableDailyTipsCheckbox:function(e){modules['RESTips'].options.dailyTip.value=e.target.checked;RESStorage.setItem('RESoptions.RESTips',JSON.stringify(modules['RESTips'].options))},nextTip:function(){if(typeof(this.currTip)=='undefined')this.currTip=0;modules['RESTips'].nextPrevTip(1)},prevTip:function(){if(typeof(this.currTip)=='undefined')this.currTip=0;modules['RESTips'].nextPrevTip(-1)},nextPrevTip:function(a){if(typeof(this.currTip)=='undefined')this.currTip=0;guiders.hideAll();this.currTip+=a;if(this.currTip<0){this.currTip=this.tips.length-1}else if(this.currTip>=this.tips.length){this.currTip=0}this.showTip(this.currTip)},tips:Array({message:'Welcome to RES. You can turn modules on and off, and configure settings for the modules using the gear icon link at the top right. For feature requests, or just help getting a question answered, be sure to subscribe to <a href="http://reddit.com/r/Enhancement">/r/Enhancement</a>.'},{message:"Most of RES is configurable. Roll over the gear icon and click the settings console link to check it out.",attachTo:"#openRESPrefs",position:5},{message:"Click the tag icon next to a user to tag that user with any name you like - you can also color code the tag.",attachTo:".RESUserTagImage:visible",position:3},{message:"Don't forget to subscribe to <a href=\"http://reddit.com/r/Enhancement\">/r/Enhancement</a> to keep up to date on the latest versions of RES or suggest features! For bug reports, submit to <a href=\"http://reddit.com/r/RESIssues\">/r/RESIssues</a>"},{message:"Don't want to see posts containing certain keywords? Want to filter out certain subreddits from /r/all? Try the filteReddit module!"},{message:"Keyboard Navigation is one of the most underutilized features in RES. You should try it!  Hit the ? key (shift-/) to see a list of commands."},{message:"Did you know you can configure the appearance of a number of things in RES? For example: Keyboard navigation lets you configure the look of the 'selected' box, and commentBoxes lets you configure the borders / shadows."},{message:"Do you subscribe to a ton of reddits? Give the subreddit tagger a try, it can make your homepage a bit more readable."},{message:"If you haven't tried it yet, Keyboard Navigation is great. Just hit ? while browsing for instructions."},{message:"Roll over a user's name to get information about them such as their karma, and how long they've been a reddit user."},{message:"Hover over the 'parent' link in comments pages to see the text of the parent being referred to."},{message:"You can configure the color and style of the User Highlighter module if you want to change how the highlights look."},{message:"Not a fan of how comments pages look? You can change the appearance in the Style Tweaks module"},{message:"Don't like the style in a certain subreddit? RES gives you a checkbox to disable styles individually - check the right sidebar!"},{message:"Looking for posts by submitter, post with photos, or posts in IAmA form? Try out the comment navigator."},{message:"Have you seen the RES Dashboard? It allows you to do all sorts of great stuff, like keep track of lower traffic subreddits, and manage your user tags and thread subscriptions!"},{message:"Sick of seeing these tips?  They only show up once every 24 hours, but you can disable that in the RES Tips and Tricks preferences."},{message:"Did you know that there is now a 'keep me logged in' option in the Account Switcher? Turn it on if you want to stay logged in to Reddit when using the switcher!"},{message:"See that little [vw] next to users you've voted on?  That's their vote weight - it moves up and down as you vote the same user up / down."}),tour:[],initTips:function(){$('#disableDailyTipsCheckbox').live('click',modules['RESTips'].disableDailyTipsCheckbox);for(var i=0,len=this.tips.length;i<len;i++){var a="tip"+i;var b=((parseInt(i+1))>=len)?0:(parseInt(i+1));var c="tip"+b;var d=(modules['RESTips'].options.dailyTip.value)?'checked="checked"':'';guiders.createGuider({attachTo:this.tips[i].attachTo,buttons:[{name:"Prev",onclick:modules['RESTips'].prevTip},{name:"Next",onclick:modules['RESTips'].nextTip}],buttonCustomHTML:"<input type=\"checkbox\" id=\"disableDailyTipsCheckbox\" "+d+" /><label for=\"disableDailyTipsCheckbox\" class=\"stopper\"> Show these tips once every 24 hours</label>",description:this.tips[i].message,id:a,next:c,position:this.tips[i].position,xButton:true,title:"RES Tips and Tricks"})}},showTip:function(a){if(typeof(this.tipsInitialized)=='undefined'){this.initTips();this.tipsInitialized=true}guiders.show('tip'+a)},showGuider:function(a){guiders.show(a)}};modules['dashboard']={moduleID:'dashboard',moduleName:'RES Dashboard',category:'UI',options:{defaultPosts:{type:'text',value:3,description:'Number of posts to show by default in each widget'},defaultSort:{type:'enum',values:[{name:'hot',value:'hot'},{name:'new',value:'new'},{name:'controversial',value:'controversial'},{name:'top',value:'top'}],value:'hot',description:'Default sort method for new widgets'},dashboardShortcut:{type:'boolean',value:true,description:'Show +dashboard shortcut in sidebar for easy addition of dashboard widgets.'},tagsPerPage:{type:'text',value:25,description:'How many user tags to show per page. (enter zero to show all on one page)'}},description:'The RES Dashboard is home to a number of features including widgets and other useful tools',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/^https?:\/\/([-\w\.]+\.)?reddit\.com\/[-\w\.\/]*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},go:function(){if(this.isEnabled()){this.getLatestWidgets();RESUtils.addCSS('.RESDashboardToggle { margin-right: 5px; color: white; background-image: url(/static/bg-button-add.png); cursor: pointer; text-align: center; width: 68px; font-weight: bold; font-size: 10px; border: 1px solid #444444; padding: 1px 6px; border-radius: 3px 3px 3px 3px;  }');RESUtils.addCSS('.RESDashboardToggle.remove { background-image: url(/static/bg-button-remove.png) }');if(this.isMatchURL()){$('#RESDropdownOptions').prepend('<li id="DashboardLink"><a href="/r/Dashboard">my dashboard</a></li>');if(RESUtils.currentSubreddit()){RESUtils.addCSS('.RESDashboardToggle {}');if(!(this.widgets instanceof Array)){this.widgets=[]}if(RESUtils.currentSubreddit('dashboard')){$('#noresults, #header-bottom-left .tabmenu:not(".viewimages")').hide();$('#header-bottom-left .redditname a:first').text('My Dashboard');this.drawDashboard()}if(this.options.dashboardShortcut.value==true)this.addDashboardShortcuts()}}}},getLatestWidgets:function(){try{this.widgets=JSON.parse(RESStorage.getItem('RESmodules.dashboard.'+RESUtils.loggedInUser()))||[]}catch(e){this.widgets=[]}},loader:'data:image/gif;base64,R0lGODlhEAAQAPQAAP///2+NyPb3+7zK5e3w95as1rPD4W+NyKC02oOdz8/Z7Nnh8HqVzMbS6XGOyI2l06m73gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAAFdyAgAgIJIeWoAkRCCMdBkKtIHIngyMKsErPBYbADpkSCwhDmQCBethRB6Vj4kFCkQPG4IlWDgrNRIwnO4UKBXDufzQvDMaoSDBgFb886MiQadgNABAokfCwzBA8LCg0Egl8jAggGAA1kBIA1BAYzlyILczULC2UhACH5BAkKAAAALAAAAAAQABAAAAV2ICACAmlAZTmOREEIyUEQjLKKxPHADhEvqxlgcGgkGI1DYSVAIAWMx+lwSKkICJ0QsHi9RgKBwnVTiRQQgwF4I4UFDQQEwi6/3YSGWRRmjhEETAJfIgMFCnAKM0KDV4EEEAQLiF18TAYNXDaSe3x6mjidN1s3IQAh+QQJCgAAACwAAAAAEAAQAAAFeCAgAgLZDGU5jgRECEUiCI+yioSDwDJyLKsXoHFQxBSHAoAAFBhqtMJg8DgQBgfrEsJAEAg4YhZIEiwgKtHiMBgtpg3wbUZXGO7kOb1MUKRFMysCChAoggJCIg0GC2aNe4gqQldfL4l/Ag1AXySJgn5LcoE3QXI3IQAh+QQJCgAAACwAAAAAEAAQAAAFdiAgAgLZNGU5joQhCEjxIssqEo8bC9BRjy9Ag7GILQ4QEoE0gBAEBcOpcBA0DoxSK/e8LRIHn+i1cK0IyKdg0VAoljYIg+GgnRrwVS/8IAkICyosBIQpBAMoKy9dImxPhS+GKkFrkX+TigtLlIyKXUF+NjagNiEAIfkECQoAAAAsAAAAABAAEAAABWwgIAICaRhlOY4EIgjH8R7LKhKHGwsMvb4AAy3WODBIBBKCsYA9TjuhDNDKEVSERezQEL0WrhXucRUQGuik7bFlngzqVW9LMl9XWvLdjFaJtDFqZ1cEZUB0dUgvL3dgP4WJZn4jkomWNpSTIyEAIfkECQoAAAAsAAAAABAAEAAABX4gIAICuSxlOY6CIgiD8RrEKgqGOwxwUrMlAoSwIzAGpJpgoSDAGifDY5kopBYDlEpAQBwevxfBtRIUGi8xwWkDNBCIwmC9Vq0aiQQDQuK+VgQPDXV9hCJjBwcFYU5pLwwHXQcMKSmNLQcIAExlbH8JBwttaX0ABAcNbWVbKyEAIfkECQoAAAAsAAAAABAAEAAABXkgIAICSRBlOY7CIghN8zbEKsKoIjdFzZaEgUBHKChMJtRwcWpAWoWnifm6ESAMhO8lQK0EEAV3rFopIBCEcGwDKAqPh4HUrY4ICHH1dSoTFgcHUiZjBhAJB2AHDykpKAwHAwdzf19KkASIPl9cDgcnDkdtNwiMJCshACH5BAkKAAAALAAAAAAQABAAAAV3ICACAkkQZTmOAiosiyAoxCq+KPxCNVsSMRgBsiClWrLTSWFoIQZHl6pleBh6suxKMIhlvzbAwkBWfFWrBQTxNLq2RG2yhSUkDs2b63AYDAoJXAcFRwADeAkJDX0AQCsEfAQMDAIPBz0rCgcxky0JRWE1AmwpKyEAIfkECQoAAAAsAAAAABAAEAAABXkgIAICKZzkqJ4nQZxLqZKv4NqNLKK2/Q4Ek4lFXChsg5ypJjs1II3gEDUSRInEGYAw6B6zM4JhrDAtEosVkLUtHA7RHaHAGJQEjsODcEg0FBAFVgkQJQ1pAwcDDw8KcFtSInwJAowCCA6RIwqZAgkPNgVpWndjdyohACH5BAkKAAAALAAAAAAQABAAAAV5ICACAimc5KieLEuUKvm2xAKLqDCfC2GaO9eL0LABWTiBYmA06W6kHgvCqEJiAIJiu3gcvgUsscHUERm+kaCxyxa+zRPk0SgJEgfIvbAdIAQLCAYlCj4DBw0IBQsMCjIqBAcPAooCBg9pKgsJLwUFOhCZKyQDA3YqIQAh+QQJCgAAACwAAAAAEAAQAAAFdSAgAgIpnOSonmxbqiThCrJKEHFbo8JxDDOZYFFb+A41E4H4OhkOipXwBElYITDAckFEOBgMQ3arkMkUBdxIUGZpEb7kaQBRlASPg0FQQHAbEEMGDSVEAA1QBhAED1E0NgwFAooCDWljaQIQCE5qMHcNhCkjIQAh+QQJCgAAACwAAAAAEAAQAAAFeSAgAgIpnOSoLgxxvqgKLEcCC65KEAByKK8cSpA4DAiHQ/DkKhGKh4ZCtCyZGo6F6iYYPAqFgYy02xkSaLEMV34tELyRYNEsCQyHlvWkGCzsPgMCEAY7Cg04Uk48LAsDhRA8MVQPEF0GAgqYYwSRlycNcWskCkApIyEAOwAAAAAAAAAAAA==',drawDashboard:function(){RESUtils.addCSS('.id-t3_qi5iy {display: none;}');RESUtils.addCSS('.RESDashboardComponent { position: relative; border: 1px solid #cccccc; border-radius: 3px 3px 3px 3px; overflow: hidden; margin-bottom: 10px; }');RESUtils.addCSS('.RESDashboardComponentHeader { box-sizing: border-box; padding: 5px 0px 8px 0px; background-color: #f0f3fc; overflow: hidden; }');RESUtils.addCSS('.RESDashboardComponentScrim { position: absolute; top: 0px; bottom: 0px; left: 0px; right: 0px; z-index: 5; display: none; }');RESUtils.addCSS('.RESDashboardComponentLoader { box-sizing: border-box; position: absolute; background-color: #f2f9ff; border: 1px solid #b9d7f4; border-radius: 3px 3px 3px 3px; width: 314px; height: 40px; left: 50%; top: 50%; margin-left: -167px; margin-top: -20px; text-align: center; padding-top: 11px; }');RESUtils.addCSS('.RESDashboardComponentLoader span { position: relative; top: -6px; left: 5px; } ');RESUtils.addCSS('.RESDashboardComponentContainer { padding: 10px 15px 0px 15px; min-height: 100px; }');RESUtils.addCSS('.RESDashboardComponentContainer.minimized { display: none; }');RESUtils.addCSS('.RESDashboardComponent a.widgetPath, .addNewWidget, .editWidget { display: inline-block; margin-left: 0px; margin-top: 7px; color: #000000; font-weight: bold; }');RESUtils.addCSS('.editWidget { float: left; margin-right: 10px; } ');RESUtils.addCSS('.RESDashboardComponent a.widgetPath { margin-left: 15px; vertical-align: top; width: 120px; overflow: hidden; text-overflow: ellipsis; }');RESUtils.addCSS('#RESDashboardAddComponent, #RESDashboardEditComponent { box-sizing: border-box; padding: 5px 8px 5px 8px; vertical-align: middle; background-color: #cee3f8; border: 1px solid #336699;}');RESUtils.addCSS('#RESDashboardEditComponent { display: none; position: absolute; }');RESUtils.addCSS('#addRedditFormContainer, #addMailWidgetContainer, #addUserFormContainer { display: none; }');RESUtils.addCSS('#addWidgetButtons, #addRedditFormContainer, #addMailWidgetContainer, #addUserFormContainer, #editRedditFormContainer { width: auto; min-width: 550px; height: 28px; float: right; text-align: right; }');RESUtils.addCSS('#editRedditFormContainer { width: auto; }');RESUtils.addCSS('#addUserForm, #addRedditForm { display: inline-block }');RESUtils.addCSS('#addUser { width: 200px; height: 24px; }');RESUtils.addCSS('#addRedditFormContainer ul.token-input-list-facebook, #editRedditFormContainer ul.token-input-list-facebook { float: left; }');RESUtils.addCSS('#addReddit { width: 115px; background-color: #ffffff; border: 1px solid #96bfe8; margin-left: 6px; margin-right: 6px; padding: 1px 2px 1px 2px; }');RESUtils.addCSS('#addRedditDisplayName, #editRedditDisplayName { width: 140px; height: 24px; background-color: #ffffff; border: 1px solid #96bfe8; margin-left: 6px; margin-right: 6px; padding: 1px 2px 1px 2px; }');RESUtils.addCSS('#editReddit { width: 5px; } ');RESUtils.addCSS('.addButton, .updateButton { cursor: pointer; display: inline-block; width: auto; padding-top: 3px; padding-bottom: 3px; padding-left: 5px; padding-right: 5px; font-size: 11px; color: #ffffff; border: 1px solid #636363; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; background-color: #5cc410; margin-top: 3px; margin-left: 5px; }');RESUtils.addCSS('.cancelButton { width: 50px; text-align: center; cursor: pointer; display: inline-block; padding-top: 3px; padding-bottom: 3px; padding-left: 5px; padding-right: 5px; font-size: 11px; color: #ffffff; border: 1px solid #636363; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; background-color: #D02020; margin-top: 3px; margin-left: 5px; }');RESUtils.addCSS('.backToWidgetTypes { display: inline-block; vertical-align: top; margin-top: 8px; font-weight: bold; color: #000000; cursor: pointer; }');RESUtils.addCSS('.RESDashboardComponentHeader ul { font-family: Verdana; font-size: 13px; box-sizing: border-box; line-height: 22px; display: inline-block; margin-top: 2px; }');RESUtils.addCSS('.RESDashboardComponentHeader ul li { box-sizing: border-box; vertical-align: middle; height: 24px; display: inline-block; cursor: pointer; padding: 0px 6px 0px 6px; border: 1px solid #c7c7c7; background-color: #ffffff; color: #6c6c6c; border-radius: 3px 3px 3px 3px; }');RESUtils.addCSS('.RESDashboardComponentHeader .editButton { display: inline-block; padding: 0; width: 24px; -moz-box-sizing: border-box; vertical-align: middle; margin-left: 10px; } ');RESUtils.addCSS('.RESDashboardComponent.minimized ul li { display: none; }');RESUtils.addCSS('.RESDashboardComponent.minimized li.RESClose, .RESDashboardComponent.minimized li.minimize { display: inline-block; }');RESUtils.addCSS('ul.widgetSortButtons li { margin-right: 10px; }');RESUtils.addCSS('.RESDashboardComponentHeader ul li.active, .RESDashboardComponentHeader ul li:hover { background-color: #a6ccf1; color: #ffffff; border-color: #699dcf; }');RESUtils.addCSS('ul.widgetStateButtons li { margin-right: 5px; }');RESUtils.addCSS('ul.widgetStateButtons li:last-child { margin-right: 0; }');RESUtils.addCSS('ul.widgetStateButtons li.disabled { background-color: #dddddd; }');RESUtils.addCSS('ul.widgetStateButtons li.disabled:hover { cursor: auto; background-color: #dddddd; color: #6c6c6c; border: 1px solid #c7c7c7; }');RESUtils.addCSS('ul.widgetSortButtons { margin-left: 10px; }');RESUtils.addCSS('ul.widgetStateButtons { float: right; margin-right: 8px; }');RESUtils.addCSS('ul.widgetStateButtons li.updateTime { cursor: auto; background: none; border: none; color: #afafaf; font-size: 9px; padding-right: 0px; }');RESUtils.addCSS('ul.widgetStateButtons li.minimize, ul.widgetStateButtons li.close { font-size: 24px; }');RESUtils.addCSS('.minimized ul.widgetStateButtons li.minimize { font-size: 14px; }');RESUtils.addCSS('ul.widgetStateButtons li.refresh { margin-left: 3px; width: 24px; position:relative; padding: 0px 0px; }');RESUtils.addCSS('ul.widgetStateButtons li.refresh div { height: 16px; width: 16px; position: absolute; left: 4px; top: 4px; background-image: url(\'http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png\'); background-repeat: no-repeat; background-position: -16px -209px; }');RESUtils.addCSS('#userTaggerContents .show { display: inline-block; }');RESUtils.addCSS('#tagPageControls { display: inline-block; position: relative; top: 9px;}');var a=$('span.redditname a');if($(a).length>1){$(a[0]).addClass('active')}this.attachContainer();this.attachAddComponent();this.attachEditComponent();this.initUpdateQueue()},initUpdateQueue:function(){modules['dashboard'].updateQueue=[];for(var i in this.widgets)if(this.widgets[i])this.addWidget(this.widgets[i]);setTimeout(function(){$('#RESDashboard').dragsort({dragSelector:"div.RESDashboardComponentHeader",dragSelectorExclude:'a, li, li.refreshAll, li.refresh > div, .editButton',dragEnd:modules['dashboard'].saveOrder,placeHolderTemplate:"<div class='placeHolder'><div></div></div>"})},300)},addToUpdateQueue:function(a){modules['dashboard'].updateQueue.push(a);if(!modules['dashboard'].updateQueueTimer){modules['dashboard'].updateQueueTimer=setInterval(modules['dashboard'].processUpdateQueue,2000);setTimeout(modules['dashboard'].processUpdateQueue,100)}},processUpdateQueue:function(){var a=modules['dashboard'].updateQueue.pop();a();if(modules['dashboard'].updateQueue.length<1){clearInterval(modules['dashboard'].updateQueueTimer);delete modules['dashboard'].updateQueueTimer}},saveOrder:function(){var a=$("#siteTable li.RESDashboardComponent").map(function(){return $(this).attr("id")}).get();a.reverse();var b=[];for(var i=0,len=modules['dashboard'].widgets.length;i<len;i++){var c=a.indexOf(modules['dashboard'].widgets[i].basePath.replace(/(\/|\+)/g,'_'));b[c]=modules['dashboard'].widgets[i]}modules['dashboard'].widgets=b;delete b;RESStorage.setItem('RESmodules.dashboard.'+RESUtils.loggedInUser(),JSON.stringify(modules['dashboard'].widgets))},attachContainer:function(){this.siteTable=$('#siteTable.linklisting');$(this.siteTable).append('<div id="dashboardContents" class="dashboardPane" />');if((location.hash!='')&&(location.hash!='#dashboardContents')){$('span.redditname a').removeClass('active');var a=location.hash.replace('#','#tab-');$(a).addClass('active');$('.dashboardPane').hide();$(location.hash).show()}else{$('#userTaggerContents').hide()}$('span.redditname a:first').click(function(e){e.preventDefault();location.hash='dashboardContents';$('span.redditname a').removeClass('active');$(this).addClass('active');$('.dashboardPane').hide();$('#dashboardContents').show()})},attachEditComponent:function(){this.dashboardContents=$('#dashboardContents');this.dashboardEditComponent=$('<div id="RESDashboardEditComponent" class="RESDashboardComponent" />');$(this.dashboardEditComponent).html(' 			<div class="editWidget">Edit widget</div> 			<div id="editRedditFormContainer" class="editRedditForm"> 				<form id="editRedditForm"><input type="text" id="editReddit"><input type="text" id="editRedditDisplayName" placeholder="display name (e.g. stuff)"><input type="submit" class="updateButton" value="save changes"> <input type="cancel" class="cancelButton" value="cancel"></form> 			</div> 		');var b=$(this.dashboardEditComponent).find('#editReddit');$(this.dashboardEditComponent).find('#editRedditForm').submit(function(e){e.preventDefault();var a=$('#editReddit').val();if(a!=''){if(a.indexOf(',')!=-1){a=a.replace(/\,/g,'+')}modules['dashboard'].widgetBeingEdited.formerBasePath=modules['dashboard'].widgetBeingEdited.basePath;modules['dashboard'].widgetBeingEdited.basePath='/r/'+a;modules['dashboard'].widgetBeingEdited.displayName=$('#editRedditDisplayName').val();modules['dashboard'].widgetBeingEdited.update();$('#editReddit').tokenInput('clear');$('#RESDashboardEditComponent').fadeOut(function(){$('#editReddit').blur()});modules['dashboard'].widgetBeingEdited.widgetEle.find('.widgetPath').text(modules['dashboard'].widgetBeingEdited.displayName).attr('title','/r/'+a);modules['dashboard'].updateWidget()}});$(this.dashboardEditComponent).find('.cancelButton').click(function(e){$('#editReddit').tokenInput('clear');$('#RESDashboardEditComponent').fadeOut(function(){$('#editReddit').blur()})});$(document.body).append(this.dashboardEditComponent)},showEditForm:function(){var e=modules['dashboard'].widgetBeingEdited.basePath;var f=modules['dashboard'].widgetBeingEdited.widgetEle;$('#editRedditDisplayName').val(modules['dashboard'].widgetBeingEdited.displayName);var g=$(f).position().top;var h=$(f).width();$('#RESDashboardEditComponent').css('top',g+'px').css('left','5px').css('width',(h+2)+'px').fadeIn('fast');e=e.replace(/^\/r\//,'');var j=[];var k=e.split('+');for(var i=0,len=k.length;i<len;i++){j.push({id:k[i],name:k[i]})}if(typeof(modules['dashboard'].firstEdit)=='undefined'){$('#editReddit').tokenInput('/api/search_reddit_names.json?app=res',{method:"POST",queryParam:"query",theme:"facebook",allowCustomEntry:true,onResult:function(a){var b=a.names;var c=[];for(var i=0,len=b.length;i<len;i++){c.push({id:b[i],name:b[i]})}if(b.length==0){var d=$('#token-input-editReddit').val();c.push({id:d,name:d,failedResult:true})}return c},prePopulate:j,searchingText:'Searching for matching reddits - may take a few seconds...',hintText:'Type one or more subreddits for which to create a widget.',resultsFormatter:function(a){var b=a.name;if(a['failedResult'])b+=' - [this subreddit may not exist, ensure proper spelling]';return"<li>"+b+"</li>"}});modules['dashboard'].firstEdit=true}else{$('#editReddit').tokenInput('clear');for(var i=0,len=j.length;i<len;i++){$('#editReddit').tokenInput('add',j[i])}}},attachAddComponent:function(){this.dashboardContents=$('#dashboardContents');this.dashboardAddComponent=$('<div id="RESDashboardAddComponent" class="RESDashboardComponent" />');$(this.dashboardAddComponent).html(' 			<div class="addNewWidget">Add a new widget</div> 			<div id="addWidgetButtons"> 				<div class="addButton" id="addMailWidget">+mail widget</div> 				<div class="addButton" id="addUserWidget">+user widget</div> 				<div class="addButton" id="addRedditWidget">+subreddit widget</div> 			</div> 			<div id="addMailWidgetContainer"> 				<div class="backToWidgetTypes">&laquo; back</div> 				<div class="addButton widgetShortcut" widgetPath="/message/inbox/">+inbox</div> 				<div class="addButton widgetShortcut" widgetPath="/message/unread/">+unread</div> 				<div class="addButton widgetShortcut" widgetPath="/message/messages/">+messages</div> 				<div class="addButton widgetShortcut" widgetPath="/message/comments/">+comment replies</div> 				<div class="addButton widgetShortcut" widgetPath="/message/selfreply/">+post replies</div> 			</div> 			<div id="addUserFormContainer" class="addUserForm"> 				<div class="backToWidgetTypes">&laquo; back</div> 				<form id="addUserForm"><input type="text" id="addUser"><input type="submit" class="addButton" value="+add"></form> 			</div> 			<div id="addRedditFormContainer" class="addRedditForm"> 				<div class="backToWidgetTypes">&laquo; back</div> 				<form id="addRedditForm"><input type="text" id="addReddit"><input type="text" id="addRedditDisplayName" placeholder="display name (e.g. stuff)"><input type="submit" class="addButton" value="+add"></form> 			</div> 		');$(this.dashboardAddComponent).find('.backToWidgetTypes').click(function(e){$(this).parent().fadeOut(function(){$('#addWidgetButtons').fadeIn()})});$(this.dashboardAddComponent).find('.widgetShortcut').click(function(e){var a=$(this).attr('widgetPath');modules['dashboard'].addWidget({basePath:a},true);$('#addMailWidgetContainer').fadeOut(function(){$('#addWidgetButtons').fadeIn()})});$(this.dashboardAddComponent).find('#addRedditWidget').click(function(e){$('#addWidgetButtons').fadeOut(function(){$('#addRedditFormContainer').fadeIn(function(){$('#token-input-addReddit').focus()})})});$(this.dashboardAddComponent).find('#addMailWidget').click(function(e){$('#addWidgetButtons').fadeOut(function(){$('#addMailWidgetContainer').fadeIn()})});$(this.dashboardAddComponent).find('#addUserWidget').click(function(e){$('#addWidgetButtons').fadeOut(function(){$('#addUserFormContainer').fadeIn()})});var f=$(this.dashboardAddComponent).find('#addReddit');$(f).tokenInput('/api/search_reddit_names.json?app=res',{method:"POST",queryParam:"query",theme:"facebook",allowCustomEntry:true,onResult:function(a){var b=a.names;var c=[];for(var i=0,len=b.length;i<len;i++){c.push({id:b[i],name:b[i]})}if(b.length==0){var d=$('#token-input-addReddit').val();c.push({id:d,name:d,failedResult:true})}return c},searchingText:'Searching for matching reddits - may take a few seconds...',hintText:'Type one or more subreddits for which to create a widget.',resultsFormatter:function(a){var b=a.name;if(a['failedResult'])b+=' - [this subreddit may not exist, ensure proper spelling]';return"<li>"+b+"</li>"}});$(this.dashboardAddComponent).find('#addRedditForm').submit(function(e){e.preventDefault();var a=$('#addReddit').val();if(a!=''){if(a.indexOf(',')!=-1){a=a.replace(/\,/g,'+')}var b=($('#addRedditDisplayName').val())?$('#addRedditDisplayName').val():a;modules['dashboard'].addWidget({basePath:a,displayName:b},true);$('#addReddit').tokenInput('clear');$('#addRedditFormContainer').fadeOut(function(){$('#addReddit').blur();$('#addWidgetButtons').fadeIn()})}});$(this.dashboardAddComponent).find('#addUserForm').submit(function(e){e.preventDefault();var a='/user/'+$('#addUser').val();modules['dashboard'].addWidget({basePath:a},true);$('#addUser').val('').blur();$('#addUserFormContainer').fadeOut(function(){$('#addWidgetButtons').fadeIn()})});$(this.dashboardContents).append(this.dashboardAddComponent);this.dashboardUL=$('<ul id="RESDashboard"></ul>');$(this.dashboardContents).append(this.dashboardUL)},addWidget:function(a,b){if(a.basePath.slice(0,1)!='/')a.basePath='/r/'+a.basePath;var c=false;for(var i=0,len=this.widgets.length;i<len;i++){if(this.widgets[i].basePath==a.basePath){c=true;break}}setTimeout(function(){$('.widgetShortcut[widgetPath="'+a.basePath+'"]').hide()},1000);if(c&&b){alert('A widget for '+a.basePath+' already exists!')}else{var d=new this.widgetObject(a);d.init();modules['dashboard'].saveWidget(d.optionsObject())}},removeWidget:function(b){this.getLatestWidgets();var c=false;for(var i=0,len=modules['dashboard'].widgets.length;i<len;i++){if(modules['dashboard'].widgets[i].basePath==b.basePath){c=true;$('#'+modules['dashboard'].widgets[i].basePath.replace(/\/|\+/g,'_')).fadeOut('slow',function(a){$(this).detach()});modules['dashboard'].widgets.splice(i,1);setTimeout(function(){$('.widgetShortcut[widgetPath="'+b.basePath+'"]').show()},1000);break}}if(!c)RESUtils.notification('Error, the widget you just tried to remove does not seem to exist.');RESStorage.setItem('RESmodules.dashboard.'+RESUtils.loggedInUser(),JSON.stringify(modules['dashboard'].widgets))},saveWidget:function(a,b){this.getLatestWidgets();var c=false;for(var i=0,len=modules['dashboard'].widgets.length;i<len;i++){if(modules['dashboard'].widgets[i].basePath==a.basePath){c=true;modules['dashboard'].widgets[i]=a}}if(!c)modules['dashboard'].widgets.push(a);RESStorage.setItem('RESmodules.dashboard.'+RESUtils.loggedInUser(),JSON.stringify(modules['dashboard'].widgets))},updateWidget:function(){this.getLatestWidgets();var a=false;for(var i=0,len=modules['dashboard'].widgets.length;i<len;i++){if(modules['dashboard'].widgets[i].basePath==modules['dashboard'].widgetBeingEdited.formerBasePath){a=true;delete modules['dashboard'].widgetBeingEdited.formerBasePath;modules['dashboard'].widgets[i]=modules['dashboard'].widgetBeingEdited.optionsObject()}}RESStorage.setItem('RESmodules.dashboard.'+RESUtils.loggedInUser(),JSON.stringify(modules['dashboard'].widgets))},widgetObject:function(d){var f=this;f.basePath=d.basePath;if((typeof(d.displayName)=='undefined')||(d.displayName==null)){d.displayName=f.basePath}f.displayName=d.displayName;f.numPosts=d.numPosts||modules['dashboard'].options.defaultPosts.value;f.sortBy=d.sortBy||modules['dashboard'].options.defaultSort.value;f.minimized=d.minimized||false;f.widgetEle=$('<li class="RESDashboardComponent" id="'+f.basePath.replace(/\/|\+/g,'_')+'"><div class="RESDashboardComponentScrim"><div class="RESDashboardComponentLoader"><img id="dashboardLoader" src="'+modules['dashboard'].loader+'"><span>querying the server. one moment please.</span></div></div></li>');var g=(f.basePath.indexOf('/r/')==-1)?'':'<div class="editButton" title="edit"></div>';f.header=$('<div class="RESDashboardComponentHeader"><a class="widgetPath" title="'+f.basePath+'" href="'+f.basePath+'">'+f.displayName+'</a></div>');f.sortControls=$('<ul class="widgetSortButtons"><li sort="hot">hot</li><li sort="new">new</li><li sort="controversial">controversial</li><li sort="top">top</li></ul>');f.optionsObject=function(){return{basePath:f.basePath,displayName:f.displayName,numPosts:f.numPosts,sortBy:f.sortBy,minimized:f.minimized}}$(f.sortControls).find('li[sort='+f.sortBy+']').addClass('active');$(f.sortControls).find('li').click(function(e){f.sortChange($(e.target).attr('sort'))});$(f.header).append(f.sortControls);if((f.basePath.indexOf('/r/')!=0)&&(f.basePath.indexOf('/user/')!=0)){setTimeout(function(){$(f.sortControls).hide()},100)}f.stateControls=$('<ul class="widgetStateButtons"><li class="updateTime"></li><li action="refresh" class="refresh"><div action="refresh"></div></li><li action="refreshAll" class="refreshAll">Refresh All</li><li action="addRow">+row</li><li action="subRow">-row</li><li action="edit" class="editButton"></li><li action="minimize" class="minimize">-</li><li action="delete" class="RESClose">&times;</li></ul>');$(f.stateControls).find('li').click(function(e){switch($(e.target).attr('action')){case'refresh':f.update();break;case'refreshAll':$('li[action="refresh"]').click();break;case'addRow':if(f.numPosts==10)break;f.numPosts++;if(f.numPosts==10)$(f.stateControls).find('li[action=addRow]').addClass('disabled');$(f.stateControls).find('li[action=subRow]').removeClass('disabled');modules['dashboard'].saveWidget(f.optionsObject());f.update();break;case'subRow':if(f.numPosts==0)break;f.numPosts--;if(f.numPosts==1)$(f.stateControls).find('li[action=subRow]').addClass('disabled');$(f.stateControls).find('li[action=addRow]').removeClass('disabled');modules['dashboard'].saveWidget(f.optionsObject());f.update();break;case'minimize':$(f.widgetEle).toggleClass('minimized');if($(f.widgetEle).hasClass('minimized')){$(e.target).text('+');f.minimized=true}else{$(e.target).text('-');f.minimized=false;f.update()}$(f.contents).parent().slideToggle();modules['dashboard'].saveWidget(f.optionsObject());break;case'delete':modules['dashboard'].removeWidget(f.optionsObject());break}});$(f.header).append(f.stateControls);f.sortChange=function(a){f.sortBy=a;$(f.header).find('ul.widgetSortButtons li').removeClass('active');$(f.header).find('ul.widgetSortButtons li[sort='+a+']').addClass('active');f.update();modules['dashboard'].saveWidget(f.optionsObject())}f.edit=function(e){modules['dashboard'].widgetBeingEdited=f;modules['dashboard'].showEditForm()}$(f.header).find('.editButton').click(f.edit);f.update=function(){if(f.basePath.match(/\/user\//)){f.sortPath=(f.sortBy=='hot')?'/':'?sort='+f.sortBy}else if(f.basePath.match(/\/r\//)){f.sortPath=(f.sortBy=='hot')?'/':'/'+f.sortBy+'/'}else{f.sortPath=''}f.url=location.protocol+'//'+location.hostname+'/'+f.basePath+f.sortPath;$(f.contents).fadeTo('fast',0.25);$(f.scrim).fadeIn();$.ajax({url:f.url,data:{limit:f.numPosts},success:f.populate,error:f.error})}f.container=$('<div class="RESDashboardComponentContainer"><div class="RESDashboardComponentContents"></div></div>');if(f.minimized){$(f.container).addClass('minimized');$(f.stateControls).find('li.minimize').addClass('minimized').text('+')}f.scrim=$(f.widgetEle).find('.RESDashboardComponentScrim');f.contents=$(f.container).find('.RESDashboardComponentContents');f.init=function(){if(RESUtils.currentSubreddit('dashboard')){f.draw();if(!f.minimized)modules['dashboard'].addToUpdateQueue(f.update)}}f.draw=function(){$(f.widgetEle).append(f.header);$(f.widgetEle).append(f.container);if(f.minimized)$(f.widgetEle).addClass('minimized');modules['dashboard'].dashboardUL.prepend(f.widgetEle)}f.populate=function(b){var c=$(b).find('#siteTable');$(c).attr('id','siteTable_'+f.basePath.replace(/\/|\+/g,'_'));if(c.length==2)c=c[1];$(c).attr('url',f.url+'?limit='+f.numPosts);if((c)&&($(c).html()!='')){$(f.contents).html(c);$(f.contents).fadeTo('fast',1);$(f.scrim).fadeOut(function(e){$(this).hide()})$(f.stateControls).find('.updateTime').text('updated: '+RESUtils.niceDateTime())}else{if(f.url.indexOf('/message/')!=-1){$(f.contents).html('<div class="widgetNoMail">No messages were found.</div>')}else{$(f.contents).html('<div class="error">There were no results returned for this widget. If you made a typo, simply close the widget to delete it. If reddit is just under heavy load, try clicking refresh in a few moments.</div>')}$(f.contents).fadeTo('fast',1);$(f.scrim).fadeOut();$(f.stateControls).find('.updateTime').text('updated: '+RESUtils.niceDateTime())}RESUtils.watchers.siteTable.forEach(function(a){if(a)a(c[0])})}f.error=function(a,b){if(a.status==404){$(f.contents).html('<div class="error">This widget received a 404 not found error. You may have made a typo when adding it.</div>')}else{$(f.contents).html('<div class="error">There was an error loading data for this widget. Reddit may be under heavy load, or you may have provided an invalid path.</div>')}$(f.scrim).fadeOut();$(f.contents).fadeTo('fast',1)}},addDashboardShortcuts:function(){var a=document.querySelectorAll('.fancy-toggle-button');for(var h=0,len=a.length;h<len;h++){var b=a[h];if((RESUtils.currentSubreddit().indexOf('+')==-1)&&(RESUtils.currentSubreddit()!='mod')){var c=RESUtils.currentSubreddit();var d=false}else if($(b).parent().hasClass('subButtons')){var d=true;var c=$(b).parent().parent().find('a.title').text()}else{var d=true;var c=$(b).next().text()}if(!($('#subButtons-'+c).length>0)){var e=$('<div id="subButtons-'+c+'" class="subButtons" style="margin: 0 !important;"></div>');$(b).wrap(e);if(d){var f=$(b).parent();$(f).appendTo($(f).parent())}}var g=document.createElement('span');g.setAttribute('class','RESDashboardToggle');g.setAttribute('subreddit',c);var j=false;for(var i=0,sublen=this.widgets.length;i<sublen;i++){if((this.widgets[i])&&(this.widgets[i].basePath.toLowerCase()=='/r/'+c.toLowerCase())){j=true;break}}if(j){g.textContent='-dashboard';g.setAttribute('title','Remove this subreddit from your dashboard');addClass(g,'remove')}else{g.textContent='+dashboard';g.setAttribute('title','Add this subreddit to your dashboard')}g.setAttribute('subreddit',c)g.addEventListener('click',modules['dashboard'].toggleDashboard,false);$('#subButtons-'+c).append(g);var k=$('#subButtons-'+c).next();if($(k).hasClass('title')&&(!$('#subButtons-'+c).hasClass('swapped'))){$('#subButtons-'+c).before($(k));$('#subButtons-'+c).addClass('swapped')}}},toggleDashboard:function(e){var a='/r/'+e.target.getAttribute('subreddit');if(hasClass(e.target,'remove')){modules['dashboard'].removeWidget({basePath:a},true);e.target.textContent='+dashboard';removeClass(e.target,'remove')}else{modules['dashboard'].addWidget({basePath:a},true);e.target.textContent='-dashboard';RESUtils.notification({header:'Dashboard Notification',message:'Dashboard widget added for '+a+' <p><a class="RESNotificationButtonBlue" href="/r/Dashboard">view the dashboard</a></p><div class="clear"></div>'});addClass(e.target,'remove')}},addTab:function(a,b){$('#siteTable.linklisting').append('<div id="'+a+'" class="dashboardPane" />');$('span.redditname').append('<a id="tab-'+a+'" class="dashboardTab" title="'+b+'">'+b+'</a>');$('#tab-'+a).click(function(e){location.hash=a;$('span.redditname a').removeClass('active');$(this).addClass('active');$('.dashboardPane').hide();$('#'+a).show()})}};modules['subredditInfo']={moduleID:'subredditInfo',moduleName:'Subreddit Info',category:'UI',options:{hoverDelay:{type:'text',value:800,description:'Delay, in milliseconds, before hover tooltip loads. Default is 800.'},fadeDelay:{type:'text',value:200,description:'Delay, in milliseconds, before hover tooltip fades away. Default is 200.'},fadeSpeed:{type:'text',value:0.3,description:'Fade animation\'s speed. Default is 0.3, the range is 0-1. Setting the speed to 1 will disable the animation.'},USDateFormat:{type:'boolean',value:false,description:'Show date (subreddit created...) in US format (i.e. 08-31-2010)'}},description:'Adds a hover tooltip to subreddits',isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:Array(/https?:\/\/([a-z]+).reddit.com\/[\?]*/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},beforeLoad:function(){if((this.isEnabled())&&(this.isMatchURL())){var a='';a+='#subredditInfoToolTip { display: none; position: absolute; width: 412px; z-index: 10001; }';a+='#subredditInfoToolTip .subredditLabel { float: left; width: 140px; margin-bottom: 12px; }';a+='#subredditInfoToolTip .subredditDetail { float: left; width: 240px; margin-bottom: 12px; }';a+='#subredditInfoToolTip .blueButton { float: right; margin-left: 8px; cursor: pointer; margin-top: 12px; padding-top: 3px; padding-bottom: 3px; padding-left: 5px; padding-right: 5px; font-size: 12px; color: #ffffff !important; border: 1px solid #636363; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; background-color: #107ac4; }';a+='#subredditInfoToolTip .redButton { float: right; margin-left: 8px; cursor: pointer; margin-top: 12px; padding-top: 3px; padding-bottom: 3px; padding-left: 5px; padding-right: 5px; font-size: 12px; color: #ffffff !important; border: 1px solid #bc3d1b; border-radius: 3px 3px 3px 3px; -moz-border-radius: 3px 3px 3px 3px; -webkit-border-radius: 3px 3px 3px 3px; background-color: #ff5757; }';RESUtils.addCSS(a)}},go:function(){if((this.isEnabled())&&(this.isMatchURL())){this.subredditInfoCache=[];this.subredditInfoToolTip=createElementWithID('div','subredditInfoToolTip','RESDialogSmall');this.subredditInfoToolTipHeader=document.createElement('h3');this.subredditInfoToolTip.appendChild(this.subredditInfoToolTipHeader);this.subredditInfoToolTipCloseButton=createElementWithID('div','subredditInfoToolTipClose','RESCloseButton');this.subredditInfoToolTipCloseButton.textContent='X';this.subredditInfoToolTip.appendChild(this.subredditInfoToolTipCloseButton);this.subredditInfoToolTipCloseButton.addEventListener('click',function(e){if(typeof(modules['subredditInfo'].hideTimer)!='undefined'){clearTimeout(modules['subredditInfo'].hideTimer)}modules['subredditInfo'].hideSubredditInfo()},false);this.subredditInfoToolTipContents=createElementWithID('div','subredditInfoToolTipContents','RESDialogContents');this.subredditInfoToolTip.appendChild(this.subredditInfoToolTipContents);this.subredditInfoToolTip.addEventListener('mouseover',function(e){if(typeof(modules['subredditInfo'].hideTimer)!='undefined'){clearTimeout(modules['subredditInfo'].hideTimer)}},false);this.subredditInfoToolTip.addEventListener('mouseout',function(e){if(e.target.getAttribute('class')!='hoverSubreddit'){modules['subredditInfo'].hideTimer=setTimeout(function(){modules['subredditInfo'].hideSubredditInfo()},modules['subredditInfo'].options.fadeDelay.value)}},false);document.body.appendChild(this.subredditInfoToolTip);this.addListeners();RESUtils.watchForElement('siteTable',modules['subredditInfo'].addListeners)}},addListeners:function(a){var a=a||document.body;var b=document.body.querySelectorAll('.listing-page a.subreddit');if(b){var c=b.length;for(var i=0;i<c;i++){var d=b[i];d.addEventListener('mouseover',function(e){modules['subredditInfo'].showTimer=setTimeout(function(){modules['subredditInfo'].showSubredditInfo(e.target)},modules['subredditInfo'].options.hoverDelay.value)},false);d.addEventListener('mouseout',function(e){clearTimeout(modules['subredditInfo'].showTimer)},false)}}},showSubredditInfo:function(c){var d=RESUtils.getXYpos(c);var e=c.textContent;$(this.subredditInfoToolTipHeader).html('<a href="/r/'+escapeHTML(e)+'">/r/'+escapeHTML(e)+'</a>');$(this.subredditInfoToolTipContents).html('<a class="hoverSubreddit" href="/user/'+escapeHTML(e)+'">'+escapeHTML(e)+'</a>:<br><img src="'+RESConsole.loader+'"> loading...');if((window.innerWidth-d.x)<=412){this.subredditInfoToolTip.setAttribute('style','top: '+(d.y-14)+'px; left: '+(d.x-180)+'px;')}else{this.subredditInfoToolTip.setAttribute('style','top: '+(d.y-14)+'px; left: '+(d.x-10)+'px;')}if(this.options.fadeSpeed.value<0||this.options.fadeSpeed.value>1||isNaN(this.options.fadeSpeed.value)){this.options.fadeSpeed.value=0.3}RESUtils.fadeElementIn(this.subredditInfoToolTip,this.options.fadeSpeed.value);setTimeout(function(){if(!RESUtils.elementUnderMouse(modules['subredditInfo'].subredditInfoToolTip)){modules['subredditInfo'].hideSubredditInfo()}},1000);if(typeof(this.subredditInfoCache[e])!='undefined'){this.writeSubredditInfo(this.subredditInfoCache[e])}else{GM_xmlhttpRequest({method:"GET",url:location.protocol+"//"+location.hostname+"/r/"+e+"/about.json?app=res",onload:function(a){var b=JSON.parse(a.responseText);modules['subredditInfo'].subredditInfoCache[e]=b;modules['subredditInfo'].writeSubredditInfo(b)}})}},writeSubredditInfo:function(a){var b=a.data.created;var d=new Date(b*1000);var c;a.data.over18===true?c='Yes':c='No';var e='<div class="subredditLabel">Subreddit created:</div> <div class="subredditDetail">'+RESUtils.niceDate(d,this.options.USDateFormat.value)+' ('+RESUtils.niceDateDiff(d)+')</div>';e+='<div class="subredditLabel">Subscribers:</div> <div class="subredditDetail">'+RESUtils.addCommas(a.data.subscribers)+'</div>';e+='<div class="subredditLabel">Title:</div> <div class="subredditDetail">'+escapeHTML(a.data.title)+'</div>';e+='<div class="subredditLabel">Over 18:</div> <div class="subredditDetail">'+escapeHTML(c)+'</div>';e+='<div class="clear"></div><div id="subTooltipButtons" class="bottomButtons">';e+='<div class="clear"></div></div>';$(this.subredditInfoToolTipContents).html(e);if(modules['subredditManager'].isEnabled()){var f=document.createElement('span');f.setAttribute('style','display: inline-block !important;');f.setAttribute('class','RESshortcut RESshortcutside');f.setAttribute('subreddit',a.data.display_name.toLowerCase());var g=-1;for(var i=0,len=modules['subredditManager'].mySubredditShortcuts.length;i<len;i++){if(modules['subredditManager'].mySubredditShortcuts[i].subreddit.toLowerCase()==a.data.display_name.toLowerCase()){g=i;break}}if(g!=-1){f.textContent='-shortcut';f.setAttribute('title','Remove this subreddit from your shortcut bar');addClass(f,'remove')}else{f.textContent='+shortcut';f.setAttribute('title','Add this subreddit to your shortcut bar')}f.addEventListener('click',modules['subredditManager'].toggleSubredditShortcut,false);$('#subTooltipButtons').append(f)}if(modules['dashboard'].isEnabled()){var h=document.createElement('span');h.setAttribute('class','RESDashboardToggle');h.setAttribute('subreddit',a.data.display_name.toLowerCase());var j=false;for(var i=0,len=modules['dashboard'].widgets.length;i<len;i++){if((modules['dashboard'].widgets[i])&&(modules['dashboard'].widgets[i].basePath.toLowerCase()=='/r/'+a.data.display_name.toLowerCase())){j=true;break}}if(j){h.textContent='-dashboard';h.setAttribute('title','Remove this subreddit from your dashboard');addClass(h,'remove')}else{h.textContent='+dashboard';h.setAttribute('title','Add this subreddit to your dashboard')}h.addEventListener('click',modules['dashboard'].toggleDashboard,false);$('#subTooltipButtons').append(h)}if(modules['filteReddit'].isEnabled()){var k=document.createElement('span');k.setAttribute('class','RESFilterToggle');k.setAttribute('subreddit',a.data.display_name.toLowerCase());var j=false;var l=modules['filteReddit'].options.subreddits.value;for(var i=0,len=l.length;i<len;i++){if((l[i])&&(l[i][0].toLowerCase()==a.data.display_name.toLowerCase())){j=true;break}}if(j){k.textContent='-filter';k.setAttribute('title','Stop filtering from /r/all and /domain/*');addClass(k,'remove')}else{k.textContent='+filter';k.setAttribute('title','Filter this subreddit from /r/all and /domain/*')}k.addEventListener('click',modules['filteReddit'].toggleFilter,false);$('#subTooltipButtons').append(k)}},hideSubredditInfo:function(a){if(this.options.fadeSpeed.value<0||this.options.fadeSpeed.value>1||isNaN(this.options.fadeSpeed.value)){this.options.fadeSpeed.value=0.3}RESUtils.fadeElementOut(this.subredditInfoToolTip,this.options.fadeSpeed.value)}};m_chp=modules['commentHidePersistor']={moduleID:'commentHidePersistor',moduleName:'Comment Hide Persistor',category:'Comments',description:'Saves the state of hidden comments across page views.',allHiddenThings:{},hiddenKeys:[],hiddenThings:[],hiddenThingsKey:window.location.href,maxKeys:100,pruneKeysTo:50,options:{},isEnabled:function(){return RESConsole.getModulePrefs(this.moduleID)},include:new Array(/https?:\/\/([a-z]+).reddit.com\/[-\w\.\/]+\/comments\/[-\w\.]+/i,/https?:\/\/([a-z]+).reddit.com\/comments\/[-\w\.]+/i),isMatchURL:function(){return RESUtils.isMatchURL(this.moduleID)},go:function(){if((this.isEnabled())&&(this.isMatchURL())){m_chp.bindToHideLinks();m_chp.hideHiddenThings()}},bindToHideLinks:function(){$('a.expand').live('click',function(){var a=$(this).parents('.thing'),thingId=a.data('fullname'),collapsing=!$(this).parent().is('.collapsed');if(m_chp.hiddenKeys.indexOf(m_chp.hiddenThingsKey)==-1){m_chp.hiddenKeys.push(m_chp.hiddenThingsKey)}if(collapsing){m_chp.addHiddenThing(thingId)}else{m_chp.removeHiddenThing(thingId)}})},loadHiddenThings:function(){var a=RESStorage.getItem('RESmodules.commentHidePersistor.hidePersistor')if(a){try{m_chp.hidePersistorData=safeJSON.parse(a)m_chp.allHiddenThings=m_chp.hidePersistorData['hiddenThings']m_chp.hiddenKeys=m_chp.hidePersistorData['hiddenKeys']if(m_chp.hiddenKeys.length>m_chp.maxKeys){var b=m_chp.maxKeys-m_chp.pruneKeysTo,newHiddenThings={},newHiddenKeys=[];for(var i=b;i<m_chp.hiddenKeys.length;i++){var c=m_chp.hiddenKeys[i];newHiddenKeys.push(c);newHiddenThings[c]=m_chp.allHiddenThings[c]}m_chp.allHiddenThings=newHiddenThings;m_chp.hiddenKeys=newHiddenKeys;m_chp.syncHiddenThings()}if(typeof m_chp.allHiddenThings[m_chp.hiddenThingsKey]!=='undefined'){m_chp.hiddenThings=m_chp.allHiddenThings[m_chp.hiddenThingsKey];return}}catch(e){}}},addHiddenThing:function(a){var i=m_chp.hiddenThings.indexOf(a);if(i===-1){m_chp.hiddenThings.push(a)}m_chp.syncHiddenThings()},removeHiddenThing:function(a){var i=m_chp.hiddenThings.indexOf(a);if(i!==-1){m_chp.hiddenThings.splice(i,1)}m_chp.syncHiddenThings()},syncHiddenThings:function(){var a;m_chp.allHiddenThings[m_chp.hiddenThingsKey]=m_chp.hiddenThings;a={'hiddenThings':m_chp.allHiddenThings,'hiddenKeys':m_chp.hiddenKeys}RESStorage.setItem('RESmodules.commentHidePersistor.hidePersistor',JSON.stringify(a))},hideHiddenThings:function(){m_chp.loadHiddenThings();for(var i=0,il=m_chp.hiddenThings.length;i<il;i++){var b=m_chp.hiddenThings[i],$hideLink=document.querySelector('div.id-'+b+' > div.entry div.noncollapsed a.expand');if($hideLink){(function(a){window.setTimeout(function(){RESUtils.click(a)},0)})($hideLink)}}}};var Konami=function(){var f={addEvent:function(a,b,c,d){if(a.addEventListener)a.addEventListener(b,c,false);else if(a.attachEvent){a["e"+b+c]=c;a[b+c]=function(){a["e"+b+c](window.event,d)}a.attachEvent("on"+b,a[b+c])}},input:"",prepattern:"38384040373937396665",almostThere:false,pattern:"3838404037393739666513",load:function(b){this.addEvent(document,"keydown",function(e,a){if(a)f=a;f.input+=e?e.keyCode:event.keyCode;if(f.input.length>f.pattern.length)f.input=f.input.substr((f.input.length-f.pattern.length));if(f.input==f.pattern){f.code(b);f.input="";return}else if((f.input==f.prepattern)||(f.input.substr(2,f.input.length)==f.prepattern)){f.almostThere=true;setTimeout(function(){f.almostThere=false},2000)}},this);this.iphone.load(b)},code:function(a){window.location=a},iphone:{start_x:0,start_y:0,stop_x:0,stop_y:0,tap:false,capture:false,orig_keys:"",keys:["UP","UP","DOWN","DOWN","LEFT","RIGHT","LEFT","RIGHT","TAP","TAP","TAP"],code:function(a){f.code(a)},load:function(b){this.orig_keys=this.keys;f.addEvent(document,"touchmove",function(e){if(e.touches.length==1&&f.iphone.capture==true){var a=e.touches[0];f.iphone.stop_x=a.pageX;f.iphone.stop_y=a.pageY;f.iphone.tap=false;f.iphone.capture=false;f.iphone.check_direction()}});f.addEvent(document,"touchend",function(a){if(f.iphone.tap==true)f.iphone.check_direction(b)},false);f.addEvent(document,"touchstart",function(a){f.iphone.start_x=a.changedTouches[0].pageX f.iphone.start_y=a.changedTouches[0].pageY f.iphone.tap=true f.iphone.capture=true})},check_direction:function(a){x_magnitude=Math.abs(this.start_x-this.stop_x)y_magnitude=Math.abs(this.start_y-this.stop_y)x=((this.start_x-this.stop_x)<0)?"RIGHT":"LEFT";y=((this.start_y-this.stop_y)<0)?"DOWN":"UP";result=(x_magnitude>y_magnitude)?x:y;result=(this.tap==true)?"TAP":result;if(result==this.keys[0])this.keys=this.keys.slice(1,this.keys.length)if(this.keys.length==0){this.keys=this.orig_keys;this.code(a)}}}}return f};function RESPreloadCSS(){RESUtils.addCSS(' #RESConsole { 	visibility: hidden; 	color: #000; 	font-size: 12px; 	z-index: 1000; 	position: fixed; 	margin: auto; 	top: -1500px; 	left: 1.5%; 	width: 95%; 	height: 85%; 	overflow: hidden; 	padding: 10px; 	box-shadow: 10px 10px 10px #aaa; 	-moz-box-shadow: 10px 10px 10px #aaa; 	-webkit-box-shadow: 10px 10px 10px #aaa; 	border-radius: 3px 3px 3px 3px; 	-moz-border-radius: 3px 3px 3px 3px; 	-webkit-border-radius: 3px 3px 3px 3px; 	/* border: 4px solid #CCCCCC; */ 	background-color: #ffffff; 	-webkit-transition:top 0.5s ease-in-out; 	-moz-transition:top 0.5s ease-in-out; 	-o-transition:top 0.5s ease-in-out; 	-ms-transition:top 0.5s ease-in-out; 	-transition:top 0.5s ease-in-out; } #RESConsole.slideIn { 	visibility: visible; 	top: 30px; } #RESConsole.slideOut { 	visibility: visible; 	top: -1500px; } #modalOverlay { 	display: none; 	z-index: 999; 	position: fixed; 	top: 0px; 	left: 0px; 	width: 100%; 	height: 100%; 	background-color: #c9c9c9; 	opacity: 0; 	-webkit-transition:opacity 0.4s ease-in-out; 	-moz-transition:opacity 0.4s ease-in-out; 	-o-transition:opacity 0.4s ease-in-out; 	-ms-transition:opacity 0.4s ease-in-out; 	-transition:opacity 0.4s ease-in-out; } #modalOverlay.fadeIn { 	display: block; 	opacity: 0.9; } #modalOverlay.fadeOut { 	display: block; 	opacity: 0; 	height: 0; } #RESSettingsButton { 	display: inline-block; 	margin: auto; 	margin-bottom: -2px; 	width: 15px; 	height: 15px; 	background-image: url(\'http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png\'); 	background-repeat: no-repeat; 	background-position: 0px -209px; } #RESSettingsButton.newNotification, .gearIcon.newNotification { 	cursor: pointer; 	background-position: 0px -134px; } #DashboardLink a { 	display: block; 	width: auto; 	height: auto; } #RESMainGearOverlay { 	position: absolute; 	display: none; 	width: 27px; 	height: 24px; 	border: 1px solid #336699; 	border-bottom: 1px solid #5f99cf; 	background-color: #5f99cf; 	border-radius: 3px 3px 0px 0px; 	z-index: 10000; } .gearIcon { 	position: absolute; 	top: 3px; 	left: 6px; 	width: 15px; 	height: 15px; 	background-image: url(\'http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png\'); 	background-repeat: no-repeat; 	background-position: 0px -209px; } #RESPrefsDropdown { 	display: none; 	position: absolute; 	z-index: 10000; } .RESDropdownList { 	list-style-type: none; 	background-color: #5f99cf; 	width: 180px; 	border-radius: 0px 0px 3px 3px; 	border: 1px solid #336699; 	border-bottom: none; 	margin-top: -1px; } .RESDropdownList li { 	cursor: pointer; 	border-bottom: 1px solid #336699; 	height: 35px; 	line-height: 34px; 	font-weight: bold; 	color: #c9def2; 	padding-left: 10px; } .RESDropdownList a, .RESDropdownList a:visited { 	display: inline-block; 	width: 100%; 	height: 100%; 	color: #c9def2; } .RESDropdownList li:hover, .RESDropdownList li a:hover { 	background-color: #9cc6ec; 	color: #336699; } .editButton { 	cursor: pointer; 	width: 24px; 	height: 22px; 	background-repeat: no-repeat; 	background-position: 2px 2px; 	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAY5JREFUeNpi/P//PwM1ABMDlcDAGHTgwAFxigy6d+8e0507d+p+/PixaseOHf1kGfTw4UPON2/edL9//77R0NDQ7unTp2pbtmzZSpJBp0+fFgZSE7W0tIrevXvHcObMGQYFBQWvs2fPftq+fft6ogwCKlY4d+7cPKBhqX///mXQ0NBgAHqP4erVqyDpX/z8/F0EDQJqNj558uRsOTk5v8+fPzOsX7+eAZTeVFVVGV69etXi4uLSYWVldRxZDyN6ggS6xBZoSLuKioo1yJCXL18yPH78mIGdnZ1BVFQ0w8LCYqOxsfELvGF06tQp9pUrV3rp6elZf/jwgeH58+cMwMBl+PTpEyjQq3R0dFZiMwTDRRMmTFADuuLKr1+/WAUEBMAu+fnzJ8ig7MzMzLk2NjY/iUpHgoKCrmlpaawgNsglnJycDGxsbJHR0dEz8BkCAizInG3btglJSUkxaGtrM+zfvx8UsF5LlizZTkyiRfFaenr6/2vXrlXKyMj8/vfv33VgeG0jNvswDt9iBCDAAGGFwZtPlqrJAAAAAElFTkSuQmCC) } .optionsTable .deleteButton { 	cursor: pointer; 	width: 16px; 	height: 16px; 	background-image: url(data:image/gif;base64,R0lGODlhEAAQAOZOAP///3F6hcopAJMAAP/M//Hz9OTr8ZqksMTL1P8pAP9MDP9sFP+DIP8zAO7x8/D1/LnEz+vx+Flha+Ln7OLm61hhayk0QCo1QMfR2eDo8b/K1M/U2pqiqcfP15WcpcLK05ymsig0P2lyftnf5naBi8XJzZ6lrJGdqmBqdKissYyZpf/+/puotNzk66ayvtbc4rC7x9Xd5n+KlbG7xpiirnJ+ivDz9KKrtrvH1Ojv9ePq8HF8h2x2gvj9/yYyPmRueFxlb4eRm+71+kFLVdrb3c/X4KOnrYGMl3uGke/0+5Sgq1ZfaY6Xn/X4+f///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAE4ALAAAAAAQABAAAAexgE6CggGFAYOIiAEPEREPh4lOhpOUgwEAmJmaABuQAUktMUUYGhAwLiwnKp41REYmHB5MQUcyN0iQTjsAHU05ICM4SjMQJIg8AAgFBgcvE5gUJYgiycsHDisCApjagj/VzAACBATa5AJOKOAHAAMMDOTvA05A6w7tC/kL804V9uIKAipA52QJgA82dNAQRyBBgwYJyjmRgKmHkAztHA4YAJHfEB8hLFxI0W4AACcbnQQCADs=) } #openRESPrefs { 	display: inline-block; 	height: 100%; } #RESConsoleHeader { 	width: 100%; } #RESLogo { 	margin-right: 5px; 	float: left; } .RESDialogTopBar { 	border-radius: 3px 3px 0px 0px; 	-moz-border-radius: 3px 3px 0px 0px; 	-webkit-border-radius: 3px 3px 0px 0px; 	position: absolute; 	top: 0px; 	left: 0px; 	right: 0px; 	height: 40px; 	margin-bottom: 10px; 	padding-top: 10px; 	padding-left: 10px; 	padding-right: 10px; 	border-bottom: 1px solid #c7c7c7; 	background-color: #F0F3FC; 	float: left; } #RESConsoleTopBar h1 { 	float: left; 	margin-top: 6px; 	padding: 0px; 	font-size: 14px; } #RESConsoleSubredditLink { 	float: right; 	margin-right: 34px; 	margin-top: 7px; 	font-size: 11px; } #RESKnownBugs, #RESKnownFeatureRequests { 	list-style-type: disc; } .RESCloseButton { 	position: absolute; 	top: 7px; 	right: 7px; 	font: 12px Verdana, sans-serif; 	background-color: #ffffff; 	border: 1px solid #d7d9dc; 	border-radius: 3px 3px 3px 3px; 	-moz-border-radius: 3px 3px 3px 3px; 	-webkit-border-radius: 3px 3px 3px 3px; 	color: #9a958e; 	text-align: center; 	line-height: 22px; 	width: 24px; 	height: 24px; 	z-index: 1000; 	cursor: pointer; } #RESConsoleTopBar .RESCloseButton { 	top: 9px; 	right: 9px; } .RESCloseButton:hover { 	border: 1px solid #999999; 	background-color: #dddddd; } #RESClose { 	float: right; 	margin-top: 2px; 	margin-right: 0px; } .RESDialogSmall { 	background-color: #ffffff; 	border: 1px solid #c7c7c7; 	border-radius: 3px 3px 3px 3px; 	-moz-border-radius: 3px 3px 3px 3px; 	-webkit-border-radius: 3px 3px 3px 3px; 	font-size: 12px; 	color: #666666; 	position: relative; } .RESDialogSmall > h3 { 	color: #000000; 	font-size: 14px; 	margin-top: 6px; 	margin-bottom: 10px; 	font-weight: normal; 	position: absolute; 	top: -5px; 	left: 0px; 	right: 0px; 	background-color: #f0f3fc; 	border-bottom: 1px solid #c7c7c7; 	width: auto; 	z-index: 10; 	height: 28px; 	padding-left: 10px; 	padding-top: 12px; } .RESDialogSmall .RESDialogContents, .usertext-edit .RESDialogSmall .md.RESDialogContents { 	padding: 56px 12px 12px 12px;  } .usertext-edit .RESDialogSmall .md.RESDialogContents { 	border: none; } #RESHelp { 	background-image: url("http://e.thumbs.redditmedia.com/r22WT2K4sio9Bvev.png"); 	background-position: -16px -120px; 	margin-right: 8px; 	width: 16px; 	height: 16px; 	float: right; 	cursor: pointer; } #RESMenu { 	position: absolute; 	top: 60px; 	left: 15px; 	right: 0px; 	height: 30px; } #RESMenu li { 	float: left; 	text-align: center; 	/* min-width: 80px; */ 	height: 22px; 	margin-right: 15px; 	border: 1px solid #c7c7c7; 	border-radius: 3px 3px 3px 3px; 	-moz-border-radius: 3px 3px 3px 3px; 	-webkit-border-radius: 3px 3px 3px 3px; 	padding-top: 6px; 	padding-bottom: 0px; 	padding-left: 8px; 	padding-right: 8px; 	cursor: pointer; 	background-color: #dddddd; 	color: #6c6c6c; } #RESMenu li.active { 	border-color: #000000; 	background-color: #7f7f7f; 	color: #ffffff; } #RESMenu li:hover { 	border-color: #000000; } #RESConsoleContent { 	clear: both; 	padding: 6px; 	position: absolute; 	top: 100px; 	left: 0px; 	right: 0px; 	bottom: 0px; 	border-top: 1px solid #DDDDDD; 	overflow: auto; } #RESConfigPanelOptions, #RESAboutDetails { 	margin-top: 15px; 	display: block; 	margin-left: 220px; } #allOptionsContainer { 	position: relative; } #moduleOptionsScrim { 	display: none; 	position: absolute; 	top: 1px; 	left: 4px; 	right: 13px; 	bottom: 1px; 	border-radius:2px 	z-index: 1500; 	background-color: #DDDDDD; 	opacity: 0.7; } #moduleOptionsScrim.visible { 	display: block; } #RESConfigPanelModulesPane, #RESAboutPane { 	float: left; 	width: 195px; 	padding-right: 15px; 	border-right: 1px solid #dedede; 	height: 100%; } .moduleButton { 	font-size: 12px; 	color: #868686; 	text-align: right; 	padding-bottom: 3px; 	padding-top: 3px; 	margin-bottom: 12px; 	cursor: pointer; 	opacity: 0.5; } .moduleButton.enabled { 	opacity: 1; } .moduleButton:hover { 	text-decoration: underline; } .moduleButton.active, .moduleButton.active:hover { 	opacity: 1; 	font-weight: bold; } .RESPanel { 	display: none; } .clear { 	clear: both; } #keyCodeModal { 	display: none; 	width: 200px; 	height: 40px; 	position: absolute; 	z-index: 1000; 	background-color: #FFFFFF; 	padding: 4px; 	border: 2px solid #CCCCCC; } p.moduleListing { 	padding-left: 5px; 	padding-right: 5px; 	padding-top: 5px; 	padding-bottom: 15px; 	border: 1px solid #BBBBBB; 	-moz-box-shadow: 3px 3px 3px #BBB; 	-webkit-box-shadow: 3px 3px 3px #BBB; } #RESConsoleModulesPanel label { 	float: left; 	width: 15%; 	padding-top: 6px; } #RESConsoleModulesPanel input[type=checkbox] { 	float: left; 	margin-left: 10px; } #RESConsoleModulesPanel input[type=button] { 	float: right; 	padding: 3px; 	margin-left: 20px; 	font-size: 12px; 	border: 1px solid #DDDDDD; 	-moz-box-shadow: 3px 3px 3px #BBB; 	-webkit-box-shadow: 3px 3px 3px #BBB; 	background-color: #F0F3FC; 	margin-bottom: 10px; } #RESConsoleModulesPanel p { 	overflow: auto; 	clear: both; 	margin-bottom: 10px; } .moduleDescription { 	float: left; 	width: 500px; 	margin-left: 10px; 	padding-top: 6px; } #RESConfigPanelOptions .moduleDescription { 	margin-left: 0px; 	margin-top: 10px; 	padding-top: 0px; 	clear: both; 	width: auto; } .moduleToggle, .toggleButton { 	float: left; 	width: 60px; 	height: 20px; 	cursor: pointer; } .moduleHeader { 	border: 1px solid #c7c7c7; 	border-radius: 2px 2px 2px 2px; 	padding: 12px; 	background-color: #f0f3fc; 	display: block; 	margin-bottom: 12px; 	margin-right: 12px; 	margin-left: 3px; 	overflow: auto; } .moduleName { 	font-size: 16px; 	float: left; 	margin-right: 15px; } #RESConsole .toggleButton { 	margin-left: 10px; } .toggleButton input[type=checkbox] { 	display: none; } .moduleToggle span, .toggleButton span { 	margin-top: -3px; 	font-size: 11px; 	padding-top: 3px; 	width: 28px; 	height: 17px; 	float: left; 	display: inline-block; 	text-align: center; } .moduleToggle .toggleOn, .toggleButton .toggleOn { 	background-color: #dddddd; 	color: #636363; 	border-left: 1px solid #636363; 	border-top: 1px solid #636363; 	border-bottom: 1px solid #636363; 	border-radius: 3px 0px 0px 3px; } .moduleToggle.enabled .toggleOn, .toggleButton.enabled .toggleOn { 	background-color: #107ac4 ; 	color: #ffffff; } .moduleToggle.enabled .toggleOff, .toggleButton.enabled .toggleOff { 	background-color: #dddddd; 	color: #636363; } .moduleToggle .toggleOff, .toggleButton .toggleOff { 	background-color: #d02020; 	color: #ffffff; 	border-right: 1px solid #636363; 	border-top: 1px solid #636363; 	border-bottom: 1px solid #636363; 	border-radius: 0px 3px 3px 0px; } .optionContainer { 	position: relative; 	border: 1px solid #c7c7c7; 	border-radius: 2px 2px 2px 2px; 	padding: 12px; 	background-color: #f0f3fc; 	display: block; 	margin-bottom: 12px; 	margin-right: 12px; 	margin-left: 3px; 	overflow: auto; } .optionContainer table { 	clear: both; 	width: 650px; 	margin-top: 20px; } .optionContainer label { 	float: left; 	width: 175px; } .optionContainer input[type=text], .optionContainer input[type=password], div.enum { 	margin-left: 10px; 	float: left; 	width: 140px; } .optionContainer input[type=checkbox] { 	margin-left: 10px; 	margin-top: 0px; 	float: left; } .optionContainer .optionsTable input[type=text], .optionContainer .optionsTable input[type=password] { 	margin-left: 0px; } .optionsTable th, .optionsTable td { 	padding-bottom: 7px; } .optionsTable textarea { 	width: 400px; } .optionDescription { 	margin-left: 255px; } .optionDescription.textInput { 	margin-left: 340px; } .optionDescription.table { 	position: relative; 	top: auto; 	left: auto; 	right: auto; 	float: left; 	width: 100%; 	margin-left: 0px; 	margin-top: 12px; 	margin-bottom: 12px; } #RESConsoleVersion { 	float: left; 	font-size: 10px; 	color: f0f3fc; 	margin-left: 6px; 	margin-top: 7px; } #moduleOptionsSave { 	display: none; 	position: fixed; 	z-index: 1100; 	top: 98px; 	right: 4%; 	cursor: pointer; 	padding-top: 3px; 	padding-bottom: 3px; 	padding-left: 5px; 	padding-right: 5px; 	font-size: 12px; 	color: #ffffff; 	border: 1px solid #636363; 	border-radius: 3px 3px 3px 3px; 	-moz-border-radius: 3px 3px 3px 3px; 	-webkit-border-radius: 3px 3px 3px 3px; 	background-color: #5cc410; 	margin-bottom: 10px; } #moduleOptionsSave:hover { 	background-color: #73e81e; } .addRowButton { 	cursor: pointer; 	padding-top: 2px; 	padding-bottom: 2px; 	padding-right: 5px; 	padding-left: 5px; 	color: #ffffff; 	border: 1px solid #636363; 	border-radius: 3px 3px 3px 3px; 	-moz-border-radius: 3px 3px 3px 3px; 	-webkit-border-radius: 3px 3px 3px 3px; 	background-color: #107ac4; } .addRowButton:hover { 	background-color: #289dee; } #moduleOptionsSaveBottom { 	float: right; 	margin-top: 10px; 	margin-right: 30px; 	cursor: pointer; 	padding: 3px; 	font-size: 12px; 	border: 1px solid #DDDDDD; 	-moz-box-shadow: 3px 3px 3px #BBB; 	-webkit-box-shadow: 3px 3px 3px #BBB; 	background-color: #F0F3FC; 	margin-bottom: 10px; } #moduleOptionsSaveStatus { 	display: none; 	position: fixed; 	top: 98px; 	right: 160px; 	width: 180px; 	padding: 5px; 	text-align: center; 	background-color: #FFFACD; } #moduleOptionsSaveStatusBottom { 	display: none; 	float: right; 	margin-top: 10px; 	width: 180px; 	padding: 5px; 	text-align: center; 	background-color: #FFFACD; } #RESConsoleAboutPanel p { 	margin-bottom: 10px; } #RESConsoleAboutPanel ul { 	margin-bottom: 10px; 	margin-top: 10px; } #RESConsoleAboutPanel li { 	list-style-type: disc; 	margin-left: 15px; } .aboutPanel { 	background-color: #f0f3fc; 	border: 1px solid #c7c7c7; 	border-radius: 3px 3px 3px 3px; 	padding: 10px; } .aboutPanel h3 { 	margin-top: 0px; 	margin-bottom: 10px; } #DonateRES { 	display: block; } #RESTeam { 	display: none; } #AboutRESTeamImage { 	width: 100%; 	background-color: #000000; 	margin-bottom: 12px; } #AboutRESTeamImage img { 	display: block; 	margin: auto; } #AboutRES { 	display: none; } .outdated { 	float: right; 	font-size: 11px; 	margin-right: 15px; 	margin-top: 5px; } #RESNotifications { 	position: fixed; 	top: 0px; 	right: 10px; 	height: auto; 	width: 360px; 	background: none; } .RESNotification { 	opacity: 0; 	position: relative; 	font: 12px/14px Arial, Helvetica, Verdana, sans-serif; 	z-index: 99999; 	width: 360px; 	margin-top: 6px; 	border: 1px solid #ccccff; 	border-radius: 3px 3px 3px 3px; 	-moz-border-radius: 3px 3px 3px 3px; 	-webkit-border-radius: 3px 3px 3px 3px; 	color: #000000; 	background-color: #ffffff; } .RESNotification a { 	color: orangered; } .RESNotification a:hover { 	text-decoration: underline; } .RESNotification.timerOn { 	border: 1px solid #c7c7c7; } .RESNotificationContent { 	overflow: auto; 	padding: 10px; 	color: #999999; } .RESNotificationContent h2 { 	color: #000000; 	margin-bottom: 10px; } .RESNotificationHeader { 	padding-left: 10px; 	padding-right: 10px; 	background-color: #f0f3fc; 	border-bottom: #c7c7c7; 	height: 38px; } .RESNotificationHeader h3 { 	padding-top: 12px; 	font-size: 15px; } .RESNotificationClose { 	position: absolute; 	right: 0px; 	top: 0px; 	margin-right: 12px; 	margin-top: 6px; } a.RESNotificationButtonBlue { 	clear: both; 	float: right; 	cursor: pointer; 	margin-top: 12px; 	padding-top: 3px; 	padding-bottom: 3px; 	padding-left: 5px; 	padding-right: 5px; 	font-size: 12px; 	color: #ffffff !important; 	border: 1px solid #636363; 	border-radius: 3px 3px 3px 3px; 	-moz-border-radius: 3px 3px 3px 3px; 	-webkit-border-radius: 3px 3px 3px 3px; 	background-color: #107ac4; } #baconBit { 	position: fixed; 	width: 32px; 	height: 32px; 	background-image: url("http://thumbs.reddit.com/t5_2s10b_6.png"); 	top: -5%; 	left: -5%; 	z-index: 999999; 	-webkit-transform: rotate(0deg); 	-moz-transform: rotate(0deg); 	transform: rotate(0deg); 	-webkit-transition: all 2s linear; 	-moz-transition: all 2s linear; 	-o-transition: all 2s linear; 	-ms-transition: all 2s linear; 	-transition: all 2s linear; } #baconBit.makeitrain { 	top: 100%; 	left: 100%; 	-webkit-transform: rotate(2000deg); 	-moz-transform: rotate(2000deg); 	transform: rotate(2000deg); } .RESButton { margin: 5px; padding: 3px; border: 1px solid #999999; width: 120px; cursor: pointer; border-radius: 5px 5px 5px 5px; -moz-border-radius: 5px 5px 5px 5px; -webkit-border-radius: 5px 5px 5px 5px;  } .RESButton:hover { background-color: #DDDDDD;  } ')}RESPreloadCSS();var _beforeLoadComplete=false;function RESdoBeforeLoad(){if(_beforeLoadComplete)return;_beforeLoadComplete=true;for(var a in modules){if(typeof(modules[a])=='object'){RESUtils.getOptions(a)}}for(var a in modules){if(typeof(modules[a])=='object'){if(typeof(modules[a].beforeLoad)=='function')modules[a].beforeLoad()}}GM_addStyle(RESUtils.css);RESUtils.css=''}function RESInit(){RESUtils.initObservers();localStorageFail=false;try{localStorage.setItem('RES.localStorageTest','test');if(typeof(self.on)=='function'){if((localStorage.getItem('RES.lsTest')=='test')&&(localStorage.getItem('copyComplete')!='true')){RESUtils.notification('<h2>Important Alert for Greasemonkey Users!</h2>Hey! It looks like you have upgraded to RES 4.0, but used to use the Greasemonkey version of RES. You\'re going to see double until you uninstall the Greasemonkey script. However, you should first copy your settings by clicking the blue button. <b>After installing, refresh this page!</b> <a target="_blank" class="RESNotificationButtonBlue" href="http://redditenhancementsuite.com/gmutil/reddit_enhancement_suite.user.js">GM->FF Import Tool</a>',15000);localStorage.removeItem('RES.lsTest');document.body.addEventListener('DOMNodeInserted',function(a){if((a.target.tagName=='DIV')&&(a.target.getAttribute('id')&&a.target.getAttribute('id').indexOf('copyToSimpleStorage')!=-1)){GMSVtoFFSS()}},true)}}}catch(e){localStorageFail=true}addClass(document.body,'res');if(localStorageFail){RESFail="Sorry, but localStorage seems inaccessible. Reddit Enhancement Suite can't work without it. \n\n";if(typeof(safari)!='undefined'){RESFail+='Since you\'re using Safari, it might be that you\'re in private browsing mode, which unfortunately is incompatible with RES until Safari provides a way to allow extensions localStorage access.'}else if(typeof(chrome)!='undefined'){RESFail+='Since you\'re using Chrome, you might just need to go to your extensions settings and check the "Allow in Incognito" box.'}else if(typeof(opera)!='undefined'){RESFail+='Since you\'re using Opera, you might just need to go to your extensions settings and click the gear icon, then click "privacy" and check the box that says "allow interaction with private tabs".'}else{RESFail+='Since it looks like you\'re using Firefox, you probably need to go to about:config and ensure that dom.storage.enabled is set to true, and that dom.storage.default_quota is set to a number above zero (i.e. 5120, the normal default)".'}var b=document.querySelector('#header-bottom-right');if(b){var c=b.querySelector('UL');var d=document.createElement('span');d.setAttribute('class','separator');d.textContent='|';RESPrefsLink=document.createElement('a');RESPrefsLink.setAttribute('href','javascript:void(0)');RESPrefsLink.addEventListener('click',function(e){e.preventDefault();alert(RESFail)},true);RESPrefsLink.textContent='[RES - ERROR]';RESPrefsLink.setAttribute('style','color: red; font-weight: bold;');insertAfter(c,RESPrefsLink);insertAfter(c,d)}}else{document.body.addEventListener('mousemove',RESUtils.setMouseXY,false);if(location.href.match(/^(http|https):\/\/([\w]+.)?reddit\.com/i)){RESUtils.firstRun();RESUtils.checkForUpdate();RESConsole.create();RESConsole.addConsoleLink();RESConsole.addConsoleDropdown();RESUtils.checkIfSubmitting();for(var f in modules){if(typeof(modules[f])=='object'){modules[f].go()}}GM_addStyle(RESUtils.css)}if((location.href.match(/reddit.honestbleeps.com\/download/))||(location.href.match(/redditenhancementsuite.com\/download/))){var g=document.body.querySelectorAll('.install');for(var i=0,len=g.length;i<len;i++){addClass(g[i],'update');addClass(g[i],'res4');removeClass(g[i],'install')}}konami=new Konami();konami.code=function(){var a=createElementWithID('div','baconBit');document.body.appendChild(a);RESUtils.notification({header:'RES Easter Eggies!',message:'Mmm, bacon!'});setTimeout(function(){addClass(a,'makeitrain')},500)}konami.load()}}RESStorage={};function setUpRESStorage(e){if(typeof(chrome)!='undefined'){RESStorage=e;RESStorage.getItem=function(a){if(typeof(RESStorage[a])!='undefined')return RESStorage[a];return null}RESStorage.setItem=function(a,b,c){if(RESStorage[a]!=b){RESStorage[a]=b;var d={requestType:'localStorage',operation:'setItem',itemName:a,itemValue:b};if(!c){chrome.extension.sendMessage(d)}}}RESStorage.removeItem=function(a){delete RESStorage[a];var b={requestType:'localStorage',operation:'removeItem',itemName:a};chrome.extension.sendMessage(b)}window.localStorage=RESStorage}else if(typeof(safari)!='undefined'){RESStorage=e;RESStorage.getItem=function(a){if(typeof(RESStorage[a])!='undefined')return RESStorage[a];return null}RESStorage.setItem=function(a,b,c){if(RESStorage[a]!=b){RESStorage[a]=b;var d={requestType:'localStorage',operation:'setItem',itemName:a,itemValue:b}if(!c){safari.self.tab.dispatchMessage("localStorage",d)}}}RESStorage.removeItem=function(a){delete RESStorage[a];var b={requestType:'localStorage',operation:'removeItem',itemName:a}safari.self.tab.dispatchMessage("localStorage",b)}window.localStorage=RESStorage}else if(typeof(opera)!='undefined'){RESStorage=e;RESStorage.getItem=function(a){if(typeof(RESStorage[a])!='undefined')return RESStorage[a];return null}RESStorage.setItem=function(a,b,c){if(RESStorage[a]!=b){RESStorage[a]=b;var d={requestType:'localStorage',operation:'setItem',itemName:a,itemValue:b}if(!c){opera.extension.postMessage(JSON.stringify(d))}}}RESStorage.removeItem=function(a){delete RESStorage[a];var b={requestType:'localStorage',operation:'removeItem',itemName:a}opera.extension.postMessage(JSON.stringify(b))}window.localStorage=RESStorage}else if(typeof(self.on)!='undefined'){RESStorage=e;RESStorage.getItem=function(a){if(typeof(RESStorage[a])!='undefined')return RESStorage[a];return null}RESStorage.setItem=function(a,b,c){if(RESStorage[a]!=b){RESStorage[a]=b;var d={requestType:'localStorage',operation:'setItem',itemName:a,itemValue:b}if(!c){self.postMessage(d)}}}RESStorage.removeItem=function(a){delete RESStorage[a];var b={requestType:'localStorage',operation:'removeItem',itemName:a}self.postMessage(b)}window.localStorage=RESStorage}else{RESStorage.getItem=function(a){if(typeof(RESStorage[a])!='undefined')return RESStorage[a];RESStorage[a]=GM_getValue(a);if(typeof(RESStorage[a])=='undefined')return null;return GM_getValue(a)}RESStorage.setItem=function(a,b){if(typeof(b)!='undefined'){if(typeof(b)=='number'){b=b.toString()}if(RESStorage[a]!=b){RESStorage[a]=b;setTimeout(function(){GM_setValue(a,b)},0)}}return true}RESStorage.removeItem=function(a){delete RESStorage[a];GM_deleteValue(a);return true}}RESdoBeforeLoad()}(function(u){if((typeof(RESRunOnce)!='undefined')||(location.href.match(/\/toolbar\/toolbar\?id/i))||(location.href.match(/comscore-iframe/i))||(location.href.match(/static\.reddit/i))||(location.href.match(/thumbs\.reddit/i))||(location.href.match(/blog\.reddit/i))||(location.href.match(/code\.reddit/i))||(location.href.match(/metareddit.com/i))){return false}RESRunOnce=true;if(typeof(chrome)!='undefined'){var d={requestType:'getLocalStorage'};chrome.extension.sendMessage(d,function(b){if(typeof(b.importedFromForeground)=='undefined'){var c={requestType:'saveLocalStorage',data:localStorage};chrome.extension.sendMessage(c,function(a){setUpRESStorage(a)})}else{setUpRESStorage(b)}})}else if(typeof(safari)!='undefined'){d={requestType:'getLocalStorage'}safari.self.tab.dispatchMessage("getLocalStorage",d)}else if(typeof(self.on)!='undefined'){d={requestType:'getLocalStorage'}self.postMessage(d)}else if(typeof(opera)!='undefined'){console.log=opera.postError;opera.extension.addEventListener("message",operaMessageHandler,false);window.addEventListener("DOMContentLoaded",function(u){d={requestType:'getLocalStorage'}opera.extension.postMessage(JSON.stringify(d))},false)}else{(typeof(unsafeWindow)!='undefined')?ls=unsafeWindow.localStorage:ls=localStorage;if(GM_getValue('importedFromForeground')!='true'){for(var i=0,len=ls.length;i<len;i++){var e=ls.getItem(ls.key(i));if(typeof(e)!='undefined'){if((typeof(e)=='number')&&(e>2147483647)){e=e.toString()}if(ls.key(i)){GM_setValue(ls.key(i),e)}}}GM_setValue('importedFromForeground','true')}setUpRESStorage()}})();function RESInitReadyCheck(){if((typeof(RESStorage.getItem)!='function')||(document.body==null)){setTimeout(RESInitReadyCheck,50)}else{if(typeof(self.on)=='function'){document=unsafeWindow.document;window=unsafeWindow;if(typeof($)!='function'){console.log('Uh oh, something has gone wrong loading jQuery...')}}else if((typeof(unsafeWindow)!='undefined')&&(unsafeWindow.jQuery)){if(typeof($)=='undefined'){$=unsafeWindow.jQuery;jQuery=$}}else if(typeof(window.jQuery)=='function'){$=window.jQuery;jQuery=$}else{if(typeof($)!='function'){console.log('Uh oh, something has gone wrong loading jQuery...')}}if(typeof(opera)!='undefined'){if(typeof(opera.getFileData)=='function'){(function(){var e=opera.extension,t={text:"readAsText",json:"readAsText",dataurl:"readAsDataURL",arraybuffer:"readAsArrayBuffer"};"getFile"in e&&!("getFileData"in e)&&(e.getFileData=function(e,n,r){typeof n=="function"?(r=n,n="text"):(n=n&&n.toLowerCase(),n=n in t?n:"text");if(typeof r!="function")return;var i=opera.extension.getFile(e);if(i){var s=new FileReader;s.onload=function(e){if(n=="json")try{r(JSON.parse(s.result),i)}catch(e){r(null)}else r(s.result,i)},s.onerror=function(e){r(null)},s[t[n]](i)}else setTimeout(r,0,null,i)})})();var a=this,require=function(){function define(e,t){typeof e=="function"||typeof t!="function"?define.compiled=typeof e=="undefined"?null:e:(define._wait=!0,require(e,function(e){var n=[].slice.call(arguments,1),r=e.pop();r.cb(t.apply(a,n))}.bind(a,define._store)))}return define.compiled=null,define._store=null,define._wait=!1,function(){function _compile(){define.compiled=null,define._store=arguments[1]._store;with({})eval(arguments[0]);return define._wait?(define._wait=!1,arguments[1]._store.push({cb:arguments[3],path:arguments[4]}),!1):(processData(define.compiled,arguments[1],arguments[2]),!0)}function processData(e,t,n){t.temp[n]&&delete t.temp[n],t.add(e,n);var r=t.path;if(!(r[n]in require._cache)||e&&require._cache[r[n]]===null)require._cache[r[n]]=e;var i=t.temp[n+1];if(i)if(!i.parsedPath[1]){var s=_compile(i.data,t,n+1,i.cb,i.parsedPath[0]);s||(require._cache[i.path]=null)}else processData(i.data,t,n+1)}function wait(e,t){setTimeout(function(){t.apply(a,e)},0)}function compileCB(e,t,n,r){processData(r,t,n),t.length==t.path.length&&e&&wait(t,e)}function parsePath(e){var t=e.split("!");return!t[1]&&e.indexOf(/\.js$/i)==-1&&(t[0]=e+=".js"),t}return function(e,t){var n=[];n.temp=[],n._store=[],n.add=function(r,i){return this.length==i?(this.push(r),!0):(this.temp[i]={data:r,cb:compileCB.bind(a,t,n,i),parsedPath:parsePath(e[i]),path:e[i]},!1)};if(!e.length)return wait(n,t),null;Array.isArray(e)||(e=[e]),n.path=e;for(var r=0,i=e.length;r<i;r++){if(e[r]==="!domReady"){document.readyState=="complete"||document.readyState=="interactive"?processData(document,n,r):document.addEventListener("DOMContentLoaded",function(r){processData(document,n,r),n.length==e.length&&t&&wait(n,t)}.bind(a,r));continue}var s=parsePath(e[r]);if(!s[0]){processData(null,n,r);continue}if(e[r]in require._cache){processData(require._cache[e[r]],n,r);continue}opera.extension.getFileData((require._base||"")+s[0],s[1]||"text",function(r,i,s){if(s)if(!i[1]){if(n.length!=r){if(n.length>r){debugger;alert("oh shit, this shoud not happen!")}processData(s,n,r);return}var o=_compile(s,n,r,compileCB.bind(a,t,n,r),i[0]);if(!o){require._cache[e[r]]=null;return}}else processData(s,n,r);else processData(null,n,r);n.length==e.length&&t&&wait(n,t)}.bind(a,r,s))}if(n.length==e.length)return t&&wait(n,t),n.length==1?n[0]:n}}()}();require._cache={},require._base="/modules/";require(['guiders-1.2.8','jquery.dragsort-0.4.3.min','jquery.tokeninput','jquery-fieldselection.min','tinycon.min','snuownd'],function(){Tinycon=window.Tinycon;RESInit()})}else{RESInit()}}else{$(document).ready(RESInit)}}}window.onload=RESInitReadyCheck();var lastPerf=0;function perfTest(a){var d=new Date();var b=d.getTime()-lastPerf;console.log(a+' executed. Diff since last: '+b+'ms');lastPerf=d.getTime()}